Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.076604 mse_soft=1.074281 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=23.181757 best_discrete=23.181757 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.874076 mse_soft=0.871887 ent_in=3.6309 ent_out=3.6654 rowmax_in=0.0451 rowmax_out=0.0449 discrete_mse=930.761597 best_discrete=23.181757 hash=False elapsed=2.5s
step    50/900 tau=0.8260 loss=0.653715 mse_soft=0.651816 ent_in=3.1220 ent_out=3.2103 rowmax_in=0.0905 rowmax_out=0.0905 discrete_mse=5516.632812 best_discrete=23.181757 hash=False elapsed=4.5s
step    75/900 tau=0.7493 loss=0.502853 mse_soft=0.501291 ent_in=2.5766 ent_out=2.6280 rowmax_in=0.2018 rowmax_out=0.2036 discrete_mse=482.717743 best_discrete=23.181757 hash=False elapsed=6.6s
step   100/900 tau=0.6797 loss=0.393008 mse_soft=0.391854 ent_in=1.9972 ent_out=1.8511 rowmax_in=0.3484 rowmax_out=0.4027 discrete_mse=905.314087 best_discrete=23.181757 hash=False elapsed=8.9s
step   125/900 tau=0.6165 loss=0.340091 mse_soft=0.339269 ent_in=1.6189 ent_out=1.1203 rowmax_in=0.4288 rowmax_out=0.6469 discrete_mse=489.476074 best_discrete=23.181757 hash=False elapsed=11.0s
step   150/900 tau=0.5592 loss=0.315508 mse_soft=0.314854 ent_in=1.4413 ent_out=0.7377 rowmax_in=0.4601 rowmax_out=0.7530 discrete_mse=595.852539 best_discrete=23.181757 hash=False elapsed=13.2s
step   175/900 tau=0.5073 loss=0.302727 mse_soft=0.302152 ent_in=1.3317 ent_out=0.5860 rowmax_in=0.4751 rowmax_out=0.7881 discrete_mse=1092.800781 best_discrete=23.181757 hash=False elapsed=15.4s
step   200/900 tau=0.4602 loss=0.295386 mse_soft=0.294851 ent_in=1.2676 ent_out=0.5161 rowmax_in=0.4869 rowmax_out=0.8052 discrete_mse=971.002258 best_discrete=23.181757 hash=False elapsed=17.4s
step   225/900 tau=0.4174 loss=0.290909 mse_soft=0.290400 ent_in=1.2326 ent_out=0.4627 rowmax_in=0.4909 rowmax_out=0.8197 discrete_mse=963.200378 best_discrete=23.181757 hash=False elapsed=19.5s
step   250/900 tau=0.3786 loss=0.286824 mse_soft=0.286340 ent_in=1.2009 ent_out=0.4136 rowmax_in=0.4963 rowmax_out=0.8333 discrete_mse=678.774353 best_discrete=23.181757 hash=False elapsed=21.6s
step   275/900 tau=0.3434 loss=0.284597 mse_soft=0.284125 ent_in=1.1813 ent_out=0.3916 rowmax_in=0.4980 rowmax_out=0.8389 discrete_mse=1828.208008 best_discrete=23.181757 hash=False elapsed=23.7s
step   300/900 tau=0.3115 loss=0.283021 mse_soft=0.282559 ent_in=1.1634 ent_out=0.3754 rowmax_in=0.4995 rowmax_out=0.8424 discrete_mse=870.603394 best_discrete=23.181757 hash=False elapsed=25.8s
step   325/900 tau=0.2826 loss=0.280902 mse_soft=0.280448 ent_in=1.1562 ent_out=0.3570 rowmax_in=0.4990 rowmax_out=0.8497 discrete_mse=870.603394 best_discrete=23.181757 hash=False elapsed=27.8s
step   350/900 tau=0.2563 loss=0.279798 mse_soft=0.279354 ent_in=1.1507 ent_out=0.3310 rowmax_in=0.5007 rowmax_out=0.8618 discrete_mse=2687.694824 best_discrete=23.181757 hash=False elapsed=30.0s
step   375/900 tau=0.2325 loss=0.279297 mse_soft=0.278863 ent_in=1.1390 ent_out=0.3067 rowmax_in=0.5035 rowmax_out=0.8720 discrete_mse=2658.426270 best_discrete=23.181757 hash=False elapsed=32.2s
step   400/900 tau=0.2109 loss=0.278303 mse_soft=0.277875 ent_in=1.1389 ent_out=0.2880 rowmax_in=0.5006 rowmax_out=0.8783 discrete_mse=310.104462 best_discrete=23.181757 hash=False elapsed=34.3s
step   425/900 tau=0.1913 loss=0.277858 mse_soft=0.277435 ent_in=1.1336 ent_out=0.2783 rowmax_in=0.5017 rowmax_out=0.8817 discrete_mse=878.264282 best_discrete=23.181757 hash=False elapsed=36.4s
step   450/900 tau=0.1735 loss=0.277706 mse_soft=0.277284 ent_in=1.1312 ent_out=0.2741 rowmax_in=0.5008 rowmax_out=0.8815 discrete_mse=878.264282 best_discrete=23.181757 hash=False elapsed=38.3s
step   475/900 tau=0.1574 loss=0.279432 mse_soft=0.279012 ent_in=1.1224 ent_out=0.2756 rowmax_in=0.5039 rowmax_out=0.8796 discrete_mse=1053.489624 best_discrete=23.181757 hash=False elapsed=40.1s
step   500/900 tau=0.1428 loss=0.279047 mse_soft=0.278629 ent_in=1.1244 ent_out=0.2688 rowmax_in=0.5019 rowmax_out=0.8839 discrete_mse=803.755005 best_discrete=23.181757 hash=False elapsed=42.0s
step   525/900 tau=0.1295 loss=0.282121 mse_soft=0.281704 ent_in=1.1233 ent_out=0.2663 rowmax_in=0.5021 rowmax_out=0.8836 discrete_mse=803.755005 best_discrete=23.181757 hash=False elapsed=43.8s
step   550/900 tau=0.1175 loss=0.285439 mse_soft=0.285025 ent_in=1.1180 ent_out=0.2614 rowmax_in=0.5025 rowmax_out=0.8852 discrete_mse=1263.091919 best_discrete=23.181757 hash=False elapsed=45.8s
step   575/900 tau=0.1066 loss=0.292975 mse_soft=0.292565 ent_in=1.1141 ent_out=0.2523 rowmax_in=0.4985 rowmax_out=0.8813 discrete_mse=482.433777 best_discrete=23.181757 hash=False elapsed=47.9s
step   600/900 tau=0.0967 loss=0.284558 mse_soft=0.284162 ent_in=1.0709 ent_out=0.2475 rowmax_in=0.5209 rowmax_out=0.8898 discrete_mse=159.002121 best_discrete=23.181757 hash=False elapsed=50.1s
step   625/900 tau=0.0877 loss=0.286717 mse_soft=0.286329 ent_in=1.0513 ent_out=0.2407 rowmax_in=0.5242 rowmax_out=0.8912 discrete_mse=321.885254 best_discrete=23.181757 hash=False elapsed=52.1s
step   650/900 tau=0.0795 loss=0.323274 mse_soft=0.322887 ent_in=1.0415 ent_out=0.2503 rowmax_in=0.5325 rowmax_out=0.8815 discrete_mse=411.653931 best_discrete=23.181757 hash=False elapsed=54.1s
step   675/900 tau=0.0722 loss=0.300822 mse_soft=0.300444 ent_in=1.0097 ent_out=0.2498 rowmax_in=0.5302 rowmax_out=0.8838 discrete_mse=292.264404 best_discrete=23.181757 hash=False elapsed=56.1s
step   700/900 tau=0.0655 loss=0.298833 mse_soft=0.298450 ent_in=1.0302 ent_out=0.2491 rowmax_in=0.5290 rowmax_out=0.8828 discrete_mse=42.948730 best_discrete=23.181757 hash=False elapsed=58.3s
step   725/900 tau=0.0594 loss=0.469353 mse_soft=0.469020 ent_in=0.9162 ent_out=0.1939 rowmax_in=0.5966 rowmax_out=0.9189 discrete_mse=474.216034 best_discrete=23.181757 hash=False elapsed=60.5s
step   750/900 tau=0.0539 loss=0.397268 mse_soft=0.397015 ent_in=0.6875 ent_out=0.1557 rowmax_in=0.6841 rowmax_out=0.9249 discrete_mse=135.730789 best_discrete=23.181757 hash=False elapsed=62.8s
step   775/900 tau=0.0489 loss=0.369841 mse_soft=0.369593 ent_in=0.6617 ent_out=0.1661 rowmax_in=0.6718 rowmax_out=0.9161 discrete_mse=47.153984 best_discrete=23.181757 hash=False elapsed=65.0s
step   800/900 tau=0.0443 loss=0.348487 mse_soft=0.348230 ent_in=0.6745 ent_out=0.1826 rowmax_in=0.6662 rowmax_out=0.9023 discrete_mse=224.669525 best_discrete=23.181757 hash=False elapsed=67.2s
step   825/900 tau=0.0402 loss=0.359500 mse_soft=0.359257 ent_in=0.6208 ent_out=0.1892 rowmax_in=0.6880 rowmax_out=0.8954 discrete_mse=28.083261 best_discrete=23.181757 hash=False elapsed=69.4s
step   850/900 tau=0.0365 loss=0.432996 mse_soft=0.432799 ent_in=0.5080 ent_out=0.1508 rowmax_in=0.7343 rowmax_out=0.9236 discrete_mse=19.113369 best_discrete=19.113369 hash=False elapsed=71.5s
step   875/900 tau=0.0331 loss=0.415516 mse_soft=0.415352 ent_in=0.3943 ent_out=0.1527 rowmax_in=0.7963 rowmax_out=0.9185 discrete_mse=11.065841 best_discrete=11.065841 hash=False elapsed=73.7s
step   900/900 tau=0.0300 loss=0.414163 mse_soft=0.414001 ent_in=0.4011 ent_out=0.1374 rowmax_in=0.7744 rowmax_out=0.9242 discrete_mse=23.101049 best_discrete=11.065841 hash=False elapsed=75.8s

Final metrics:
  soft_mse_full=0.443257
  rowmax_in_mean=0.7892
  rowmax_out_mean=0.9307
  ent_in_mean=0.3833
  ent_out_mean=0.1331
  final_discrete_mse=7.339920
  hash_match=False
  best_discrete_mse_seen=11.065841
Saved results to overnight_b238_j1.json
