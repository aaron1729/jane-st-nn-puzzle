Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.084490 mse_soft=1.082167 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=77.349625 best_discrete=77.349625 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.879874 mse_soft=0.877684 ent_in=3.6325 ent_out=3.6673 rowmax_in=0.0459 rowmax_out=0.0440 discrete_mse=1439.604614 best_discrete=77.349625 hash=False elapsed=2.4s
step    50/900 tau=0.8229 loss=0.656967 mse_soft=0.655064 ent_in=3.1215 ent_out=3.2196 rowmax_in=0.0949 rowmax_out=0.0907 discrete_mse=2240.176758 best_discrete=77.349625 hash=False elapsed=4.4s
step    75/900 tau=0.7450 loss=0.523110 mse_soft=0.521525 ent_in=2.6050 ent_out=2.6783 rowmax_in=0.1919 rowmax_out=0.1913 discrete_mse=3837.858398 best_discrete=77.349625 hash=False elapsed=6.5s
step   100/900 tau=0.6745 loss=0.420603 mse_soft=0.419434 ent_in=2.0126 ent_out=1.8830 rowmax_in=0.3418 rowmax_out=0.3869 discrete_mse=1573.869019 best_discrete=77.349625 hash=False elapsed=8.8s
step   125/900 tau=0.6107 loss=0.359435 mse_soft=0.358585 ent_in=1.6218 ent_out=1.2112 rowmax_in=0.4199 rowmax_out=0.5706 discrete_mse=274.256256 best_discrete=77.349625 hash=False elapsed=11.2s
step   150/900 tau=0.5529 loss=0.336423 mse_soft=0.335712 ent_in=1.4895 ent_out=0.8801 rowmax_in=0.4348 rowmax_out=0.6793 discrete_mse=187.690781 best_discrete=77.349625 hash=False elapsed=13.5s
step   175/900 tau=0.5006 loss=0.325438 mse_soft=0.324808 ent_in=1.4132 ent_out=0.6866 rowmax_in=0.4407 rowmax_out=0.7490 discrete_mse=206.502213 best_discrete=77.349625 hash=False elapsed=15.9s
step   200/900 tau=0.4532 loss=0.316634 mse_soft=0.316050 ent_in=1.3589 ent_out=0.5865 rowmax_in=0.4502 rowmax_out=0.7698 discrete_mse=894.583984 best_discrete=77.349625 hash=False elapsed=18.1s
step   225/900 tau=0.4103 loss=0.309899 mse_soft=0.309346 ent_in=1.3218 ent_out=0.5215 rowmax_in=0.4543 rowmax_out=0.7900 discrete_mse=385.265137 best_discrete=77.349625 hash=False elapsed=20.8s
step   250/900 tau=0.3715 loss=0.304928 mse_soft=0.304403 ent_in=1.2792 ent_out=0.4686 rowmax_in=0.4661 rowmax_out=0.8016 discrete_mse=449.950287 best_discrete=77.349625 hash=False elapsed=23.2s
step   275/900 tau=0.3363 loss=0.301310 mse_soft=0.300802 ent_in=1.2520 ent_out=0.4396 rowmax_in=0.4742 rowmax_out=0.8142 discrete_mse=948.509583 best_discrete=77.349625 hash=False elapsed=25.5s
step   300/900 tau=0.3045 loss=0.299522 mse_soft=0.299029 ent_in=1.2322 ent_out=0.4131 rowmax_in=0.4791 rowmax_out=0.8244 discrete_mse=948.509583 best_discrete=77.349625 hash=False elapsed=28.0s
step   325/900 tau=0.2756 loss=0.297958 mse_soft=0.297475 ent_in=1.2210 ent_out=0.3902 rowmax_in=0.4813 rowmax_out=0.8322 discrete_mse=187.009293 best_discrete=77.349625 hash=False elapsed=30.2s
step   350/900 tau=0.2496 loss=0.301319 mse_soft=0.300846 ent_in=1.2120 ent_out=0.3650 rowmax_in=0.4838 rowmax_out=0.8402 discrete_mse=187.009293 best_discrete=77.349625 hash=False elapsed=32.6s
step   375/900 tau=0.2259 loss=0.300148 mse_soft=0.299679 ent_in=1.2061 ent_out=0.3574 rowmax_in=0.4837 rowmax_out=0.8414 discrete_mse=187.009293 best_discrete=77.349625 hash=False elapsed=35.0s
step   400/900 tau=0.2046 loss=0.299991 mse_soft=0.299524 ent_in=1.2006 ent_out=0.3551 rowmax_in=0.4845 rowmax_out=0.8410 discrete_mse=187.009293 best_discrete=77.349625 hash=False elapsed=37.2s
step   425/900 tau=0.1852 loss=0.301673 mse_soft=0.301209 ent_in=1.1966 ent_out=0.3495 rowmax_in=0.4847 rowmax_out=0.8424 discrete_mse=272.812592 best_discrete=77.349625 hash=False elapsed=39.4s
step   450/900 tau=0.1677 loss=0.296812 mse_soft=0.296350 ent_in=1.1938 ent_out=0.3449 rowmax_in=0.4852 rowmax_out=0.8433 discrete_mse=378.253632 best_discrete=77.349625 hash=False elapsed=41.6s
step   475/900 tau=0.1518 loss=0.296733 mse_soft=0.296273 ent_in=1.1892 ent_out=0.3418 rowmax_in=0.4856 rowmax_out=0.8443 discrete_mse=448.453979 best_discrete=77.349625 hash=False elapsed=44.0s
step   500/900 tau=0.1374 loss=0.297814 mse_soft=0.297357 ent_in=1.1825 ent_out=0.3404 rowmax_in=0.4896 rowmax_out=0.8425 discrete_mse=191.803070 best_discrete=77.349625 hash=False elapsed=46.5s
step   525/900 tau=0.1244 loss=0.297464 mse_soft=0.297011 ent_in=1.1735 ent_out=0.3386 rowmax_in=0.4916 rowmax_out=0.8456 discrete_mse=228.030121 best_discrete=77.349625 hash=False elapsed=48.9s
step   550/900 tau=0.1126 loss=0.311752 mse_soft=0.311314 ent_in=1.1367 ent_out=0.3235 rowmax_in=0.5029 rowmax_out=0.8384 discrete_mse=49.788616 best_discrete=49.788616 hash=False elapsed=51.1s
step   575/900 tau=0.1020 loss=0.304931 mse_soft=0.304500 ent_in=1.1298 ent_out=0.3071 rowmax_in=0.4978 rowmax_out=0.8507 discrete_mse=285.735291 best_discrete=49.788616 hash=False elapsed=53.4s
step   600/900 tau=0.0923 loss=0.305124 mse_soft=0.304692 ent_in=1.1230 ent_out=0.3180 rowmax_in=0.5017 rowmax_out=0.8553 discrete_mse=144.053314 best_discrete=49.788616 hash=False elapsed=55.7s
step   625/900 tau=0.0836 loss=0.306561 mse_soft=0.306134 ent_in=1.1120 ent_out=0.3135 rowmax_in=0.5005 rowmax_out=0.8566 discrete_mse=354.869293 best_discrete=49.788616 hash=False elapsed=57.9s
step   650/900 tau=0.0757 loss=0.301779 mse_soft=0.301352 ent_in=1.1086 ent_out=0.3121 rowmax_in=0.4977 rowmax_out=0.8588 discrete_mse=198.175323 best_discrete=49.788616 hash=False elapsed=60.3s
step   675/900 tau=0.0685 loss=0.330712 mse_soft=0.330300 ent_in=1.0584 ent_out=0.3132 rowmax_in=0.5291 rowmax_out=0.8560 discrete_mse=301.471588 best_discrete=49.788616 hash=False elapsed=62.9s
step   700/900 tau=0.0620 loss=0.399711 mse_soft=0.399400 ent_in=0.7851 ent_out=0.2501 rowmax_in=0.6463 rowmax_out=0.8647 discrete_mse=3.169418 best_discrete=3.169418 hash=False elapsed=65.2s
step   725/900 tau=0.0562 loss=0.375049 mse_soft=0.374765 ent_in=0.7250 ent_out=0.2239 rowmax_in=0.6532 rowmax_out=0.8859 discrete_mse=7.229584 best_discrete=3.169418 hash=False elapsed=67.5s
step   750/900 tau=0.0508 loss=0.389268 mse_soft=0.388979 ent_in=0.7349 ent_out=0.2282 rowmax_in=0.6252 rowmax_out=0.8821 discrete_mse=58.383057 best_discrete=3.169418 hash=False elapsed=69.9s
step   775/900 tau=0.0460 loss=0.367362 mse_soft=0.367107 ent_in=0.6094 ent_out=0.2410 rowmax_in=0.7014 rowmax_out=0.8663 discrete_mse=18.472872 best_discrete=3.169418 hash=False elapsed=72.3s
step   800/900 tau=0.0417 loss=0.358740 mse_soft=0.358493 ent_in=0.5892 ent_out=0.2319 rowmax_in=0.7030 rowmax_out=0.8728 discrete_mse=2.684929 best_discrete=2.684929 hash=False elapsed=74.6s
step   825/900 tau=0.0377 loss=0.348981 mse_soft=0.348734 ent_in=0.5904 ent_out=0.2319 rowmax_in=0.7113 rowmax_out=0.8735 discrete_mse=2.397117 best_discrete=2.397117 hash=False elapsed=77.0s
step   850/900 tau=0.0342 loss=0.349161 mse_soft=0.348912 ent_in=0.5966 ent_out=0.2320 rowmax_in=0.7092 rowmax_out=0.8738 discrete_mse=1.763117 best_discrete=1.763117 hash=False elapsed=79.4s
step   875/900 tau=0.0309 loss=0.391718 mse_soft=0.391483 ent_in=0.5378 ent_out=0.2445 rowmax_in=0.7444 rowmax_out=0.8653 discrete_mse=1.123233 best_discrete=1.123233 hash=False elapsed=81.6s
step   900/900 tau=0.0280 loss=0.359717 mse_soft=0.359490 ent_in=0.5068 ent_out=0.2481 rowmax_in=0.7461 rowmax_out=0.8624 discrete_mse=2.741521 best_discrete=1.123233 hash=False elapsed=83.6s

Final metrics:
  soft_mse_full=0.360347
  rowmax_in_mean=0.7426
  rowmax_out_mean=0.8619
  ent_in_mean=0.5108
  ent_out_mean=0.2484
  final_discrete_mse=2.741521
  hash_match=False
  best_discrete_mse_seen=1.123233
Saved results to overnight_b247_j2.json
