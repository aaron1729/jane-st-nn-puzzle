Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.059844 mse_soft=1.057522 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=48.910568 best_discrete=48.910568 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.858023 mse_soft=0.855833 ent_in=3.6327 ent_out=3.6662 rowmax_in=0.0461 rowmax_out=0.0449 discrete_mse=486.766479 best_discrete=48.910568 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.645549 mse_soft=0.643638 ent_in=3.1356 ent_out=3.2326 rowmax_in=0.0924 rowmax_out=0.0899 discrete_mse=10281.443359 best_discrete=48.910568 hash=False elapsed=4.8s
step    75/900 tau=0.7450 loss=0.507550 mse_soft=0.505963 ent_in=2.6225 ent_out=2.6698 rowmax_in=0.1921 rowmax_out=0.2044 discrete_mse=391.543243 best_discrete=48.910568 hash=False elapsed=7.0s
step   100/900 tau=0.6745 loss=0.401568 mse_soft=0.400410 ent_in=2.0304 ent_out=1.8281 rowmax_in=0.3424 rowmax_out=0.4105 discrete_mse=1180.572144 best_discrete=48.910568 hash=False elapsed=9.3s
step   125/900 tau=0.6107 loss=0.333674 mse_soft=0.332869 ent_in=1.5417 ent_out=1.1398 rowmax_in=0.4590 rowmax_out=0.6338 discrete_mse=844.645996 best_discrete=48.910568 hash=False elapsed=11.7s
step   150/900 tau=0.5529 loss=0.304150 mse_soft=0.303512 ent_in=1.3430 ent_out=0.7840 rowmax_in=0.4909 rowmax_out=0.7166 discrete_mse=283.333252 best_discrete=48.910568 hash=False elapsed=13.9s
step   175/900 tau=0.5006 loss=0.289415 mse_soft=0.288878 ent_in=1.2014 ent_out=0.5892 rowmax_in=0.5243 rowmax_out=0.7838 discrete_mse=34.999588 best_discrete=34.999588 hash=False elapsed=16.1s
step   200/900 tau=0.4532 loss=0.282229 mse_soft=0.281731 ent_in=1.1526 ent_out=0.5055 rowmax_in=0.5336 rowmax_out=0.8104 discrete_mse=108.301170 best_discrete=34.999588 hash=False elapsed=18.1s
step   225/900 tau=0.4103 loss=0.276651 mse_soft=0.276182 ent_in=1.1196 ent_out=0.4435 rowmax_in=0.5476 rowmax_out=0.8199 discrete_mse=34.001701 best_discrete=34.001701 hash=False elapsed=20.4s
step   250/900 tau=0.3715 loss=0.273597 mse_soft=0.273147 ent_in=1.0870 ent_out=0.4126 rowmax_in=0.5599 rowmax_out=0.8209 discrete_mse=61.983616 best_discrete=34.001701 hash=False elapsed=22.3s
step   275/900 tau=0.3363 loss=0.270161 mse_soft=0.269724 ent_in=1.0581 ent_out=0.4003 rowmax_in=0.5681 rowmax_out=0.8236 discrete_mse=61.983616 best_discrete=34.001701 hash=False elapsed=24.4s
step   300/900 tau=0.3045 loss=0.268324 mse_soft=0.267896 ent_in=1.0361 ent_out=0.3892 rowmax_in=0.5736 rowmax_out=0.8266 discrete_mse=18.210768 best_discrete=18.210768 hash=False elapsed=26.7s
step   325/900 tau=0.2756 loss=0.266558 mse_soft=0.266139 ent_in=1.0210 ent_out=0.3748 rowmax_in=0.5754 rowmax_out=0.8305 discrete_mse=20.754227 best_discrete=18.210768 hash=False elapsed=28.9s
step   350/900 tau=0.2496 loss=0.267957 mse_soft=0.267545 ent_in=1.0083 ent_out=0.3671 rowmax_in=0.5821 rowmax_out=0.8326 discrete_mse=4.565683 best_discrete=4.565683 hash=False elapsed=31.1s
step   375/900 tau=0.2259 loss=0.265552 mse_soft=0.265146 ent_in=0.9886 ent_out=0.3646 rowmax_in=0.5873 rowmax_out=0.8358 discrete_mse=4.565683 best_discrete=4.565683 hash=False elapsed=33.2s
step   400/900 tau=0.2046 loss=0.262755 mse_soft=0.262350 ent_in=0.9867 ent_out=0.3620 rowmax_in=0.5884 rowmax_out=0.8397 discrete_mse=4.565683 best_discrete=4.565683 hash=False elapsed=35.3s
step   425/900 tau=0.1852 loss=0.264570 mse_soft=0.264164 ent_in=0.9836 ent_out=0.3672 rowmax_in=0.5865 rowmax_out=0.8374 discrete_mse=4.565683 best_discrete=4.565683 hash=False elapsed=37.3s
step   450/900 tau=0.1677 loss=0.262768 mse_soft=0.262364 ent_in=0.9780 ent_out=0.3676 rowmax_in=0.5870 rowmax_out=0.8362 discrete_mse=130.206253 best_discrete=4.565683 hash=False elapsed=39.7s
step   475/900 tau=0.1518 loss=0.263211 mse_soft=0.262809 ent_in=0.9765 ent_out=0.3640 rowmax_in=0.5864 rowmax_out=0.8371 discrete_mse=130.206253 best_discrete=4.565683 hash=False elapsed=41.9s
step   500/900 tau=0.1374 loss=0.266541 mse_soft=0.266141 ent_in=0.9717 ent_out=0.3613 rowmax_in=0.5902 rowmax_out=0.8376 discrete_mse=130.206253 best_discrete=4.565683 hash=False elapsed=44.3s
step   525/900 tau=0.1244 loss=0.274104 mse_soft=0.273704 ent_in=0.9675 ent_out=0.3643 rowmax_in=0.5906 rowmax_out=0.8347 discrete_mse=130.206253 best_discrete=4.565683 hash=False elapsed=46.5s
step   550/900 tau=0.1126 loss=0.264133 mse_soft=0.263736 ent_in=0.9612 ent_out=0.3607 rowmax_in=0.5939 rowmax_out=0.8355 discrete_mse=130.206253 best_discrete=4.565683 hash=False elapsed=48.5s
step   575/900 tau=0.1020 loss=0.281388 mse_soft=0.280992 ent_in=0.9619 ent_out=0.3563 rowmax_in=0.5930 rowmax_out=0.8370 discrete_mse=130.206253 best_discrete=4.565683 hash=False elapsed=50.4s
step   600/900 tau=0.0923 loss=0.268797 mse_soft=0.268407 ent_in=0.9543 ent_out=0.3452 rowmax_in=0.5945 rowmax_out=0.8414 discrete_mse=2.120788 best_discrete=2.120788 hash=False elapsed=52.4s
step   625/900 tau=0.0836 loss=0.271369 mse_soft=0.270987 ent_in=0.9309 ent_out=0.3414 rowmax_in=0.6045 rowmax_out=0.8454 discrete_mse=130.206253 best_discrete=2.120788 hash=False elapsed=54.5s
step   650/900 tau=0.0757 loss=0.280300 mse_soft=0.279917 ent_in=0.9315 ent_out=0.3447 rowmax_in=0.6030 rowmax_out=0.8403 discrete_mse=130.206253 best_discrete=2.120788 hash=False elapsed=56.6s
step   675/900 tau=0.0685 loss=0.269262 mse_soft=0.268889 ent_in=0.9048 ent_out=0.3372 rowmax_in=0.6136 rowmax_out=0.8480 discrete_mse=1.606933 best_discrete=1.606933 hash=False elapsed=58.6s
step   700/900 tau=0.0620 loss=0.275549 mse_soft=0.275188 ent_in=0.8559 ent_out=0.3456 rowmax_in=0.6306 rowmax_out=0.8413 discrete_mse=8.414784 best_discrete=1.606933 hash=False elapsed=60.6s
step   725/900 tau=0.0562 loss=0.395537 mse_soft=0.395235 ent_in=0.7386 ent_out=0.2710 rowmax_in=0.6689 rowmax_out=0.8831 discrete_mse=13.174076 best_discrete=1.606933 hash=False elapsed=62.6s
step   750/900 tau=0.0508 loss=0.341496 mse_soft=0.341230 ent_in=0.6230 ent_out=0.2614 rowmax_in=0.6891 rowmax_out=0.8744 discrete_mse=11.573558 best_discrete=1.606933 hash=False elapsed=64.6s
step   775/900 tau=0.0460 loss=0.389338 mse_soft=0.389130 ent_in=0.4603 ent_out=0.2340 rowmax_in=0.7666 rowmax_out=0.8844 discrete_mse=10.368953 best_discrete=1.606933 hash=False elapsed=66.7s
step   800/900 tau=0.0417 loss=0.362582 mse_soft=0.362375 ent_in=0.4552 ent_out=0.2367 rowmax_in=0.7651 rowmax_out=0.8766 discrete_mse=63.591267 best_discrete=1.606933 hash=False elapsed=68.7s
step   825/900 tau=0.0377 loss=0.428766 mse_soft=0.428561 ent_in=0.4458 ent_out=0.2373 rowmax_in=0.7641 rowmax_out=0.8794 discrete_mse=0.873329 best_discrete=0.873329 hash=False elapsed=70.7s
step   850/900 tau=0.0342 loss=0.398283 mse_soft=0.398092 ent_in=0.4001 ent_out=0.2354 rowmax_in=0.7911 rowmax_out=0.8749 discrete_mse=2.230469 best_discrete=0.873329 hash=False elapsed=72.8s
step   875/900 tau=0.0309 loss=0.389565 mse_soft=0.389385 ent_in=0.3689 ent_out=0.2331 rowmax_in=0.8068 rowmax_out=0.8796 discrete_mse=8.864522 best_discrete=0.873329 hash=False elapsed=74.9s
step   900/900 tau=0.0280 loss=0.380283 mse_soft=0.380099 ent_in=0.3727 ent_out=0.2392 rowmax_in=0.8043 rowmax_out=0.8734 discrete_mse=4.777826 best_discrete=0.873329 hash=False elapsed=77.1s

Final metrics:
  soft_mse_full=0.389024
  rowmax_in_mean=0.8035
  rowmax_out_mean=0.8702
  ent_in_mean=0.3750
  ent_out_mean=0.2408
  final_discrete_mse=20.683006
  hash_match=False
  best_discrete_mse_seen=0.873329
Saved results to overnight_b211_j2.json
