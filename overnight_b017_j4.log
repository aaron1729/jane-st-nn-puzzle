Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.015
step     1/700 tau=1.0000 loss=1.064160 mse_soft=1.063385 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=3.332993 best_discrete=3.332993 hash=False elapsed=0.5s
step    25/700 tau=0.8810 loss=0.971915 mse_soft=0.971155 ent_in=3.7929 ent_out=3.8055 rowmax_in=0.0331 rowmax_out=0.0322 discrete_mse=16659.896484 best_discrete=3.332993 hash=False elapsed=2.4s
step    50/700 tau=0.7721 loss=0.785946 mse_soft=0.785238 ent_in=3.5146 ent_out=3.5648 rowmax_in=0.0565 rowmax_out=0.0548 discrete_mse=6576.060059 best_discrete=3.332993 hash=False elapsed=4.5s
step    75/700 tau=0.6767 loss=0.641153 mse_soft=0.640517 ent_in=3.1310 ent_out=3.2283 rowmax_in=0.0962 rowmax_out=0.0932 discrete_mse=2413.137695 best_discrete=3.332993 hash=False elapsed=6.8s
step   100/700 tau=0.5931 loss=0.528459 mse_soft=0.527907 ent_in=2.7046 ent_out=2.8198 rowmax_in=0.1817 rowmax_out=0.1734 discrete_mse=339.817993 best_discrete=3.332993 hash=False elapsed=8.8s
step   125/700 tau=0.5198 loss=0.435308 mse_soft=0.434873 ent_in=2.1746 ent_out=2.1669 rowmax_in=0.3069 rowmax_out=0.3223 discrete_mse=882.324768 best_discrete=3.332993 hash=False elapsed=10.7s
step   150/700 tau=0.4555 loss=0.369198 mse_soft=0.368875 ent_in=1.6902 ent_out=1.5415 rowmax_in=0.4163 rowmax_out=0.5000 discrete_mse=800.795410 best_discrete=3.332993 hash=False elapsed=12.7s
step   175/700 tau=0.3992 loss=0.339814 mse_soft=0.339553 ent_in=1.4568 ent_out=1.1484 rowmax_in=0.4650 rowmax_out=0.6152 discrete_mse=2736.852295 best_discrete=3.332993 hash=False elapsed=14.6s
step   200/700 tau=0.3499 loss=0.323910 mse_soft=0.323686 ent_in=1.3411 ent_out=0.8986 rowmax_in=0.4784 rowmax_out=0.6896 discrete_mse=285.024170 best_discrete=3.332993 hash=False elapsed=16.6s
step   225/700 tau=0.3066 loss=0.310202 mse_soft=0.310008 ent_in=1.2534 ent_out=0.6854 rowmax_in=0.4933 rowmax_out=0.7575 discrete_mse=239.511688 best_discrete=3.332993 hash=False elapsed=18.8s
step   250/700 tau=0.2687 loss=0.301022 mse_soft=0.300850 ent_in=1.1669 ent_out=0.5598 rowmax_in=0.5149 rowmax_out=0.7816 discrete_mse=312.250031 best_discrete=3.332993 hash=False elapsed=20.8s
step   275/700 tau=0.2355 loss=0.296669 mse_soft=0.296506 ent_in=1.1191 ent_out=0.5082 rowmax_in=0.5193 rowmax_out=0.7941 discrete_mse=419.497284 best_discrete=3.332993 hash=False elapsed=22.7s
step   300/700 tau=0.2064 loss=0.293828 mse_soft=0.293672 ent_in=1.0878 ent_out=0.4703 rowmax_in=0.5284 rowmax_out=0.8041 discrete_mse=419.497284 best_discrete=3.332993 hash=False elapsed=24.8s
step   325/700 tau=0.1809 loss=0.292307 mse_soft=0.292156 ent_in=1.0616 ent_out=0.4560 rowmax_in=0.5341 rowmax_out=0.8095 discrete_mse=223.397141 best_discrete=3.332993 hash=False elapsed=27.0s
step   350/700 tau=0.1585 loss=0.292095 mse_soft=0.291947 ent_in=1.0458 ent_out=0.4423 rowmax_in=0.5381 rowmax_out=0.8111 discrete_mse=223.397141 best_discrete=3.332993 hash=False elapsed=29.1s
step   375/700 tau=0.1389 loss=0.290401 mse_soft=0.290255 ent_in=1.0316 ent_out=0.4272 rowmax_in=0.5401 rowmax_out=0.8159 discrete_mse=223.397141 best_discrete=3.332993 hash=False elapsed=31.3s
step   400/700 tau=0.1218 loss=0.287757 mse_soft=0.287612 ent_in=1.0303 ent_out=0.4125 rowmax_in=0.5379 rowmax_out=0.8209 discrete_mse=158.068359 best_discrete=3.332993 hash=False elapsed=33.3s
step   425/700 tau=0.1067 loss=0.287442 mse_soft=0.287300 ent_in=1.0284 ent_out=0.3970 rowmax_in=0.5371 rowmax_out=0.8256 discrete_mse=184.180771 best_discrete=3.332993 hash=False elapsed=35.5s
step   450/700 tau=0.0935 loss=0.291602 mse_soft=0.291461 ent_in=1.0220 ent_out=0.3868 rowmax_in=0.5371 rowmax_out=0.8286 discrete_mse=184.180771 best_discrete=3.332993 hash=False elapsed=37.4s
step   475/700 tau=0.0820 loss=0.292661 mse_soft=0.292521 ent_in=1.0162 ent_out=0.3782 rowmax_in=0.5395 rowmax_out=0.8324 discrete_mse=184.180771 best_discrete=3.332993 hash=False elapsed=39.5s
step   500/700 tau=0.0718 loss=0.293885 mse_soft=0.293745 ent_in=1.0132 ent_out=0.3815 rowmax_in=0.5358 rowmax_out=0.8291 discrete_mse=184.180771 best_discrete=3.332993 hash=False elapsed=41.5s
step   525/700 tau=0.0630 loss=0.291268 mse_soft=0.291132 ent_in=0.9977 ent_out=0.3641 rowmax_in=0.5467 rowmax_out=0.8376 discrete_mse=184.180771 best_discrete=3.332993 hash=False elapsed=43.4s
step   550/700 tau=0.0552 loss=0.295090 mse_soft=0.294955 ent_in=0.9939 ent_out=0.3562 rowmax_in=0.5384 rowmax_out=0.8370 discrete_mse=156.648193 best_discrete=3.332993 hash=False elapsed=45.4s
step   575/700 tau=0.0484 loss=0.289421 mse_soft=0.289288 ent_in=0.9854 ent_out=0.3453 rowmax_in=0.5405 rowmax_out=0.8417 discrete_mse=184.180771 best_discrete=3.332993 hash=False elapsed=47.3s
step   600/700 tau=0.0424 loss=0.375204 mse_soft=0.375075 ent_in=0.9512 ent_out=0.3456 rowmax_in=0.5551 rowmax_out=0.8419 discrete_mse=84.313034 best_discrete=3.332993 hash=False elapsed=49.3s
step   625/700 tau=0.0371 loss=0.396553 mse_soft=0.396446 ent_in=0.7835 ent_out=0.2858 rowmax_in=0.6187 rowmax_out=0.8608 discrete_mse=11.934307 best_discrete=3.332993 hash=False elapsed=51.3s
step   650/700 tau=0.0325 loss=0.327654 mse_soft=0.327547 ent_in=0.7521 ent_out=0.3233 rowmax_in=0.6025 rowmax_out=0.8317 discrete_mse=28.846296 best_discrete=3.332993 hash=False elapsed=53.4s
step   675/700 tau=0.0285 loss=0.381111 mse_soft=0.381016 ent_in=0.6591 ent_out=0.2949 rowmax_in=0.6661 rowmax_out=0.8600 discrete_mse=6.665638 best_discrete=3.332993 hash=False elapsed=55.4s
step   700/700 tau=0.0250 loss=0.602847 mse_soft=0.602753 ent_in=0.6372 ent_out=0.3092 rowmax_in=0.6586 rowmax_out=0.8333 discrete_mse=187.628906 best_discrete=3.332993 hash=False elapsed=57.4s

Final metrics:
  soft_mse_full=0.379945
  rowmax_in_mean=0.6588
  rowmax_out_mean=0.8456
  ent_in_mean=0.6430
  ent_out_mean=0.3009
  final_discrete_mse=99.177612
  hash_match=False
  best_discrete_mse_seen=3.332993
Saved results to overnight_b017_j4.json
