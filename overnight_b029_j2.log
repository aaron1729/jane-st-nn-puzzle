Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.097057 mse_soft=1.094735 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=14.454112 best_discrete=14.454112 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.890515 mse_soft=0.888325 ent_in=3.6335 ent_out=3.6659 rowmax_in=0.0450 rowmax_out=0.0444 discrete_mse=6027.316406 best_discrete=14.454112 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.671019 mse_soft=0.669117 ent_in=3.1284 ent_out=3.2141 rowmax_in=0.0942 rowmax_out=0.0882 discrete_mse=1915.259766 best_discrete=14.454112 hash=False elapsed=5.2s
step    75/900 tau=0.7450 loss=0.527477 mse_soft=0.525905 ent_in=2.5833 ent_out=2.6571 rowmax_in=0.2041 rowmax_out=0.2034 discrete_mse=686.393494 best_discrete=14.454112 hash=False elapsed=7.8s
step   100/900 tau=0.6745 loss=0.406732 mse_soft=0.405602 ent_in=1.9623 ent_out=1.8042 rowmax_in=0.3694 rowmax_out=0.4372 discrete_mse=453.817078 best_discrete=14.454112 hash=False elapsed=10.3s
step   125/900 tau=0.6107 loss=0.343135 mse_soft=0.342314 ent_in=1.5552 ent_out=1.1826 rowmax_in=0.4680 rowmax_out=0.5914 discrete_mse=1338.096313 best_discrete=14.454112 hash=False elapsed=12.9s
step   150/900 tau=0.5529 loss=0.316204 mse_soft=0.315550 ent_in=1.3448 ent_out=0.8355 rowmax_in=0.5004 rowmax_out=0.7078 discrete_mse=1611.612549 best_discrete=14.454112 hash=False elapsed=15.4s
step   175/900 tau=0.5006 loss=0.304493 mse_soft=0.303931 ent_in=1.2385 ent_out=0.6363 rowmax_in=0.5180 rowmax_out=0.7783 discrete_mse=1001.330872 best_discrete=14.454112 hash=False elapsed=17.7s
step   200/900 tau=0.4532 loss=0.296967 mse_soft=0.296454 ent_in=1.1828 ent_out=0.5271 rowmax_in=0.5282 rowmax_out=0.8021 discrete_mse=948.795898 best_discrete=14.454112 hash=False elapsed=20.2s
step   225/900 tau=0.4103 loss=0.291474 mse_soft=0.290998 ent_in=1.1319 ent_out=0.4537 rowmax_in=0.5339 rowmax_out=0.8208 discrete_mse=79.495094 best_discrete=14.454112 hash=False elapsed=22.4s
step   250/900 tau=0.3715 loss=0.288168 mse_soft=0.287715 ent_in=1.0928 ent_out=0.4141 rowmax_in=0.5400 rowmax_out=0.8289 discrete_mse=569.864624 best_discrete=14.454112 hash=False elapsed=24.9s
step   275/900 tau=0.3363 loss=0.287074 mse_soft=0.286633 ent_in=1.0729 ent_out=0.3965 rowmax_in=0.5454 rowmax_out=0.8280 discrete_mse=153.449265 best_discrete=14.454112 hash=False elapsed=27.5s
step   300/900 tau=0.3045 loss=0.285264 mse_soft=0.284831 ent_in=1.0591 ent_out=0.3818 rowmax_in=0.5483 rowmax_out=0.8322 discrete_mse=407.895782 best_discrete=14.454112 hash=False elapsed=30.0s
step   325/900 tau=0.2756 loss=0.282447 mse_soft=0.282020 ent_in=1.0504 ent_out=0.3731 rowmax_in=0.5505 rowmax_out=0.8361 discrete_mse=337.345337 best_discrete=14.454112 hash=False elapsed=32.4s
step   350/900 tau=0.2496 loss=0.281935 mse_soft=0.281514 ent_in=1.0430 ent_out=0.3615 rowmax_in=0.5515 rowmax_out=0.8405 discrete_mse=337.345337 best_discrete=14.454112 hash=False elapsed=34.8s
step   375/900 tau=0.2259 loss=0.283765 mse_soft=0.283349 ent_in=1.0345 ent_out=0.3547 rowmax_in=0.5524 rowmax_out=0.8423 discrete_mse=407.895782 best_discrete=14.454112 hash=False elapsed=37.3s
step   400/900 tau=0.2046 loss=0.285789 mse_soft=0.285376 ent_in=1.0247 ent_out=0.3520 rowmax_in=0.5553 rowmax_out=0.8421 discrete_mse=337.345337 best_discrete=14.454112 hash=False elapsed=39.7s
step   425/900 tau=0.1852 loss=0.283230 mse_soft=0.282819 ent_in=1.0192 ent_out=0.3499 rowmax_in=0.5547 rowmax_out=0.8413 discrete_mse=337.345337 best_discrete=14.454112 hash=False elapsed=42.2s
step   450/900 tau=0.1677 loss=0.284525 mse_soft=0.284116 ent_in=1.0185 ent_out=0.3464 rowmax_in=0.5551 rowmax_out=0.8412 discrete_mse=379.159790 best_discrete=14.454112 hash=False elapsed=44.7s
step   475/900 tau=0.1518 loss=0.288760 mse_soft=0.288355 ent_in=1.0090 ent_out=0.3421 rowmax_in=0.5585 rowmax_out=0.8420 discrete_mse=985.334167 best_discrete=14.454112 hash=False elapsed=47.1s
step   500/900 tau=0.1374 loss=0.287818 mse_soft=0.287414 ent_in=1.0055 ent_out=0.3391 rowmax_in=0.5611 rowmax_out=0.8416 discrete_mse=379.159790 best_discrete=14.454112 hash=False elapsed=49.7s
step   525/900 tau=0.1244 loss=0.290329 mse_soft=0.289927 ent_in=1.0001 ent_out=0.3404 rowmax_in=0.5607 rowmax_out=0.8405 discrete_mse=201.605270 best_discrete=14.454112 hash=False elapsed=52.2s
step   550/900 tau=0.1126 loss=0.375594 mse_soft=0.375196 ent_in=0.9944 ent_out=0.3321 rowmax_in=0.5678 rowmax_out=0.8399 discrete_mse=151.230972 best_discrete=14.454112 hash=False elapsed=54.9s
step   575/900 tau=0.1020 loss=0.305364 mse_soft=0.305002 ent_in=0.9173 ent_out=0.2911 rowmax_in=0.5881 rowmax_out=0.8545 discrete_mse=227.622391 best_discrete=14.454112 hash=False elapsed=57.6s
step   600/900 tau=0.0923 loss=0.294504 mse_soft=0.294133 ent_in=0.9255 ent_out=0.3098 rowmax_in=0.5873 rowmax_out=0.8464 discrete_mse=163.685715 best_discrete=14.454112 hash=False elapsed=60.1s
step   625/900 tau=0.0836 loss=0.298624 mse_soft=0.298253 ent_in=0.9150 ent_out=0.3232 rowmax_in=0.5913 rowmax_out=0.8389 discrete_mse=36.493172 best_discrete=14.454112 hash=False elapsed=62.3s
step   650/900 tau=0.0757 loss=0.303433 mse_soft=0.303062 ent_in=0.9098 ent_out=0.3263 rowmax_in=0.5869 rowmax_out=0.8377 discrete_mse=36.493172 best_discrete=14.454112 hash=False elapsed=64.6s
step   675/900 tau=0.0685 loss=0.349023 mse_soft=0.348668 ent_in=0.8709 ent_out=0.3116 rowmax_in=0.6021 rowmax_out=0.8441 discrete_mse=57.596661 best_discrete=14.454112 hash=False elapsed=66.9s
step   700/900 tau=0.0620 loss=0.403942 mse_soft=0.403712 ent_in=0.5737 ent_out=0.1931 rowmax_in=0.7329 rowmax_out=0.9182 discrete_mse=10.821692 best_discrete=10.821692 hash=False elapsed=69.4s
step   725/900 tau=0.0562 loss=0.363070 mse_soft=0.362841 ent_in=0.5443 ent_out=0.2197 rowmax_in=0.7507 rowmax_out=0.8854 discrete_mse=15.063103 best_discrete=10.821692 hash=False elapsed=71.8s
step   750/900 tau=0.0508 loss=0.363479 mse_soft=0.363247 ent_in=0.5404 ent_out=0.2331 rowmax_in=0.7382 rowmax_out=0.8767 discrete_mse=7.112606 best_discrete=7.112606 hash=False elapsed=74.1s
step   775/900 tau=0.0460 loss=0.357639 mse_soft=0.357412 ent_in=0.5180 ent_out=0.2405 rowmax_in=0.7388 rowmax_out=0.8684 discrete_mse=3.680712 best_discrete=3.680712 hash=False elapsed=76.5s
step   800/900 tau=0.0417 loss=0.353609 mse_soft=0.353384 ent_in=0.5167 ent_out=0.2334 rowmax_in=0.7454 rowmax_out=0.8680 discrete_mse=64.068794 best_discrete=3.680712 hash=False elapsed=79.0s
step   825/900 tau=0.0377 loss=0.378122 mse_soft=0.377935 ent_in=0.4209 ent_out=0.2022 rowmax_in=0.7786 rowmax_out=0.8969 discrete_mse=25.768604 best_discrete=3.680712 hash=False elapsed=81.5s
step   850/900 tau=0.0342 loss=0.361863 mse_soft=0.361667 ent_in=0.4271 ent_out=0.2261 rowmax_in=0.7772 rowmax_out=0.8762 discrete_mse=2.704584 best_discrete=2.704584 hash=False elapsed=84.1s
step   875/900 tau=0.0309 loss=0.369906 mse_soft=0.369722 ent_in=0.3884 ent_out=0.2275 rowmax_in=0.7929 rowmax_out=0.8787 discrete_mse=8.807657 best_discrete=2.704584 hash=False elapsed=86.4s
step   900/900 tau=0.0280 loss=0.376282 mse_soft=0.376099 ent_in=0.3832 ent_out=0.2270 rowmax_in=0.7987 rowmax_out=0.8752 discrete_mse=3.522778 best_discrete=2.704584 hash=False elapsed=88.6s

Final metrics:
  soft_mse_full=0.377912
  rowmax_in_mean=0.7866
  rowmax_out_mean=0.8792
  ent_in_mean=0.3908
  ent_out_mean=0.2212
  final_discrete_mse=1.603388
  hash_match=False
  best_discrete_mse_seen=2.704584
Saved results to overnight_b029_j2.json
