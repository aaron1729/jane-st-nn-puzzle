Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.074256 mse_soft=1.071934 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=8.810302 best_discrete=8.810302 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.867936 mse_soft=0.865746 ent_in=3.6340 ent_out=3.6681 rowmax_in=0.0458 rowmax_out=0.0441 discrete_mse=2630.469238 best_discrete=8.810302 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.649118 mse_soft=0.647212 ent_in=3.1308 ent_out=3.2219 rowmax_in=0.0928 rowmax_out=0.0865 discrete_mse=3128.711914 best_discrete=8.810302 hash=False elapsed=4.8s
step    75/900 tau=0.7450 loss=0.504606 mse_soft=0.503032 ent_in=2.5900 ent_out=2.6556 rowmax_in=0.2011 rowmax_out=0.2003 discrete_mse=395.665039 best_discrete=8.810302 hash=False elapsed=7.0s
step   100/900 tau=0.6745 loss=0.413083 mse_soft=0.411861 ent_in=2.0948 ent_out=1.9778 rowmax_in=0.3209 rowmax_out=0.3527 discrete_mse=857.555298 best_discrete=8.810302 hash=False elapsed=9.1s
step   125/900 tau=0.6107 loss=0.349439 mse_soft=0.348553 ent_in=1.7015 ent_out=1.2516 rowmax_in=0.4213 rowmax_out=0.5943 discrete_mse=502.161224 best_discrete=8.810302 hash=False elapsed=11.4s
step   150/900 tau=0.5529 loss=0.315856 mse_soft=0.315165 ent_in=1.5099 ent_out=0.7943 rowmax_in=0.4589 rowmax_out=0.7231 discrete_mse=1530.215210 best_discrete=8.810302 hash=False elapsed=13.6s
step   175/900 tau=0.5006 loss=0.296399 mse_soft=0.295808 ent_in=1.3884 ent_out=0.5810 rowmax_in=0.4743 rowmax_out=0.7785 discrete_mse=839.170776 best_discrete=8.810302 hash=False elapsed=15.6s
step   200/900 tau=0.4532 loss=0.287050 mse_soft=0.286511 ent_in=1.3271 ent_out=0.4679 rowmax_in=0.4764 rowmax_out=0.8192 discrete_mse=593.880859 best_discrete=8.810302 hash=False elapsed=17.7s
step   225/900 tau=0.4103 loss=0.281705 mse_soft=0.281192 ent_in=1.2957 ent_out=0.4139 rowmax_in=0.4788 rowmax_out=0.8257 discrete_mse=974.490479 best_discrete=8.810302 hash=False elapsed=19.9s
step   250/900 tau=0.3715 loss=0.277668 mse_soft=0.277176 ent_in=1.2723 ent_out=0.3692 rowmax_in=0.4828 rowmax_out=0.8422 discrete_mse=2362.586426 best_discrete=8.810302 hash=False elapsed=22.0s
step   275/900 tau=0.3363 loss=0.274836 mse_soft=0.274356 ent_in=1.2613 ent_out=0.3389 rowmax_in=0.4810 rowmax_out=0.8529 discrete_mse=1262.799072 best_discrete=8.810302 hash=False elapsed=24.3s
step   300/900 tau=0.3045 loss=0.272437 mse_soft=0.271970 ent_in=1.2387 ent_out=0.3193 rowmax_in=0.4866 rowmax_out=0.8592 discrete_mse=1780.014404 best_discrete=8.810302 hash=False elapsed=26.6s
step   325/900 tau=0.2756 loss=0.272215 mse_soft=0.271755 ent_in=1.2324 ent_out=0.2997 rowmax_in=0.4867 rowmax_out=0.8674 discrete_mse=1780.014404 best_discrete=8.810302 hash=False elapsed=29.0s
step   350/900 tau=0.2496 loss=0.273082 mse_soft=0.272628 ent_in=1.2249 ent_out=0.2876 rowmax_in=0.4855 rowmax_out=0.8746 discrete_mse=783.200684 best_discrete=8.810302 hash=False elapsed=31.4s
step   375/900 tau=0.2259 loss=0.272293 mse_soft=0.271847 ent_in=1.2147 ent_out=0.2740 rowmax_in=0.4898 rowmax_out=0.8796 discrete_mse=161.484665 best_discrete=8.810302 hash=False elapsed=33.4s
step   400/900 tau=0.2046 loss=0.270112 mse_soft=0.269669 ent_in=1.2117 ent_out=0.2653 rowmax_in=0.4880 rowmax_out=0.8829 discrete_mse=729.698059 best_discrete=8.810302 hash=False elapsed=35.5s
step   425/900 tau=0.1852 loss=0.268898 mse_soft=0.268458 ent_in=1.2043 ent_out=0.2620 rowmax_in=0.4888 rowmax_out=0.8829 discrete_mse=729.698059 best_discrete=8.810302 hash=False elapsed=37.6s
step   450/900 tau=0.1677 loss=0.270848 mse_soft=0.270410 ent_in=1.2012 ent_out=0.2590 rowmax_in=0.4870 rowmax_out=0.8850 discrete_mse=550.046814 best_discrete=8.810302 hash=False elapsed=39.6s
step   475/900 tau=0.1518 loss=0.271954 mse_soft=0.271518 ent_in=1.1956 ent_out=0.2590 rowmax_in=0.4891 rowmax_out=0.8843 discrete_mse=375.768402 best_discrete=8.810302 hash=False elapsed=41.7s
step   500/900 tau=0.1374 loss=0.280236 mse_soft=0.279801 ent_in=1.1957 ent_out=0.2551 rowmax_in=0.4822 rowmax_out=0.8908 discrete_mse=550.046814 best_discrete=8.810302 hash=False elapsed=43.9s
step   525/900 tau=0.1244 loss=0.271658 mse_soft=0.271228 ent_in=1.1725 ent_out=0.2591 rowmax_in=0.4955 rowmax_out=0.8820 discrete_mse=510.572174 best_discrete=8.810302 hash=False elapsed=46.3s
step   550/900 tau=0.1126 loss=0.295632 mse_soft=0.295204 ent_in=1.1734 ent_out=0.2521 rowmax_in=0.4916 rowmax_out=0.8829 discrete_mse=713.197449 best_discrete=8.810302 hash=False elapsed=48.5s
step   575/900 tau=0.1020 loss=0.295548 mse_soft=0.295127 ent_in=1.1547 ent_out=0.2467 rowmax_in=0.5025 rowmax_out=0.8874 discrete_mse=453.045593 best_discrete=8.810302 hash=False elapsed=50.9s
step   600/900 tau=0.0923 loss=0.280754 mse_soft=0.280335 ent_in=1.1491 ent_out=0.2477 rowmax_in=0.5012 rowmax_out=0.8846 discrete_mse=240.564789 best_discrete=8.810302 hash=False elapsed=53.4s
step   625/900 tau=0.0836 loss=0.306084 mse_soft=0.305662 ent_in=1.1501 ent_out=0.2590 rowmax_in=0.4928 rowmax_out=0.8754 discrete_mse=353.739136 best_discrete=8.810302 hash=False elapsed=55.7s
step   650/900 tau=0.0757 loss=0.276537 mse_soft=0.276117 ent_in=1.1357 ent_out=0.2646 rowmax_in=0.5032 rowmax_out=0.8714 discrete_mse=856.744751 best_discrete=8.810302 hash=False elapsed=58.1s
step   675/900 tau=0.0685 loss=0.301362 mse_soft=0.300944 ent_in=1.1184 ent_out=0.2753 rowmax_in=0.5051 rowmax_out=0.8623 discrete_mse=415.571594 best_discrete=8.810302 hash=False elapsed=60.2s
step   700/900 tau=0.0620 loss=0.532074 mse_soft=0.531777 ent_in=0.7774 ent_out=0.2112 rowmax_in=0.6573 rowmax_out=0.8813 discrete_mse=116.430145 best_discrete=8.810302 hash=False elapsed=62.6s
step   725/900 tau=0.0562 loss=0.400757 mse_soft=0.400521 ent_in=0.6087 ent_out=0.1764 rowmax_in=0.7178 rowmax_out=0.9037 discrete_mse=387.111176 best_discrete=8.810302 hash=False elapsed=64.9s
step   750/900 tau=0.0508 loss=0.460618 mse_soft=0.460418 ent_in=0.5385 ent_out=0.1289 rowmax_in=0.7380 rowmax_out=0.9394 discrete_mse=463.303528 best_discrete=8.810302 hash=False elapsed=67.1s
step   775/900 tau=0.0460 loss=0.454140 mse_soft=0.453951 ent_in=0.4807 ent_out=0.1471 rowmax_in=0.7523 rowmax_out=0.9220 discrete_mse=338.293396 best_discrete=8.810302 hash=False elapsed=69.3s
step   800/900 tau=0.0417 loss=0.529642 mse_soft=0.529474 ent_in=0.4512 ent_out=0.1074 rowmax_in=0.7539 rowmax_out=0.9509 discrete_mse=35.863029 best_discrete=8.810302 hash=False elapsed=71.7s
step   825/900 tau=0.0377 loss=0.437256 mse_soft=0.437101 ent_in=0.4009 ent_out=0.1175 rowmax_in=0.7775 rowmax_out=0.9327 discrete_mse=33.623299 best_discrete=8.810302 hash=False elapsed=74.0s
step   850/900 tau=0.0342 loss=0.537853 mse_soft=0.537706 ent_in=0.3819 ent_out=0.1072 rowmax_in=0.7996 rowmax_out=0.9529 discrete_mse=28.265396 best_discrete=8.810302 hash=False elapsed=76.1s
step   875/900 tau=0.0309 loss=0.480485 mse_soft=0.480321 ent_in=0.3991 ent_out=0.1474 rowmax_in=0.7811 rowmax_out=0.9231 discrete_mse=35.712566 best_discrete=8.810302 hash=False elapsed=78.4s
step   900/900 tau=0.0280 loss=0.455637 mse_soft=0.455478 ent_in=0.3711 ent_out=0.1588 rowmax_in=0.7948 rowmax_out=0.9101 discrete_mse=75.795670 best_discrete=8.810302 hash=False elapsed=80.7s

Final metrics:
  soft_mse_full=0.461806
  rowmax_in_mean=0.7937
  rowmax_out_mean=0.9105
  ent_in_mean=0.3722
  ent_out_mean=0.1588
  final_discrete_mse=75.795670
  hash_match=False
  best_discrete_mse_seen=8.810302
Saved results to overnight_b019_j2.json
