Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.086862 mse_soft=1.084539 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=15.911794 best_discrete=15.911794 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.873633 mse_soft=0.871442 ent_in=3.6341 ent_out=3.6686 rowmax_in=0.0454 rowmax_out=0.0436 discrete_mse=1207.134155 best_discrete=15.911794 hash=False elapsed=2.7s
step    50/900 tau=0.8229 loss=0.646088 mse_soft=0.644178 ent_in=3.1344 ent_out=3.2328 rowmax_in=0.0934 rowmax_out=0.0866 discrete_mse=2813.845215 best_discrete=15.911794 hash=False elapsed=5.0s
step    75/900 tau=0.7450 loss=0.504207 mse_soft=0.502615 ent_in=2.6009 ent_out=2.7047 rowmax_in=0.2005 rowmax_out=0.1970 discrete_mse=395.335205 best_discrete=15.911794 hash=False elapsed=7.5s
step   100/900 tau=0.6745 loss=0.397890 mse_soft=0.396721 ent_in=2.0237 ent_out=1.8735 rowmax_in=0.3559 rowmax_out=0.4337 discrete_mse=1389.759277 best_discrete=15.911794 hash=False elapsed=10.0s
step   125/900 tau=0.6107 loss=0.340596 mse_soft=0.339729 ent_in=1.6889 ent_out=1.1985 rowmax_in=0.4099 rowmax_out=0.6055 discrete_mse=787.778503 best_discrete=15.911794 hash=False elapsed=12.4s
step   150/900 tau=0.5529 loss=0.312440 mse_soft=0.311738 ent_in=1.5115 ent_out=0.8309 rowmax_in=0.4549 rowmax_out=0.7051 discrete_mse=812.021179 best_discrete=15.911794 hash=False elapsed=14.8s
step   175/900 tau=0.5006 loss=0.295309 mse_soft=0.294694 ent_in=1.3960 ent_out=0.6523 rowmax_in=0.4796 rowmax_out=0.7395 discrete_mse=512.278809 best_discrete=15.911794 hash=False elapsed=17.2s
step   200/900 tau=0.4532 loss=0.286014 mse_soft=0.285449 ent_in=1.3215 ent_out=0.5620 rowmax_in=0.4897 rowmax_out=0.7587 discrete_mse=4437.504883 best_discrete=15.911794 hash=False elapsed=19.5s
step   225/900 tau=0.4103 loss=0.279103 mse_soft=0.278577 ent_in=1.2579 ent_out=0.4954 rowmax_in=0.5045 rowmax_out=0.7860 discrete_mse=4437.504883 best_discrete=15.911794 hash=False elapsed=22.0s
step   250/900 tau=0.3715 loss=0.274366 mse_soft=0.273861 ent_in=1.2281 ent_out=0.4543 rowmax_in=0.5078 rowmax_out=0.8061 discrete_mse=4574.828125 best_discrete=15.911794 hash=False elapsed=24.4s
step   275/900 tau=0.3363 loss=0.272399 mse_soft=0.271907 ent_in=1.2072 ent_out=0.4327 rowmax_in=0.5100 rowmax_out=0.8120 discrete_mse=5370.643066 best_discrete=15.911794 hash=False elapsed=27.0s
step   300/900 tau=0.3045 loss=0.273187 mse_soft=0.272704 ent_in=1.1989 ent_out=0.4122 rowmax_in=0.5105 rowmax_out=0.8211 discrete_mse=4117.471680 best_discrete=15.911794 hash=False elapsed=29.5s
step   325/900 tau=0.2756 loss=0.273205 mse_soft=0.272726 ent_in=1.1929 ent_out=0.4036 rowmax_in=0.5114 rowmax_out=0.8234 discrete_mse=2350.805664 best_discrete=15.911794 hash=False elapsed=32.0s
step   350/900 tau=0.2496 loss=0.272806 mse_soft=0.272331 ent_in=1.1859 ent_out=0.3989 rowmax_in=0.5121 rowmax_out=0.8253 discrete_mse=2350.805664 best_discrete=15.911794 hash=False elapsed=34.4s
step   375/900 tau=0.2259 loss=0.271839 mse_soft=0.271369 ent_in=1.1766 ent_out=0.3908 rowmax_in=0.5132 rowmax_out=0.8262 discrete_mse=1721.778809 best_discrete=15.911794 hash=False elapsed=36.7s
step   400/900 tau=0.2046 loss=0.271983 mse_soft=0.271520 ent_in=1.1664 ent_out=0.3770 rowmax_in=0.5149 rowmax_out=0.8311 discrete_mse=2562.634277 best_discrete=15.911794 hash=False elapsed=39.1s
step   425/900 tau=0.1852 loss=0.272776 mse_soft=0.272318 ent_in=1.1593 ent_out=0.3676 rowmax_in=0.5181 rowmax_out=0.8330 discrete_mse=1485.107056 best_discrete=15.911794 hash=False elapsed=41.4s
step   450/900 tau=0.1677 loss=0.268715 mse_soft=0.268261 ent_in=1.1551 ent_out=0.3591 rowmax_in=0.5202 rowmax_out=0.8354 discrete_mse=1442.978760 best_discrete=15.911794 hash=False elapsed=43.5s
step   475/900 tau=0.1518 loss=0.268610 mse_soft=0.268158 ent_in=1.1488 ent_out=0.3557 rowmax_in=0.5222 rowmax_out=0.8358 discrete_mse=766.323181 best_discrete=15.911794 hash=False elapsed=46.0s
step   500/900 tau=0.1374 loss=0.270335 mse_soft=0.269886 ent_in=1.1451 ent_out=0.3510 rowmax_in=0.5238 rowmax_out=0.8389 discrete_mse=672.164307 best_discrete=15.911794 hash=False elapsed=48.5s
step   525/900 tau=0.1244 loss=0.271513 mse_soft=0.271066 ent_in=1.1407 ent_out=0.3482 rowmax_in=0.5238 rowmax_out=0.8391 discrete_mse=808.731873 best_discrete=15.911794 hash=False elapsed=50.9s
step   550/900 tau=0.1126 loss=0.279339 mse_soft=0.278898 ent_in=1.1262 ent_out=0.3434 rowmax_in=0.5275 rowmax_out=0.8418 discrete_mse=542.167297 best_discrete=15.911794 hash=False elapsed=53.3s
step   575/900 tau=0.1020 loss=0.270360 mse_soft=0.269923 ent_in=1.1157 ent_out=0.3413 rowmax_in=0.5276 rowmax_out=0.8413 discrete_mse=235.673141 best_discrete=15.911794 hash=False elapsed=55.6s
step   600/900 tau=0.0923 loss=0.282885 mse_soft=0.282450 ent_in=1.1121 ent_out=0.3383 rowmax_in=0.5197 rowmax_out=0.8408 discrete_mse=640.300598 best_discrete=15.911794 hash=False elapsed=58.0s
step   625/900 tau=0.0836 loss=0.288417 mse_soft=0.287987 ent_in=1.0855 ent_out=0.3489 rowmax_in=0.5324 rowmax_out=0.8375 discrete_mse=309.382599 best_discrete=15.911794 hash=False elapsed=60.4s
step   650/900 tau=0.0757 loss=0.288933 mse_soft=0.288531 ent_in=1.0221 ent_out=0.3183 rowmax_in=0.5529 rowmax_out=0.8526 discrete_mse=102.324593 best_discrete=15.911794 hash=False elapsed=63.0s
step   675/900 tau=0.0685 loss=0.291843 mse_soft=0.291450 ent_in=1.0114 ent_out=0.3001 rowmax_in=0.5547 rowmax_out=0.8503 discrete_mse=200.683395 best_discrete=15.911794 hash=False elapsed=65.2s
step   700/900 tau=0.0620 loss=0.292839 mse_soft=0.292454 ent_in=0.9921 ent_out=0.2891 rowmax_in=0.5622 rowmax_out=0.8609 discrete_mse=770.969482 best_discrete=15.911794 hash=False elapsed=67.5s
step   725/900 tau=0.0562 loss=0.354188 mse_soft=0.353831 ent_in=0.9169 ent_out=0.2724 rowmax_in=0.5952 rowmax_out=0.8642 discrete_mse=127.550125 best_discrete=15.911794 hash=False elapsed=69.7s
step   750/900 tau=0.0508 loss=0.429620 mse_soft=0.429320 ent_in=0.7640 ent_out=0.2384 rowmax_in=0.6475 rowmax_out=0.8756 discrete_mse=177.616501 best_discrete=15.911794 hash=False elapsed=72.1s
step   775/900 tau=0.0460 loss=0.374205 mse_soft=0.373980 ent_in=0.5672 ent_out=0.1846 rowmax_in=0.7228 rowmax_out=0.8967 discrete_mse=227.535690 best_discrete=15.911794 hash=False elapsed=74.3s
step   800/900 tau=0.0417 loss=0.339427 mse_soft=0.339198 ent_in=0.5942 ent_out=0.1713 rowmax_in=0.6969 rowmax_out=0.9097 discrete_mse=237.915771 best_discrete=15.911794 hash=False elapsed=76.5s
step   825/900 tau=0.0377 loss=0.350635 mse_soft=0.350407 ent_in=0.5939 ent_out=0.1682 rowmax_in=0.7015 rowmax_out=0.9122 discrete_mse=14.800794 best_discrete=14.800794 hash=False elapsed=78.9s
step   850/900 tau=0.0342 loss=0.361057 mse_soft=0.360843 ent_in=0.5705 ent_out=0.1400 rowmax_in=0.7088 rowmax_out=0.9278 discrete_mse=36.124119 best_discrete=14.800794 hash=False elapsed=81.2s
step   875/900 tau=0.0309 loss=0.430925 mse_soft=0.430757 ent_in=0.4663 ent_out=0.0917 rowmax_in=0.7712 rowmax_out=0.9503 discrete_mse=70.516151 best_discrete=14.800794 hash=False elapsed=83.2s
step   900/900 tau=0.0280 loss=0.371118 mse_soft=0.370962 ent_in=0.4412 ent_out=0.0799 rowmax_in=0.7708 rowmax_out=0.9554 discrete_mse=18.536791 best_discrete=14.800794 hash=False elapsed=85.2s

Final metrics:
  soft_mse_full=0.389195
  rowmax_in_mean=0.7630
  rowmax_out_mean=0.9554
  ent_in_mean=0.4478
  ent_out_mean=0.0800
  final_discrete_mse=43.037567
  hash_match=False
  best_discrete_mse_seen=14.800794
Saved results to overnight_b157_j2.json
