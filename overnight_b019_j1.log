Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.064855 mse_soft=1.062532 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=45.822731 best_discrete=45.822731 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.861023 mse_soft=0.858832 ent_in=3.6337 ent_out=3.6692 rowmax_in=0.0464 rowmax_out=0.0441 discrete_mse=2773.514648 best_discrete=45.822731 hash=False elapsed=2.5s
step    50/900 tau=0.8260 loss=0.646223 mse_soft=0.644320 ent_in=3.1252 ent_out=3.2199 rowmax_in=0.0945 rowmax_out=0.0885 discrete_mse=638.238159 best_discrete=45.822731 hash=False elapsed=4.6s
step    75/900 tau=0.7493 loss=0.498595 mse_soft=0.497032 ent_in=2.5383 ent_out=2.6721 rowmax_in=0.2209 rowmax_out=0.2027 discrete_mse=854.681152 best_discrete=45.822731 hash=False elapsed=6.9s
step   100/900 tau=0.6797 loss=0.398896 mse_soft=0.397755 ent_in=1.9088 ent_out=1.8956 rowmax_in=0.3560 rowmax_out=0.4055 discrete_mse=864.093201 best_discrete=45.822731 hash=False elapsed=8.9s
step   125/900 tau=0.6165 loss=0.342156 mse_soft=0.341322 ent_in=1.5627 ent_out=1.2179 rowmax_in=0.4491 rowmax_out=0.6042 discrete_mse=164.127853 best_discrete=45.822731 hash=False elapsed=11.0s
step   150/900 tau=0.5592 loss=0.310901 mse_soft=0.310254 ent_in=1.3744 ent_out=0.7847 rowmax_in=0.4841 rowmax_out=0.7334 discrete_mse=354.340729 best_discrete=45.822731 hash=False elapsed=13.1s
step   175/900 tau=0.5073 loss=0.291515 mse_soft=0.290958 ent_in=1.2608 ent_out=0.5977 rowmax_in=0.5080 rowmax_out=0.7736 discrete_mse=278.155853 best_discrete=45.822731 hash=False elapsed=15.1s
step   200/900 tau=0.4602 loss=0.285667 mse_soft=0.285148 ent_in=1.1957 ent_out=0.5348 rowmax_in=0.5215 rowmax_out=0.7881 discrete_mse=772.248169 best_discrete=45.822731 hash=False elapsed=17.3s
step   225/900 tau=0.4174 loss=0.280113 mse_soft=0.279611 ent_in=1.1616 ent_out=0.5091 rowmax_in=0.5265 rowmax_out=0.7906 discrete_mse=722.805359 best_discrete=45.822731 hash=False elapsed=19.4s
step   250/900 tau=0.3786 loss=0.277705 mse_soft=0.277219 ent_in=1.1408 ent_out=0.4785 rowmax_in=0.5280 rowmax_out=0.7996 discrete_mse=474.814331 best_discrete=45.822731 hash=False elapsed=21.6s
step   275/900 tau=0.3434 loss=0.276551 mse_soft=0.276078 ent_in=1.1235 ent_out=0.4504 rowmax_in=0.5297 rowmax_out=0.8059 discrete_mse=474.814331 best_discrete=45.822731 hash=False elapsed=23.7s
step   300/900 tau=0.3115 loss=0.272878 mse_soft=0.272416 ent_in=1.1067 ent_out=0.4338 rowmax_in=0.5338 rowmax_out=0.8083 discrete_mse=404.812866 best_discrete=45.822731 hash=False elapsed=26.0s
step   325/900 tau=0.2826 loss=0.274244 mse_soft=0.273787 ent_in=1.0975 ent_out=0.4257 rowmax_in=0.5349 rowmax_out=0.8095 discrete_mse=325.275330 best_discrete=45.822731 hash=False elapsed=28.3s
step   350/900 tau=0.2563 loss=0.276378 mse_soft=0.275926 ent_in=1.0880 ent_out=0.4186 rowmax_in=0.5374 rowmax_out=0.8111 discrete_mse=970.983765 best_discrete=45.822731 hash=False elapsed=30.8s
step   375/900 tau=0.2325 loss=0.269965 mse_soft=0.269516 ent_in=1.0865 ent_out=0.4109 rowmax_in=0.5363 rowmax_out=0.8119 discrete_mse=610.056702 best_discrete=45.822731 hash=False elapsed=32.9s
step   400/900 tau=0.2109 loss=0.273864 mse_soft=0.273419 ent_in=1.0795 ent_out=0.4025 rowmax_in=0.5366 rowmax_out=0.8145 discrete_mse=970.983765 best_discrete=45.822731 hash=False elapsed=35.0s
step   425/900 tau=0.1913 loss=0.274475 mse_soft=0.274037 ent_in=1.0696 ent_out=0.3919 rowmax_in=0.5400 rowmax_out=0.8176 discrete_mse=970.983765 best_discrete=45.822731 hash=False elapsed=36.9s
step   450/900 tau=0.1735 loss=0.283323 mse_soft=0.282889 ent_in=1.0650 ent_out=0.3831 rowmax_in=0.5414 rowmax_out=0.8195 discrete_mse=970.983765 best_discrete=45.822731 hash=False elapsed=38.8s
step   475/900 tau=0.1574 loss=0.294863 mse_soft=0.294433 ent_in=1.0608 ent_out=0.3741 rowmax_in=0.5420 rowmax_out=0.8271 discrete_mse=433.042145 best_discrete=45.822731 hash=False elapsed=40.8s
step   500/900 tau=0.1428 loss=0.291141 mse_soft=0.290710 ent_in=1.0648 ent_out=0.3721 rowmax_in=0.5371 rowmax_out=0.8242 discrete_mse=490.761139 best_discrete=45.822731 hash=False elapsed=42.9s
step   525/900 tau=0.1295 loss=0.281528 mse_soft=0.281101 ent_in=1.0558 ent_out=0.3684 rowmax_in=0.5429 rowmax_out=0.8225 discrete_mse=794.192871 best_discrete=45.822731 hash=False elapsed=45.2s
step   550/900 tau=0.1175 loss=0.285734 mse_soft=0.285308 ent_in=1.0580 ent_out=0.3622 rowmax_in=0.5413 rowmax_out=0.8212 discrete_mse=705.050903 best_discrete=45.822731 hash=False elapsed=47.5s
step   575/900 tau=0.1066 loss=0.288762 mse_soft=0.288337 ent_in=1.0568 ent_out=0.3607 rowmax_in=0.5421 rowmax_out=0.8179 discrete_mse=240.712601 best_discrete=45.822731 hash=False elapsed=49.8s
step   600/900 tau=0.0967 loss=0.306399 mse_soft=0.306027 ent_in=0.9291 ent_out=0.3100 rowmax_in=0.5874 rowmax_out=0.8477 discrete_mse=30.943596 best_discrete=30.943596 hash=False elapsed=52.2s
step   625/900 tau=0.0877 loss=0.285423 mse_soft=0.285058 ent_in=0.9158 ent_out=0.3032 rowmax_in=0.5854 rowmax_out=0.8363 discrete_mse=12.907061 best_discrete=12.907061 hash=False elapsed=54.4s
step   650/900 tau=0.0795 loss=0.281404 mse_soft=0.281037 ent_in=0.9222 ent_out=0.2995 rowmax_in=0.5875 rowmax_out=0.8330 discrete_mse=10.984040 best_discrete=10.984040 hash=False elapsed=56.6s
step   675/900 tau=0.0722 loss=0.294203 mse_soft=0.293843 ent_in=0.9072 ent_out=0.2923 rowmax_in=0.5940 rowmax_out=0.8418 discrete_mse=43.938183 best_discrete=10.984040 hash=False elapsed=59.0s
step   700/900 tau=0.0655 loss=0.318629 mse_soft=0.318273 ent_in=0.9093 ent_out=0.2775 rowmax_in=0.5967 rowmax_out=0.8522 discrete_mse=14.874851 best_discrete=10.984040 hash=False elapsed=61.3s
step   725/900 tau=0.0594 loss=0.307154 mse_soft=0.306824 ent_in=0.8292 ent_out=0.2692 rowmax_in=0.6312 rowmax_out=0.8585 discrete_mse=41.714245 best_discrete=10.984040 hash=False elapsed=63.5s
step   750/900 tau=0.0539 loss=0.297512 mse_soft=0.297176 ent_in=0.8342 ent_out=0.2844 rowmax_in=0.6016 rowmax_out=0.8389 discrete_mse=79.976433 best_discrete=10.984040 hash=False elapsed=65.9s
step   775/900 tau=0.0489 loss=0.357906 mse_soft=0.357627 ent_in=0.6811 ent_out=0.2487 rowmax_in=0.6603 rowmax_out=0.8683 discrete_mse=25.861475 best_discrete=10.984040 hash=False elapsed=68.0s
step   800/900 tau=0.0443 loss=0.316633 mse_soft=0.316357 ent_in=0.6725 ent_out=0.2497 rowmax_in=0.6567 rowmax_out=0.8692 discrete_mse=78.986313 best_discrete=10.984040 hash=False elapsed=70.4s
step   825/900 tau=0.0402 loss=0.320415 mse_soft=0.320134 ent_in=0.6946 ent_out=0.2418 rowmax_in=0.6518 rowmax_out=0.8762 discrete_mse=65.179314 best_discrete=10.984040 hash=False elapsed=72.6s
step   850/900 tau=0.0365 loss=0.330043 mse_soft=0.329778 ent_in=0.6419 ent_out=0.2411 rowmax_in=0.6668 rowmax_out=0.8740 discrete_mse=47.469986 best_discrete=10.984040 hash=False elapsed=74.7s
step   875/900 tau=0.0331 loss=0.492367 mse_soft=0.492235 ent_in=0.3364 ent_out=0.1040 rowmax_in=0.8438 rowmax_out=0.9559 discrete_mse=9.429992 best_discrete=9.429992 hash=False elapsed=76.9s
step   900/900 tau=0.0300 loss=0.480487 mse_soft=0.480373 ent_in=0.2944 ent_out=0.0862 rowmax_in=0.8331 rowmax_out=0.9540 discrete_mse=29.446827 best_discrete=9.429992 hash=False elapsed=79.1s

Final metrics:
  soft_mse_full=0.511506
  rowmax_in_mean=0.8401
  rowmax_out_mean=0.9541
  ent_in_mean=0.2908
  ent_out_mean=0.0861
  final_discrete_mse=22.265387
  hash_match=False
  best_discrete_mse_seen=9.429992
Saved results to overnight_b019_j1.json
