Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.083898 mse_soft=1.081575 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=129.078278 best_discrete=129.078278 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.877274 mse_soft=0.875084 ent_in=3.6327 ent_out=3.6652 rowmax_in=0.0458 rowmax_out=0.0446 discrete_mse=522.305481 best_discrete=129.078278 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.659924 mse_soft=0.658022 ent_in=3.1256 ent_out=3.2146 rowmax_in=0.0925 rowmax_out=0.0891 discrete_mse=5046.624023 best_discrete=129.078278 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.528828 mse_soft=0.527246 ent_in=2.6127 ent_out=2.6589 rowmax_in=0.2000 rowmax_out=0.2100 discrete_mse=1424.394531 best_discrete=129.078278 hash=False elapsed=7.2s
step   100/900 tau=0.6797 loss=0.414059 mse_soft=0.412911 ent_in=2.0345 ent_out=1.7914 rowmax_in=0.3273 rowmax_out=0.4354 discrete_mse=371.080505 best_discrete=129.078278 hash=False elapsed=9.4s
step   125/900 tau=0.6165 loss=0.347381 mse_soft=0.346560 ent_in=1.6316 ent_out=1.1047 rowmax_in=0.4154 rowmax_out=0.6297 discrete_mse=349.920380 best_discrete=129.078278 hash=False elapsed=11.6s
step   150/900 tau=0.5592 loss=0.318419 mse_soft=0.317757 ent_in=1.4206 ent_out=0.7831 rowmax_in=0.4643 rowmax_out=0.7057 discrete_mse=1096.487915 best_discrete=129.078278 hash=False elapsed=14.1s
step   175/900 tau=0.5073 loss=0.306492 mse_soft=0.305905 ent_in=1.3366 ent_out=0.6198 rowmax_in=0.4732 rowmax_out=0.7457 discrete_mse=452.922882 best_discrete=129.078278 hash=False elapsed=16.3s
step   200/900 tau=0.4602 loss=0.298546 mse_soft=0.297999 ent_in=1.2890 ent_out=0.5316 rowmax_in=0.4761 rowmax_out=0.7776 discrete_mse=502.239532 best_discrete=129.078278 hash=False elapsed=18.5s
step   225/900 tau=0.4174 loss=0.292295 mse_soft=0.291790 ent_in=1.2433 ent_out=0.4422 rowmax_in=0.4877 rowmax_out=0.7978 discrete_mse=208.153427 best_discrete=129.078278 hash=False elapsed=20.8s
step   250/900 tau=0.3786 loss=0.291189 mse_soft=0.290701 ent_in=1.2160 ent_out=0.4109 rowmax_in=0.4939 rowmax_out=0.8086 discrete_mse=475.557648 best_discrete=129.078278 hash=False elapsed=23.1s
step   275/900 tau=0.3434 loss=0.288398 mse_soft=0.287919 ent_in=1.2040 ent_out=0.3926 rowmax_in=0.4944 rowmax_out=0.8189 discrete_mse=544.589722 best_discrete=129.078278 hash=False elapsed=25.3s
step   300/900 tau=0.3115 loss=0.287241 mse_soft=0.286768 ent_in=1.1957 ent_out=0.3832 rowmax_in=0.4946 rowmax_out=0.8236 discrete_mse=199.423676 best_discrete=129.078278 hash=False elapsed=27.4s
step   325/900 tau=0.2826 loss=0.285653 mse_soft=0.285190 ent_in=1.1752 ent_out=0.3654 rowmax_in=0.4966 rowmax_out=0.8350 discrete_mse=144.157776 best_discrete=129.078278 hash=False elapsed=29.6s
step   350/900 tau=0.2563 loss=0.282936 mse_soft=0.282487 ent_in=1.1522 ent_out=0.3416 rowmax_in=0.5013 rowmax_out=0.8476 discrete_mse=244.620789 best_discrete=129.078278 hash=False elapsed=31.9s
step   375/900 tau=0.2325 loss=0.284604 mse_soft=0.284166 ent_in=1.1332 ent_out=0.3247 rowmax_in=0.5051 rowmax_out=0.8532 discrete_mse=244.620789 best_discrete=129.078278 hash=False elapsed=34.2s
step   400/900 tau=0.2109 loss=0.280507 mse_soft=0.280074 ent_in=1.1245 ent_out=0.3165 rowmax_in=0.5061 rowmax_out=0.8547 discrete_mse=244.620789 best_discrete=129.078278 hash=False elapsed=36.3s
step   425/900 tau=0.1913 loss=0.282133 mse_soft=0.281701 ent_in=1.1214 ent_out=0.3178 rowmax_in=0.5060 rowmax_out=0.8527 discrete_mse=244.620789 best_discrete=129.078278 hash=False elapsed=38.6s
step   450/900 tau=0.1735 loss=0.281363 mse_soft=0.280931 ent_in=1.1174 ent_out=0.3232 rowmax_in=0.5064 rowmax_out=0.8470 discrete_mse=244.620789 best_discrete=129.078278 hash=False elapsed=41.0s
step   475/900 tau=0.1574 loss=0.280967 mse_soft=0.280535 ent_in=1.1146 ent_out=0.3257 rowmax_in=0.5056 rowmax_out=0.8437 discrete_mse=244.620789 best_discrete=129.078278 hash=False elapsed=43.2s
step   500/900 tau=0.1428 loss=0.281443 mse_soft=0.281012 ent_in=1.1119 ent_out=0.3264 rowmax_in=0.5055 rowmax_out=0.8427 discrete_mse=366.463776 best_discrete=129.078278 hash=False elapsed=45.4s
step   525/900 tau=0.1295 loss=0.281885 mse_soft=0.281454 ent_in=1.1079 ent_out=0.3271 rowmax_in=0.5074 rowmax_out=0.8422 discrete_mse=366.463776 best_discrete=129.078278 hash=False elapsed=47.8s
step   550/900 tau=0.1175 loss=0.291214 mse_soft=0.290783 ent_in=1.1101 ent_out=0.3284 rowmax_in=0.5050 rowmax_out=0.8429 discrete_mse=225.844391 best_discrete=129.078278 hash=False elapsed=50.3s
step   575/900 tau=0.1066 loss=0.284646 mse_soft=0.284222 ent_in=1.0901 ent_out=0.3251 rowmax_in=0.5074 rowmax_out=0.8415 discrete_mse=212.916138 best_discrete=129.078278 hash=False elapsed=52.6s
step   600/900 tau=0.0967 loss=0.280952 mse_soft=0.280536 ent_in=1.0685 ent_out=0.3150 rowmax_in=0.5173 rowmax_out=0.8442 discrete_mse=145.331390 best_discrete=129.078278 hash=False elapsed=55.0s
step   625/900 tau=0.0877 loss=0.289093 mse_soft=0.288686 ent_in=1.0487 ent_out=0.3085 rowmax_in=0.5266 rowmax_out=0.8578 discrete_mse=1262.848755 best_discrete=129.078278 hash=False elapsed=57.5s
step   650/900 tau=0.0795 loss=0.283915 mse_soft=0.283502 ent_in=1.0613 ent_out=0.3145 rowmax_in=0.5161 rowmax_out=0.8444 discrete_mse=253.767899 best_discrete=129.078278 hash=False elapsed=59.9s
step   675/900 tau=0.0722 loss=0.293287 mse_soft=0.292886 ent_in=1.0279 ent_out=0.3088 rowmax_in=0.5349 rowmax_out=0.8451 discrete_mse=139.544403 best_discrete=129.078278 hash=False elapsed=62.3s
step   700/900 tau=0.0655 loss=0.334783 mse_soft=0.334441 ent_in=0.8447 ent_out=0.2926 rowmax_in=0.6307 rowmax_out=0.8539 discrete_mse=60.978836 best_discrete=60.978836 hash=False elapsed=64.6s
step   725/900 tau=0.0594 loss=0.298639 mse_soft=0.298298 ent_in=0.8467 ent_out=0.2877 rowmax_in=0.5859 rowmax_out=0.8541 discrete_mse=208.889847 best_discrete=60.978836 hash=False elapsed=66.8s
step   750/900 tau=0.0539 loss=0.329435 mse_soft=0.329116 ent_in=0.7836 ent_out=0.2794 rowmax_in=0.6169 rowmax_out=0.8555 discrete_mse=68.892487 best_discrete=60.978836 hash=False elapsed=69.0s
step   775/900 tau=0.0489 loss=0.314898 mse_soft=0.314572 ent_in=0.8112 ent_out=0.2770 rowmax_in=0.6061 rowmax_out=0.8609 discrete_mse=206.723801 best_discrete=60.978836 hash=False elapsed=71.2s
step   800/900 tau=0.0443 loss=0.307270 mse_soft=0.306951 ent_in=0.8004 ent_out=0.2648 rowmax_in=0.6028 rowmax_out=0.8561 discrete_mse=250.611267 best_discrete=60.978836 hash=False elapsed=73.6s
step   825/900 tau=0.0402 loss=0.431163 mse_soft=0.430931 ent_in=0.5546 ent_out=0.2184 rowmax_in=0.7224 rowmax_out=0.8786 discrete_mse=259.604858 best_discrete=60.978836 hash=False elapsed=75.7s
step   850/900 tau=0.0365 loss=0.548834 mse_soft=0.548702 ent_in=0.2708 ent_out=0.1707 rowmax_in=0.8626 rowmax_out=0.8896 discrete_mse=34.025826 best_discrete=34.025826 hash=False elapsed=77.8s
step   875/900 tau=0.0331 loss=0.482940 mse_soft=0.482807 ent_in=0.3050 ent_out=0.1361 rowmax_in=0.8376 rowmax_out=0.9093 discrete_mse=78.848763 best_discrete=34.025826 hash=False elapsed=79.9s
step   900/900 tau=0.0300 loss=0.475698 mse_soft=0.475566 ent_in=0.3012 ent_out=0.1390 rowmax_in=0.8367 rowmax_out=0.9074 discrete_mse=108.470085 best_discrete=34.025826 hash=False elapsed=82.1s

Final metrics:
  soft_mse_full=0.466954
  rowmax_in_mean=0.8359
  rowmax_out_mean=0.9075
  ent_in_mean=0.3018
  ent_out_mean=0.1390
  final_discrete_mse=108.470085
  hash_match=False
  best_discrete_mse_seen=34.025826
Saved results to overnight_b077_j1.json
