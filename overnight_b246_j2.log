Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.057040 mse_soft=1.054718 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=67.220245 best_discrete=67.220245 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.859152 mse_soft=0.856962 ent_in=3.6354 ent_out=3.6649 rowmax_in=0.0449 rowmax_out=0.0445 discrete_mse=3720.908691 best_discrete=67.220245 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.654613 mse_soft=0.652701 ent_in=3.1403 ent_out=3.2318 rowmax_in=0.0924 rowmax_out=0.0887 discrete_mse=3617.718994 best_discrete=67.220245 hash=False elapsed=4.8s
step    75/900 tau=0.7450 loss=0.512017 mse_soft=0.510433 ent_in=2.6063 ent_out=2.6734 rowmax_in=0.2030 rowmax_out=0.2057 discrete_mse=3416.567871 best_discrete=67.220245 hash=False elapsed=7.0s
step   100/900 tau=0.6745 loss=0.399815 mse_soft=0.398654 ent_in=2.0145 ent_out=1.8545 rowmax_in=0.3273 rowmax_out=0.4129 discrete_mse=312.008301 best_discrete=67.220245 hash=False elapsed=9.2s
step   125/900 tau=0.6107 loss=0.337796 mse_soft=0.336981 ent_in=1.5537 ent_out=1.1644 rowmax_in=0.4481 rowmax_out=0.6232 discrete_mse=181.661972 best_discrete=67.220245 hash=False elapsed=11.5s
step   150/900 tau=0.5529 loss=0.313509 mse_soft=0.312847 ent_in=1.3749 ent_out=0.8332 rowmax_in=0.4809 rowmax_out=0.7039 discrete_mse=280.139252 best_discrete=67.220245 hash=False elapsed=13.7s
step   175/900 tau=0.5006 loss=0.297523 mse_soft=0.296952 ent_in=1.2761 ent_out=0.6253 rowmax_in=0.4949 rowmax_out=0.7605 discrete_mse=866.233582 best_discrete=67.220245 hash=False elapsed=16.0s
step   200/900 tau=0.4532 loss=0.289999 mse_soft=0.289484 ent_in=1.2182 ent_out=0.4997 rowmax_in=0.5023 rowmax_out=0.8015 discrete_mse=837.577271 best_discrete=67.220245 hash=False elapsed=18.4s
step   225/900 tau=0.4103 loss=0.285000 mse_soft=0.284511 ent_in=1.1979 ent_out=0.4325 rowmax_in=0.5009 rowmax_out=0.8178 discrete_mse=827.367737 best_discrete=67.220245 hash=False elapsed=20.6s
step   250/900 tau=0.3715 loss=0.282756 mse_soft=0.282291 ent_in=1.1694 ent_out=0.3805 rowmax_in=0.5034 rowmax_out=0.8266 discrete_mse=320.952179 best_discrete=67.220245 hash=False elapsed=23.0s
step   275/900 tau=0.3363 loss=0.280569 mse_soft=0.280118 ent_in=1.1566 ent_out=0.3496 rowmax_in=0.5086 rowmax_out=0.8341 discrete_mse=363.939331 best_discrete=67.220245 hash=False elapsed=25.4s
step   300/900 tau=0.3045 loss=0.279100 mse_soft=0.278659 ent_in=1.1367 ent_out=0.3338 rowmax_in=0.5176 rowmax_out=0.8363 discrete_mse=336.990051 best_discrete=67.220245 hash=False elapsed=27.6s
step   325/900 tau=0.2756 loss=0.277644 mse_soft=0.277210 ent_in=1.1227 ent_out=0.3235 rowmax_in=0.5231 rowmax_out=0.8370 discrete_mse=363.909790 best_discrete=67.220245 hash=False elapsed=29.9s
step   350/900 tau=0.2496 loss=0.275263 mse_soft=0.274832 ent_in=1.1123 ent_out=0.3230 rowmax_in=0.5277 rowmax_out=0.8338 discrete_mse=412.939880 best_discrete=67.220245 hash=False elapsed=31.8s
step   375/900 tau=0.2259 loss=0.273419 mse_soft=0.272994 ent_in=1.0996 ent_out=0.3173 rowmax_in=0.5289 rowmax_out=0.8363 discrete_mse=620.554260 best_discrete=67.220245 hash=False elapsed=34.0s
step   400/900 tau=0.2046 loss=0.272724 mse_soft=0.272300 ent_in=1.0983 ent_out=0.3162 rowmax_in=0.5272 rowmax_out=0.8380 discrete_mse=620.554260 best_discrete=67.220245 hash=False elapsed=36.3s
step   425/900 tau=0.1852 loss=0.274202 mse_soft=0.273780 ent_in=1.0948 ent_out=0.3123 rowmax_in=0.5286 rowmax_out=0.8427 discrete_mse=236.387939 best_discrete=67.220245 hash=False elapsed=38.4s
step   450/900 tau=0.1677 loss=0.272676 mse_soft=0.272255 ent_in=1.0912 ent_out=0.3113 rowmax_in=0.5307 rowmax_out=0.8437 discrete_mse=282.416138 best_discrete=67.220245 hash=False elapsed=40.8s
step   475/900 tau=0.1518 loss=0.274662 mse_soft=0.274245 ent_in=1.0835 ent_out=0.3056 rowmax_in=0.5312 rowmax_out=0.8483 discrete_mse=268.288666 best_discrete=67.220245 hash=False elapsed=43.1s
step   500/900 tau=0.1374 loss=0.278654 mse_soft=0.278240 ent_in=1.0720 ent_out=0.3056 rowmax_in=0.5352 rowmax_out=0.8478 discrete_mse=265.462891 best_discrete=67.220245 hash=False elapsed=45.2s
step   525/900 tau=0.1244 loss=0.272504 mse_soft=0.272094 ent_in=1.0630 ent_out=0.3036 rowmax_in=0.5399 rowmax_out=0.8457 discrete_mse=265.462891 best_discrete=67.220245 hash=False elapsed=47.4s
step   550/900 tau=0.1126 loss=0.278491 mse_soft=0.278083 ent_in=1.0582 ent_out=0.3019 rowmax_in=0.5380 rowmax_out=0.8479 discrete_mse=240.482590 best_discrete=67.220245 hash=False elapsed=49.5s
step   575/900 tau=0.1020 loss=0.306368 mse_soft=0.305961 ent_in=1.0540 ent_out=0.3011 rowmax_in=0.5400 rowmax_out=0.8495 discrete_mse=60.935963 best_discrete=60.935963 hash=False elapsed=51.9s
step   600/900 tau=0.0923 loss=0.277793 mse_soft=0.277398 ent_in=1.0173 ent_out=0.2978 rowmax_in=0.5534 rowmax_out=0.8473 discrete_mse=200.595093 best_discrete=60.935963 hash=False elapsed=54.3s
step   625/900 tau=0.0836 loss=0.301330 mse_soft=0.300936 ent_in=1.0189 ent_out=0.2946 rowmax_in=0.5512 rowmax_out=0.8507 discrete_mse=67.232903 best_discrete=60.935963 hash=False elapsed=56.6s
step   650/900 tau=0.0757 loss=0.280402 mse_soft=0.280008 ent_in=1.0117 ent_out=0.3014 rowmax_in=0.5509 rowmax_out=0.8450 discrete_mse=263.412231 best_discrete=60.935963 hash=False elapsed=58.7s
step   675/900 tau=0.0685 loss=0.308608 mse_soft=0.308283 ent_in=0.8486 ent_out=0.2356 rowmax_in=0.6071 rowmax_out=0.8847 discrete_mse=65.378876 best_discrete=60.935963 hash=False elapsed=60.8s
step   700/900 tau=0.0620 loss=0.299117 mse_soft=0.298823 ent_in=0.7450 ent_out=0.2357 rowmax_in=0.6481 rowmax_out=0.8849 discrete_mse=65.089470 best_discrete=60.935963 hash=False elapsed=62.8s
step   725/900 tau=0.0562 loss=0.289253 mse_soft=0.288959 ent_in=0.7597 ent_out=0.2206 rowmax_in=0.6439 rowmax_out=0.8923 discrete_mse=106.726074 best_discrete=60.935963 hash=False elapsed=65.0s
step   750/900 tau=0.0508 loss=0.287413 mse_soft=0.287121 ent_in=0.7617 ent_out=0.2143 rowmax_in=0.6414 rowmax_out=0.8946 discrete_mse=42.789623 best_discrete=42.789623 hash=False elapsed=67.1s
step   775/900 tau=0.0460 loss=0.293549 mse_soft=0.293258 ent_in=0.7555 ent_out=0.2118 rowmax_in=0.6406 rowmax_out=0.8952 discrete_mse=110.990570 best_discrete=42.789623 hash=False elapsed=69.3s
step   800/900 tau=0.0417 loss=0.446108 mse_soft=0.445945 ent_in=0.4068 ent_out=0.1365 rowmax_in=0.8099 rowmax_out=0.9438 discrete_mse=21.393955 best_discrete=21.393955 hash=False elapsed=71.6s
step   825/900 tau=0.0377 loss=0.398592 mse_soft=0.398446 ent_in=0.3460 ent_out=0.1410 rowmax_in=0.8324 rowmax_out=0.9372 discrete_mse=15.000246 best_discrete=15.000246 hash=False elapsed=73.7s
step   850/900 tau=0.0342 loss=0.392888 mse_soft=0.392732 ent_in=0.3541 ent_out=0.1680 rowmax_in=0.8220 rowmax_out=0.9200 discrete_mse=8.948606 best_discrete=8.948606 hash=False elapsed=75.9s
step   875/900 tau=0.0309 loss=0.381493 mse_soft=0.381345 ent_in=0.3286 ent_out=0.1662 rowmax_in=0.8340 rowmax_out=0.9149 discrete_mse=14.044790 best_discrete=8.948606 hash=False elapsed=78.2s
step   900/900 tau=0.0280 loss=0.379777 mse_soft=0.379628 ent_in=0.3324 ent_out=0.1656 rowmax_in=0.8329 rowmax_out=0.9168 discrete_mse=14.044790 best_discrete=8.948606 hash=False elapsed=80.1s

Final metrics:
  soft_mse_full=0.393234
  rowmax_in_mean=0.8326
  rowmax_out_mean=0.9173
  ent_in_mean=0.3323
  ent_out_mean=0.1651
  final_discrete_mse=14.044790
  hash_match=False
  best_discrete_mse_seen=8.948606
Saved results to overnight_b246_j2.json
