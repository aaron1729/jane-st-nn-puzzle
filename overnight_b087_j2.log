Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.093414 mse_soft=1.091091 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=15.027719 best_discrete=15.027719 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.881743 mse_soft=0.879554 ent_in=3.6330 ent_out=3.6656 rowmax_in=0.0459 rowmax_out=0.0444 discrete_mse=1946.931519 best_discrete=15.027719 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.660330 mse_soft=0.658425 ent_in=3.1276 ent_out=3.2206 rowmax_in=0.0931 rowmax_out=0.0868 discrete_mse=2205.685547 best_discrete=15.027719 hash=False elapsed=5.1s
step    75/900 tau=0.7450 loss=0.520448 mse_soft=0.518865 ent_in=2.5851 ent_out=2.6923 rowmax_in=0.2069 rowmax_out=0.1983 discrete_mse=2349.444336 best_discrete=15.027719 hash=False elapsed=7.7s
step   100/900 tau=0.6745 loss=0.411173 mse_soft=0.410011 ent_in=1.9937 ent_out=1.8775 rowmax_in=0.3467 rowmax_out=0.4017 discrete_mse=1758.328979 best_discrete=15.027719 hash=False elapsed=10.3s
step   125/900 tau=0.6107 loss=0.351628 mse_soft=0.350791 ent_in=1.5677 ent_out=1.2244 rowmax_in=0.4509 rowmax_out=0.5947 discrete_mse=606.303711 best_discrete=15.027719 hash=False elapsed=12.8s
step   150/900 tau=0.5529 loss=0.323107 mse_soft=0.322429 ent_in=1.3959 ent_out=0.8641 rowmax_in=0.4806 rowmax_out=0.7167 discrete_mse=77.712738 best_discrete=15.027719 hash=False elapsed=15.3s
step   175/900 tau=0.5006 loss=0.304112 mse_soft=0.303520 ent_in=1.3024 ent_out=0.6735 rowmax_in=0.5001 rowmax_out=0.7703 discrete_mse=329.876831 best_discrete=15.027719 hash=False elapsed=17.8s
step   200/900 tau=0.4532 loss=0.294984 mse_soft=0.294442 ent_in=1.2457 ent_out=0.5581 rowmax_in=0.5063 rowmax_out=0.7987 discrete_mse=751.432617 best_discrete=15.027719 hash=False elapsed=20.2s
step   225/900 tau=0.4103 loss=0.289994 mse_soft=0.289479 ent_in=1.2181 ent_out=0.4974 rowmax_in=0.5086 rowmax_out=0.8088 discrete_mse=312.840332 best_discrete=15.027719 hash=False elapsed=22.8s
step   250/900 tau=0.3715 loss=0.286834 mse_soft=0.286336 ent_in=1.1985 ent_out=0.4640 rowmax_in=0.5105 rowmax_out=0.8129 discrete_mse=191.543274 best_discrete=15.027719 hash=False elapsed=25.3s
step   275/900 tau=0.3363 loss=0.293582 mse_soft=0.293092 ent_in=1.1879 ent_out=0.4461 rowmax_in=0.5099 rowmax_out=0.8144 discrete_mse=191.543274 best_discrete=15.027719 hash=False elapsed=28.2s
step   300/900 tau=0.3045 loss=0.282121 mse_soft=0.281639 ent_in=1.1823 ent_out=0.4245 rowmax_in=0.5047 rowmax_out=0.8231 discrete_mse=666.372864 best_discrete=15.027719 hash=False elapsed=30.8s
step   325/900 tau=0.2756 loss=0.279606 mse_soft=0.279135 ent_in=1.1738 ent_out=0.3946 rowmax_in=0.5038 rowmax_out=0.8318 discrete_mse=1846.406738 best_discrete=15.027719 hash=False elapsed=33.6s
step   350/900 tau=0.2496 loss=0.279700 mse_soft=0.279239 ent_in=1.1578 ent_out=0.3788 rowmax_in=0.5043 rowmax_out=0.8415 discrete_mse=1846.406738 best_discrete=15.027719 hash=False elapsed=36.2s
step   375/900 tau=0.2259 loss=0.276376 mse_soft=0.275923 ent_in=1.1454 ent_out=0.3627 rowmax_in=0.5035 rowmax_out=0.8512 discrete_mse=858.617859 best_discrete=15.027719 hash=False elapsed=38.7s
step   400/900 tau=0.2046 loss=0.277233 mse_soft=0.276794 ent_in=1.1214 ent_out=0.3425 rowmax_in=0.5128 rowmax_out=0.8608 discrete_mse=1183.517578 best_discrete=15.027719 hash=False elapsed=41.3s
step   425/900 tau=0.1852 loss=0.275596 mse_soft=0.275164 ent_in=1.1102 ent_out=0.3296 rowmax_in=0.5152 rowmax_out=0.8658 discrete_mse=1183.517578 best_discrete=15.027719 hash=False elapsed=43.8s
step   450/900 tau=0.1677 loss=0.274856 mse_soft=0.274429 ent_in=1.1019 ent_out=0.3206 rowmax_in=0.5148 rowmax_out=0.8687 discrete_mse=928.853455 best_discrete=15.027719 hash=False elapsed=46.4s
step   475/900 tau=0.1518 loss=0.274743 mse_soft=0.274322 ent_in=1.0895 ent_out=0.3133 rowmax_in=0.5196 rowmax_out=0.8707 discrete_mse=928.853455 best_discrete=15.027719 hash=False elapsed=49.2s
step   500/900 tau=0.1374 loss=0.275670 mse_soft=0.275256 ent_in=1.0796 ent_out=0.3014 rowmax_in=0.5216 rowmax_out=0.8743 discrete_mse=928.853455 best_discrete=15.027719 hash=False elapsed=51.5s
step   525/900 tau=0.1244 loss=0.277296 mse_soft=0.276885 ent_in=1.0751 ent_out=0.2962 rowmax_in=0.5198 rowmax_out=0.8755 discrete_mse=672.817200 best_discrete=15.027719 hash=False elapsed=53.8s
step   550/900 tau=0.1126 loss=0.278979 mse_soft=0.278573 ent_in=1.0651 ent_out=0.2857 rowmax_in=0.5202 rowmax_out=0.8813 discrete_mse=672.817200 best_discrete=15.027719 hash=False elapsed=56.3s
step   575/900 tau=0.1020 loss=0.279782 mse_soft=0.279379 ent_in=1.0582 ent_out=0.2825 rowmax_in=0.5199 rowmax_out=0.8810 discrete_mse=672.817200 best_discrete=15.027719 hash=False elapsed=58.8s
step   600/900 tau=0.0923 loss=0.287565 mse_soft=0.287166 ent_in=1.0515 ent_out=0.2783 rowmax_in=0.5181 rowmax_out=0.8815 discrete_mse=263.370331 best_discrete=15.027719 hash=False elapsed=61.2s
step   625/900 tau=0.0836 loss=0.278439 mse_soft=0.278044 ent_in=1.0410 ent_out=0.2740 rowmax_in=0.5229 rowmax_out=0.8837 discrete_mse=79.454811 best_discrete=15.027719 hash=False elapsed=63.6s
step   650/900 tau=0.0757 loss=0.335470 mse_soft=0.335136 ent_in=0.9058 ent_out=0.2094 rowmax_in=0.5771 rowmax_out=0.9016 discrete_mse=1.304333 best_discrete=1.304333 hash=False elapsed=66.1s
step   675/900 tau=0.0685 loss=0.302291 mse_soft=0.301966 ent_in=0.8660 ent_out=0.2182 rowmax_in=0.5811 rowmax_out=0.8998 discrete_mse=26.798706 best_discrete=1.304333 hash=False elapsed=68.4s
step   700/900 tau=0.0620 loss=0.327487 mse_soft=0.327163 ent_in=0.8607 ent_out=0.2178 rowmax_in=0.5785 rowmax_out=0.9036 discrete_mse=395.859985 best_discrete=1.304333 hash=False elapsed=70.9s
step   725/900 tau=0.0562 loss=0.325824 mse_soft=0.325507 ent_in=0.8538 ent_out=0.2041 rowmax_in=0.5877 rowmax_out=0.9109 discrete_mse=329.268280 best_discrete=1.304333 hash=False elapsed=73.2s
step   750/900 tau=0.0508 loss=0.347739 mse_soft=0.347481 ent_in=0.6912 ent_out=0.1686 rowmax_in=0.6629 rowmax_out=0.9233 discrete_mse=5.793492 best_discrete=1.304333 hash=False elapsed=75.3s
step   775/900 tau=0.0460 loss=0.326703 mse_soft=0.326444 ent_in=0.7182 ent_out=0.1460 rowmax_in=0.6166 rowmax_out=0.9314 discrete_mse=176.240295 best_discrete=1.304333 hash=False elapsed=77.8s
step   800/900 tau=0.0417 loss=0.316310 mse_soft=0.316047 ent_in=0.7286 ent_out=0.1474 rowmax_in=0.6155 rowmax_out=0.9323 discrete_mse=72.231758 best_discrete=1.304333 hash=False elapsed=80.1s
step   825/900 tau=0.0377 loss=0.312993 mse_soft=0.312726 ent_in=0.7350 ent_out=0.1539 rowmax_in=0.6101 rowmax_out=0.9305 discrete_mse=62.722084 best_discrete=1.304333 hash=False elapsed=82.4s
step   850/900 tau=0.0342 loss=0.331409 mse_soft=0.331147 ent_in=0.7204 ent_out=0.1550 rowmax_in=0.6226 rowmax_out=0.9272 discrete_mse=352.506897 best_discrete=1.304333 hash=False elapsed=84.7s
step   875/900 tau=0.0309 loss=0.578606 mse_soft=0.578457 ent_in=0.3686 ent_out=0.1266 rowmax_in=0.8162 rowmax_out=0.9258 discrete_mse=2.279313 best_discrete=1.304333 hash=False elapsed=87.1s
step   900/900 tau=0.0280 loss=0.463051 mse_soft=0.462901 ent_in=0.3490 ent_out=0.1502 rowmax_in=0.8088 rowmax_out=0.9016 discrete_mse=70.747437 best_discrete=1.304333 hash=False elapsed=89.3s

Final metrics:
  soft_mse_full=0.458361
  rowmax_in_mean=0.8088
  rowmax_out_mean=0.8994
  ent_in_mean=0.3495
  ent_out_mean=0.1511
  final_discrete_mse=70.747437
  hash_match=False
  best_discrete_mse_seen=1.304333
Saved results to overnight_b087_j2.json
