Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.029101 mse_soft=1.026778 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=14.056970 best_discrete=14.056970 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.831055 mse_soft=0.828865 ent_in=3.6305 ent_out=3.6685 rowmax_in=0.0466 rowmax_out=0.0434 discrete_mse=2617.887451 best_discrete=14.056970 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.629158 mse_soft=0.627253 ent_in=3.1234 ent_out=3.2262 rowmax_in=0.0946 rowmax_out=0.0861 discrete_mse=3821.254639 best_discrete=14.056970 hash=False elapsed=5.2s
step    75/900 tau=0.7450 loss=0.496323 mse_soft=0.494747 ent_in=2.5765 ent_out=2.6782 rowmax_in=0.2151 rowmax_out=0.1905 discrete_mse=2051.194824 best_discrete=14.056970 hash=False elapsed=7.4s
step   100/900 tau=0.6745 loss=0.404283 mse_soft=0.403120 ent_in=1.9975 ent_out=1.8764 rowmax_in=0.3506 rowmax_out=0.4007 discrete_mse=1954.550293 best_discrete=14.056970 hash=False elapsed=9.7s
step   125/900 tau=0.6107 loss=0.351970 mse_soft=0.351140 ent_in=1.6220 ent_out=1.1465 rowmax_in=0.4257 rowmax_out=0.6260 discrete_mse=358.657654 best_discrete=14.056970 hash=False elapsed=12.2s
step   150/900 tau=0.5529 loss=0.329703 mse_soft=0.329056 ent_in=1.4602 ent_out=0.6938 rowmax_in=0.4596 rowmax_out=0.7553 discrete_mse=213.783737 best_discrete=14.056970 hash=False elapsed=14.3s
step   175/900 tau=0.5006 loss=0.316787 mse_soft=0.316222 ent_in=1.3654 ent_out=0.5171 rowmax_in=0.4827 rowmax_out=0.8066 discrete_mse=540.701660 best_discrete=14.056970 hash=False elapsed=16.3s
step   200/900 tau=0.4532 loss=0.306413 mse_soft=0.305907 ent_in=1.2751 ent_out=0.4093 rowmax_in=0.4988 rowmax_out=0.8383 discrete_mse=496.582397 best_discrete=14.056970 hash=False elapsed=18.2s
step   225/900 tau=0.4103 loss=0.300148 mse_soft=0.299677 ent_in=1.2216 ent_out=0.3487 rowmax_in=0.5071 rowmax_out=0.8587 discrete_mse=865.646790 best_discrete=14.056970 hash=False elapsed=20.2s
step   250/900 tau=0.3715 loss=0.294333 mse_soft=0.293883 ent_in=1.1892 ent_out=0.3095 rowmax_in=0.5088 rowmax_out=0.8688 discrete_mse=1384.932739 best_discrete=14.056970 hash=False elapsed=22.1s
step   275/900 tau=0.3363 loss=0.291629 mse_soft=0.291196 ent_in=1.1635 ent_out=0.2792 rowmax_in=0.5111 rowmax_out=0.8769 discrete_mse=773.235901 best_discrete=14.056970 hash=False elapsed=23.9s
step   300/900 tau=0.3045 loss=0.290599 mse_soft=0.290177 ent_in=1.1382 ent_out=0.2683 rowmax_in=0.5159 rowmax_out=0.8780 discrete_mse=874.218262 best_discrete=14.056970 hash=False elapsed=26.2s
step   325/900 tau=0.2756 loss=0.287770 mse_soft=0.287355 ent_in=1.1290 ent_out=0.2551 rowmax_in=0.5132 rowmax_out=0.8800 discrete_mse=587.149658 best_discrete=14.056970 hash=False elapsed=28.4s
step   350/900 tau=0.2496 loss=0.287512 mse_soft=0.287104 ent_in=1.1123 ent_out=0.2474 rowmax_in=0.5179 rowmax_out=0.8804 discrete_mse=1485.259155 best_discrete=14.056970 hash=False elapsed=30.3s
step   375/900 tau=0.2259 loss=0.284805 mse_soft=0.284405 ent_in=1.0914 ent_out=0.2419 rowmax_in=0.5262 rowmax_out=0.8808 discrete_mse=1485.259155 best_discrete=14.056970 hash=False elapsed=32.2s
step   400/900 tau=0.2046 loss=0.284776 mse_soft=0.284381 ent_in=1.0769 ent_out=0.2379 rowmax_in=0.5290 rowmax_out=0.8811 discrete_mse=1485.259155 best_discrete=14.056970 hash=False elapsed=34.5s
step   425/900 tau=0.1852 loss=0.285128 mse_soft=0.284736 ent_in=1.0650 ent_out=0.2397 rowmax_in=0.5324 rowmax_out=0.8781 discrete_mse=1564.453613 best_discrete=14.056970 hash=False elapsed=36.7s
step   450/900 tau=0.1677 loss=0.284121 mse_soft=0.283734 ent_in=1.0519 ent_out=0.2376 rowmax_in=0.5360 rowmax_out=0.8797 discrete_mse=1564.453613 best_discrete=14.056970 hash=False elapsed=39.0s
step   475/900 tau=0.1518 loss=0.284055 mse_soft=0.283670 ent_in=1.0494 ent_out=0.2326 rowmax_in=0.5362 rowmax_out=0.8821 discrete_mse=1201.551147 best_discrete=14.056970 hash=False elapsed=41.3s
step   500/900 tau=0.1374 loss=0.286093 mse_soft=0.285710 ent_in=1.0469 ent_out=0.2281 rowmax_in=0.5359 rowmax_out=0.8846 discrete_mse=1066.014771 best_discrete=14.056970 hash=False elapsed=43.6s
step   525/900 tau=0.1244 loss=0.282322 mse_soft=0.281941 ent_in=1.0461 ent_out=0.2251 rowmax_in=0.5358 rowmax_out=0.8847 discrete_mse=1066.014771 best_discrete=14.056970 hash=False elapsed=45.7s
step   550/900 tau=0.1126 loss=0.286947 mse_soft=0.286568 ent_in=1.0370 ent_out=0.2253 rowmax_in=0.5373 rowmax_out=0.8856 discrete_mse=1546.616821 best_discrete=14.056970 hash=False elapsed=47.7s
step   575/900 tau=0.1020 loss=0.309417 mse_soft=0.309038 ent_in=1.0315 ent_out=0.2304 rowmax_in=0.5440 rowmax_out=0.8811 discrete_mse=774.464661 best_discrete=14.056970 hash=False elapsed=50.0s
step   600/900 tau=0.0923 loss=0.287287 mse_soft=0.286908 ent_in=1.0330 ent_out=0.2297 rowmax_in=0.5357 rowmax_out=0.8806 discrete_mse=1066.014771 best_discrete=14.056970 hash=False elapsed=52.3s
step   625/900 tau=0.0836 loss=0.285796 mse_soft=0.285416 ent_in=1.0359 ent_out=0.2303 rowmax_in=0.5320 rowmax_out=0.8796 discrete_mse=930.538147 best_discrete=14.056970 hash=False elapsed=54.4s
step   650/900 tau=0.0757 loss=0.360395 mse_soft=0.360026 ent_in=0.9978 ent_out=0.2313 rowmax_in=0.5560 rowmax_out=0.8819 discrete_mse=71.439713 best_discrete=14.056970 hash=False elapsed=56.4s
step   675/900 tau=0.0685 loss=0.384480 mse_soft=0.384173 ent_in=0.8375 ent_out=0.1874 rowmax_in=0.6277 rowmax_out=0.9109 discrete_mse=73.777588 best_discrete=14.056970 hash=False elapsed=58.4s
step   700/900 tau=0.0620 loss=0.405321 mse_soft=0.405083 ent_in=0.6279 ent_out=0.1663 rowmax_in=0.7173 rowmax_out=0.9245 discrete_mse=39.022301 best_discrete=14.056970 hash=False elapsed=60.7s
step   725/900 tau=0.0562 loss=0.368088 mse_soft=0.367840 ent_in=0.6201 ent_out=0.2079 rowmax_in=0.7126 rowmax_out=0.8925 discrete_mse=167.775803 best_discrete=14.056970 hash=False elapsed=62.7s
step   750/900 tau=0.0508 loss=0.362812 mse_soft=0.362553 ent_in=0.6602 ent_out=0.2024 rowmax_in=0.6893 rowmax_out=0.8946 discrete_mse=18.391043 best_discrete=14.056970 hash=False elapsed=64.8s
step   775/900 tau=0.0460 loss=0.347131 mse_soft=0.346866 ent_in=0.6707 ent_out=0.2100 rowmax_in=0.6851 rowmax_out=0.8824 discrete_mse=148.609543 best_discrete=14.056970 hash=False elapsed=67.0s
step   800/900 tau=0.0417 loss=0.350614 mse_soft=0.350354 ent_in=0.6650 ent_out=0.2020 rowmax_in=0.6787 rowmax_out=0.8900 discrete_mse=20.041803 best_discrete=14.056970 hash=False elapsed=69.1s
step   825/900 tau=0.0377 loss=0.455423 mse_soft=0.455238 ent_in=0.4792 ent_out=0.1375 rowmax_in=0.7606 rowmax_out=0.9250 discrete_mse=48.027451 best_discrete=14.056970 hash=False elapsed=71.1s
step   850/900 tau=0.0342 loss=0.406634 mse_soft=0.406461 ent_in=0.4612 ent_out=0.1161 rowmax_in=0.7596 rowmax_out=0.9342 discrete_mse=53.736980 best_discrete=14.056970 hash=False elapsed=73.4s
step   875/900 tau=0.0309 loss=0.396887 mse_soft=0.396707 ent_in=0.4670 ent_out=0.1331 rowmax_in=0.7622 rowmax_out=0.9253 discrete_mse=81.901855 best_discrete=14.056970 hash=False elapsed=75.5s
step   900/900 tau=0.0280 loss=0.487129 mse_soft=0.487004 ent_in=0.3387 ent_out=0.0790 rowmax_in=0.8031 rowmax_out=0.9431 discrete_mse=75.646896 best_discrete=14.056970 hash=False elapsed=77.6s

Final metrics:
  soft_mse_full=0.960830
  rowmax_in_mean=0.8132
  rowmax_out_mean=0.9445
  ent_in_mean=0.3282
  ent_out_mean=0.0774
  final_discrete_mse=54.038948
  hash_match=False
  best_discrete_mse_seen=14.056970
Saved results to overnight_b044_j2.json
