Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.088055 mse_soft=1.085732 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=53.606716 best_discrete=53.606716 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.878438 mse_soft=0.876249 ent_in=3.6329 ent_out=3.6639 rowmax_in=0.0451 rowmax_out=0.0446 discrete_mse=4343.164062 best_discrete=53.606716 hash=False elapsed=2.9s
step    50/900 tau=0.8229 loss=0.662787 mse_soft=0.660879 ent_in=3.1405 ent_out=3.2210 rowmax_in=0.0920 rowmax_out=0.0886 discrete_mse=958.824158 best_discrete=53.606716 hash=False elapsed=5.3s
step    75/900 tau=0.7450 loss=0.519516 mse_soft=0.517941 ent_in=2.6011 ent_out=2.6486 rowmax_in=0.2034 rowmax_out=0.2078 discrete_mse=109.811371 best_discrete=53.606716 hash=False elapsed=7.6s
step   100/900 tau=0.6745 loss=0.406100 mse_soft=0.404967 ent_in=1.9833 ent_out=1.7937 rowmax_in=0.3582 rowmax_out=0.4308 discrete_mse=154.911926 best_discrete=53.606716 hash=False elapsed=9.9s
step   125/900 tau=0.6107 loss=0.345402 mse_soft=0.344589 ent_in=1.5731 ent_out=1.1370 rowmax_in=0.4336 rowmax_out=0.6270 discrete_mse=314.632629 best_discrete=53.606716 hash=False elapsed=12.4s
step   150/900 tau=0.5529 loss=0.319797 mse_soft=0.319140 ent_in=1.3832 ent_out=0.8075 rowmax_in=0.4760 rowmax_out=0.7473 discrete_mse=145.043945 best_discrete=53.606716 hash=False elapsed=14.6s
step   175/900 tau=0.5006 loss=0.304046 mse_soft=0.303473 ent_in=1.2734 ent_out=0.6370 rowmax_in=0.4913 rowmax_out=0.7911 discrete_mse=326.874786 best_discrete=53.606716 hash=False elapsed=17.0s
step   200/900 tau=0.4532 loss=0.295870 mse_soft=0.295348 ent_in=1.2189 ent_out=0.5226 rowmax_in=0.5034 rowmax_out=0.8181 discrete_mse=72.252121 best_discrete=53.606716 hash=False elapsed=19.4s
step   225/900 tau=0.4103 loss=0.290091 mse_soft=0.289609 ent_in=1.1761 ent_out=0.4320 rowmax_in=0.5173 rowmax_out=0.8397 discrete_mse=258.249878 best_discrete=53.606716 hash=False elapsed=22.0s
step   250/900 tau=0.3715 loss=0.286372 mse_soft=0.285916 ent_in=1.1453 ent_out=0.3771 rowmax_in=0.5246 rowmax_out=0.8535 discrete_mse=183.236023 best_discrete=53.606716 hash=False elapsed=24.3s
step   275/900 tau=0.3363 loss=0.281302 mse_soft=0.280861 ent_in=1.1183 ent_out=0.3507 rowmax_in=0.5300 rowmax_out=0.8608 discrete_mse=953.556458 best_discrete=53.606716 hash=False elapsed=26.7s
step   300/900 tau=0.3045 loss=0.277413 mse_soft=0.276986 ent_in=1.0960 ent_out=0.3268 rowmax_in=0.5344 rowmax_out=0.8688 discrete_mse=593.153381 best_discrete=53.606716 hash=False elapsed=29.1s
step   325/900 tau=0.2756 loss=0.276138 mse_soft=0.275722 ent_in=1.0846 ent_out=0.3026 rowmax_in=0.5350 rowmax_out=0.8765 discrete_mse=372.846649 best_discrete=53.606716 hash=False elapsed=31.5s
step   350/900 tau=0.2496 loss=0.275927 mse_soft=0.275518 ent_in=1.0764 ent_out=0.2873 rowmax_in=0.5361 rowmax_out=0.8803 discrete_mse=593.153381 best_discrete=53.606716 hash=False elapsed=33.9s
step   375/900 tau=0.2259 loss=0.273483 mse_soft=0.273078 ent_in=1.0714 ent_out=0.2803 rowmax_in=0.5367 rowmax_out=0.8808 discrete_mse=495.501190 best_discrete=53.606716 hash=False elapsed=36.1s
step   400/900 tau=0.2046 loss=0.273457 mse_soft=0.273053 ent_in=1.0671 ent_out=0.2796 rowmax_in=0.5373 rowmax_out=0.8788 discrete_mse=658.411804 best_discrete=53.606716 hash=False elapsed=38.3s
step   425/900 tau=0.1852 loss=0.276333 mse_soft=0.275931 ent_in=1.0630 ent_out=0.2772 rowmax_in=0.5377 rowmax_out=0.8792 discrete_mse=495.501190 best_discrete=53.606716 hash=False elapsed=40.5s
step   450/900 tau=0.1677 loss=0.275182 mse_soft=0.274780 ent_in=1.0620 ent_out=0.2782 rowmax_in=0.5376 rowmax_out=0.8771 discrete_mse=624.866699 best_discrete=53.606716 hash=False elapsed=42.6s
step   475/900 tau=0.1518 loss=0.280384 mse_soft=0.279983 ent_in=1.0576 ent_out=0.2784 rowmax_in=0.5401 rowmax_out=0.8742 discrete_mse=658.411804 best_discrete=53.606716 hash=False elapsed=45.0s
step   500/900 tau=0.1374 loss=0.278260 mse_soft=0.277862 ent_in=1.0525 ent_out=0.2754 rowmax_in=0.5401 rowmax_out=0.8747 discrete_mse=719.017761 best_discrete=53.606716 hash=False elapsed=47.3s
step   525/900 tau=0.1244 loss=0.275908 mse_soft=0.275513 ent_in=1.0453 ent_out=0.2708 rowmax_in=0.5443 rowmax_out=0.8743 discrete_mse=719.017761 best_discrete=53.606716 hash=False elapsed=49.8s
step   550/900 tau=0.1126 loss=0.278563 mse_soft=0.278178 ent_in=1.0274 ent_out=0.2559 rowmax_in=0.5432 rowmax_out=0.8794 discrete_mse=318.099701 best_discrete=53.606716 hash=False elapsed=52.2s
step   575/900 tau=0.1020 loss=0.288372 mse_soft=0.287994 ent_in=1.0088 ent_out=0.2518 rowmax_in=0.5500 rowmax_out=0.8795 discrete_mse=1265.502197 best_discrete=53.606716 hash=False elapsed=54.6s
step   600/900 tau=0.0923 loss=0.280579 mse_soft=0.280203 ent_in=0.9991 ent_out=0.2533 rowmax_in=0.5523 rowmax_out=0.8795 discrete_mse=184.513474 best_discrete=53.606716 hash=False elapsed=57.0s
step   625/900 tau=0.0836 loss=0.283334 mse_soft=0.282962 ent_in=0.9887 ent_out=0.2500 rowmax_in=0.5598 rowmax_out=0.8800 discrete_mse=339.261780 best_discrete=53.606716 hash=False elapsed=59.3s
step   650/900 tau=0.0757 loss=0.286233 mse_soft=0.285861 ent_in=0.9908 ent_out=0.2499 rowmax_in=0.5468 rowmax_out=0.8786 discrete_mse=184.555466 best_discrete=53.606716 hash=False elapsed=61.6s
step   675/900 tau=0.0685 loss=0.381883 mse_soft=0.381592 ent_in=0.7641 ent_out=0.2036 rowmax_in=0.6429 rowmax_out=0.8987 discrete_mse=24.518522 best_discrete=24.518522 hash=False elapsed=63.7s
step   700/900 tau=0.0620 loss=0.330345 mse_soft=0.330063 ent_in=0.7131 ent_out=0.2247 rowmax_in=0.6629 rowmax_out=0.8893 discrete_mse=33.289013 best_discrete=24.518522 hash=False elapsed=65.9s
step   725/900 tau=0.0562 loss=0.321970 mse_soft=0.321689 ent_in=0.7197 ent_out=0.2161 rowmax_in=0.6513 rowmax_out=0.8952 discrete_mse=15.880943 best_discrete=15.880943 hash=False elapsed=68.0s
step   750/900 tau=0.0508 loss=0.321403 mse_soft=0.321125 ent_in=0.7140 ent_out=0.2131 rowmax_in=0.6566 rowmax_out=0.8966 discrete_mse=22.314468 best_discrete=15.880943 hash=False elapsed=70.0s
step   775/900 tau=0.0460 loss=0.479755 mse_soft=0.479531 ent_in=0.5680 ent_out=0.1806 rowmax_in=0.7426 rowmax_out=0.9058 discrete_mse=17.634405 best_discrete=15.880943 hash=False elapsed=72.1s
step   800/900 tau=0.0417 loss=1.489969 mse_soft=1.489813 ent_in=0.3406 ent_out=0.1773 rowmax_in=0.8596 rowmax_out=0.9082 discrete_mse=64.350563 best_discrete=15.880943 hash=False elapsed=74.3s
step   825/900 tau=0.0377 loss=0.432111 mse_soft=0.431973 ent_in=0.2916 ent_out=0.1703 rowmax_in=0.8569 rowmax_out=0.9088 discrete_mse=26.024836 best_discrete=15.880943 hash=False elapsed=76.5s
step   850/900 tau=0.0342 loss=0.410109 mse_soft=0.409963 ent_in=0.3257 ent_out=0.1587 rowmax_in=0.8406 rowmax_out=0.9130 discrete_mse=13.970836 best_discrete=13.970836 hash=False elapsed=79.0s
step   875/900 tau=0.0309 loss=0.401724 mse_soft=0.401576 ent_in=0.3331 ent_out=0.1596 rowmax_in=0.8315 rowmax_out=0.9116 discrete_mse=13.970836 best_discrete=13.970836 hash=False elapsed=81.6s
step   900/900 tau=0.0280 loss=0.397663 mse_soft=0.397514 ent_in=0.3436 ent_out=0.1540 rowmax_in=0.8348 rowmax_out=0.9171 discrete_mse=7.283141 best_discrete=7.283141 hash=False elapsed=84.0s

Final metrics:
  soft_mse_full=0.401202
  rowmax_in_mean=0.8345
  rowmax_out_mean=0.9175
  ent_in_mean=0.3423
  ent_out_mean=0.1534
  final_discrete_mse=7.283141
  hash_match=False
  best_discrete_mse_seen=7.283141
Saved results to overnight_b170_j2.json
