Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.061082 mse_soft=1.058759 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=23.903172 best_discrete=23.903172 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.861790 mse_soft=0.859601 ent_in=3.6310 ent_out=3.6672 rowmax_in=0.0462 rowmax_out=0.0442 discrete_mse=2455.630127 best_discrete=23.903172 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.651031 mse_soft=0.649127 ent_in=3.1266 ent_out=3.2183 rowmax_in=0.0921 rowmax_out=0.0893 discrete_mse=996.533752 best_discrete=23.903172 hash=False elapsed=5.1s
step    75/900 tau=0.7450 loss=0.517476 mse_soft=0.515893 ent_in=2.6120 ent_out=2.6659 rowmax_in=0.1981 rowmax_out=0.1971 discrete_mse=132.851120 best_discrete=23.903172 hash=False elapsed=7.6s
step   100/900 tau=0.6745 loss=0.400699 mse_soft=0.399544 ent_in=1.9945 ent_out=1.8539 rowmax_in=0.3519 rowmax_out=0.3946 discrete_mse=112.737549 best_discrete=23.903172 hash=False elapsed=9.9s
step   125/900 tau=0.6107 loss=0.339242 mse_soft=0.338396 ent_in=1.5505 ent_out=1.2686 rowmax_in=0.4568 rowmax_out=0.5482 discrete_mse=217.357941 best_discrete=23.903172 hash=False elapsed=12.2s
step   150/900 tau=0.5529 loss=0.307195 mse_soft=0.306515 ent_in=1.3581 ent_out=0.9104 rowmax_in=0.5089 rowmax_out=0.6655 discrete_mse=324.660583 best_discrete=23.903172 hash=False elapsed=14.4s
step   175/900 tau=0.5006 loss=0.291654 mse_soft=0.291053 ent_in=1.2672 ent_out=0.7378 rowmax_in=0.5246 rowmax_out=0.7051 discrete_mse=207.535614 best_discrete=23.903172 hash=False elapsed=16.5s
step   200/900 tau=0.4532 loss=0.283511 mse_soft=0.282953 ent_in=1.2166 ent_out=0.6442 rowmax_in=0.5251 rowmax_out=0.7331 discrete_mse=329.747498 best_discrete=23.903172 hash=False elapsed=18.7s
step   225/900 tau=0.4103 loss=0.275927 mse_soft=0.275404 ent_in=1.1876 ent_out=0.5545 rowmax_in=0.5286 rowmax_out=0.7722 discrete_mse=367.893646 best_discrete=23.903172 hash=False elapsed=21.1s
step   250/900 tau=0.3715 loss=0.271528 mse_soft=0.271032 ent_in=1.1547 ent_out=0.4992 rowmax_in=0.5365 rowmax_out=0.7925 discrete_mse=605.809814 best_discrete=23.903172 hash=False elapsed=23.4s
step   275/900 tau=0.3363 loss=0.268523 mse_soft=0.268044 ent_in=1.1298 ent_out=0.4650 rowmax_in=0.5408 rowmax_out=0.8060 discrete_mse=581.472656 best_discrete=23.903172 hash=False elapsed=25.7s
step   300/900 tau=0.3045 loss=0.266138 mse_soft=0.265670 ent_in=1.1116 ent_out=0.4504 rowmax_in=0.5445 rowmax_out=0.8098 discrete_mse=415.320465 best_discrete=23.903172 hash=False elapsed=28.0s
step   325/900 tau=0.2756 loss=0.265544 mse_soft=0.265085 ent_in=1.0915 ent_out=0.4415 rowmax_in=0.5499 rowmax_out=0.8089 discrete_mse=355.373169 best_discrete=23.903172 hash=False elapsed=30.3s
step   350/900 tau=0.2496 loss=0.264588 mse_soft=0.264138 ent_in=1.0718 ent_out=0.4294 rowmax_in=0.5541 rowmax_out=0.8089 discrete_mse=151.136475 best_discrete=23.903172 hash=False elapsed=32.6s
step   375/900 tau=0.2259 loss=0.263536 mse_soft=0.263091 ent_in=1.0609 ent_out=0.4224 rowmax_in=0.5555 rowmax_out=0.8108 discrete_mse=383.575714 best_discrete=23.903172 hash=False elapsed=34.8s
step   400/900 tau=0.2046 loss=0.259740 mse_soft=0.259302 ent_in=1.0432 ent_out=0.4157 rowmax_in=0.5593 rowmax_out=0.8114 discrete_mse=319.090729 best_discrete=23.903172 hash=False elapsed=37.2s
step   425/900 tau=0.1852 loss=0.260422 mse_soft=0.259991 ent_in=1.0271 ent_out=0.4086 rowmax_in=0.5636 rowmax_out=0.8134 discrete_mse=355.373169 best_discrete=23.903172 hash=False elapsed=39.7s
step   450/900 tau=0.1677 loss=0.262633 mse_soft=0.262205 ent_in=1.0198 ent_out=0.4075 rowmax_in=0.5650 rowmax_out=0.8130 discrete_mse=355.373169 best_discrete=23.903172 hash=False elapsed=41.8s
step   475/900 tau=0.1518 loss=0.259706 mse_soft=0.259280 ent_in=1.0164 ent_out=0.4057 rowmax_in=0.5648 rowmax_out=0.8131 discrete_mse=355.373169 best_discrete=23.903172 hash=False elapsed=44.2s
step   500/900 tau=0.1374 loss=0.262623 mse_soft=0.262198 ent_in=1.0112 ent_out=0.4030 rowmax_in=0.5673 rowmax_out=0.8125 discrete_mse=515.341064 best_discrete=23.903172 hash=False elapsed=46.7s
step   525/900 tau=0.1244 loss=0.260124 mse_soft=0.259704 ent_in=1.0017 ent_out=0.3990 rowmax_in=0.5693 rowmax_out=0.8130 discrete_mse=274.850403 best_discrete=23.903172 hash=False elapsed=48.9s
step   550/900 tau=0.1126 loss=0.265809 mse_soft=0.265392 ent_in=0.9939 ent_out=0.3976 rowmax_in=0.5712 rowmax_out=0.8114 discrete_mse=220.302475 best_discrete=23.903172 hash=False elapsed=51.3s
step   575/900 tau=0.1020 loss=0.293786 mse_soft=0.293378 ent_in=0.9681 ent_out=0.3929 rowmax_in=0.5862 rowmax_out=0.8116 discrete_mse=220.302475 best_discrete=23.903172 hash=False elapsed=53.6s
step   600/900 tau=0.0923 loss=0.262499 mse_soft=0.262095 ent_in=0.9625 ent_out=0.3833 rowmax_in=0.5833 rowmax_out=0.8181 discrete_mse=274.850403 best_discrete=23.903172 hash=False elapsed=56.1s
step   625/900 tau=0.0836 loss=0.271678 mse_soft=0.271290 ent_in=0.9152 ent_out=0.3757 rowmax_in=0.5931 rowmax_out=0.8220 discrete_mse=101.056686 best_discrete=23.903172 hash=False elapsed=58.5s
step   650/900 tau=0.0757 loss=0.296914 mse_soft=0.296547 ent_in=0.8613 ent_out=0.3629 rowmax_in=0.6274 rowmax_out=0.8215 discrete_mse=47.589466 best_discrete=23.903172 hash=False elapsed=60.8s
step   675/900 tau=0.0685 loss=0.269593 mse_soft=0.269223 ent_in=0.8725 ent_out=0.3596 rowmax_in=0.6126 rowmax_out=0.8233 discrete_mse=140.595703 best_discrete=23.903172 hash=False elapsed=63.2s
step   700/900 tau=0.0620 loss=0.308559 mse_soft=0.308205 ent_in=0.8633 ent_out=0.3167 rowmax_in=0.6135 rowmax_out=0.8474 discrete_mse=76.304741 best_discrete=23.903172 hash=False elapsed=65.5s
step   725/900 tau=0.0562 loss=0.471977 mse_soft=0.471764 ent_in=0.4719 ent_out=0.2406 rowmax_in=0.7918 rowmax_out=0.8952 discrete_mse=12.828529 best_discrete=12.828529 hash=False elapsed=67.9s
step   750/900 tau=0.0508 loss=0.470037 mse_soft=0.469850 ent_in=0.3687 ent_out=0.2557 rowmax_in=0.8374 rowmax_out=0.8592 discrete_mse=3.235488 best_discrete=3.235488 hash=False elapsed=70.1s
step   775/900 tau=0.0460 loss=0.410736 mse_soft=0.410561 ent_in=0.3728 ent_out=0.2121 rowmax_in=0.8244 rowmax_out=0.8905 discrete_mse=2.797472 best_discrete=2.797472 hash=False elapsed=72.4s
step   800/900 tau=0.0417 loss=0.387379 mse_soft=0.387193 ent_in=0.4104 ent_out=0.2127 rowmax_in=0.7956 rowmax_out=0.8872 discrete_mse=24.403852 best_discrete=2.797472 hash=False elapsed=74.7s
step   825/900 tau=0.0377 loss=0.421310 mse_soft=0.421128 ent_in=0.3959 ent_out=0.2113 rowmax_in=0.8150 rowmax_out=0.8882 discrete_mse=48.935497 best_discrete=2.797472 hash=False elapsed=76.7s
step   850/900 tau=0.0342 loss=0.409857 mse_soft=0.409701 ent_in=0.3563 ent_out=0.1621 rowmax_in=0.8294 rowmax_out=0.9145 discrete_mse=0.937611 best_discrete=0.937611 hash=False elapsed=78.8s
step   875/900 tau=0.0309 loss=0.392800 mse_soft=0.392649 ent_in=0.3398 ent_out=0.1641 rowmax_in=0.8278 rowmax_out=0.9117 discrete_mse=45.548725 best_discrete=0.937611 hash=False elapsed=81.0s
step   900/900 tau=0.0280 loss=0.388964 mse_soft=0.388810 ent_in=0.3522 ent_out=0.1603 rowmax_in=0.8231 rowmax_out=0.9144 discrete_mse=52.714512 best_discrete=0.937611 hash=False elapsed=83.1s

Final metrics:
  soft_mse_full=0.397714
  rowmax_in_mean=0.8212
  rowmax_out_mean=0.9145
  ent_in_mean=0.3537
  ent_out_mean=0.1602
  final_discrete_mse=52.714512
  hash_match=False
  best_discrete_mse_seen=0.937611
Saved results to overnight_b166_j2.json
