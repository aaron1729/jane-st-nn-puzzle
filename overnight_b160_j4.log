Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.015
step     1/700 tau=1.0000 loss=1.064187 mse_soft=1.063413 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=92.580772 best_discrete=92.580772 hash=False elapsed=0.5s
step    25/700 tau=0.8810 loss=0.972031 mse_soft=0.971271 ent_in=3.7932 ent_out=3.8055 rowmax_in=0.0330 rowmax_out=0.0323 discrete_mse=3641.409424 best_discrete=92.580772 hash=False elapsed=2.8s
step    50/700 tau=0.7721 loss=0.786001 mse_soft=0.785293 ent_in=3.5152 ent_out=3.5673 rowmax_in=0.0560 rowmax_out=0.0545 discrete_mse=7268.056641 best_discrete=92.580772 hash=False elapsed=5.1s
step    75/700 tau=0.6767 loss=0.643822 mse_soft=0.643185 ent_in=3.1342 ent_out=3.2358 rowmax_in=0.0951 rowmax_out=0.0907 discrete_mse=6698.836426 best_discrete=92.580772 hash=False elapsed=7.4s
step   100/700 tau=0.5931 loss=0.532171 mse_soft=0.531616 ent_in=2.7264 ent_out=2.8297 rowmax_in=0.1801 rowmax_out=0.1686 discrete_mse=1078.260986 best_discrete=92.580772 hash=False elapsed=9.7s
step   125/700 tau=0.5198 loss=0.434305 mse_soft=0.433866 ent_in=2.2095 ent_out=2.1766 rowmax_in=0.2975 rowmax_out=0.3080 discrete_mse=9994.606445 best_discrete=92.580772 hash=False elapsed=12.1s
step   150/700 tau=0.4555 loss=0.367690 mse_soft=0.367360 ent_in=1.7716 ent_out=1.5257 rowmax_in=0.4066 rowmax_out=0.4864 discrete_mse=1455.556885 best_discrete=92.580772 hash=False elapsed=14.2s
step   175/700 tau=0.3992 loss=0.335073 mse_soft=0.334808 ent_in=1.5197 ent_out=1.1266 rowmax_in=0.4578 rowmax_out=0.5874 discrete_mse=349.296326 best_discrete=92.580772 hash=False elapsed=16.8s
step   200/700 tau=0.3499 loss=0.317292 mse_soft=0.317067 ent_in=1.3755 ent_out=0.8771 rowmax_in=0.4845 rowmax_out=0.6438 discrete_mse=1123.901733 best_discrete=92.580772 hash=False elapsed=18.9s
step   225/700 tau=0.3066 loss=0.302835 mse_soft=0.302640 ent_in=1.2613 ent_out=0.6863 rowmax_in=0.5087 rowmax_out=0.7089 discrete_mse=343.972351 best_discrete=92.580772 hash=False elapsed=21.0s
step   250/700 tau=0.2687 loss=0.296860 mse_soft=0.296681 ent_in=1.1952 ent_out=0.5942 rowmax_in=0.5157 rowmax_out=0.7310 discrete_mse=408.044983 best_discrete=92.580772 hash=False elapsed=23.2s
step   275/700 tau=0.2355 loss=0.292911 mse_soft=0.292741 ent_in=1.1589 ent_out=0.5414 rowmax_in=0.5212 rowmax_out=0.7470 discrete_mse=915.703491 best_discrete=92.580772 hash=False elapsed=25.4s
step   300/700 tau=0.2064 loss=0.292785 mse_soft=0.292621 ent_in=1.1225 ent_out=0.5130 rowmax_in=0.5287 rowmax_out=0.7557 discrete_mse=915.703491 best_discrete=92.580772 hash=False elapsed=27.7s
step   325/700 tau=0.1809 loss=0.289596 mse_soft=0.289436 ent_in=1.1020 ent_out=0.5015 rowmax_in=0.5331 rowmax_out=0.7581 discrete_mse=2194.238037 best_discrete=92.580772 hash=False elapsed=30.0s
step   350/700 tau=0.1585 loss=0.288683 mse_soft=0.288526 ent_in=1.0842 ent_out=0.4834 rowmax_in=0.5347 rowmax_out=0.7625 discrete_mse=2194.238037 best_discrete=92.580772 hash=False elapsed=32.2s
step   375/700 tau=0.1389 loss=0.287638 mse_soft=0.287484 ent_in=1.0730 ent_out=0.4665 rowmax_in=0.5357 rowmax_out=0.7693 discrete_mse=1661.903198 best_discrete=92.580772 hash=False elapsed=34.4s
step   400/700 tau=0.1218 loss=0.290947 mse_soft=0.290795 ent_in=1.0631 ent_out=0.4567 rowmax_in=0.5374 rowmax_out=0.7739 discrete_mse=1661.903198 best_discrete=92.580772 hash=False elapsed=36.6s
step   425/700 tau=0.1067 loss=0.291252 mse_soft=0.291100 ent_in=1.0619 ent_out=0.4540 rowmax_in=0.5367 rowmax_out=0.7748 discrete_mse=1693.847168 best_discrete=92.580772 hash=False elapsed=38.9s
step   450/700 tau=0.0935 loss=0.294096 mse_soft=0.293946 ent_in=1.0520 ent_out=0.4517 rowmax_in=0.5400 rowmax_out=0.7753 discrete_mse=1527.509521 best_discrete=92.580772 hash=False elapsed=41.1s
step   475/700 tau=0.0820 loss=0.292910 mse_soft=0.292760 ent_in=1.0534 ent_out=0.4492 rowmax_in=0.5404 rowmax_out=0.7730 discrete_mse=2173.092773 best_discrete=92.580772 hash=False elapsed=43.5s
step   500/700 tau=0.0718 loss=0.288670 mse_soft=0.288521 ent_in=1.0419 ent_out=0.4405 rowmax_in=0.5424 rowmax_out=0.7754 discrete_mse=3974.500244 best_discrete=92.580772 hash=False elapsed=46.1s
step   525/700 tau=0.0630 loss=0.290275 mse_soft=0.290129 ent_in=1.0312 ent_out=0.4354 rowmax_in=0.5458 rowmax_out=0.7751 discrete_mse=3499.159180 best_discrete=92.580772 hash=False elapsed=48.4s
step   550/700 tau=0.0552 loss=0.304742 mse_soft=0.304596 ent_in=1.0224 ent_out=0.4387 rowmax_in=0.5486 rowmax_out=0.7707 discrete_mse=988.438965 best_discrete=92.580772 hash=False elapsed=50.8s
step   575/700 tau=0.0484 loss=0.343183 mse_soft=0.343044 ent_in=0.9712 ent_out=0.4232 rowmax_in=0.5662 rowmax_out=0.7829 discrete_mse=253.817017 best_discrete=92.580772 hash=False elapsed=53.3s
step   600/700 tau=0.0424 loss=0.296355 mse_soft=0.296217 ent_in=0.9555 ent_out=0.4288 rowmax_in=0.5694 rowmax_out=0.7648 discrete_mse=689.864624 best_discrete=92.580772 hash=False elapsed=55.6s
step   625/700 tau=0.0371 loss=0.294777 mse_soft=0.294639 ent_in=0.9461 ent_out=0.4336 rowmax_in=0.5725 rowmax_out=0.7633 discrete_mse=549.711487 best_discrete=92.580772 hash=False elapsed=57.9s
step   650/700 tau=0.0325 loss=0.302272 mse_soft=0.302135 ent_in=0.9360 ent_out=0.4333 rowmax_in=0.5758 rowmax_out=0.7635 discrete_mse=589.831421 best_discrete=92.580772 hash=False elapsed=60.3s
step   675/700 tau=0.0285 loss=0.368947 mse_soft=0.368846 ent_in=0.7256 ent_out=0.2916 rowmax_in=0.6414 rowmax_out=0.8702 discrete_mse=183.174713 best_discrete=92.580772 hash=False elapsed=62.5s
step   700/700 tau=0.0250 loss=0.372759 mse_soft=0.372673 ent_in=0.6116 ent_out=0.2463 rowmax_in=0.6885 rowmax_out=0.8904 discrete_mse=256.523499 best_discrete=92.580772 hash=False elapsed=64.7s

Final metrics:
  soft_mse_full=0.370012
  rowmax_in_mean=0.6802
  rowmax_out_mean=0.8866
  ent_in_mean=0.6198
  ent_out_mean=0.2477
  final_discrete_mse=128.831573
  hash_match=False
  best_discrete_mse_seen=92.580772
Saved results to overnight_b160_j4.json
