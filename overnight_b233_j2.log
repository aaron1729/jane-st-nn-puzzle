Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.062413 mse_soft=1.060091 ent_in=3.8712 ent_out=3.8711 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=28.599693 best_discrete=28.599693 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.857349 mse_soft=0.855160 ent_in=3.6306 ent_out=3.6657 rowmax_in=0.0463 rowmax_out=0.0440 discrete_mse=1709.505005 best_discrete=28.599693 hash=False elapsed=2.9s
step    50/900 tau=0.8229 loss=0.645068 mse_soft=0.643162 ent_in=3.1260 ent_out=3.2279 rowmax_in=0.0943 rowmax_out=0.0866 discrete_mse=6828.575195 best_discrete=28.599693 hash=False elapsed=5.2s
step    75/900 tau=0.7450 loss=0.507557 mse_soft=0.505972 ent_in=2.6010 ent_out=2.6840 rowmax_in=0.2038 rowmax_out=0.1976 discrete_mse=312.802399 best_discrete=28.599693 hash=False elapsed=7.5s
step   100/900 tau=0.6745 loss=0.407529 mse_soft=0.406343 ent_in=2.0233 ent_out=1.9298 rowmax_in=0.3578 rowmax_out=0.3997 discrete_mse=328.186005 best_discrete=28.599693 hash=False elapsed=9.8s
step   125/900 tau=0.6107 loss=0.338780 mse_soft=0.337951 ent_in=1.5836 ent_out=1.1802 rowmax_in=0.4596 rowmax_out=0.6195 discrete_mse=106.219200 best_discrete=28.599693 hash=False elapsed=12.1s
step   150/900 tau=0.5529 loss=0.304669 mse_soft=0.304028 ent_in=1.3637 ent_out=0.7720 rowmax_in=0.4978 rowmax_out=0.7281 discrete_mse=158.624969 best_discrete=28.599693 hash=False elapsed=14.3s
step   175/900 tau=0.5006 loss=0.284598 mse_soft=0.284047 ent_in=1.2119 ent_out=0.6260 rowmax_in=0.5341 rowmax_out=0.7562 discrete_mse=137.305435 best_discrete=28.599693 hash=False elapsed=16.4s
step   200/900 tau=0.4532 loss=0.274975 mse_soft=0.274463 ent_in=1.1342 ent_out=0.5717 rowmax_in=0.5495 rowmax_out=0.7633 discrete_mse=91.232796 best_discrete=28.599693 hash=False elapsed=18.6s
step   225/900 tau=0.4103 loss=0.270797 mse_soft=0.270312 ent_in=1.0802 ent_out=0.5386 rowmax_in=0.5600 rowmax_out=0.7690 discrete_mse=30.157148 best_discrete=28.599693 hash=False elapsed=21.0s
step   250/900 tau=0.3715 loss=0.269511 mse_soft=0.269040 ent_in=1.0505 ent_out=0.5167 rowmax_in=0.5646 rowmax_out=0.7690 discrete_mse=30.157148 best_discrete=28.599693 hash=False elapsed=23.4s
step   275/900 tau=0.3363 loss=0.266601 mse_soft=0.266139 ent_in=1.0348 ent_out=0.5042 rowmax_in=0.5652 rowmax_out=0.7725 discrete_mse=30.157148 best_discrete=28.599693 hash=False elapsed=25.8s
step   300/900 tau=0.3045 loss=0.264875 mse_soft=0.264417 ent_in=1.0263 ent_out=0.4979 rowmax_in=0.5652 rowmax_out=0.7752 discrete_mse=58.350613 best_discrete=28.599693 hash=False elapsed=28.1s
step   325/900 tau=0.2756 loss=0.263664 mse_soft=0.263211 ent_in=1.0182 ent_out=0.4888 rowmax_in=0.5651 rowmax_out=0.7787 discrete_mse=58.350613 best_discrete=28.599693 hash=False elapsed=30.3s
step   350/900 tau=0.2496 loss=0.264536 mse_soft=0.264089 ent_in=1.0108 ent_out=0.4807 rowmax_in=0.5659 rowmax_out=0.7801 discrete_mse=58.350613 best_discrete=28.599693 hash=False elapsed=32.6s
step   375/900 tau=0.2259 loss=0.263048 mse_soft=0.262604 ent_in=1.0064 ent_out=0.4758 rowmax_in=0.5678 rowmax_out=0.7806 discrete_mse=58.350613 best_discrete=28.599693 hash=False elapsed=34.9s
step   400/900 tau=0.2046 loss=0.264146 mse_soft=0.263704 ent_in=1.0004 ent_out=0.4725 rowmax_in=0.5702 rowmax_out=0.7798 discrete_mse=80.465958 best_discrete=28.599693 hash=False elapsed=37.2s
step   425/900 tau=0.1852 loss=0.263996 mse_soft=0.263555 ent_in=1.0001 ent_out=0.4697 rowmax_in=0.5680 rowmax_out=0.7782 discrete_mse=58.350613 best_discrete=28.599693 hash=False elapsed=39.4s
step   450/900 tau=0.1677 loss=0.264754 mse_soft=0.264314 ent_in=0.9994 ent_out=0.4652 rowmax_in=0.5688 rowmax_out=0.7784 discrete_mse=80.465958 best_discrete=28.599693 hash=False elapsed=41.8s
step   475/900 tau=0.1518 loss=0.262781 mse_soft=0.262345 ent_in=0.9936 ent_out=0.4600 rowmax_in=0.5697 rowmax_out=0.7807 discrete_mse=80.465958 best_discrete=28.599693 hash=False elapsed=44.2s
step   500/900 tau=0.1374 loss=0.267593 mse_soft=0.267167 ent_in=0.9694 ent_out=0.4486 rowmax_in=0.5770 rowmax_out=0.7824 discrete_mse=124.593124 best_discrete=28.599693 hash=False elapsed=46.4s
step   525/900 tau=0.1244 loss=0.265675 mse_soft=0.265249 ent_in=0.9711 ent_out=0.4497 rowmax_in=0.5702 rowmax_out=0.7860 discrete_mse=255.703888 best_discrete=28.599693 hash=False elapsed=48.6s
step   550/900 tau=0.1126 loss=0.306916 mse_soft=0.306493 ent_in=0.9667 ent_out=0.4433 rowmax_in=0.5766 rowmax_out=0.7835 discrete_mse=182.932495 best_discrete=28.599693 hash=False elapsed=50.8s
step   575/900 tau=0.1020 loss=0.268915 mse_soft=0.268506 ent_in=0.9340 ent_out=0.4269 rowmax_in=0.5809 rowmax_out=0.7834 discrete_mse=53.061035 best_discrete=28.599693 hash=False elapsed=52.9s
step   600/900 tau=0.0923 loss=0.267114 mse_soft=0.266709 ent_in=0.9297 ent_out=0.4215 rowmax_in=0.5806 rowmax_out=0.7944 discrete_mse=153.271027 best_discrete=28.599693 hash=False elapsed=55.1s
step   625/900 tau=0.0836 loss=0.267330 mse_soft=0.266924 ent_in=0.9373 ent_out=0.4158 rowmax_in=0.5778 rowmax_out=0.7985 discrete_mse=150.580826 best_discrete=28.599693 hash=False elapsed=57.7s
step   650/900 tau=0.0757 loss=0.270032 mse_soft=0.269639 ent_in=0.9045 ent_out=0.4044 rowmax_in=0.5970 rowmax_out=0.7978 discrete_mse=65.321106 best_discrete=28.599693 hash=False elapsed=60.1s
step   675/900 tau=0.0685 loss=0.275512 mse_soft=0.275138 ent_in=0.8839 ent_out=0.3617 rowmax_in=0.5899 rowmax_out=0.8120 discrete_mse=30.029160 best_discrete=28.599693 hash=False elapsed=62.4s
step   700/900 tau=0.0620 loss=0.269183 mse_soft=0.268799 ent_in=0.9063 ent_out=0.3749 rowmax_in=0.5868 rowmax_out=0.8060 discrete_mse=28.758417 best_discrete=28.599693 hash=False elapsed=64.8s
step   725/900 tau=0.0562 loss=0.299755 mse_soft=0.299415 ent_in=0.8103 ent_out=0.3205 rowmax_in=0.6332 rowmax_out=0.8336 discrete_mse=62.900219 best_discrete=28.599693 hash=False elapsed=67.4s
step   750/900 tau=0.0508 loss=0.291902 mse_soft=0.291583 ent_in=0.7731 ent_out=0.2909 rowmax_in=0.6273 rowmax_out=0.8380 discrete_mse=80.856796 best_discrete=28.599693 hash=False elapsed=69.8s
step   775/900 tau=0.0460 loss=0.428115 mse_soft=0.427908 ent_in=0.5310 ent_out=0.1589 rowmax_in=0.7427 rowmax_out=0.9216 discrete_mse=15.550175 best_discrete=15.550175 hash=False elapsed=72.1s
step   800/900 tau=0.0417 loss=0.363874 mse_soft=0.363686 ent_in=0.5178 ent_out=0.1112 rowmax_in=0.7410 rowmax_out=0.9412 discrete_mse=4.545875 best_discrete=4.545875 hash=False elapsed=74.5s
step   825/900 tau=0.0377 loss=0.350494 mse_soft=0.350307 ent_in=0.5178 ent_out=0.1071 rowmax_in=0.7375 rowmax_out=0.9388 discrete_mse=0.785417 best_discrete=0.785417 hash=False elapsed=76.9s
step   850/900 tau=0.0342 loss=0.349199 mse_soft=0.349018 ent_in=0.4976 ent_out=0.1059 rowmax_in=0.7486 rowmax_out=0.9355 discrete_mse=1.611186 best_discrete=0.785417 hash=False elapsed=79.3s
step   875/900 tau=0.0309 loss=0.348082 mse_soft=0.347904 ent_in=0.4889 ent_out=0.1051 rowmax_in=0.7444 rowmax_out=0.9362 discrete_mse=1.729210 best_discrete=0.785417 hash=False elapsed=81.7s
step   900/900 tau=0.0280 loss=0.391692 mse_soft=0.391537 ent_in=0.4151 ent_out=0.0988 rowmax_in=0.7910 rowmax_out=0.9397 discrete_mse=1.169397 best_discrete=0.785417 hash=False elapsed=84.1s

Final metrics:
  soft_mse_full=0.378829
  rowmax_in_mean=0.7810
  rowmax_out_mean=0.9399
  ent_in_mean=0.4262
  ent_out_mean=0.0983
  final_discrete_mse=1.169397
  hash_match=False
  best_discrete_mse_seen=0.785417
Saved results to overnight_b233_j2.json
