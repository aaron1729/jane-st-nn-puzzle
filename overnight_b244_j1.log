Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.067967 mse_soft=1.065645 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=21.652916 best_discrete=21.652916 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.864475 mse_soft=0.862285 ent_in=3.6327 ent_out=3.6671 rowmax_in=0.0456 rowmax_out=0.0437 discrete_mse=2363.124023 best_discrete=21.652916 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.655443 mse_soft=0.653537 ent_in=3.1273 ent_out=3.2251 rowmax_in=0.0920 rowmax_out=0.0861 discrete_mse=10615.608398 best_discrete=21.652916 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.517258 mse_soft=0.515677 ent_in=2.5816 ent_out=2.6886 rowmax_in=0.2078 rowmax_out=0.1938 discrete_mse=1186.385132 best_discrete=21.652916 hash=False elapsed=7.4s
step   100/900 tau=0.6797 loss=0.417382 mse_soft=0.416214 ent_in=1.9946 ent_out=1.8994 rowmax_in=0.3453 rowmax_out=0.3962 discrete_mse=381.792328 best_discrete=21.652916 hash=False elapsed=9.8s
step   125/900 tau=0.6165 loss=0.353543 mse_soft=0.352680 ent_in=1.6080 ent_out=1.2682 rowmax_in=0.4391 rowmax_out=0.5746 discrete_mse=4927.918457 best_discrete=21.652916 hash=False elapsed=12.2s
step   150/900 tau=0.5592 loss=0.318734 mse_soft=0.318076 ent_in=1.3805 ent_out=0.8110 rowmax_in=0.4784 rowmax_out=0.7270 discrete_mse=322.693634 best_discrete=21.652916 hash=False elapsed=14.6s
step   175/900 tau=0.5073 loss=0.301037 mse_soft=0.300478 ent_in=1.2674 ent_out=0.5963 rowmax_in=0.4989 rowmax_out=0.7913 discrete_mse=190.475052 best_discrete=21.652916 hash=False elapsed=16.9s
step   200/900 tau=0.4602 loss=0.291632 mse_soft=0.291132 ent_in=1.1818 ent_out=0.4848 rowmax_in=0.5153 rowmax_out=0.8278 discrete_mse=343.978149 best_discrete=21.652916 hash=False elapsed=19.2s
step   225/900 tau=0.4174 loss=0.284358 mse_soft=0.283899 ent_in=1.1385 ent_out=0.3895 rowmax_in=0.5183 rowmax_out=0.8660 discrete_mse=1439.761963 best_discrete=21.652916 hash=False elapsed=21.6s
step   250/900 tau=0.3786 loss=0.278789 mse_soft=0.278356 ent_in=1.1076 ent_out=0.3352 rowmax_in=0.5235 rowmax_out=0.8782 discrete_mse=167.707901 best_discrete=21.652916 hash=False elapsed=23.9s
step   275/900 tau=0.3434 loss=0.275688 mse_soft=0.275272 ent_in=1.0920 ent_out=0.2952 rowmax_in=0.5248 rowmax_out=0.8906 discrete_mse=168.336380 best_discrete=21.652916 hash=False elapsed=26.2s
step   300/900 tau=0.3115 loss=0.273543 mse_soft=0.273134 ent_in=1.0883 ent_out=0.2740 rowmax_in=0.5215 rowmax_out=0.8965 discrete_mse=421.353180 best_discrete=21.652916 hash=False elapsed=28.6s
step   325/900 tau=0.2826 loss=0.272672 mse_soft=0.272268 ent_in=1.0838 ent_out=0.2637 rowmax_in=0.5215 rowmax_out=0.8985 discrete_mse=421.353180 best_discrete=21.652916 hash=False elapsed=31.0s
step   350/900 tau=0.2563 loss=0.272321 mse_soft=0.271919 ent_in=1.0859 ent_out=0.2537 rowmax_in=0.5199 rowmax_out=0.9001 discrete_mse=266.931641 best_discrete=21.652916 hash=False elapsed=33.4s
step   375/900 tau=0.2325 loss=0.271295 mse_soft=0.270899 ent_in=1.0826 ent_out=0.2370 rowmax_in=0.5181 rowmax_out=0.9051 discrete_mse=243.907791 best_discrete=21.652916 hash=False elapsed=35.8s
step   400/900 tau=0.2109 loss=0.271406 mse_soft=0.271015 ent_in=1.0751 ent_out=0.2293 rowmax_in=0.5184 rowmax_out=0.9066 discrete_mse=217.532425 best_discrete=21.652916 hash=False elapsed=38.1s
step   425/900 tau=0.1913 loss=0.269464 mse_soft=0.269075 ent_in=1.0684 ent_out=0.2272 rowmax_in=0.5195 rowmax_out=0.9057 discrete_mse=666.289429 best_discrete=21.652916 hash=False elapsed=40.5s
step   450/900 tau=0.1735 loss=0.270396 mse_soft=0.270009 ent_in=1.0662 ent_out=0.2267 rowmax_in=0.5199 rowmax_out=0.9043 discrete_mse=543.743164 best_discrete=21.652916 hash=False elapsed=42.8s
step   475/900 tau=0.1574 loss=0.269706 mse_soft=0.269319 ent_in=1.0641 ent_out=0.2263 rowmax_in=0.5204 rowmax_out=0.9037 discrete_mse=543.743164 best_discrete=21.652916 hash=False elapsed=45.2s
step   500/900 tau=0.1428 loss=0.269216 mse_soft=0.268830 ent_in=1.0584 ent_out=0.2256 rowmax_in=0.5225 rowmax_out=0.9038 discrete_mse=543.743164 best_discrete=21.652916 hash=False elapsed=47.6s
step   525/900 tau=0.1295 loss=0.270679 mse_soft=0.270296 ent_in=1.0502 ent_out=0.2293 rowmax_in=0.5251 rowmax_out=0.9007 discrete_mse=543.743164 best_discrete=21.652916 hash=False elapsed=49.7s
step   550/900 tau=0.1175 loss=0.274596 mse_soft=0.274214 ent_in=1.0420 ent_out=0.2320 rowmax_in=0.5282 rowmax_out=0.8985 discrete_mse=543.743164 best_discrete=21.652916 hash=False elapsed=52.1s
step   575/900 tau=0.1066 loss=0.278191 mse_soft=0.277806 ent_in=1.0531 ent_out=0.2292 rowmax_in=0.5221 rowmax_out=0.9003 discrete_mse=169.527390 best_discrete=21.652916 hash=False elapsed=54.4s
step   600/900 tau=0.0967 loss=0.270919 mse_soft=0.270538 ent_in=1.0439 ent_out=0.2238 rowmax_in=0.5272 rowmax_out=0.9003 discrete_mse=169.527390 best_discrete=21.652916 hash=False elapsed=56.6s
step   625/900 tau=0.0877 loss=0.273871 mse_soft=0.273494 ent_in=1.0389 ent_out=0.2197 rowmax_in=0.5287 rowmax_out=0.9018 discrete_mse=801.421997 best_discrete=21.652916 hash=False elapsed=59.1s
step   650/900 tau=0.0795 loss=0.274322 mse_soft=0.273947 ent_in=1.0318 ent_out=0.2172 rowmax_in=0.5330 rowmax_out=0.9044 discrete_mse=1089.423340 best_discrete=21.652916 hash=False elapsed=61.5s
step   675/900 tau=0.0722 loss=0.277325 mse_soft=0.276951 ent_in=1.0249 ent_out=0.2189 rowmax_in=0.5317 rowmax_out=0.9022 discrete_mse=321.603455 best_discrete=21.652916 hash=False elapsed=63.9s
step   700/900 tau=0.0655 loss=0.320990 mse_soft=0.320661 ent_in=0.9012 ent_out=0.1953 rowmax_in=0.5909 rowmax_out=0.9081 discrete_mse=154.375671 best_discrete=21.652916 hash=False elapsed=66.3s
step   725/900 tau=0.0594 loss=0.404550 mse_soft=0.404343 ent_in=0.5749 ent_out=0.1177 rowmax_in=0.7425 rowmax_out=0.9445 discrete_mse=39.338497 best_discrete=21.652916 hash=False elapsed=68.7s
step   750/900 tau=0.0539 loss=0.369586 mse_soft=0.369374 ent_in=0.5915 ent_out=0.1166 rowmax_in=0.7156 rowmax_out=0.9436 discrete_mse=84.059036 best_discrete=21.652916 hash=False elapsed=70.9s
step   775/900 tau=0.0489 loss=0.386545 mse_soft=0.386339 ent_in=0.5717 ent_out=0.1153 rowmax_in=0.7250 rowmax_out=0.9466 discrete_mse=44.813759 best_discrete=21.652916 hash=False elapsed=73.2s
step   800/900 tau=0.0443 loss=0.460070 mse_soft=0.459864 ent_in=0.5799 ent_out=0.1052 rowmax_in=0.7013 rowmax_out=0.9512 discrete_mse=21.755749 best_discrete=21.652916 hash=False elapsed=75.5s
step   825/900 tau=0.0402 loss=0.417468 mse_soft=0.417315 ent_in=0.4128 ent_out=0.0968 rowmax_in=0.8107 rowmax_out=0.9523 discrete_mse=33.421535 best_discrete=21.652916 hash=False elapsed=77.8s
step   850/900 tau=0.0365 loss=0.393455 mse_soft=0.393285 ent_in=0.4610 ent_out=0.1056 rowmax_in=0.7723 rowmax_out=0.9497 discrete_mse=44.813759 best_discrete=21.652916 hash=False elapsed=79.9s
step   875/900 tau=0.0331 loss=0.383381 mse_soft=0.383208 ent_in=0.4689 ent_out=0.1076 rowmax_in=0.7694 rowmax_out=0.9491 discrete_mse=24.007637 best_discrete=21.652916 hash=False elapsed=82.2s
step   900/900 tau=0.0300 loss=0.379016 mse_soft=0.378842 ent_in=0.4818 ent_out=0.1001 rowmax_in=0.7553 rowmax_out=0.9534 discrete_mse=33.421535 best_discrete=21.652916 hash=False elapsed=84.5s

Final metrics:
  soft_mse_full=0.372897
  rowmax_in_mean=0.7587
  rowmax_out_mean=0.9533
  ent_in_mean=0.4781
  ent_out_mean=0.1002
  final_discrete_mse=33.421535
  hash_match=False
  best_discrete_mse_seen=21.652916
Saved results to overnight_b244_j1.json
