Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.056998 mse_soft=1.054675 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=103.150131 best_discrete=103.150131 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.855252 mse_soft=0.853062 ent_in=3.6341 ent_out=3.6655 rowmax_in=0.0464 rowmax_out=0.0444 discrete_mse=3207.135498 best_discrete=103.150131 hash=False elapsed=2.7s
step    50/900 tau=0.8229 loss=0.646270 mse_soft=0.644361 ent_in=3.1374 ent_out=3.2238 rowmax_in=0.0893 rowmax_out=0.0871 discrete_mse=1607.662231 best_discrete=103.150131 hash=False elapsed=5.0s
step    75/900 tau=0.7450 loss=0.510105 mse_soft=0.508521 ent_in=2.6134 ent_out=2.6686 rowmax_in=0.1963 rowmax_out=0.2027 discrete_mse=321.208038 best_discrete=103.150131 hash=False elapsed=7.1s
step   100/900 tau=0.6745 loss=0.403006 mse_soft=0.401855 ent_in=2.0061 ent_out=1.8318 rowmax_in=0.3375 rowmax_out=0.4278 discrete_mse=625.227905 best_discrete=103.150131 hash=False elapsed=9.4s
step   125/900 tau=0.6107 loss=0.341066 mse_soft=0.340248 ent_in=1.5821 ent_out=1.1464 rowmax_in=0.4513 rowmax_out=0.6252 discrete_mse=1262.942627 best_discrete=103.150131 hash=False elapsed=11.8s
step   150/900 tau=0.5529 loss=0.315904 mse_soft=0.315229 ent_in=1.4199 ent_out=0.8323 rowmax_in=0.4859 rowmax_out=0.7079 discrete_mse=386.230652 best_discrete=103.150131 hash=False elapsed=14.2s
step   175/900 tau=0.5006 loss=0.305424 mse_soft=0.304835 ent_in=1.3162 ent_out=0.6470 rowmax_in=0.5097 rowmax_out=0.7581 discrete_mse=197.650314 best_discrete=103.150131 hash=False elapsed=16.6s
step   200/900 tau=0.4532 loss=0.295570 mse_soft=0.295024 ent_in=1.2516 ent_out=0.5679 rowmax_in=0.5213 rowmax_out=0.7799 discrete_mse=159.822067 best_discrete=103.150131 hash=False elapsed=19.1s
step   225/900 tau=0.4103 loss=0.290443 mse_soft=0.289930 ent_in=1.2083 ent_out=0.5024 rowmax_in=0.5257 rowmax_out=0.8083 discrete_mse=76.734062 best_discrete=76.734062 hash=False elapsed=21.3s
step   250/900 tau=0.3715 loss=0.286880 mse_soft=0.286387 ent_in=1.1754 ent_out=0.4661 rowmax_in=0.5343 rowmax_out=0.8237 discrete_mse=203.436188 best_discrete=76.734062 hash=False elapsed=23.5s
step   275/900 tau=0.3363 loss=0.281011 mse_soft=0.280532 ent_in=1.1481 ent_out=0.4478 rowmax_in=0.5370 rowmax_out=0.8297 discrete_mse=203.436188 best_discrete=76.734062 hash=False elapsed=26.0s
step   300/900 tau=0.3045 loss=0.278679 mse_soft=0.278210 ent_in=1.1271 ent_out=0.4337 rowmax_in=0.5401 rowmax_out=0.8277 discrete_mse=203.436188 best_discrete=76.734062 hash=False elapsed=28.6s
step   325/900 tau=0.2756 loss=0.276689 mse_soft=0.276227 ent_in=1.1194 ent_out=0.4183 rowmax_in=0.5365 rowmax_out=0.8266 discrete_mse=203.436188 best_discrete=76.734062 hash=False elapsed=30.9s
step   350/900 tau=0.2496 loss=0.276476 mse_soft=0.276023 ent_in=1.1070 ent_out=0.4037 rowmax_in=0.5405 rowmax_out=0.8285 discrete_mse=203.436188 best_discrete=76.734062 hash=False elapsed=33.3s
step   375/900 tau=0.2259 loss=0.280577 mse_soft=0.280130 ent_in=1.0955 ent_out=0.3931 rowmax_in=0.5422 rowmax_out=0.8306 discrete_mse=343.468323 best_discrete=76.734062 hash=False elapsed=35.5s
step   400/900 tau=0.2046 loss=0.273953 mse_soft=0.273514 ent_in=1.0845 ent_out=0.3788 rowmax_in=0.5458 rowmax_out=0.8346 discrete_mse=414.270905 best_discrete=76.734062 hash=False elapsed=38.2s
step   425/900 tau=0.1852 loss=0.280676 mse_soft=0.280244 ent_in=1.0736 ent_out=0.3671 rowmax_in=0.5490 rowmax_out=0.8375 discrete_mse=414.270905 best_discrete=76.734062 hash=False elapsed=40.4s
step   450/900 tau=0.1677 loss=0.284949 mse_soft=0.284522 ent_in=1.0692 ent_out=0.3555 rowmax_in=0.5502 rowmax_out=0.8403 discrete_mse=414.270905 best_discrete=76.734062 hash=False elapsed=42.7s
step   475/900 tau=0.1518 loss=0.280832 mse_soft=0.280410 ent_in=1.0619 ent_out=0.3437 rowmax_in=0.5516 rowmax_out=0.8435 discrete_mse=414.270905 best_discrete=76.734062 hash=False elapsed=45.2s
step   500/900 tau=0.1374 loss=0.275396 mse_soft=0.274980 ent_in=1.0521 ent_out=0.3338 rowmax_in=0.5539 rowmax_out=0.8471 discrete_mse=414.270905 best_discrete=76.734062 hash=False elapsed=47.4s
step   525/900 tau=0.1244 loss=0.277681 mse_soft=0.277270 ent_in=1.0471 ent_out=0.3218 rowmax_in=0.5556 rowmax_out=0.8532 discrete_mse=421.179352 best_discrete=76.734062 hash=False elapsed=49.6s
step   550/900 tau=0.1126 loss=0.274040 mse_soft=0.273631 ent_in=1.0436 ent_out=0.3171 rowmax_in=0.5554 rowmax_out=0.8540 discrete_mse=414.270905 best_discrete=76.734062 hash=False elapsed=51.9s
step   575/900 tau=0.1020 loss=0.275955 mse_soft=0.275548 ent_in=1.0387 ent_out=0.3158 rowmax_in=0.5583 rowmax_out=0.8537 discrete_mse=421.179352 best_discrete=76.734062 hash=False elapsed=54.2s
step   600/900 tau=0.0923 loss=0.344116 mse_soft=0.343817 ent_in=0.7912 ent_out=0.2028 rowmax_in=0.6388 rowmax_out=0.9147 discrete_mse=88.574959 best_discrete=76.734062 hash=False elapsed=56.6s
step   625/900 tau=0.0836 loss=0.320799 mse_soft=0.320511 ent_in=0.7520 ent_out=0.2050 rowmax_in=0.6407 rowmax_out=0.9046 discrete_mse=61.466694 best_discrete=61.466694 hash=False elapsed=59.2s
step   650/900 tau=0.0757 loss=0.314131 mse_soft=0.313840 ent_in=0.7546 ent_out=0.2184 rowmax_in=0.6334 rowmax_out=0.8932 discrete_mse=46.070568 best_discrete=46.070568 hash=False elapsed=61.5s
step   675/900 tau=0.0685 loss=0.313097 mse_soft=0.312811 ent_in=0.7475 ent_out=0.2064 rowmax_in=0.6286 rowmax_out=0.8994 discrete_mse=39.258236 best_discrete=39.258236 hash=False elapsed=63.9s
step   700/900 tau=0.0620 loss=0.317019 mse_soft=0.316735 ent_in=0.7416 ent_out=0.2053 rowmax_in=0.6334 rowmax_out=0.8965 discrete_mse=102.794197 best_discrete=39.258236 hash=False elapsed=66.2s
step   725/900 tau=0.0562 loss=0.315477 mse_soft=0.315196 ent_in=0.7341 ent_out=0.2036 rowmax_in=0.6343 rowmax_out=0.9001 discrete_mse=30.355709 best_discrete=30.355709 hash=False elapsed=68.4s
step   750/900 tau=0.0508 loss=0.385688 mse_soft=0.385465 ent_in=0.5777 ent_out=0.1662 rowmax_in=0.7080 rowmax_out=0.9247 discrete_mse=135.864578 best_discrete=30.355709 hash=False elapsed=70.9s
step   775/900 tau=0.0460 loss=0.389739 mse_soft=0.389538 ent_in=0.4941 ent_out=0.1778 rowmax_in=0.7401 rowmax_out=0.9080 discrete_mse=87.004883 best_discrete=30.355709 hash=False elapsed=73.2s
step   800/900 tau=0.0417 loss=0.356653 mse_soft=0.356443 ent_in=0.5268 ent_out=0.1738 rowmax_in=0.7098 rowmax_out=0.9109 discrete_mse=16.783949 best_discrete=16.783949 hash=False elapsed=75.5s
step   825/900 tau=0.0377 loss=0.349075 mse_soft=0.348863 ent_in=0.5181 ent_out=0.1906 rowmax_in=0.7179 rowmax_out=0.8967 discrete_mse=74.182007 best_discrete=16.783949 hash=False elapsed=77.6s
step   850/900 tau=0.0342 loss=0.362880 mse_soft=0.362693 ent_in=0.4625 ent_out=0.1615 rowmax_in=0.7522 rowmax_out=0.9070 discrete_mse=2.824992 best_discrete=2.824992 hash=False elapsed=79.7s
step   875/900 tau=0.0309 loss=0.428477 mse_soft=0.428330 ent_in=0.3686 ent_out=0.1209 rowmax_in=0.8152 rowmax_out=0.9240 discrete_mse=11.357874 best_discrete=2.824992 hash=False elapsed=82.1s
step   900/900 tau=0.0280 loss=0.398787 mse_soft=0.398647 ent_in=0.3851 ent_out=0.0829 rowmax_in=0.8119 rowmax_out=0.9308 discrete_mse=5.302251 best_discrete=2.824992 hash=False elapsed=84.3s

Final metrics:
  soft_mse_full=0.402726
  rowmax_in_mean=0.8111
  rowmax_out_mean=0.9306
  ent_in_mean=0.3853
  ent_out_mean=0.0844
  final_discrete_mse=5.302251
  hash_match=False
  best_discrete_mse_seen=2.824992
Saved results to overnight_b102_j2.json
