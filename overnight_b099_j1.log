Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.072870 mse_soft=1.070548 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=27.077959 best_discrete=27.077959 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.865357 mse_soft=0.863167 ent_in=3.6328 ent_out=3.6678 rowmax_in=0.0462 rowmax_out=0.0439 discrete_mse=325.472229 best_discrete=27.077959 hash=False elapsed=2.4s
step    50/900 tau=0.8260 loss=0.650054 mse_soft=0.648147 ent_in=3.1281 ent_out=3.2270 rowmax_in=0.0916 rowmax_out=0.0855 discrete_mse=4939.869141 best_discrete=27.077959 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.513423 mse_soft=0.511836 ent_in=2.6025 ent_out=2.6896 rowmax_in=0.2018 rowmax_out=0.1896 discrete_mse=3356.818604 best_discrete=27.077959 hash=False elapsed=7.1s
step   100/900 tau=0.6797 loss=0.410099 mse_soft=0.408933 ent_in=1.9778 ent_out=1.9099 rowmax_in=0.3633 rowmax_out=0.3941 discrete_mse=675.348999 best_discrete=27.077959 hash=False elapsed=9.3s
step   125/900 tau=0.6165 loss=0.337562 mse_soft=0.336735 ent_in=1.5399 ent_out=1.2142 rowmax_in=0.4614 rowmax_out=0.5680 discrete_mse=194.865097 best_discrete=27.077959 hash=False elapsed=11.5s
step   150/900 tau=0.5592 loss=0.308186 mse_soft=0.307516 ent_in=1.3578 ent_out=0.8759 rowmax_in=0.4904 rowmax_out=0.6754 discrete_mse=1517.299438 best_discrete=27.077959 hash=False elapsed=14.0s
step   175/900 tau=0.5073 loss=0.292364 mse_soft=0.291764 ent_in=1.2532 ent_out=0.7462 rowmax_in=0.5061 rowmax_out=0.7060 discrete_mse=913.329651 best_discrete=27.077959 hash=False elapsed=16.1s
step   200/900 tau=0.4602 loss=0.283690 mse_soft=0.283140 ent_in=1.1922 ent_out=0.6409 rowmax_in=0.5131 rowmax_out=0.7327 discrete_mse=327.982422 best_discrete=27.077959 hash=False elapsed=18.4s
step   225/900 tau=0.4174 loss=0.278396 mse_soft=0.277873 ent_in=1.1673 ent_out=0.5753 rowmax_in=0.5142 rowmax_out=0.7525 discrete_mse=752.422668 best_discrete=27.077959 hash=False elapsed=20.8s
step   250/900 tau=0.3786 loss=0.274991 mse_soft=0.274491 ent_in=1.1408 ent_out=0.5282 rowmax_in=0.5169 rowmax_out=0.7642 discrete_mse=752.422668 best_discrete=27.077959 hash=False elapsed=23.1s
step   275/900 tau=0.3434 loss=0.273807 mse_soft=0.273322 ent_in=1.1200 ent_out=0.4962 rowmax_in=0.5190 rowmax_out=0.7734 discrete_mse=752.422668 best_discrete=27.077959 hash=False elapsed=25.6s
step   300/900 tau=0.3115 loss=0.272041 mse_soft=0.271565 ent_in=1.1150 ent_out=0.4731 rowmax_in=0.5166 rowmax_out=0.7787 discrete_mse=282.547302 best_discrete=27.077959 hash=False elapsed=28.0s
step   325/900 tau=0.2826 loss=0.271662 mse_soft=0.271192 ent_in=1.1086 ent_out=0.4579 rowmax_in=0.5165 rowmax_out=0.7800 discrete_mse=566.481384 best_discrete=27.077959 hash=False elapsed=30.2s
step   350/900 tau=0.2563 loss=0.274129 mse_soft=0.273666 ent_in=1.1052 ent_out=0.4375 rowmax_in=0.5160 rowmax_out=0.7871 discrete_mse=484.275085 best_discrete=27.077959 hash=False elapsed=32.5s
step   375/900 tau=0.2325 loss=0.269984 mse_soft=0.269526 ent_in=1.0980 ent_out=0.4296 rowmax_in=0.5182 rowmax_out=0.7863 discrete_mse=398.016998 best_discrete=27.077959 hash=False elapsed=34.7s
step   400/900 tau=0.2109 loss=0.272948 mse_soft=0.272492 ent_in=1.0970 ent_out=0.4245 rowmax_in=0.5187 rowmax_out=0.7856 discrete_mse=324.720184 best_discrete=27.077959 hash=False elapsed=36.6s
step   425/900 tau=0.1913 loss=0.274401 mse_soft=0.273945 ent_in=1.0955 ent_out=0.4234 rowmax_in=0.5184 rowmax_out=0.7848 discrete_mse=226.851196 best_discrete=27.077959 hash=False elapsed=38.9s
step   450/900 tau=0.1735 loss=0.270588 mse_soft=0.270132 ent_in=1.0970 ent_out=0.4229 rowmax_in=0.5177 rowmax_out=0.7830 discrete_mse=299.655579 best_discrete=27.077959 hash=False elapsed=40.9s
step   475/900 tau=0.1574 loss=0.272136 mse_soft=0.271680 ent_in=1.0938 ent_out=0.4243 rowmax_in=0.5171 rowmax_out=0.7830 discrete_mse=224.332748 best_discrete=27.077959 hash=False elapsed=43.1s
step   500/900 tau=0.1428 loss=0.274628 mse_soft=0.274179 ent_in=1.0888 ent_out=0.4101 rowmax_in=0.5181 rowmax_out=0.7868 discrete_mse=130.342590 best_discrete=27.077959 hash=False elapsed=45.2s
step   525/900 tau=0.1295 loss=0.278873 mse_soft=0.278425 ent_in=1.0892 ent_out=0.4060 rowmax_in=0.5181 rowmax_out=0.7876 discrete_mse=169.624603 best_discrete=27.077959 hash=False elapsed=47.7s
step   550/900 tau=0.1175 loss=0.284212 mse_soft=0.283766 ent_in=1.0842 ent_out=0.4038 rowmax_in=0.5204 rowmax_out=0.7895 discrete_mse=130.342590 best_discrete=27.077959 hash=False elapsed=50.0s
step   575/900 tau=0.1066 loss=0.284584 mse_soft=0.284137 ent_in=1.0826 ent_out=0.4070 rowmax_in=0.5193 rowmax_out=0.7861 discrete_mse=130.342590 best_discrete=27.077959 hash=False elapsed=52.2s
step   600/900 tau=0.0967 loss=0.284310 mse_soft=0.283868 ent_in=1.0750 ent_out=0.3979 rowmax_in=0.5246 rowmax_out=0.7912 discrete_mse=162.979248 best_discrete=27.077959 hash=False elapsed=54.4s
step   625/900 tau=0.0877 loss=0.296257 mse_soft=0.295838 ent_in=1.0101 ent_out=0.3859 rowmax_in=0.5479 rowmax_out=0.7912 discrete_mse=133.771317 best_discrete=27.077959 hash=False elapsed=56.5s
step   650/900 tau=0.0795 loss=0.289462 mse_soft=0.289051 ent_in=0.9961 ent_out=0.3727 rowmax_in=0.5473 rowmax_out=0.7937 discrete_mse=421.972778 best_discrete=27.077959 hash=False elapsed=58.6s
step   675/900 tau=0.0722 loss=0.287520 mse_soft=0.287114 ent_in=0.9824 ent_out=0.3717 rowmax_in=0.5526 rowmax_out=0.7966 discrete_mse=310.754456 best_discrete=27.077959 hash=False elapsed=60.7s
step   700/900 tau=0.0655 loss=0.274894 mse_soft=0.274487 ent_in=0.9827 ent_out=0.3736 rowmax_in=0.5464 rowmax_out=0.7939 discrete_mse=278.245056 best_discrete=27.077959 hash=False elapsed=62.9s
step   725/900 tau=0.0594 loss=0.331060 mse_soft=0.330682 ent_in=0.9427 ent_out=0.3199 rowmax_in=0.5704 rowmax_out=0.8437 discrete_mse=190.745010 best_discrete=27.077959 hash=False elapsed=65.0s
step   750/900 tau=0.0539 loss=0.313860 mse_soft=0.313501 ent_in=0.8568 ent_out=0.3397 rowmax_in=0.5824 rowmax_out=0.8086 discrete_mse=67.909576 best_discrete=27.077959 hash=False elapsed=67.1s
step   775/900 tau=0.0489 loss=0.333471 mse_soft=0.333120 ent_in=0.8370 ent_out=0.3338 rowmax_in=0.5981 rowmax_out=0.8185 discrete_mse=73.148796 best_discrete=27.077959 hash=False elapsed=69.4s
step   800/900 tau=0.0443 loss=0.323782 mse_soft=0.323470 ent_in=0.7112 ent_out=0.3269 rowmax_in=0.6619 rowmax_out=0.8196 discrete_mse=31.883656 best_discrete=27.077959 hash=False elapsed=71.4s
step   825/900 tau=0.0402 loss=0.305081 mse_soft=0.304765 ent_in=0.7384 ent_out=0.3146 rowmax_in=0.6433 rowmax_out=0.8263 discrete_mse=20.743059 best_discrete=20.743059 hash=False elapsed=73.8s
step   850/900 tau=0.0365 loss=0.504103 mse_soft=0.503964 ent_in=0.3506 ent_out=0.1104 rowmax_in=0.8337 rowmax_out=0.9512 discrete_mse=10.394598 best_discrete=10.394598 hash=False elapsed=75.8s
step   875/900 tau=0.0331 loss=0.448315 mse_soft=0.448187 ent_in=0.2969 ent_out=0.1326 rowmax_in=0.8564 rowmax_out=0.9355 discrete_mse=11.095774 best_discrete=10.394598 hash=False elapsed=78.0s
step   900/900 tau=0.0300 loss=0.434393 mse_soft=0.434258 ent_in=0.3148 ent_out=0.1368 rowmax_in=0.8407 rowmax_out=0.9281 discrete_mse=17.037565 best_discrete=10.394598 hash=False elapsed=80.2s

Final metrics:
  soft_mse_full=0.435271
  rowmax_in_mean=0.8409
  rowmax_out_mean=0.9281
  ent_in_mean=0.3147
  ent_out_mean=0.1367
  final_discrete_mse=17.037565
  hash_match=False
  best_discrete_mse_seen=10.394598
Saved results to overnight_b099_j1.json
