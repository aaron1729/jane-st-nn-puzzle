Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.072541 mse_soft=1.070219 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=40.550373 best_discrete=40.550373 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.862828 mse_soft=0.860638 ent_in=3.6322 ent_out=3.6679 rowmax_in=0.0455 rowmax_out=0.0446 discrete_mse=2693.123047 best_discrete=40.550373 hash=False elapsed=2.4s
step    50/900 tau=0.8260 loss=0.647246 mse_soft=0.645339 ent_in=3.1331 ent_out=3.2210 rowmax_in=0.0944 rowmax_out=0.0874 discrete_mse=1927.976196 best_discrete=40.550373 hash=False elapsed=4.5s
step    75/900 tau=0.7493 loss=0.513009 mse_soft=0.511428 ent_in=2.5896 ent_out=2.6831 rowmax_in=0.2072 rowmax_out=0.1981 discrete_mse=555.267212 best_discrete=40.550373 hash=False elapsed=6.7s
step   100/900 tau=0.6797 loss=0.401226 mse_soft=0.400088 ent_in=1.9711 ent_out=1.8244 rowmax_in=0.3541 rowmax_out=0.4285 discrete_mse=464.617584 best_discrete=40.550373 hash=False elapsed=8.9s
step   125/900 tau=0.6165 loss=0.328905 mse_soft=0.328127 ent_in=1.5382 ent_out=1.0576 rowmax_in=0.4766 rowmax_out=0.6645 discrete_mse=121.232269 best_discrete=40.550373 hash=False elapsed=11.1s
step   150/900 tau=0.5592 loss=0.299311 mse_soft=0.298730 ent_in=1.3076 ent_out=0.6277 rowmax_in=0.5092 rowmax_out=0.7839 discrete_mse=291.958405 best_discrete=40.550373 hash=False elapsed=13.4s
step   175/900 tau=0.5073 loss=0.282790 mse_soft=0.282325 ent_in=1.1686 ent_out=0.3805 rowmax_in=0.5407 rowmax_out=0.8828 discrete_mse=255.218994 best_discrete=40.550373 hash=False elapsed=15.6s
step   200/900 tau=0.4602 loss=0.274062 mse_soft=0.273632 ent_in=1.1040 ent_out=0.3296 rowmax_in=0.5511 rowmax_out=0.8855 discrete_mse=232.709045 best_discrete=40.550373 hash=False elapsed=17.8s
step   225/900 tau=0.4174 loss=0.265572 mse_soft=0.265164 ent_in=1.0500 ent_out=0.3099 rowmax_in=0.5711 rowmax_out=0.8720 discrete_mse=232.709045 best_discrete=40.550373 hash=False elapsed=20.2s
step   250/900 tau=0.3786 loss=0.260543 mse_soft=0.260136 ent_in=1.0418 ent_out=0.3154 rowmax_in=0.5745 rowmax_out=0.8658 discrete_mse=114.049850 best_discrete=40.550373 hash=False elapsed=22.4s
step   275/900 tau=0.3434 loss=0.257840 mse_soft=0.257442 ent_in=1.0338 ent_out=0.2931 rowmax_in=0.5730 rowmax_out=0.8703 discrete_mse=116.204323 best_discrete=40.550373 hash=False elapsed=24.5s
step   300/900 tau=0.3115 loss=0.256790 mse_soft=0.256397 ent_in=1.0221 ent_out=0.2864 rowmax_in=0.5742 rowmax_out=0.8696 discrete_mse=81.609726 best_discrete=40.550373 hash=False elapsed=26.6s
step   325/900 tau=0.2826 loss=0.256432 mse_soft=0.256044 ent_in=1.0098 ent_out=0.2813 rowmax_in=0.5755 rowmax_out=0.8709 discrete_mse=73.399727 best_discrete=40.550373 hash=False elapsed=28.6s
step   350/900 tau=0.2563 loss=0.256188 mse_soft=0.255802 ent_in=1.0046 ent_out=0.2822 rowmax_in=0.5771 rowmax_out=0.8700 discrete_mse=71.169662 best_discrete=40.550373 hash=False elapsed=30.8s
step   375/900 tau=0.2325 loss=0.256115 mse_soft=0.255731 ent_in=1.0001 ent_out=0.2788 rowmax_in=0.5775 rowmax_out=0.8727 discrete_mse=71.169662 best_discrete=40.550373 hash=False elapsed=33.0s
step   400/900 tau=0.2109 loss=0.255885 mse_soft=0.255502 ent_in=0.9971 ent_out=0.2778 rowmax_in=0.5784 rowmax_out=0.8730 discrete_mse=46.511890 best_discrete=40.550373 hash=False elapsed=34.9s
step   425/900 tau=0.1913 loss=0.258224 mse_soft=0.257843 ent_in=0.9943 ent_out=0.2769 rowmax_in=0.5789 rowmax_out=0.8735 discrete_mse=71.169662 best_discrete=40.550373 hash=False elapsed=37.1s
step   450/900 tau=0.1735 loss=0.256236 mse_soft=0.255855 ent_in=0.9910 ent_out=0.2780 rowmax_in=0.5815 rowmax_out=0.8728 discrete_mse=73.293121 best_discrete=40.550373 hash=False elapsed=39.2s
step   475/900 tau=0.1574 loss=0.255355 mse_soft=0.254973 ent_in=0.9932 ent_out=0.2797 rowmax_in=0.5802 rowmax_out=0.8714 discrete_mse=46.511890 best_discrete=40.550373 hash=False elapsed=41.3s
step   500/900 tau=0.1428 loss=0.256926 mse_soft=0.256546 ent_in=0.9871 ent_out=0.2808 rowmax_in=0.5822 rowmax_out=0.8704 discrete_mse=44.240612 best_discrete=40.550373 hash=False elapsed=43.4s
step   525/900 tau=0.1295 loss=0.255988 mse_soft=0.255609 ent_in=0.9842 ent_out=0.2796 rowmax_in=0.5846 rowmax_out=0.8710 discrete_mse=44.240612 best_discrete=40.550373 hash=False elapsed=45.6s
step   550/900 tau=0.1175 loss=0.255429 mse_soft=0.255051 ent_in=0.9815 ent_out=0.2784 rowmax_in=0.5849 rowmax_out=0.8706 discrete_mse=46.511890 best_discrete=40.550373 hash=False elapsed=47.7s
step   575/900 tau=0.1066 loss=0.256870 mse_soft=0.256494 ent_in=0.9789 ent_out=0.2715 rowmax_in=0.5842 rowmax_out=0.8720 discrete_mse=56.688324 best_discrete=40.550373 hash=False elapsed=49.8s
step   600/900 tau=0.0967 loss=0.258069 mse_soft=0.257697 ent_in=0.9718 ent_out=0.2679 rowmax_in=0.5858 rowmax_out=0.8718 discrete_mse=60.418686 best_discrete=40.550373 hash=False elapsed=51.9s
step   625/900 tau=0.0877 loss=0.257505 mse_soft=0.257131 ent_in=0.9775 ent_out=0.2698 rowmax_in=0.5844 rowmax_out=0.8694 discrete_mse=38.733109 best_discrete=38.733109 hash=False elapsed=54.2s
step   650/900 tau=0.0795 loss=0.257377 mse_soft=0.257008 ent_in=0.9697 ent_out=0.2625 rowmax_in=0.5886 rowmax_out=0.8702 discrete_mse=42.586292 best_discrete=38.733109 hash=False elapsed=56.3s
step   675/900 tau=0.0722 loss=0.262722 mse_soft=0.262358 ent_in=0.9628 ent_out=0.2504 rowmax_in=0.5918 rowmax_out=0.8741 discrete_mse=48.324116 best_discrete=38.733109 hash=False elapsed=58.2s
step   700/900 tau=0.0655 loss=0.270914 mse_soft=0.270551 ent_in=0.9507 ent_out=0.2586 rowmax_in=0.5900 rowmax_out=0.8661 discrete_mse=44.541512 best_discrete=38.733109 hash=False elapsed=60.3s
step   725/900 tau=0.0594 loss=0.269083 mse_soft=0.268730 ent_in=0.9418 ent_out=0.2331 rowmax_in=0.5996 rowmax_out=0.8667 discrete_mse=157.877777 best_discrete=38.733109 hash=False elapsed=62.5s
step   750/900 tau=0.0539 loss=0.260145 mse_soft=0.259791 ent_in=0.9546 ent_out=0.2251 rowmax_in=0.5880 rowmax_out=0.8757 discrete_mse=59.341137 best_discrete=38.733109 hash=False elapsed=64.5s
step   775/900 tau=0.0489 loss=0.292748 mse_soft=0.292446 ent_in=0.8131 ent_out=0.1915 rowmax_in=0.6260 rowmax_out=0.8899 discrete_mse=84.813637 best_discrete=38.733109 hash=False elapsed=66.5s
step   800/900 tau=0.0443 loss=0.313687 mse_soft=0.313411 ent_in=0.7355 ent_out=0.1868 rowmax_in=0.6482 rowmax_out=0.8808 discrete_mse=5.039449 best_discrete=5.039449 hash=False elapsed=68.5s
step   825/900 tau=0.0402 loss=0.281237 mse_soft=0.280950 ent_in=0.7715 ent_out=0.1847 rowmax_in=0.6325 rowmax_out=0.8868 discrete_mse=36.699635 best_discrete=5.039449 hash=False elapsed=70.5s
step   850/900 tau=0.0365 loss=0.287158 mse_soft=0.286868 ent_in=0.7654 ent_out=0.2042 rowmax_in=0.6325 rowmax_out=0.8737 discrete_mse=86.962784 best_discrete=5.039449 hash=False elapsed=72.5s
step   875/900 tau=0.0331 loss=0.284394 mse_soft=0.284104 ent_in=0.7628 ent_out=0.2041 rowmax_in=0.6332 rowmax_out=0.8746 discrete_mse=193.307968 best_discrete=5.039449 hash=False elapsed=74.5s
step   900/900 tau=0.0300 loss=0.406039 mse_soft=0.405888 ent_in=0.3919 ent_out=0.1100 rowmax_in=0.7930 rowmax_out=0.9309 discrete_mse=60.808613 best_discrete=5.039449 hash=False elapsed=76.5s

Final metrics:
  soft_mse_full=0.400761
  rowmax_in_mean=0.7898
  rowmax_out_mean=0.9308
  ent_in_mean=0.3958
  ent_out_mean=0.1100
  final_discrete_mse=60.808613
  hash_match=False
  best_discrete_mse_seen=5.039449
Saved results to overnight_b091_j1.json
