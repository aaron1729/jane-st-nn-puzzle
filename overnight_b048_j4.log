Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.015
step     1/700 tau=1.0000 loss=1.064187 mse_soft=1.063413 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=112.519722 best_discrete=112.519722 hash=False elapsed=0.5s
step    25/700 tau=0.8810 loss=0.972082 mse_soft=0.971322 ent_in=3.7929 ent_out=3.8053 rowmax_in=0.0332 rowmax_out=0.0322 discrete_mse=5443.564453 best_discrete=112.519722 hash=False elapsed=2.6s
step    50/700 tau=0.7721 loss=0.786521 mse_soft=0.785813 ent_in=3.5151 ent_out=3.5660 rowmax_in=0.0575 rowmax_out=0.0536 discrete_mse=6456.044434 best_discrete=112.519722 hash=False elapsed=5.0s
step    75/700 tau=0.6767 loss=0.644195 mse_soft=0.643559 ent_in=3.1308 ent_out=3.2354 rowmax_in=0.0975 rowmax_out=0.0887 discrete_mse=1100.955078 best_discrete=112.519722 hash=False elapsed=7.5s
step   100/700 tau=0.5931 loss=0.536520 mse_soft=0.535964 ent_in=2.7229 ent_out=2.8313 rowmax_in=0.1780 rowmax_out=0.1692 discrete_mse=5277.457031 best_discrete=112.519722 hash=False elapsed=9.9s
step   125/700 tau=0.5198 loss=0.445902 mse_soft=0.445458 ent_in=2.2474 ent_out=2.1957 rowmax_in=0.2895 rowmax_out=0.3131 discrete_mse=4960.343262 best_discrete=112.519722 hash=False elapsed=12.1s
step   150/700 tau=0.4555 loss=0.372713 mse_soft=0.372382 ent_in=1.7882 ent_out=1.5310 rowmax_in=0.3975 rowmax_out=0.5151 discrete_mse=742.739319 best_discrete=112.519722 hash=False elapsed=14.5s
step   175/700 tau=0.3992 loss=0.331406 mse_soft=0.331158 ent_in=1.5311 ent_out=0.9480 rowmax_in=0.4450 rowmax_out=0.6994 discrete_mse=757.531982 best_discrete=112.519722 hash=False elapsed=16.8s
step   200/700 tau=0.3499 loss=0.310083 mse_soft=0.309885 ent_in=1.3782 ent_out=0.6043 rowmax_in=0.4682 rowmax_out=0.7879 discrete_mse=1241.276733 best_discrete=112.519722 hash=False elapsed=19.1s
step   225/700 tau=0.3066 loss=0.299152 mse_soft=0.298975 ent_in=1.3102 ent_out=0.4667 rowmax_in=0.4774 rowmax_out=0.8157 discrete_mse=2471.546387 best_discrete=112.519722 hash=False elapsed=21.4s
step   250/700 tau=0.2687 loss=0.292208 mse_soft=0.292041 ent_in=1.2516 ent_out=0.4164 rowmax_in=0.4897 rowmax_out=0.8281 discrete_mse=2049.176025 best_discrete=112.519722 hash=False elapsed=23.9s
step   275/700 tau=0.2355 loss=0.286224 mse_soft=0.286062 ent_in=1.2113 ent_out=0.4045 rowmax_in=0.4949 rowmax_out=0.8261 discrete_mse=2167.766602 best_discrete=112.519722 hash=False elapsed=26.3s
step   300/700 tau=0.2064 loss=0.284773 mse_soft=0.284616 ent_in=1.1780 ent_out=0.3880 rowmax_in=0.5003 rowmax_out=0.8267 discrete_mse=2123.833252 best_discrete=112.519722 hash=False elapsed=28.4s
step   325/700 tau=0.1809 loss=0.284617 mse_soft=0.284463 ent_in=1.1551 ent_out=0.3790 rowmax_in=0.5046 rowmax_out=0.8271 discrete_mse=1499.305176 best_discrete=112.519722 hash=False elapsed=30.6s
step   350/700 tau=0.1585 loss=0.281602 mse_soft=0.281451 ent_in=1.1409 ent_out=0.3711 rowmax_in=0.5073 rowmax_out=0.8274 discrete_mse=1635.170410 best_discrete=112.519722 hash=False elapsed=32.8s
step   375/700 tau=0.1389 loss=0.283245 mse_soft=0.283095 ent_in=1.1324 ent_out=0.3653 rowmax_in=0.5081 rowmax_out=0.8297 discrete_mse=1923.398804 best_discrete=112.519722 hash=False elapsed=35.4s
step   400/700 tau=0.1218 loss=0.284320 mse_soft=0.284172 ent_in=1.1248 ent_out=0.3604 rowmax_in=0.5085 rowmax_out=0.8304 discrete_mse=1728.563599 best_discrete=112.519722 hash=False elapsed=37.6s
step   425/700 tau=0.1067 loss=0.295135 mse_soft=0.294988 ent_in=1.1166 ent_out=0.3543 rowmax_in=0.5096 rowmax_out=0.8345 discrete_mse=1728.563599 best_discrete=112.519722 hash=False elapsed=39.9s
step   450/700 tau=0.0935 loss=0.283007 mse_soft=0.282860 ent_in=1.1130 ent_out=0.3507 rowmax_in=0.5107 rowmax_out=0.8384 discrete_mse=1728.563599 best_discrete=112.519722 hash=False elapsed=42.3s
step   475/700 tau=0.0820 loss=0.289781 mse_soft=0.289637 ent_in=1.1005 ent_out=0.3481 rowmax_in=0.5123 rowmax_out=0.8405 discrete_mse=1728.563599 best_discrete=112.519722 hash=False elapsed=44.8s
step   500/700 tau=0.0718 loss=0.287111 mse_soft=0.286967 ent_in=1.0969 ent_out=0.3406 rowmax_in=0.5130 rowmax_out=0.8467 discrete_mse=2924.858643 best_discrete=112.519722 hash=False elapsed=47.2s
step   525/700 tau=0.0630 loss=0.290385 mse_soft=0.290244 ent_in=1.0803 ent_out=0.3347 rowmax_in=0.5178 rowmax_out=0.8499 discrete_mse=2225.656250 best_discrete=112.519722 hash=False elapsed=49.4s
step   550/700 tau=0.0552 loss=0.285734 mse_soft=0.285596 ent_in=1.0660 ent_out=0.3147 rowmax_in=0.5233 rowmax_out=0.8584 discrete_mse=1497.076294 best_discrete=112.519722 hash=False elapsed=51.5s
step   575/700 tau=0.0484 loss=0.285532 mse_soft=0.285395 ent_in=1.0579 ent_out=0.3190 rowmax_in=0.5217 rowmax_out=0.8559 discrete_mse=1197.129150 best_discrete=112.519722 hash=False elapsed=53.6s
step   600/700 tau=0.0424 loss=0.306433 mse_soft=0.306300 ent_in=1.0193 ent_out=0.3110 rowmax_in=0.5326 rowmax_out=0.8582 discrete_mse=493.505676 best_discrete=112.519722 hash=False elapsed=55.7s
step   625/700 tau=0.0371 loss=0.317738 mse_soft=0.317606 ent_in=1.0128 ent_out=0.3017 rowmax_in=0.5297 rowmax_out=0.8561 discrete_mse=586.200500 best_discrete=112.519722 hash=False elapsed=57.7s
step   650/700 tau=0.0325 loss=0.322442 mse_soft=0.322316 ent_in=0.9516 ent_out=0.3071 rowmax_in=0.5472 rowmax_out=0.8405 discrete_mse=126.574821 best_discrete=112.519722 hash=False elapsed=59.8s
step   675/700 tau=0.0285 loss=0.380497 mse_soft=0.380404 ent_in=0.7423 ent_out=0.1898 rowmax_in=0.6508 rowmax_out=0.9007 discrete_mse=94.294876 best_discrete=94.294876 hash=False elapsed=61.9s
step   700/700 tau=0.0250 loss=0.361318 mse_soft=0.361232 ent_in=0.6707 ent_out=0.1904 rowmax_in=0.6611 rowmax_out=0.8997 discrete_mse=164.540466 best_discrete=94.294876 hash=False elapsed=64.0s

Final metrics:
  soft_mse_full=0.341206
  rowmax_in_mean=0.6569
  rowmax_out_mean=0.8980
  ent_in_mean=0.6745
  ent_out_mean=0.1919
  final_discrete_mse=54.527149
  hash_match=False
  best_discrete_mse_seen=94.294876
Saved results to overnight_b048_j4.json
