Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.054383 mse_soft=1.052061 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=291.727600 best_discrete=291.727600 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.854822 mse_soft=0.852631 ent_in=3.6351 ent_out=3.6683 rowmax_in=0.0454 rowmax_out=0.0443 discrete_mse=142.221069 best_discrete=142.221069 hash=False elapsed=2.9s
step    50/900 tau=0.8229 loss=0.643239 mse_soft=0.641330 ent_in=3.1371 ent_out=3.2264 rowmax_in=0.0900 rowmax_out=0.0867 discrete_mse=2124.478027 best_discrete=142.221069 hash=False elapsed=5.2s
step    75/900 tau=0.7450 loss=0.509348 mse_soft=0.507760 ent_in=2.6164 ent_out=2.6797 rowmax_in=0.1921 rowmax_out=0.2009 discrete_mse=1169.740601 best_discrete=142.221069 hash=False elapsed=7.5s
step   100/900 tau=0.6745 loss=0.400114 mse_soft=0.398941 ent_in=2.0687 ent_out=1.8429 rowmax_in=0.3207 rowmax_out=0.4100 discrete_mse=55.344986 best_discrete=55.344986 hash=False elapsed=9.6s
step   125/900 tau=0.6107 loss=0.331212 mse_soft=0.330377 ent_in=1.6607 ent_out=1.1243 rowmax_in=0.3955 rowmax_out=0.6217 discrete_mse=65.607178 best_discrete=55.344986 hash=False elapsed=11.9s
step   150/900 tau=0.5529 loss=0.303680 mse_soft=0.303014 ent_in=1.4585 ent_out=0.7615 rowmax_in=0.4381 rowmax_out=0.7250 discrete_mse=58.862537 best_discrete=55.344986 hash=False elapsed=14.1s
step   175/900 tau=0.5006 loss=0.287838 mse_soft=0.287285 ent_in=1.3230 ent_out=0.5186 rowmax_in=0.4821 rowmax_out=0.8050 discrete_mse=18.858461 best_discrete=18.858461 hash=False elapsed=16.3s
step   200/900 tau=0.4532 loss=0.280251 mse_soft=0.279753 ent_in=1.2547 ent_out=0.4041 rowmax_in=0.4952 rowmax_out=0.8403 discrete_mse=17.583071 best_discrete=17.583071 hash=False elapsed=18.7s
step   225/900 tau=0.4103 loss=0.274986 mse_soft=0.274523 ent_in=1.2237 ent_out=0.3198 rowmax_in=0.4944 rowmax_out=0.8764 discrete_mse=103.339844 best_discrete=17.583071 hash=False elapsed=20.9s
step   250/900 tau=0.3715 loss=0.272206 mse_soft=0.271765 ent_in=1.1884 ent_out=0.2800 rowmax_in=0.5007 rowmax_out=0.8924 discrete_mse=103.339844 best_discrete=17.583071 hash=False elapsed=23.1s
step   275/900 tau=0.3363 loss=0.269515 mse_soft=0.269086 ent_in=1.1706 ent_out=0.2596 rowmax_in=0.5058 rowmax_out=0.9002 discrete_mse=103.339844 best_discrete=17.583071 hash=False elapsed=25.6s
step   300/900 tau=0.3045 loss=0.267838 mse_soft=0.267413 ent_in=1.1516 ent_out=0.2649 rowmax_in=0.5064 rowmax_out=0.8900 discrete_mse=187.465729 best_discrete=17.583071 hash=False elapsed=28.0s
step   325/900 tau=0.2756 loss=0.266259 mse_soft=0.265839 ent_in=1.1414 ent_out=0.2591 rowmax_in=0.5081 rowmax_out=0.8878 discrete_mse=187.465729 best_discrete=17.583071 hash=False elapsed=30.4s
step   350/900 tau=0.2496 loss=0.267790 mse_soft=0.267372 ent_in=1.1373 ent_out=0.2537 rowmax_in=0.5081 rowmax_out=0.8878 discrete_mse=187.465729 best_discrete=17.583071 hash=False elapsed=32.7s
step   375/900 tau=0.2259 loss=0.268196 mse_soft=0.267780 ent_in=1.1324 ent_out=0.2554 rowmax_in=0.5085 rowmax_out=0.8841 discrete_mse=187.465729 best_discrete=17.583071 hash=False elapsed=34.9s
step   400/900 tau=0.2046 loss=0.267504 mse_soft=0.267089 ent_in=1.1303 ent_out=0.2519 rowmax_in=0.5096 rowmax_out=0.8869 discrete_mse=187.465729 best_discrete=17.583071 hash=False elapsed=37.1s
step   425/900 tau=0.1852 loss=0.268033 mse_soft=0.267618 ent_in=1.1292 ent_out=0.2537 rowmax_in=0.5082 rowmax_out=0.8864 discrete_mse=187.465729 best_discrete=17.583071 hash=False elapsed=39.2s
step   450/900 tau=0.1677 loss=0.268587 mse_soft=0.268175 ent_in=1.1265 ent_out=0.2474 rowmax_in=0.5089 rowmax_out=0.8907 discrete_mse=187.465729 best_discrete=17.583071 hash=False elapsed=41.3s
step   475/900 tau=0.1518 loss=0.266310 mse_soft=0.265899 ent_in=1.1263 ent_out=0.2426 rowmax_in=0.5067 rowmax_out=0.8930 discrete_mse=187.465729 best_discrete=17.583071 hash=False elapsed=43.5s
step   500/900 tau=0.1374 loss=0.267383 mse_soft=0.266974 ent_in=1.1253 ent_out=0.2372 rowmax_in=0.5065 rowmax_out=0.8957 discrete_mse=187.465729 best_discrete=17.583071 hash=False elapsed=45.8s
step   525/900 tau=0.1244 loss=0.267753 mse_soft=0.267346 ent_in=1.1259 ent_out=0.2333 rowmax_in=0.5061 rowmax_out=0.8956 discrete_mse=73.918915 best_discrete=17.583071 hash=False elapsed=48.2s
step   550/900 tau=0.1126 loss=0.270611 mse_soft=0.270207 ent_in=1.1198 ent_out=0.2272 rowmax_in=0.5072 rowmax_out=0.8985 discrete_mse=30.937206 best_discrete=17.583071 hash=False elapsed=50.3s
step   575/900 tau=0.1020 loss=0.269985 mse_soft=0.269587 ent_in=1.1088 ent_out=0.2171 rowmax_in=0.5118 rowmax_out=0.9005 discrete_mse=187.465729 best_discrete=17.583071 hash=False elapsed=52.7s
step   600/900 tau=0.0923 loss=0.281895 mse_soft=0.281499 ent_in=1.1090 ent_out=0.2111 rowmax_in=0.5073 rowmax_out=0.9054 discrete_mse=104.077423 best_discrete=17.583071 hash=False elapsed=55.1s
step   625/900 tau=0.0836 loss=0.269934 mse_soft=0.269542 ent_in=1.0936 ent_out=0.2163 rowmax_in=0.5125 rowmax_out=0.8956 discrete_mse=48.835281 best_discrete=17.583071 hash=False elapsed=57.4s
step   650/900 tau=0.0757 loss=0.280503 mse_soft=0.280122 ent_in=1.0717 ent_out=0.1965 rowmax_in=0.5195 rowmax_out=0.9002 discrete_mse=81.705643 best_discrete=17.583071 hash=False elapsed=59.6s
step   675/900 tau=0.0685 loss=0.295124 mse_soft=0.294743 ent_in=1.0665 ent_out=0.2036 rowmax_in=0.5168 rowmax_out=0.9012 discrete_mse=8.147972 best_discrete=8.147972 hash=False elapsed=61.8s
step   700/900 tau=0.0620 loss=0.317879 mse_soft=0.317511 ent_in=1.0308 ent_out=0.1966 rowmax_in=0.5468 rowmax_out=0.9015 discrete_mse=20.981585 best_discrete=8.147972 hash=False elapsed=64.3s
step   725/900 tau=0.0562 loss=0.274299 mse_soft=0.273944 ent_in=0.9984 ent_out=0.1856 rowmax_in=0.5433 rowmax_out=0.9048 discrete_mse=84.780319 best_discrete=8.147972 hash=False elapsed=66.5s
step   750/900 tau=0.0508 loss=0.287090 mse_soft=0.286735 ent_in=0.9920 ent_out=0.1897 rowmax_in=0.5449 rowmax_out=0.9005 discrete_mse=138.285477 best_discrete=8.147972 hash=False elapsed=68.7s
step   775/900 tau=0.0460 loss=0.290073 mse_soft=0.289733 ent_in=0.9428 ent_out=0.1911 rowmax_in=0.5619 rowmax_out=0.9005 discrete_mse=77.102356 best_discrete=8.147972 hash=False elapsed=71.0s
step   800/900 tau=0.0417 loss=0.421247 mse_soft=0.421056 ent_in=0.5033 ent_out=0.1306 rowmax_in=0.7641 rowmax_out=0.9355 discrete_mse=17.592512 best_discrete=8.147972 hash=False elapsed=73.1s
step   825/900 tau=0.0377 loss=0.398000 mse_soft=0.397854 ent_in=0.3907 ent_out=0.0947 rowmax_in=0.8324 rowmax_out=0.9530 discrete_mse=6.707088 best_discrete=6.707088 hash=False elapsed=75.4s
step   850/900 tau=0.0342 loss=0.377648 mse_soft=0.377487 ent_in=0.4401 ent_out=0.0957 rowmax_in=0.7884 rowmax_out=0.9531 discrete_mse=15.703248 best_discrete=6.707088 hash=False elapsed=77.7s
step   875/900 tau=0.0309 loss=0.409319 mse_soft=0.409172 ent_in=0.3954 ent_out=0.0965 rowmax_in=0.8013 rowmax_out=0.9544 discrete_mse=14.354940 best_discrete=6.707088 hash=False elapsed=79.9s
step   900/900 tau=0.0280 loss=0.428817 mse_soft=0.428682 ent_in=0.3733 ent_out=0.0773 rowmax_in=0.8228 rowmax_out=0.9612 discrete_mse=10.405128 best_discrete=6.707088 hash=False elapsed=82.2s

Final metrics:
  soft_mse_full=0.437204
  rowmax_in_mean=0.8082
  rowmax_out_mean=0.9610
  ent_in_mean=0.3832
  ent_out_mean=0.0780
  final_discrete_mse=12.893279
  hash_match=False
  best_discrete_mse_seen=6.707088
Saved results to overnight_b152_j2.json
