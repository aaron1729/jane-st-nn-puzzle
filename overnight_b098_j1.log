Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.048971 mse_soft=1.046649 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=14.991626 best_discrete=14.991626 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.847127 mse_soft=0.844937 ent_in=3.6327 ent_out=3.6655 rowmax_in=0.0461 rowmax_out=0.0442 discrete_mse=1313.982422 best_discrete=14.991626 hash=False elapsed=2.5s
step    50/900 tau=0.8260 loss=0.639148 mse_soft=0.637240 ent_in=3.1324 ent_out=3.2282 rowmax_in=0.0908 rowmax_out=0.0867 discrete_mse=2292.630371 best_discrete=14.991626 hash=False elapsed=4.5s
step    75/900 tau=0.7493 loss=0.512594 mse_soft=0.510991 ent_in=2.6272 ent_out=2.7145 rowmax_in=0.2001 rowmax_out=0.1931 discrete_mse=1214.330933 best_discrete=14.991626 hash=False elapsed=7.0s
step   100/900 tau=0.6797 loss=0.417731 mse_soft=0.416523 ent_in=2.0391 ent_out=1.9877 rowmax_in=0.3402 rowmax_out=0.3554 discrete_mse=390.678833 best_discrete=14.991626 hash=False elapsed=9.4s
step   125/900 tau=0.6165 loss=0.356980 mse_soft=0.356069 ent_in=1.6210 ent_out=1.4137 rowmax_in=0.4457 rowmax_out=0.5015 discrete_mse=4607.013184 best_discrete=14.991626 hash=False elapsed=11.9s
step   150/900 tau=0.5592 loss=0.316933 mse_soft=0.316226 ent_in=1.3748 ent_out=0.9835 rowmax_in=0.5001 rowmax_out=0.6251 discrete_mse=663.868103 best_discrete=14.991626 hash=False elapsed=14.4s
step   175/900 tau=0.5073 loss=0.299375 mse_soft=0.298783 ent_in=1.2378 ent_out=0.7357 rowmax_in=0.5301 rowmax_out=0.7040 discrete_mse=439.124603 best_discrete=14.991626 hash=False elapsed=16.7s
step   200/900 tau=0.4602 loss=0.292303 mse_soft=0.291755 ent_in=1.1811 ent_out=0.6461 rowmax_in=0.5389 rowmax_out=0.7276 discrete_mse=679.198608 best_discrete=14.991626 hash=False elapsed=19.1s
step   225/900 tau=0.4174 loss=0.286219 mse_soft=0.285700 ent_in=1.1403 ent_out=0.5911 rowmax_in=0.5440 rowmax_out=0.7472 discrete_mse=724.306091 best_discrete=14.991626 hash=False elapsed=21.7s
step   250/900 tau=0.3786 loss=0.282634 mse_soft=0.282129 ent_in=1.1263 ent_out=0.5560 rowmax_in=0.5403 rowmax_out=0.7643 discrete_mse=1607.983154 best_discrete=14.991626 hash=False elapsed=24.0s
step   275/900 tau=0.3434 loss=0.280282 mse_soft=0.279789 ent_in=1.1114 ent_out=0.5292 rowmax_in=0.5390 rowmax_out=0.7789 discrete_mse=2649.832031 best_discrete=14.991626 hash=False elapsed=26.5s
step   300/900 tau=0.3115 loss=0.276683 mse_soft=0.276202 ent_in=1.0955 ent_out=0.5090 rowmax_in=0.5440 rowmax_out=0.7881 discrete_mse=2649.832031 best_discrete=14.991626 hash=False elapsed=28.8s
step   325/900 tau=0.2826 loss=0.275667 mse_soft=0.275197 ent_in=1.0901 ent_out=0.4767 rowmax_in=0.5455 rowmax_out=0.7970 discrete_mse=1924.220947 best_discrete=14.991626 hash=False elapsed=31.2s
step   350/900 tau=0.2563 loss=0.275908 mse_soft=0.275446 ent_in=1.0826 ent_out=0.4567 rowmax_in=0.5465 rowmax_out=0.8017 discrete_mse=1532.020386 best_discrete=14.991626 hash=False elapsed=33.4s
step   375/900 tau=0.2325 loss=0.274696 mse_soft=0.274238 ent_in=1.0776 ent_out=0.4478 rowmax_in=0.5481 rowmax_out=0.8055 discrete_mse=1850.889893 best_discrete=14.991626 hash=False elapsed=35.9s
step   400/900 tau=0.2109 loss=0.274649 mse_soft=0.274195 ent_in=1.0734 ent_out=0.4414 rowmax_in=0.5472 rowmax_out=0.8085 discrete_mse=2481.468262 best_discrete=14.991626 hash=False elapsed=38.2s
step   425/900 tau=0.1913 loss=0.272287 mse_soft=0.271839 ent_in=1.0676 ent_out=0.4262 rowmax_in=0.5504 rowmax_out=0.8124 discrete_mse=1850.889893 best_discrete=14.991626 hash=False elapsed=40.7s
step   450/900 tau=0.1735 loss=0.271186 mse_soft=0.270741 ent_in=1.0661 ent_out=0.4147 rowmax_in=0.5493 rowmax_out=0.8134 discrete_mse=1532.020386 best_discrete=14.991626 hash=False elapsed=43.1s
step   475/900 tau=0.1574 loss=0.270021 mse_soft=0.269581 ent_in=1.0619 ent_out=0.4035 rowmax_in=0.5491 rowmax_out=0.8160 discrete_mse=1616.881958 best_discrete=14.991626 hash=False elapsed=45.5s
step   500/900 tau=0.1428 loss=0.270269 mse_soft=0.269833 ent_in=1.0550 ent_out=0.3966 rowmax_in=0.5505 rowmax_out=0.8174 discrete_mse=1980.167358 best_discrete=14.991626 hash=False elapsed=48.0s
step   525/900 tau=0.1295 loss=0.273609 mse_soft=0.273177 ent_in=1.0519 ent_out=0.3896 rowmax_in=0.5488 rowmax_out=0.8188 discrete_mse=1480.756958 best_discrete=14.991626 hash=False elapsed=50.0s
step   550/900 tau=0.1175 loss=0.268704 mse_soft=0.268272 ent_in=1.0482 ent_out=0.3929 rowmax_in=0.5504 rowmax_out=0.8168 discrete_mse=1980.167358 best_discrete=14.991626 hash=False elapsed=52.0s
step   575/900 tau=0.1066 loss=0.322494 mse_soft=0.322066 ent_in=1.0424 ent_out=0.3862 rowmax_in=0.5458 rowmax_out=0.8180 discrete_mse=1949.718384 best_discrete=14.991626 hash=False elapsed=54.0s
step   600/900 tau=0.0967 loss=0.339434 mse_soft=0.339054 ent_in=0.9346 ent_out=0.3297 rowmax_in=0.5869 rowmax_out=0.8493 discrete_mse=105.020538 best_discrete=14.991626 hash=False elapsed=56.3s
step   625/900 tau=0.0877 loss=0.290079 mse_soft=0.289717 ent_in=0.8714 ent_out=0.3381 rowmax_in=0.6013 rowmax_out=0.8329 discrete_mse=464.901703 best_discrete=14.991626 hash=False elapsed=58.5s
step   650/900 tau=0.0795 loss=0.283891 mse_soft=0.283533 ent_in=0.8568 ent_out=0.3374 rowmax_in=0.6076 rowmax_out=0.8333 discrete_mse=1895.787964 best_discrete=14.991626 hash=False elapsed=61.2s
step   675/900 tau=0.0722 loss=0.284772 mse_soft=0.284415 ent_in=0.8570 ent_out=0.3340 rowmax_in=0.6057 rowmax_out=0.8335 discrete_mse=1895.787964 best_discrete=14.991626 hash=False elapsed=63.4s
step   700/900 tau=0.0655 loss=0.292772 mse_soft=0.292423 ent_in=0.8334 ent_out=0.3289 rowmax_in=0.6077 rowmax_out=0.8296 discrete_mse=244.846542 best_discrete=14.991626 hash=False elapsed=65.7s
step   725/900 tau=0.0594 loss=0.287870 mse_soft=0.287513 ent_in=0.8595 ent_out=0.3292 rowmax_in=0.5998 rowmax_out=0.8284 discrete_mse=790.050232 best_discrete=14.991626 hash=False elapsed=68.1s
step   750/900 tau=0.0539 loss=0.352372 mse_soft=0.352029 ent_in=0.8284 ent_out=0.3147 rowmax_in=0.6192 rowmax_out=0.8353 discrete_mse=27.083921 best_discrete=14.991626 hash=False elapsed=70.4s
step   775/900 tau=0.0489 loss=0.455181 mse_soft=0.454993 ent_in=0.4339 ent_out=0.1908 rowmax_in=0.7984 rowmax_out=0.9178 discrete_mse=180.552277 best_discrete=14.991626 hash=False elapsed=72.7s
step   800/900 tau=0.0443 loss=0.426187 mse_soft=0.426002 ent_in=0.3926 ent_out=0.2223 rowmax_in=0.7994 rowmax_out=0.8856 discrete_mse=168.424774 best_discrete=14.991626 hash=False elapsed=74.9s
step   825/900 tau=0.0402 loss=0.405875 mse_soft=0.405694 ent_in=0.3745 ent_out=0.2304 rowmax_in=0.8046 rowmax_out=0.8794 discrete_mse=43.991375 best_discrete=14.991626 hash=False elapsed=77.3s
step   850/900 tau=0.0365 loss=0.422714 mse_soft=0.422529 ent_in=0.3975 ent_out=0.2192 rowmax_in=0.7935 rowmax_out=0.8950 discrete_mse=26.989111 best_discrete=14.991626 hash=False elapsed=79.6s
step   875/900 tau=0.0331 loss=0.396648 mse_soft=0.396478 ent_in=0.3475 ent_out=0.2185 rowmax_in=0.8136 rowmax_out=0.8966 discrete_mse=17.486862 best_discrete=14.991626 hash=False elapsed=81.9s
step   900/900 tau=0.0300 loss=0.427774 mse_soft=0.427603 ent_in=0.3484 ent_out=0.2226 rowmax_in=0.8133 rowmax_out=0.8951 discrete_mse=17.486862 best_discrete=14.991626 hash=False elapsed=84.2s

Final metrics:
  soft_mse_full=0.416003
  rowmax_in_mean=0.8103
  rowmax_out_mean=0.8853
  ent_in_mean=0.3520
  ent_out_mean=0.2279
  final_discrete_mse=17.486862
  hash_match=False
  best_discrete_mse_seen=14.991626
Saved results to overnight_b098_j1.json
