Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.043645 mse_soft=1.041323 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=22.359577 best_discrete=22.359577 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.846982 mse_soft=0.844792 ent_in=3.6329 ent_out=3.6666 rowmax_in=0.0449 rowmax_out=0.0450 discrete_mse=1158.662720 best_discrete=22.359577 hash=False elapsed=3.1s
step    50/900 tau=0.8229 loss=0.642783 mse_soft=0.640880 ent_in=3.1261 ent_out=3.2157 rowmax_in=0.0947 rowmax_out=0.0883 discrete_mse=4196.285156 best_discrete=22.359577 hash=False elapsed=5.5s
step    75/900 tau=0.7450 loss=0.512935 mse_soft=0.511364 ent_in=2.5894 ent_out=2.6486 rowmax_in=0.2063 rowmax_out=0.2046 discrete_mse=773.645996 best_discrete=22.359577 hash=False elapsed=8.0s
step   100/900 tau=0.6745 loss=0.395786 mse_soft=0.394664 ent_in=1.9674 ent_out=1.7727 rowmax_in=0.3628 rowmax_out=0.4336 discrete_mse=1020.684998 best_discrete=22.359577 hash=False elapsed=10.1s
step   125/900 tau=0.6107 loss=0.336688 mse_soft=0.335885 ent_in=1.5927 ent_out=1.0835 rowmax_in=0.4384 rowmax_out=0.6503 discrete_mse=237.104950 best_discrete=22.359577 hash=False elapsed=12.4s
step   150/900 tau=0.5529 loss=0.311819 mse_soft=0.311162 ent_in=1.4282 ent_out=0.7615 rowmax_in=0.4666 rowmax_out=0.7422 discrete_mse=182.212250 best_discrete=22.359577 hash=False elapsed=14.9s
step   175/900 tau=0.5006 loss=0.300053 mse_soft=0.299470 ent_in=1.3194 ent_out=0.6238 rowmax_in=0.4866 rowmax_out=0.7605 discrete_mse=278.918488 best_discrete=22.359577 hash=False elapsed=17.1s
step   200/900 tau=0.4532 loss=0.294403 mse_soft=0.293853 ent_in=1.2798 ent_out=0.5563 rowmax_in=0.4977 rowmax_out=0.7835 discrete_mse=604.017944 best_discrete=22.359577 hash=False elapsed=19.4s
step   225/900 tau=0.4103 loss=0.288975 mse_soft=0.288466 ent_in=1.2238 ent_out=0.4743 rowmax_in=0.5146 rowmax_out=0.8176 discrete_mse=604.017944 best_discrete=22.359577 hash=False elapsed=21.7s
step   250/900 tau=0.3715 loss=0.284625 mse_soft=0.284150 ent_in=1.1778 ent_out=0.4068 rowmax_in=0.5249 rowmax_out=0.8375 discrete_mse=430.924774 best_discrete=22.359577 hash=False elapsed=23.9s
step   275/900 tau=0.3363 loss=0.282856 mse_soft=0.282396 ent_in=1.1561 ent_out=0.3761 rowmax_in=0.5235 rowmax_out=0.8463 discrete_mse=430.924774 best_discrete=22.359577 hash=False elapsed=26.2s
step   300/900 tau=0.3045 loss=0.279378 mse_soft=0.278930 ent_in=1.1298 ent_out=0.3630 rowmax_in=0.5287 rowmax_out=0.8488 discrete_mse=448.362579 best_discrete=22.359577 hash=False elapsed=28.7s
step   325/900 tau=0.2756 loss=0.278841 mse_soft=0.278403 ent_in=1.1114 ent_out=0.3493 rowmax_in=0.5310 rowmax_out=0.8519 discrete_mse=649.914001 best_discrete=22.359577 hash=False elapsed=31.0s
step   350/900 tau=0.2496 loss=0.278427 mse_soft=0.277994 ent_in=1.0982 ent_out=0.3443 rowmax_in=0.5320 rowmax_out=0.8513 discrete_mse=355.275787 best_discrete=22.359577 hash=False elapsed=33.3s
step   375/900 tau=0.2259 loss=0.277511 mse_soft=0.277080 ent_in=1.0936 ent_out=0.3423 rowmax_in=0.5332 rowmax_out=0.8500 discrete_mse=627.346802 best_discrete=22.359577 hash=False elapsed=35.7s
step   400/900 tau=0.2046 loss=0.278070 mse_soft=0.277640 ent_in=1.0926 ent_out=0.3392 rowmax_in=0.5322 rowmax_out=0.8499 discrete_mse=511.527252 best_discrete=22.359577 hash=False elapsed=37.9s
step   425/900 tau=0.1852 loss=0.277242 mse_soft=0.276817 ent_in=1.0810 ent_out=0.3380 rowmax_in=0.5346 rowmax_out=0.8488 discrete_mse=1401.301514 best_discrete=22.359577 hash=False elapsed=40.2s
step   450/900 tau=0.1677 loss=0.274343 mse_soft=0.273920 ent_in=1.0760 ent_out=0.3338 rowmax_in=0.5361 rowmax_out=0.8492 discrete_mse=1154.678711 best_discrete=22.359577 hash=False elapsed=42.4s
step   475/900 tau=0.1518 loss=0.273868 mse_soft=0.273447 ent_in=1.0728 ent_out=0.3300 rowmax_in=0.5371 rowmax_out=0.8502 discrete_mse=864.371948 best_discrete=22.359577 hash=False elapsed=44.7s
step   500/900 tau=0.1374 loss=0.274994 mse_soft=0.274573 ent_in=1.0783 ent_out=0.3235 rowmax_in=0.5318 rowmax_out=0.8516 discrete_mse=394.606964 best_discrete=22.359577 hash=False elapsed=47.0s
step   525/900 tau=0.1244 loss=0.273693 mse_soft=0.273277 ent_in=1.0686 ent_out=0.3183 rowmax_in=0.5364 rowmax_out=0.8543 discrete_mse=1153.002563 best_discrete=22.359577 hash=False elapsed=49.2s
step   550/900 tau=0.1126 loss=0.277167 mse_soft=0.276753 ent_in=1.0631 ent_out=0.3164 rowmax_in=0.5363 rowmax_out=0.8539 discrete_mse=394.606964 best_discrete=22.359577 hash=False elapsed=51.5s
step   575/900 tau=0.1020 loss=0.281710 mse_soft=0.281297 ent_in=1.0592 ent_out=0.3166 rowmax_in=0.5395 rowmax_out=0.8538 discrete_mse=1191.699463 best_discrete=22.359577 hash=False elapsed=53.8s
step   600/900 tau=0.0923 loss=0.285494 mse_soft=0.285086 ent_in=1.0663 ent_out=0.2939 rowmax_in=0.5285 rowmax_out=0.8639 discrete_mse=1281.499146 best_discrete=22.359577 hash=False elapsed=56.1s
step   625/900 tau=0.0836 loss=0.295997 mse_soft=0.295622 ent_in=0.9830 ent_out=0.2663 rowmax_in=0.5666 rowmax_out=0.8765 discrete_mse=465.566498 best_discrete=22.359577 hash=False elapsed=58.4s
step   650/900 tau=0.0757 loss=0.288934 mse_soft=0.288557 ent_in=0.9945 ent_out=0.2611 rowmax_in=0.5533 rowmax_out=0.8714 discrete_mse=207.311615 best_discrete=22.359577 hash=False elapsed=60.7s
step   675/900 tau=0.0685 loss=0.287648 mse_soft=0.287278 ent_in=0.9676 ent_out=0.2636 rowmax_in=0.5613 rowmax_out=0.8674 discrete_mse=121.424957 best_discrete=22.359577 hash=False elapsed=62.9s
step   700/900 tau=0.0620 loss=0.286225 mse_soft=0.285857 ent_in=0.9715 ent_out=0.2559 rowmax_in=0.5501 rowmax_out=0.8734 discrete_mse=638.498901 best_discrete=22.359577 hash=False elapsed=65.2s
step   725/900 tau=0.0562 loss=0.291338 mse_soft=0.291000 ent_in=0.9073 ent_out=0.2187 rowmax_in=0.5865 rowmax_out=0.8873 discrete_mse=104.162598 best_discrete=22.359577 hash=False elapsed=67.3s
step   750/900 tau=0.0508 loss=0.317968 mse_soft=0.317650 ent_in=0.8368 ent_out=0.2241 rowmax_in=0.6138 rowmax_out=0.8863 discrete_mse=73.693420 best_discrete=22.359577 hash=False elapsed=69.5s
step   775/900 tau=0.0460 loss=0.305935 mse_soft=0.305615 ent_in=0.8436 ent_out=0.2226 rowmax_in=0.5982 rowmax_out=0.8825 discrete_mse=350.129730 best_discrete=22.359577 hash=False elapsed=71.6s
step   800/900 tau=0.0417 loss=0.353342 mse_soft=0.353071 ent_in=0.6919 ent_out=0.2098 rowmax_in=0.6613 rowmax_out=0.8897 discrete_mse=137.622742 best_discrete=22.359577 hash=False elapsed=73.6s
step   825/900 tau=0.0377 loss=0.493835 mse_soft=0.493624 ent_in=0.5368 ent_out=0.1654 rowmax_in=0.7352 rowmax_out=0.9158 discrete_mse=25.754528 best_discrete=22.359577 hash=False elapsed=75.8s
step   850/900 tau=0.0342 loss=0.599053 mse_soft=0.598920 ent_in=0.3236 ent_out=0.1191 rowmax_in=0.8140 rowmax_out=0.9362 discrete_mse=84.127052 best_discrete=22.359577 hash=False elapsed=77.8s
step   875/900 tau=0.0309 loss=0.457503 mse_soft=0.457370 ent_in=0.3139 ent_out=0.1285 rowmax_in=0.8289 rowmax_out=0.9324 discrete_mse=37.302238 best_discrete=22.359577 hash=False elapsed=80.0s
step   900/900 tau=0.0280 loss=0.502945 mse_soft=0.502842 ent_in=0.2550 ent_out=0.0884 rowmax_in=0.8639 rowmax_out=0.9603 discrete_mse=58.128162 best_discrete=22.359577 hash=False elapsed=82.2s

Final metrics:
  soft_mse_full=0.500008
  rowmax_in_mean=0.8640
  rowmax_out_mean=0.9597
  ent_in_mean=0.2557
  ent_out_mean=0.0892
  final_discrete_mse=58.128162
  hash_match=False
  best_discrete_mse_seen=22.359577
Saved results to overnight_b119_j2.json
