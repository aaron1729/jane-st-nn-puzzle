Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.061029 mse_soft=1.058707 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=941.858154 best_discrete=941.858154 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.860574 mse_soft=0.858383 ent_in=3.6366 ent_out=3.6651 rowmax_in=0.0458 rowmax_out=0.0445 discrete_mse=216.027344 best_discrete=216.027344 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.646068 mse_soft=0.644161 ent_in=3.1351 ent_out=3.2194 rowmax_in=0.0921 rowmax_out=0.0889 discrete_mse=9837.788086 best_discrete=216.027344 hash=False elapsed=5.1s
step    75/900 tau=0.7493 loss=0.504949 mse_soft=0.503371 ent_in=2.6117 ent_out=2.6499 rowmax_in=0.2043 rowmax_out=0.2086 discrete_mse=2458.619141 best_discrete=216.027344 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.388157 mse_soft=0.387017 ent_in=1.9754 ent_out=1.8275 rowmax_in=0.3591 rowmax_out=0.4191 discrete_mse=1375.222168 best_discrete=216.027344 hash=False elapsed=9.5s
step   125/900 tau=0.6165 loss=0.333200 mse_soft=0.332361 ent_in=1.6062 ent_out=1.1900 rowmax_in=0.4144 rowmax_out=0.6024 discrete_mse=221.560974 best_discrete=216.027344 hash=False elapsed=11.7s
step   150/900 tau=0.5592 loss=0.304482 mse_soft=0.303811 ent_in=1.4048 ent_out=0.8317 rowmax_in=0.4686 rowmax_out=0.6918 discrete_mse=425.262085 best_discrete=216.027344 hash=False elapsed=14.0s
step   175/900 tau=0.5073 loss=0.288829 mse_soft=0.288240 ent_in=1.2900 ent_out=0.6759 rowmax_in=0.4897 rowmax_out=0.7344 discrete_mse=220.412292 best_discrete=216.027344 hash=False elapsed=16.1s
step   200/900 tau=0.4602 loss=0.279413 mse_soft=0.278874 ent_in=1.2096 ent_out=0.5885 rowmax_in=0.5043 rowmax_out=0.7624 discrete_mse=481.461182 best_discrete=216.027344 hash=False elapsed=18.2s
step   225/900 tau=0.4174 loss=0.274674 mse_soft=0.274160 ent_in=1.1857 ent_out=0.5299 rowmax_in=0.5058 rowmax_out=0.7784 discrete_mse=262.802429 best_discrete=216.027344 hash=False elapsed=20.5s
step   250/900 tau=0.3786 loss=0.271985 mse_soft=0.271492 ent_in=1.1576 ent_out=0.4863 rowmax_in=0.5067 rowmax_out=0.7910 discrete_mse=150.726379 best_discrete=150.726379 hash=False elapsed=22.5s
step   275/900 tau=0.3434 loss=0.268683 mse_soft=0.268203 ent_in=1.1430 ent_out=0.4567 rowmax_in=0.5057 rowmax_out=0.8020 discrete_mse=223.463242 best_discrete=150.726379 hash=False elapsed=24.7s
step   300/900 tau=0.3115 loss=0.270547 mse_soft=0.270077 ent_in=1.1356 ent_out=0.4338 rowmax_in=0.5049 rowmax_out=0.8095 discrete_mse=131.859650 best_discrete=131.859650 hash=False elapsed=26.9s
step   325/900 tau=0.2826 loss=0.265667 mse_soft=0.265205 ent_in=1.1296 ent_out=0.4130 rowmax_in=0.5055 rowmax_out=0.8162 discrete_mse=168.349228 best_discrete=131.859650 hash=False elapsed=29.2s
step   350/900 tau=0.2563 loss=0.267658 mse_soft=0.267201 ent_in=1.1278 ent_out=0.3953 rowmax_in=0.5046 rowmax_out=0.8215 discrete_mse=131.859650 best_discrete=131.859650 hash=False elapsed=31.4s
step   375/900 tau=0.2325 loss=0.265788 mse_soft=0.265336 ent_in=1.1226 ent_out=0.3857 rowmax_in=0.5045 rowmax_out=0.8257 discrete_mse=91.007919 best_discrete=91.007919 hash=False elapsed=33.7s
step   400/900 tau=0.2109 loss=0.266968 mse_soft=0.266520 ent_in=1.1138 ent_out=0.3777 rowmax_in=0.5086 rowmax_out=0.8288 discrete_mse=91.007919 best_discrete=91.007919 hash=False elapsed=35.8s
step   425/900 tau=0.1913 loss=0.268158 mse_soft=0.267715 ent_in=1.1066 ent_out=0.3711 rowmax_in=0.5128 rowmax_out=0.8314 discrete_mse=271.272186 best_discrete=91.007919 hash=False elapsed=38.0s
step   450/900 tau=0.1735 loss=0.270876 mse_soft=0.270434 ent_in=1.1080 ent_out=0.3652 rowmax_in=0.5108 rowmax_out=0.8335 discrete_mse=53.326500 best_discrete=53.326500 hash=False elapsed=40.2s
step   475/900 tau=0.1574 loss=0.285146 mse_soft=0.284709 ent_in=1.0951 ent_out=0.3619 rowmax_in=0.5166 rowmax_out=0.8353 discrete_mse=427.944946 best_discrete=53.326500 hash=False elapsed=42.4s
step   500/900 tau=0.1428 loss=0.264872 mse_soft=0.264438 ent_in=1.0919 ent_out=0.3530 rowmax_in=0.5132 rowmax_out=0.8388 discrete_mse=189.997055 best_discrete=53.326500 hash=False elapsed=44.5s
step   525/900 tau=0.1295 loss=0.268138 mse_soft=0.267709 ent_in=1.0867 ent_out=0.3429 rowmax_in=0.5151 rowmax_out=0.8419 discrete_mse=332.670898 best_discrete=53.326500 hash=False elapsed=46.5s
step   550/900 tau=0.1175 loss=0.284760 mse_soft=0.284335 ent_in=1.0808 ent_out=0.3352 rowmax_in=0.5218 rowmax_out=0.8459 discrete_mse=332.670898 best_discrete=53.326500 hash=False elapsed=48.8s
step   575/900 tau=0.1066 loss=0.263379 mse_soft=0.262955 ent_in=1.0809 ent_out=0.3329 rowmax_in=0.5158 rowmax_out=0.8449 discrete_mse=332.670898 best_discrete=53.326500 hash=False elapsed=51.1s
step   600/900 tau=0.0967 loss=0.281392 mse_soft=0.280968 ent_in=1.0820 ent_out=0.3330 rowmax_in=0.5132 rowmax_out=0.8448 discrete_mse=189.997055 best_discrete=53.326500 hash=False elapsed=53.3s
step   625/900 tau=0.0877 loss=0.300505 mse_soft=0.300083 ent_in=1.0779 ent_out=0.3313 rowmax_in=0.5156 rowmax_out=0.8436 discrete_mse=189.997055 best_discrete=53.326500 hash=False elapsed=55.2s
step   650/900 tau=0.0795 loss=0.276044 mse_soft=0.275625 ent_in=1.0662 ent_out=0.3274 rowmax_in=0.5242 rowmax_out=0.8469 discrete_mse=189.997055 best_discrete=53.326500 hash=False elapsed=57.4s
step   675/900 tau=0.0722 loss=0.284109 mse_soft=0.283725 ent_in=0.9927 ent_out=0.2876 rowmax_in=0.5462 rowmax_out=0.8562 discrete_mse=298.976257 best_discrete=53.326500 hash=False elapsed=59.6s
step   700/900 tau=0.0655 loss=0.280171 mse_soft=0.279784 ent_in=0.9854 ent_out=0.3039 rowmax_in=0.5495 rowmax_out=0.8499 discrete_mse=338.839081 best_discrete=53.326500 hash=False elapsed=61.7s
step   725/900 tau=0.0594 loss=0.280119 mse_soft=0.279739 ent_in=0.9638 ent_out=0.3034 rowmax_in=0.5568 rowmax_out=0.8519 discrete_mse=338.839081 best_discrete=53.326500 hash=False elapsed=63.9s
step   750/900 tau=0.0539 loss=0.285122 mse_soft=0.284751 ent_in=0.9321 ent_out=0.3044 rowmax_in=0.5679 rowmax_out=0.8454 discrete_mse=57.043461 best_discrete=53.326500 hash=False elapsed=66.1s
step   775/900 tau=0.0489 loss=0.342576 mse_soft=0.342209 ent_in=0.9218 ent_out=0.2995 rowmax_in=0.5704 rowmax_out=0.8439 discrete_mse=275.225281 best_discrete=53.326500 hash=False elapsed=68.2s
step   800/900 tau=0.0443 loss=0.334855 mse_soft=0.334604 ent_in=0.6069 ent_out=0.2282 rowmax_in=0.7100 rowmax_out=0.8763 discrete_mse=27.258953 best_discrete=27.258953 hash=False elapsed=70.3s
step   825/900 tau=0.0402 loss=0.320369 mse_soft=0.320117 ent_in=0.5990 ent_out=0.2386 rowmax_in=0.6998 rowmax_out=0.8699 discrete_mse=74.672890 best_discrete=27.258953 hash=False elapsed=72.4s
step   850/900 tau=0.0365 loss=0.315814 mse_soft=0.315561 ent_in=0.6020 ent_out=0.2418 rowmax_in=0.6995 rowmax_out=0.8679 discrete_mse=49.287529 best_discrete=27.258953 hash=False elapsed=74.7s
step   875/900 tau=0.0331 loss=0.318547 mse_soft=0.318283 ent_in=0.6418 ent_out=0.2379 rowmax_in=0.6771 rowmax_out=0.8716 discrete_mse=92.775986 best_discrete=27.258953 hash=False elapsed=76.8s
step   900/900 tau=0.0300 loss=0.311598 mse_soft=0.311341 ent_in=0.6234 ent_out=0.2350 rowmax_in=0.6867 rowmax_out=0.8729 discrete_mse=71.343140 best_discrete=27.258953 hash=False elapsed=79.0s

Final metrics:
  soft_mse_full=0.323500
  rowmax_in_mean=0.6871
  rowmax_out_mean=0.8729
  ent_in_mean=0.6227
  ent_out_mean=0.2347
  final_discrete_mse=32.886772
  hash_match=False
  best_discrete_mse_seen=27.258953
Saved results to overnight_b232_j1.json
