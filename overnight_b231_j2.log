Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.062526 mse_soft=1.060203 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=21.480892 best_discrete=21.480892 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.852717 mse_soft=0.850528 ent_in=3.6323 ent_out=3.6659 rowmax_in=0.0455 rowmax_out=0.0456 discrete_mse=5841.075195 best_discrete=21.480892 hash=False elapsed=2.9s
step    50/900 tau=0.8229 loss=0.638512 mse_soft=0.636597 ent_in=3.1465 ent_out=3.2369 rowmax_in=0.0908 rowmax_out=0.0881 discrete_mse=2109.787598 best_discrete=21.480892 hash=False elapsed=5.3s
step    75/900 tau=0.7450 loss=0.501660 mse_soft=0.500065 ent_in=2.6468 ent_out=2.6674 rowmax_in=0.1928 rowmax_out=0.2085 discrete_mse=2789.860107 best_discrete=21.480892 hash=False elapsed=7.7s
step   100/900 tau=0.6745 loss=0.398734 mse_soft=0.397558 ent_in=2.0310 ent_out=1.8887 rowmax_in=0.3589 rowmax_out=0.3879 discrete_mse=1723.530518 best_discrete=21.480892 hash=False elapsed=10.2s
step   125/900 tau=0.6107 loss=0.330271 mse_soft=0.329413 ent_in=1.5761 ent_out=1.2836 rowmax_in=0.4676 rowmax_out=0.5654 discrete_mse=455.430298 best_discrete=21.480892 hash=False elapsed=12.6s
step   150/900 tau=0.5529 loss=0.299619 mse_soft=0.298940 ent_in=1.3644 ent_out=0.8996 rowmax_in=0.5060 rowmax_out=0.6857 discrete_mse=127.466972 best_discrete=21.480892 hash=False elapsed=15.0s
step   175/900 tau=0.5006 loss=0.286695 mse_soft=0.286115 ent_in=1.2542 ent_out=0.6784 rowmax_in=0.5249 rowmax_out=0.7632 discrete_mse=466.589325 best_discrete=21.480892 hash=False elapsed=17.3s
step   200/900 tau=0.4532 loss=0.277995 mse_soft=0.277472 ent_in=1.1742 ent_out=0.5683 rowmax_in=0.5412 rowmax_out=0.7913 discrete_mse=776.766602 best_discrete=21.480892 hash=False elapsed=19.7s
step   225/900 tau=0.4103 loss=0.272772 mse_soft=0.272287 ent_in=1.1238 ent_out=0.4921 rowmax_in=0.5491 rowmax_out=0.8144 discrete_mse=466.589325 best_discrete=21.480892 hash=False elapsed=22.2s
step   250/900 tau=0.3715 loss=0.269556 mse_soft=0.269093 ent_in=1.0972 ent_out=0.4472 rowmax_in=0.5496 rowmax_out=0.8264 discrete_mse=225.058121 best_discrete=21.480892 hash=False elapsed=24.6s
step   275/900 tau=0.3363 loss=0.268286 mse_soft=0.267835 ent_in=1.0774 ent_out=0.4241 rowmax_in=0.5522 rowmax_out=0.8342 discrete_mse=466.589325 best_discrete=21.480892 hash=False elapsed=27.0s
step   300/900 tau=0.3045 loss=0.264073 mse_soft=0.263637 ent_in=1.0510 ent_out=0.4024 rowmax_in=0.5587 rowmax_out=0.8373 discrete_mse=158.075653 best_discrete=21.480892 hash=False elapsed=29.5s
step   325/900 tau=0.2756 loss=0.262144 mse_soft=0.261721 ent_in=1.0339 ent_out=0.3766 rowmax_in=0.5593 rowmax_out=0.8459 discrete_mse=199.198242 best_discrete=21.480892 hash=False elapsed=31.9s
step   350/900 tau=0.2496 loss=0.262366 mse_soft=0.261952 ent_in=1.0218 ent_out=0.3574 rowmax_in=0.5602 rowmax_out=0.8513 discrete_mse=1186.400757 best_discrete=21.480892 hash=False elapsed=34.4s
step   375/900 tau=0.2259 loss=0.262454 mse_soft=0.262047 ent_in=1.0078 ent_out=0.3491 rowmax_in=0.5629 rowmax_out=0.8529 discrete_mse=558.039062 best_discrete=21.480892 hash=False elapsed=36.9s
step   400/900 tau=0.2046 loss=0.260059 mse_soft=0.259658 ent_in=0.9939 ent_out=0.3440 rowmax_in=0.5661 rowmax_out=0.8535 discrete_mse=731.470764 best_discrete=21.480892 hash=False elapsed=39.5s
step   425/900 tau=0.1852 loss=0.272117 mse_soft=0.271719 ent_in=0.9874 ent_out=0.3401 rowmax_in=0.5671 rowmax_out=0.8548 discrete_mse=204.368927 best_discrete=21.480892 hash=False elapsed=41.9s
step   450/900 tau=0.1677 loss=0.260544 mse_soft=0.260146 ent_in=0.9838 ent_out=0.3435 rowmax_in=0.5679 rowmax_out=0.8524 discrete_mse=603.447083 best_discrete=21.480892 hash=False elapsed=44.5s
step   475/900 tau=0.1518 loss=0.262853 mse_soft=0.262458 ent_in=0.9778 ent_out=0.3413 rowmax_in=0.5705 rowmax_out=0.8531 discrete_mse=270.605713 best_discrete=21.480892 hash=False elapsed=47.0s
step   500/900 tau=0.1374 loss=0.264985 mse_soft=0.264589 ent_in=0.9788 ent_out=0.3419 rowmax_in=0.5696 rowmax_out=0.8525 discrete_mse=78.238396 best_discrete=21.480892 hash=False elapsed=49.2s
step   525/900 tau=0.1244 loss=0.261135 mse_soft=0.260741 ent_in=0.9777 ent_out=0.3369 rowmax_in=0.5720 rowmax_out=0.8554 discrete_mse=451.565094 best_discrete=21.480892 hash=False elapsed=51.7s
step   550/900 tau=0.1126 loss=0.269739 mse_soft=0.269345 ent_in=0.9755 ent_out=0.3372 rowmax_in=0.5706 rowmax_out=0.8545 discrete_mse=666.832703 best_discrete=21.480892 hash=False elapsed=54.1s
step   575/900 tau=0.1020 loss=0.260478 mse_soft=0.260088 ent_in=0.9716 ent_out=0.3291 rowmax_in=0.5716 rowmax_out=0.8586 discrete_mse=81.896904 best_discrete=21.480892 hash=False elapsed=56.6s
step   600/900 tau=0.0923 loss=0.275720 mse_soft=0.275332 ent_in=0.9540 ent_out=0.3378 rowmax_in=0.5781 rowmax_out=0.8504 discrete_mse=716.506104 best_discrete=21.480892 hash=False elapsed=59.1s
step   625/900 tau=0.0836 loss=0.286828 mse_soft=0.286451 ent_in=0.9298 ent_out=0.3266 rowmax_in=0.5786 rowmax_out=0.8559 discrete_mse=65.255875 best_discrete=21.480892 hash=False elapsed=61.5s
step   650/900 tau=0.0757 loss=0.263341 mse_soft=0.262967 ent_in=0.9266 ent_out=0.3195 rowmax_in=0.5828 rowmax_out=0.8609 discrete_mse=30.887487 best_discrete=21.480892 hash=False elapsed=63.8s
step   675/900 tau=0.0685 loss=0.280106 mse_soft=0.279750 ent_in=0.8828 ent_out=0.3058 rowmax_in=0.5916 rowmax_out=0.8661 discrete_mse=336.864227 best_discrete=21.480892 hash=False elapsed=66.3s
step   700/900 tau=0.0620 loss=0.343309 mse_soft=0.342953 ent_in=0.8552 ent_out=0.3322 rowmax_in=0.6174 rowmax_out=0.8408 discrete_mse=148.714096 best_discrete=21.480892 hash=False elapsed=68.6s
step   725/900 tau=0.0562 loss=0.276111 mse_soft=0.275764 ent_in=0.8469 ent_out=0.3079 rowmax_in=0.5952 rowmax_out=0.8481 discrete_mse=73.191383 best_discrete=21.480892 hash=False elapsed=70.8s
step   750/900 tau=0.0508 loss=0.341531 mse_soft=0.341183 ent_in=0.8476 ent_out=0.3116 rowmax_in=0.6066 rowmax_out=0.8482 discrete_mse=130.291046 best_discrete=21.480892 hash=False elapsed=73.3s
step   775/900 tau=0.0460 loss=0.281408 mse_soft=0.281092 ent_in=0.7645 ent_out=0.2868 rowmax_in=0.6395 rowmax_out=0.8465 discrete_mse=27.106987 best_discrete=21.480892 hash=False elapsed=75.5s
step   800/900 tau=0.0417 loss=0.294573 mse_soft=0.294262 ent_in=0.7623 ent_out=0.2754 rowmax_in=0.6378 rowmax_out=0.8493 discrete_mse=32.899105 best_discrete=21.480892 hash=False elapsed=77.9s
step   825/900 tau=0.0377 loss=0.371668 mse_soft=0.371449 ent_in=0.5047 ent_out=0.2231 rowmax_in=0.7706 rowmax_out=0.8670 discrete_mse=8.177117 best_discrete=8.177117 hash=False elapsed=80.2s
step   850/900 tau=0.0342 loss=0.425265 mse_soft=0.425091 ent_in=0.3551 ent_out=0.2231 rowmax_in=0.8165 rowmax_out=0.8582 discrete_mse=12.751809 best_discrete=8.177117 hash=False elapsed=82.4s
step   875/900 tau=0.0309 loss=0.406685 mse_soft=0.406507 ent_in=0.3786 ent_out=0.2140 rowmax_in=0.7978 rowmax_out=0.8598 discrete_mse=67.719246 best_discrete=8.177117 hash=False elapsed=84.6s
step   900/900 tau=0.0280 loss=0.390968 mse_soft=0.390797 ent_in=0.3672 ent_out=0.2031 rowmax_in=0.8054 rowmax_out=0.8607 discrete_mse=79.238762 best_discrete=8.177117 hash=False elapsed=86.7s

Final metrics:
  soft_mse_full=0.399817
  rowmax_in_mean=0.8085
  rowmax_out_mean=0.8596
  ent_in_mean=0.3654
  ent_out_mean=0.2039
  final_discrete_mse=52.973068
  hash_match=False
  best_discrete_mse_seen=8.177117
Saved results to overnight_b231_j2.json
