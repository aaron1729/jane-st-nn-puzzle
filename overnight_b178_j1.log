Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.076256 mse_soft=1.073934 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=125.295372 best_discrete=125.295372 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.871021 mse_soft=0.868829 ent_in=3.6357 ent_out=3.6697 rowmax_in=0.0449 rowmax_out=0.0438 discrete_mse=1099.420532 best_discrete=125.295372 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.654219 mse_soft=0.652306 ent_in=3.1395 ent_out=3.2402 rowmax_in=0.0904 rowmax_out=0.0855 discrete_mse=5457.699219 best_discrete=125.295372 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.513238 mse_soft=0.511642 ent_in=2.6116 ent_out=2.7095 rowmax_in=0.2048 rowmax_out=0.1927 discrete_mse=1072.844116 best_discrete=125.295372 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.401346 mse_soft=0.400157 ent_in=2.0683 ent_out=1.8941 rowmax_in=0.3314 rowmax_out=0.3898 discrete_mse=1311.677124 best_discrete=125.295372 hash=False elapsed=9.6s
step   125/900 tau=0.6165 loss=0.341276 mse_soft=0.340413 ent_in=1.6640 ent_out=1.2118 rowmax_in=0.4346 rowmax_out=0.6037 discrete_mse=797.686096 best_discrete=125.295372 hash=False elapsed=12.1s
step   150/900 tau=0.5592 loss=0.315600 mse_soft=0.314895 ent_in=1.4828 ent_out=0.8660 rowmax_in=0.4609 rowmax_out=0.7079 discrete_mse=368.213531 best_discrete=125.295372 hash=False elapsed=14.4s
step   175/900 tau=0.5073 loss=0.301908 mse_soft=0.301304 ent_in=1.3729 ent_out=0.6426 rowmax_in=0.4764 rowmax_out=0.7694 discrete_mse=508.715027 best_discrete=125.295372 hash=False elapsed=16.8s
step   200/900 tau=0.4602 loss=0.291017 mse_soft=0.290472 ent_in=1.2977 ent_out=0.5176 rowmax_in=0.4885 rowmax_out=0.8054 discrete_mse=1520.188721 best_discrete=125.295372 hash=False elapsed=19.1s
step   225/900 tau=0.4174 loss=0.286197 mse_soft=0.285685 ent_in=1.2531 ent_out=0.4526 rowmax_in=0.4880 rowmax_out=0.8191 discrete_mse=735.298401 best_discrete=125.295372 hash=False elapsed=21.4s
step   250/900 tau=0.3786 loss=0.283305 mse_soft=0.282808 ent_in=1.2278 ent_out=0.4260 rowmax_in=0.4908 rowmax_out=0.8255 discrete_mse=168.521072 best_discrete=125.295372 hash=False elapsed=24.0s
step   275/900 tau=0.3434 loss=0.282321 mse_soft=0.281834 ent_in=1.2124 ent_out=0.4125 rowmax_in=0.4939 rowmax_out=0.8290 discrete_mse=735.298401 best_discrete=125.295372 hash=False elapsed=26.3s
step   300/900 tau=0.3115 loss=0.281612 mse_soft=0.281129 ent_in=1.2068 ent_out=0.4039 rowmax_in=0.4945 rowmax_out=0.8318 discrete_mse=146.613739 best_discrete=125.295372 hash=False elapsed=28.7s
step   325/900 tau=0.2826 loss=0.279798 mse_soft=0.279322 ent_in=1.1902 ent_out=0.3958 rowmax_in=0.4977 rowmax_out=0.8368 discrete_mse=262.142639 best_discrete=125.295372 hash=False elapsed=31.0s
step   350/900 tau=0.2563 loss=0.278230 mse_soft=0.277761 ent_in=1.1789 ent_out=0.3830 rowmax_in=0.4994 rowmax_out=0.8430 discrete_mse=616.881409 best_discrete=125.295372 hash=False elapsed=33.3s
step   375/900 tau=0.2325 loss=0.276724 mse_soft=0.276262 ent_in=1.1662 ent_out=0.3722 rowmax_in=0.5033 rowmax_out=0.8454 discrete_mse=616.881409 best_discrete=125.295372 hash=False elapsed=35.7s
step   400/900 tau=0.2109 loss=0.276669 mse_soft=0.276215 ent_in=1.1540 ent_out=0.3610 rowmax_in=0.5053 rowmax_out=0.8467 discrete_mse=358.203094 best_discrete=125.295372 hash=False elapsed=38.0s
step   425/900 tau=0.1913 loss=0.280731 mse_soft=0.280282 ent_in=1.1415 ent_out=0.3553 rowmax_in=0.5111 rowmax_out=0.8452 discrete_mse=358.203094 best_discrete=125.295372 hash=False elapsed=40.4s
step   450/900 tau=0.1735 loss=0.279127 mse_soft=0.278681 ent_in=1.1364 ent_out=0.3505 rowmax_in=0.5083 rowmax_out=0.8443 discrete_mse=358.203094 best_discrete=125.295372 hash=False elapsed=42.7s
step   475/900 tau=0.1574 loss=0.278982 mse_soft=0.278539 ent_in=1.1274 ent_out=0.3468 rowmax_in=0.5114 rowmax_out=0.8436 discrete_mse=358.203094 best_discrete=125.295372 hash=False elapsed=45.1s
step   500/900 tau=0.1428 loss=0.279822 mse_soft=0.279381 ent_in=1.1240 ent_out=0.3469 rowmax_in=0.5121 rowmax_out=0.8417 discrete_mse=380.085907 best_discrete=125.295372 hash=False elapsed=47.4s
step   525/900 tau=0.1295 loss=0.285599 mse_soft=0.285161 ent_in=1.1139 ent_out=0.3463 rowmax_in=0.5162 rowmax_out=0.8400 discrete_mse=472.698730 best_discrete=125.295372 hash=False elapsed=49.9s
step   550/900 tau=0.1175 loss=0.277939 mse_soft=0.277502 ent_in=1.1101 ent_out=0.3449 rowmax_in=0.5158 rowmax_out=0.8379 discrete_mse=472.698730 best_discrete=125.295372 hash=False elapsed=52.3s
step   575/900 tau=0.1066 loss=0.288765 mse_soft=0.288331 ent_in=1.1027 ent_out=0.3428 rowmax_in=0.5188 rowmax_out=0.8383 discrete_mse=433.901886 best_discrete=125.295372 hash=False elapsed=54.6s
step   600/900 tau=0.0967 loss=0.282824 mse_soft=0.282392 ent_in=1.0986 ent_out=0.3432 rowmax_in=0.5182 rowmax_out=0.8386 discrete_mse=321.251007 best_discrete=125.295372 hash=False elapsed=56.9s
step   625/900 tau=0.0877 loss=0.291163 mse_soft=0.290745 ent_in=1.0524 ent_out=0.3420 rowmax_in=0.5329 rowmax_out=0.8363 discrete_mse=175.514740 best_discrete=125.295372 hash=False elapsed=59.2s
step   650/900 tau=0.0795 loss=0.319800 mse_soft=0.319431 ent_in=0.9162 ent_out=0.3143 rowmax_in=0.5724 rowmax_out=0.8611 discrete_mse=51.293240 best_discrete=51.293240 hash=False elapsed=61.6s
step   675/900 tau=0.0722 loss=0.316094 mse_soft=0.315746 ent_in=0.8559 ent_out=0.3055 rowmax_in=0.5813 rowmax_out=0.8560 discrete_mse=153.717941 best_discrete=51.293240 hash=False elapsed=63.9s
step   700/900 tau=0.0655 loss=0.304618 mse_soft=0.304271 ent_in=0.8420 ent_out=0.3146 rowmax_in=0.5884 rowmax_out=0.8411 discrete_mse=203.031647 best_discrete=51.293240 hash=False elapsed=66.2s
step   725/900 tau=0.0594 loss=0.319400 mse_soft=0.319056 ent_in=0.8354 ent_out=0.3143 rowmax_in=0.5838 rowmax_out=0.8417 discrete_mse=70.775742 best_discrete=51.293240 hash=False elapsed=68.4s
step   750/900 tau=0.0539 loss=0.305751 mse_soft=0.305420 ent_in=0.8049 ent_out=0.3007 rowmax_in=0.6009 rowmax_out=0.8446 discrete_mse=127.267448 best_discrete=51.293240 hash=False elapsed=70.5s
step   775/900 tau=0.0489 loss=0.403515 mse_soft=0.403297 ent_in=0.5115 ent_out=0.2146 rowmax_in=0.7471 rowmax_out=0.8845 discrete_mse=28.950411 best_discrete=28.950411 hash=False elapsed=72.8s
step   800/900 tau=0.0443 loss=0.372116 mse_soft=0.371885 ent_in=0.5471 ent_out=0.2215 rowmax_in=0.7206 rowmax_out=0.8841 discrete_mse=58.275387 best_discrete=28.950411 hash=False elapsed=74.9s
step   825/900 tau=0.0402 loss=0.364783 mse_soft=0.364562 ent_in=0.5352 ent_out=0.2005 rowmax_in=0.7175 rowmax_out=0.8888 discrete_mse=7.574222 best_discrete=7.574222 hash=False elapsed=77.0s
step   850/900 tau=0.0365 loss=0.419441 mse_soft=0.419219 ent_in=0.5353 ent_out=0.2047 rowmax_in=0.7205 rowmax_out=0.8866 discrete_mse=29.489838 best_discrete=7.574222 hash=False elapsed=79.2s
step   875/900 tau=0.0331 loss=0.392183 mse_soft=0.391992 ent_in=0.4473 ent_out=0.1918 rowmax_in=0.7550 rowmax_out=0.8995 discrete_mse=25.135937 best_discrete=7.574222 hash=False elapsed=81.2s
step   900/900 tau=0.0300 loss=0.375970 mse_soft=0.375781 ent_in=0.4458 ent_out=0.1842 rowmax_in=0.7630 rowmax_out=0.8945 discrete_mse=29.215418 best_discrete=7.574222 hash=False elapsed=83.4s

Final metrics:
  soft_mse_full=0.384013
  rowmax_in_mean=0.7609
  rowmax_out_mean=0.8951
  ent_in_mean=0.4481
  ent_out_mean=0.1836
  final_discrete_mse=40.897449
  hash_match=False
  best_discrete_mse_seen=7.574222
Saved results to overnight_b178_j1.json
