Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.059822 mse_soft=1.057499 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=43.348194 best_discrete=43.348194 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.855940 mse_soft=0.853751 ent_in=3.6315 ent_out=3.6652 rowmax_in=0.0458 rowmax_out=0.0451 discrete_mse=14393.175781 best_discrete=43.348194 hash=False elapsed=2.9s
step    50/900 tau=0.8229 loss=0.641464 mse_soft=0.639566 ent_in=3.1242 ent_out=3.2039 rowmax_in=0.0898 rowmax_out=0.0910 discrete_mse=24725.724609 best_discrete=43.348194 hash=False elapsed=5.4s
step    75/900 tau=0.7450 loss=0.504328 mse_soft=0.502759 ent_in=2.5909 ent_out=2.6392 rowmax_in=0.1970 rowmax_out=0.2034 discrete_mse=3280.821777 best_discrete=43.348194 hash=False elapsed=7.9s
step   100/900 tau=0.6745 loss=0.401343 mse_soft=0.400173 ent_in=2.0250 ent_out=1.8754 rowmax_in=0.3398 rowmax_out=0.3972 discrete_mse=2182.748535 best_discrete=43.348194 hash=False elapsed=10.6s
step   125/900 tau=0.6107 loss=0.346464 mse_soft=0.345569 ent_in=1.6639 ent_out=1.3204 rowmax_in=0.4210 rowmax_out=0.5562 discrete_mse=424.949585 best_discrete=43.348194 hash=False elapsed=13.1s
step   150/900 tau=0.5529 loss=0.313902 mse_soft=0.313191 ent_in=1.4528 ent_out=0.9203 rowmax_in=0.4578 rowmax_out=0.6765 discrete_mse=429.255676 best_discrete=43.348194 hash=False elapsed=15.6s
step   175/900 tau=0.5006 loss=0.300040 mse_soft=0.299438 ent_in=1.3327 ent_out=0.6746 rowmax_in=0.4766 rowmax_out=0.7533 discrete_mse=302.731384 best_discrete=43.348194 hash=False elapsed=18.1s
step   200/900 tau=0.4532 loss=0.292715 mse_soft=0.292168 ent_in=1.2779 ent_out=0.5430 rowmax_in=0.4862 rowmax_out=0.7953 discrete_mse=425.546387 best_discrete=43.348194 hash=False elapsed=20.7s
step   225/900 tau=0.4103 loss=0.286964 mse_soft=0.286472 ent_in=1.2157 ent_out=0.4255 rowmax_in=0.5028 rowmax_out=0.8315 discrete_mse=152.912216 best_discrete=43.348194 hash=False elapsed=23.2s
step   250/900 tau=0.3715 loss=0.283757 mse_soft=0.283296 ent_in=1.1753 ent_out=0.3622 rowmax_in=0.5092 rowmax_out=0.8518 discrete_mse=131.239166 best_discrete=43.348194 hash=False elapsed=25.6s
step   275/900 tau=0.3363 loss=0.280123 mse_soft=0.279678 ent_in=1.1462 ent_out=0.3367 rowmax_in=0.5137 rowmax_out=0.8554 discrete_mse=56.493462 best_discrete=43.348194 hash=False elapsed=28.0s
step   300/900 tau=0.3045 loss=0.279165 mse_soft=0.278731 ent_in=1.1323 ent_out=0.3155 rowmax_in=0.5204 rowmax_out=0.8619 discrete_mse=17.464617 best_discrete=17.464617 hash=False elapsed=30.4s
step   325/900 tau=0.2756 loss=0.276857 mse_soft=0.276431 ent_in=1.1162 ent_out=0.3057 rowmax_in=0.5275 rowmax_out=0.8610 discrete_mse=17.464617 best_discrete=17.464617 hash=False elapsed=32.8s
step   350/900 tau=0.2496 loss=0.278544 mse_soft=0.278125 ent_in=1.0963 ent_out=0.3012 rowmax_in=0.5340 rowmax_out=0.8602 discrete_mse=10.600431 best_discrete=10.600431 hash=False elapsed=35.2s
step   375/900 tau=0.2259 loss=0.274959 mse_soft=0.274546 ent_in=1.0795 ent_out=0.2974 rowmax_in=0.5432 rowmax_out=0.8607 discrete_mse=10.600431 best_discrete=10.600431 hash=False elapsed=37.7s
step   400/900 tau=0.2046 loss=0.274594 mse_soft=0.274188 ent_in=1.0676 ent_out=0.2863 rowmax_in=0.5467 rowmax_out=0.8637 discrete_mse=43.956120 best_discrete=10.600431 hash=False elapsed=40.2s
step   425/900 tau=0.1852 loss=0.272279 mse_soft=0.271876 ent_in=1.0597 ent_out=0.2825 rowmax_in=0.5505 rowmax_out=0.8622 discrete_mse=85.281258 best_discrete=10.600431 hash=False elapsed=42.6s
step   450/900 tau=0.1677 loss=0.271095 mse_soft=0.270698 ent_in=1.0474 ent_out=0.2757 rowmax_in=0.5549 rowmax_out=0.8639 discrete_mse=85.281258 best_discrete=10.600431 hash=False elapsed=45.1s
step   475/900 tau=0.1518 loss=0.271002 mse_soft=0.270607 ent_in=1.0415 ent_out=0.2748 rowmax_in=0.5557 rowmax_out=0.8646 discrete_mse=85.281258 best_discrete=10.600431 hash=False elapsed=47.7s
step   500/900 tau=0.1374 loss=0.278103 mse_soft=0.277709 ent_in=1.0391 ent_out=0.2756 rowmax_in=0.5561 rowmax_out=0.8640 discrete_mse=85.281258 best_discrete=10.600431 hash=False elapsed=50.0s
step   525/900 tau=0.1244 loss=0.277469 mse_soft=0.277076 ent_in=1.0365 ent_out=0.2729 rowmax_in=0.5567 rowmax_out=0.8664 discrete_mse=85.281258 best_discrete=10.600431 hash=False elapsed=52.6s
step   550/900 tau=0.1126 loss=0.274564 mse_soft=0.274171 ent_in=1.0366 ent_out=0.2737 rowmax_in=0.5565 rowmax_out=0.8638 discrete_mse=85.281258 best_discrete=10.600431 hash=False elapsed=55.3s
step   575/900 tau=0.1020 loss=0.275484 mse_soft=0.275093 ent_in=1.0300 ent_out=0.2720 rowmax_in=0.5585 rowmax_out=0.8627 discrete_mse=215.676041 best_discrete=10.600431 hash=False elapsed=57.8s
step   600/900 tau=0.0923 loss=0.280393 mse_soft=0.280009 ent_in=1.0140 ent_out=0.2672 rowmax_in=0.5657 rowmax_out=0.8670 discrete_mse=104.773026 best_discrete=10.600431 hash=False elapsed=60.3s
step   625/900 tau=0.0836 loss=0.274236 mse_soft=0.273857 ent_in=1.0011 ent_out=0.2635 rowmax_in=0.5624 rowmax_out=0.8692 discrete_mse=104.773026 best_discrete=10.600431 hash=False elapsed=62.8s
step   650/900 tau=0.0757 loss=0.299573 mse_soft=0.299200 ent_in=0.9840 ent_out=0.2595 rowmax_in=0.5634 rowmax_out=0.8779 discrete_mse=211.782974 best_discrete=10.600431 hash=False elapsed=65.4s
step   675/900 tau=0.0685 loss=0.289089 mse_soft=0.288724 ent_in=0.9603 ent_out=0.2544 rowmax_in=0.5707 rowmax_out=0.8731 discrete_mse=52.983753 best_discrete=10.600431 hash=False elapsed=67.8s
step   700/900 tau=0.0620 loss=0.316675 mse_soft=0.316319 ent_in=0.9370 ent_out=0.2493 rowmax_in=0.5775 rowmax_out=0.8847 discrete_mse=45.640011 best_discrete=10.600431 hash=False elapsed=70.4s
step   725/900 tau=0.0562 loss=0.320509 mse_soft=0.320188 ent_in=0.8045 ent_out=0.2649 rowmax_in=0.6351 rowmax_out=0.8717 discrete_mse=17.455736 best_discrete=10.600431 hash=False elapsed=72.9s
step   750/900 tau=0.0508 loss=0.463175 mse_soft=0.463001 ent_in=0.5148 ent_out=0.0647 rowmax_in=0.7691 rowmax_out=0.9811 discrete_mse=3.320041 best_discrete=3.320041 hash=False elapsed=75.6s
step   775/900 tau=0.0460 loss=0.363914 mse_soft=0.363750 ent_in=0.4107 ent_out=0.1357 rowmax_in=0.8048 rowmax_out=0.9295 discrete_mse=4.297720 best_discrete=3.320041 hash=False elapsed=78.2s
step   800/900 tau=0.0417 loss=0.364080 mse_soft=0.363907 ent_in=0.4074 ent_out=0.1682 rowmax_in=0.8079 rowmax_out=0.9133 discrete_mse=3.365416 best_discrete=3.320041 hash=False elapsed=80.8s
step   825/900 tau=0.0377 loss=0.354847 mse_soft=0.354680 ent_in=0.4002 ent_out=0.1571 rowmax_in=0.8101 rowmax_out=0.9171 discrete_mse=1.815621 best_discrete=1.815621 hash=False elapsed=83.5s
step   850/900 tau=0.0342 loss=0.354746 mse_soft=0.354578 ent_in=0.4007 ent_out=0.1577 rowmax_in=0.8070 rowmax_out=0.9165 discrete_mse=1.815621 best_discrete=1.815621 hash=False elapsed=86.0s
step   875/900 tau=0.0309 loss=0.367400 mse_soft=0.367251 ent_in=0.3665 ent_out=0.1308 rowmax_in=0.8213 rowmax_out=0.9304 discrete_mse=0.894709 best_discrete=0.894709 hash=False elapsed=88.5s
step   900/900 tau=0.0280 loss=0.357888 mse_soft=0.357730 ent_in=0.3992 ent_out=0.1291 rowmax_in=0.7957 rowmax_out=0.9307 discrete_mse=11.298887 best_discrete=0.894709 hash=False elapsed=90.9s

Final metrics:
  soft_mse_full=0.369442
  rowmax_in_mean=0.7985
  rowmax_out_mean=0.9304
  ent_in_mean=0.3976
  ent_out_mean=0.1284
  final_discrete_mse=11.298887
  hash_match=False
  best_discrete_mse_seen=0.894709
Saved results to overnight_b171_j2.json
