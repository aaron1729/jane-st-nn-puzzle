Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.081047 mse_soft=1.078725 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=18.885044 best_discrete=18.885044 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.872424 mse_soft=0.870234 ent_in=3.6317 ent_out=3.6674 rowmax_in=0.0458 rowmax_out=0.0437 discrete_mse=1040.848633 best_discrete=18.885044 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.654886 mse_soft=0.652979 ent_in=3.1296 ent_out=3.2242 rowmax_in=0.0942 rowmax_out=0.0888 discrete_mse=1741.879395 best_discrete=18.885044 hash=False elapsed=5.0s
step    75/900 tau=0.7450 loss=0.513101 mse_soft=0.511530 ent_in=2.5849 ent_out=2.6548 rowmax_in=0.2032 rowmax_out=0.2045 discrete_mse=612.066589 best_discrete=18.885044 hash=False elapsed=7.6s
step   100/900 tau=0.6745 loss=0.405681 mse_soft=0.404518 ent_in=2.0019 ent_out=1.8750 rowmax_in=0.3461 rowmax_out=0.4046 discrete_mse=581.580505 best_discrete=18.885044 hash=False elapsed=10.1s
step   125/900 tau=0.6107 loss=0.343347 mse_soft=0.342493 ent_in=1.5689 ent_out=1.2796 rowmax_in=0.4458 rowmax_out=0.5683 discrete_mse=1649.409180 best_discrete=18.885044 hash=False elapsed=12.5s
step   150/900 tau=0.5529 loss=0.309655 mse_soft=0.309011 ent_in=1.3038 ent_out=0.8432 rowmax_in=0.5074 rowmax_out=0.7120 discrete_mse=598.632996 best_discrete=18.885044 hash=False elapsed=14.8s
step   175/900 tau=0.5006 loss=0.292760 mse_soft=0.292218 ent_in=1.2061 ent_out=0.6017 rowmax_in=0.5270 rowmax_out=0.7981 discrete_mse=390.415894 best_discrete=18.885044 hash=False elapsed=17.1s
step   200/900 tau=0.4532 loss=0.283904 mse_soft=0.283414 ent_in=1.1531 ent_out=0.4791 rowmax_in=0.5327 rowmax_out=0.8207 discrete_mse=847.632568 best_discrete=18.885044 hash=False elapsed=19.2s
step   225/900 tau=0.4103 loss=0.278344 mse_soft=0.277883 ent_in=1.1041 ent_out=0.4322 rowmax_in=0.5446 rowmax_out=0.8226 discrete_mse=1042.282349 best_discrete=18.885044 hash=False elapsed=21.5s
step   250/900 tau=0.3715 loss=0.274526 mse_soft=0.274093 ent_in=1.0748 ent_out=0.3701 rowmax_in=0.5461 rowmax_out=0.8427 discrete_mse=710.125061 best_discrete=18.885044 hash=False elapsed=24.0s
step   275/900 tau=0.3363 loss=0.273249 mse_soft=0.272827 ent_in=1.0614 ent_out=0.3453 rowmax_in=0.5480 rowmax_out=0.8492 discrete_mse=710.125061 best_discrete=18.885044 hash=False elapsed=26.2s
step   300/900 tau=0.3045 loss=0.272341 mse_soft=0.271928 ent_in=1.0502 ent_out=0.3245 rowmax_in=0.5482 rowmax_out=0.8564 discrete_mse=710.125061 best_discrete=18.885044 hash=False elapsed=28.4s
step   325/900 tau=0.2756 loss=0.271414 mse_soft=0.271008 ent_in=1.0372 ent_out=0.3161 rowmax_in=0.5549 rowmax_out=0.8596 discrete_mse=313.426331 best_discrete=18.885044 hash=False elapsed=30.8s
step   350/900 tau=0.2496 loss=0.269840 mse_soft=0.269439 ent_in=1.0335 ent_out=0.3025 rowmax_in=0.5564 rowmax_out=0.8646 discrete_mse=539.438782 best_discrete=18.885044 hash=False elapsed=33.2s
step   375/900 tau=0.2259 loss=0.270132 mse_soft=0.269734 ent_in=1.0312 ent_out=0.2936 rowmax_in=0.5553 rowmax_out=0.8678 discrete_mse=117.376419 best_discrete=18.885044 hash=False elapsed=35.6s
step   400/900 tau=0.2046 loss=0.268667 mse_soft=0.268276 ent_in=1.0234 ent_out=0.2816 rowmax_in=0.5571 rowmax_out=0.8709 discrete_mse=532.017822 best_discrete=18.885044 hash=False elapsed=38.2s
step   425/900 tau=0.1852 loss=0.267369 mse_soft=0.266981 ent_in=1.0209 ent_out=0.2726 rowmax_in=0.5574 rowmax_out=0.8726 discrete_mse=295.731415 best_discrete=18.885044 hash=False elapsed=40.4s
step   450/900 tau=0.1677 loss=0.266853 mse_soft=0.266467 ent_in=1.0220 ent_out=0.2662 rowmax_in=0.5577 rowmax_out=0.8737 discrete_mse=295.731415 best_discrete=18.885044 hash=False elapsed=42.8s
step   475/900 tau=0.1518 loss=0.266881 mse_soft=0.266496 ent_in=1.0217 ent_out=0.2630 rowmax_in=0.5570 rowmax_out=0.8742 discrete_mse=117.376419 best_discrete=18.885044 hash=False elapsed=45.1s
step   500/900 tau=0.1374 loss=0.267175 mse_soft=0.266790 ent_in=1.0232 ent_out=0.2623 rowmax_in=0.5558 rowmax_out=0.8737 discrete_mse=295.731415 best_discrete=18.885044 hash=False elapsed=47.6s
step   525/900 tau=0.1244 loss=0.269198 mse_soft=0.268814 ent_in=1.0214 ent_out=0.2608 rowmax_in=0.5567 rowmax_out=0.8742 discrete_mse=175.695084 best_discrete=18.885044 hash=False elapsed=50.0s
step   550/900 tau=0.1126 loss=0.272235 mse_soft=0.271852 ent_in=1.0205 ent_out=0.2573 rowmax_in=0.5566 rowmax_out=0.8747 discrete_mse=229.934662 best_discrete=18.885044 hash=False elapsed=52.5s
step   575/900 tau=0.1020 loss=0.282075 mse_soft=0.281691 ent_in=1.0225 ent_out=0.2569 rowmax_in=0.5539 rowmax_out=0.8746 discrete_mse=182.275040 best_discrete=18.885044 hash=False elapsed=54.8s
step   600/900 tau=0.0923 loss=0.269133 mse_soft=0.268752 ent_in=1.0156 ent_out=0.2545 rowmax_in=0.5570 rowmax_out=0.8733 discrete_mse=126.217262 best_discrete=18.885044 hash=False elapsed=57.1s
step   625/900 tau=0.0836 loss=0.273470 mse_soft=0.273092 ent_in=1.0071 ent_out=0.2520 rowmax_in=0.5593 rowmax_out=0.8732 discrete_mse=167.828125 best_discrete=18.885044 hash=False elapsed=59.2s
step   650/900 tau=0.0757 loss=0.275327 mse_soft=0.274945 ent_in=1.0144 ent_out=0.2561 rowmax_in=0.5541 rowmax_out=0.8695 discrete_mse=164.523346 best_discrete=18.885044 hash=False elapsed=61.4s
step   675/900 tau=0.0685 loss=0.276144 mse_soft=0.275764 ent_in=1.0129 ent_out=0.2561 rowmax_in=0.5544 rowmax_out=0.8700 discrete_mse=68.294640 best_discrete=18.885044 hash=False elapsed=63.6s
step   700/900 tau=0.0620 loss=0.287776 mse_soft=0.287397 ent_in=1.0060 ent_out=0.2569 rowmax_in=0.5566 rowmax_out=0.8689 discrete_mse=144.520737 best_discrete=18.885044 hash=False elapsed=65.8s
step   725/900 tau=0.0562 loss=0.282750 mse_soft=0.282373 ent_in=0.9885 ent_out=0.2662 rowmax_in=0.5625 rowmax_out=0.8662 discrete_mse=248.906464 best_discrete=18.885044 hash=False elapsed=68.0s
step   750/900 tau=0.0508 loss=0.319460 mse_soft=0.319178 ent_in=0.7510 ent_out=0.1904 rowmax_in=0.6367 rowmax_out=0.9086 discrete_mse=45.809372 best_discrete=18.885044 hash=False elapsed=70.2s
step   775/900 tau=0.0460 loss=0.298616 mse_soft=0.298326 ent_in=0.7453 ent_out=0.2221 rowmax_in=0.6207 rowmax_out=0.8776 discrete_mse=24.812059 best_discrete=18.885044 hash=False elapsed=72.5s
step   800/900 tau=0.0417 loss=0.293974 mse_soft=0.293686 ent_in=0.7406 ent_out=0.2196 rowmax_in=0.6234 rowmax_out=0.8852 discrete_mse=49.511585 best_discrete=18.885044 hash=False elapsed=74.7s
step   825/900 tau=0.0377 loss=0.300289 mse_soft=0.300004 ent_in=0.7416 ent_out=0.2091 rowmax_in=0.6232 rowmax_out=0.8955 discrete_mse=27.931818 best_discrete=18.885044 hash=False elapsed=77.0s
step   850/900 tau=0.0342 loss=0.495907 mse_soft=0.495795 ent_in=0.2756 ent_out=0.0984 rowmax_in=0.8474 rowmax_out=0.9550 discrete_mse=18.772934 best_discrete=18.772934 hash=False elapsed=79.4s
step   875/900 tau=0.0309 loss=0.486338 mse_soft=0.486231 ent_in=0.2839 ent_out=0.0743 rowmax_in=0.8493 rowmax_out=0.9737 discrete_mse=34.689018 best_discrete=18.772934 hash=False elapsed=81.7s
step   900/900 tau=0.0280 loss=0.482858 mse_soft=0.482743 ent_in=0.2971 ent_out=0.0860 rowmax_in=0.8441 rowmax_out=0.9665 discrete_mse=21.850533 best_discrete=18.772934 hash=False elapsed=83.9s

Final metrics:
  soft_mse_full=0.485499
  rowmax_in_mean=0.8406
  rowmax_out_mean=0.9658
  ent_in_mean=0.3022
  ent_out_mean=0.0866
  final_discrete_mse=21.850533
  hash_match=False
  best_discrete_mse_seen=18.772934
Saved results to overnight_b098_j2.json
