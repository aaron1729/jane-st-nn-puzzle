Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.059997 mse_soft=1.057674 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=18.111332 best_discrete=18.111332 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.858710 mse_soft=0.856520 ent_in=3.6355 ent_out=3.6652 rowmax_in=0.0458 rowmax_out=0.0445 discrete_mse=246.451843 best_discrete=18.111332 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.650307 mse_soft=0.648394 ent_in=3.1410 ent_out=3.2368 rowmax_in=0.0918 rowmax_out=0.0839 discrete_mse=1836.216919 best_discrete=18.111332 hash=False elapsed=4.7s
step    75/900 tau=0.7493 loss=0.515148 mse_soft=0.513560 ent_in=2.6061 ent_out=2.6873 rowmax_in=0.2110 rowmax_out=0.2027 discrete_mse=5.865830 best_discrete=5.865830 hash=False elapsed=7.0s
step   100/900 tau=0.6797 loss=0.420308 mse_soft=0.419105 ent_in=2.0546 ent_out=1.9532 rowmax_in=0.3441 rowmax_out=0.3766 discrete_mse=130.400787 best_discrete=5.865830 hash=False elapsed=9.0s
step   125/900 tau=0.6165 loss=0.347479 mse_soft=0.346649 ent_in=1.5766 ent_out=1.1897 rowmax_in=0.4615 rowmax_out=0.6291 discrete_mse=149.511902 best_discrete=5.865830 hash=False elapsed=11.1s
step   150/900 tau=0.5592 loss=0.311218 mse_soft=0.310594 ent_in=1.3651 ent_out=0.7128 rowmax_in=0.5063 rowmax_out=0.7733 discrete_mse=86.767174 best_discrete=5.865830 hash=False elapsed=13.0s
step   175/900 tau=0.5073 loss=0.293195 mse_soft=0.292679 ent_in=1.2186 ent_out=0.5018 rowmax_in=0.5258 rowmax_out=0.8415 discrete_mse=91.138123 best_discrete=5.865830 hash=False elapsed=15.0s
step   200/900 tau=0.4602 loss=0.284947 mse_soft=0.284464 ent_in=1.1503 ent_out=0.4613 rowmax_in=0.5406 rowmax_out=0.8345 discrete_mse=146.108322 best_discrete=5.865830 hash=False elapsed=17.0s
step   225/900 tau=0.4174 loss=0.279811 mse_soft=0.279349 ent_in=1.1107 ent_out=0.4310 rowmax_in=0.5467 rowmax_out=0.8418 discrete_mse=183.034317 best_discrete=5.865830 hash=False elapsed=19.3s
step   250/900 tau=0.3786 loss=0.276255 mse_soft=0.275812 ent_in=1.0833 ent_out=0.3938 rowmax_in=0.5485 rowmax_out=0.8575 discrete_mse=151.393021 best_discrete=5.865830 hash=False elapsed=21.4s
step   275/900 tau=0.3434 loss=0.273904 mse_soft=0.273475 ent_in=1.0707 ent_out=0.3606 rowmax_in=0.5456 rowmax_out=0.8675 discrete_mse=151.393021 best_discrete=5.865830 hash=False elapsed=23.5s
step   300/900 tau=0.3115 loss=0.271960 mse_soft=0.271541 ent_in=1.0562 ent_out=0.3401 rowmax_in=0.5489 rowmax_out=0.8728 discrete_mse=207.890198 best_discrete=5.865830 hash=False elapsed=25.7s
step   325/900 tau=0.2826 loss=0.271764 mse_soft=0.271351 ent_in=1.0501 ent_out=0.3264 rowmax_in=0.5490 rowmax_out=0.8753 discrete_mse=207.890198 best_discrete=5.865830 hash=False elapsed=28.0s
step   350/900 tau=0.2563 loss=0.273160 mse_soft=0.272753 ent_in=1.0411 ent_out=0.3160 rowmax_in=0.5517 rowmax_out=0.8774 discrete_mse=256.997833 best_discrete=5.865830 hash=False elapsed=30.3s
step   375/900 tau=0.2325 loss=0.271097 mse_soft=0.270693 ent_in=1.0334 ent_out=0.3118 rowmax_in=0.5527 rowmax_out=0.8783 discrete_mse=180.709244 best_discrete=5.865830 hash=False elapsed=32.6s
step   400/900 tau=0.2109 loss=0.273415 mse_soft=0.273012 ent_in=1.0303 ent_out=0.3125 rowmax_in=0.5528 rowmax_out=0.8764 discrete_mse=259.586029 best_discrete=5.865830 hash=False elapsed=34.9s
step   425/900 tau=0.1913 loss=0.273552 mse_soft=0.273150 ent_in=1.0275 ent_out=0.3108 rowmax_in=0.5506 rowmax_out=0.8764 discrete_mse=259.586029 best_discrete=5.865830 hash=False elapsed=37.2s
step   450/900 tau=0.1735 loss=0.271877 mse_soft=0.271477 ent_in=1.0250 ent_out=0.3101 rowmax_in=0.5491 rowmax_out=0.8759 discrete_mse=259.586029 best_discrete=5.865830 hash=False elapsed=39.5s
step   475/900 tau=0.1574 loss=0.271811 mse_soft=0.271410 ent_in=1.0253 ent_out=0.3116 rowmax_in=0.5468 rowmax_out=0.8758 discrete_mse=323.969940 best_discrete=5.865830 hash=False elapsed=41.7s
step   500/900 tau=0.1428 loss=0.268892 mse_soft=0.268492 ent_in=1.0222 ent_out=0.3117 rowmax_in=0.5471 rowmax_out=0.8746 discrete_mse=256.997833 best_discrete=5.865830 hash=False elapsed=43.6s
step   525/900 tau=0.1295 loss=0.273666 mse_soft=0.273270 ent_in=1.0191 ent_out=0.3024 rowmax_in=0.5473 rowmax_out=0.8776 discrete_mse=256.997833 best_discrete=5.865830 hash=False elapsed=45.5s
step   550/900 tau=0.1175 loss=0.269279 mse_soft=0.268890 ent_in=1.0144 ent_out=0.2836 rowmax_in=0.5452 rowmax_out=0.8818 discrete_mse=147.515396 best_discrete=5.865830 hash=False elapsed=47.7s
step   575/900 tau=0.1066 loss=0.270960 mse_soft=0.270577 ent_in=1.0096 ent_out=0.2675 rowmax_in=0.5447 rowmax_out=0.8861 discrete_mse=147.515396 best_discrete=5.865830 hash=False elapsed=50.1s
step   600/900 tau=0.0967 loss=0.271850 mse_soft=0.271472 ent_in=1.0011 ent_out=0.2578 rowmax_in=0.5468 rowmax_out=0.8885 discrete_mse=147.515396 best_discrete=5.865830 hash=False elapsed=52.1s
step   625/900 tau=0.0877 loss=0.274040 mse_soft=0.273668 ent_in=0.9911 ent_out=0.2493 rowmax_in=0.5474 rowmax_out=0.8912 discrete_mse=148.736053 best_discrete=5.865830 hash=False elapsed=54.0s
step   650/900 tau=0.0795 loss=0.273726 mse_soft=0.273363 ent_in=0.9722 ent_out=0.2390 rowmax_in=0.5577 rowmax_out=0.8909 discrete_mse=11.151752 best_discrete=5.865830 hash=False elapsed=56.2s
step   675/900 tau=0.0722 loss=0.280667 mse_soft=0.280318 ent_in=0.9316 ent_out=0.2335 rowmax_in=0.5691 rowmax_out=0.8879 discrete_mse=15.916325 best_discrete=5.865830 hash=False elapsed=58.5s
step   700/900 tau=0.0655 loss=0.282790 mse_soft=0.282443 ent_in=0.9343 ent_out=0.2221 rowmax_in=0.5639 rowmax_out=0.8985 discrete_mse=33.687641 best_discrete=5.865830 hash=False elapsed=60.7s
step   725/900 tau=0.0594 loss=0.280040 mse_soft=0.279697 ent_in=0.9254 ent_out=0.2189 rowmax_in=0.5687 rowmax_out=0.8950 discrete_mse=15.916325 best_discrete=5.865830 hash=False elapsed=62.8s
step   750/900 tau=0.0539 loss=0.353383 mse_soft=0.353061 ent_in=0.8651 ent_out=0.2065 rowmax_in=0.5839 rowmax_out=0.8961 discrete_mse=16.746481 best_discrete=5.865830 hash=False elapsed=64.8s
step   775/900 tau=0.0489 loss=0.329852 mse_soft=0.329612 ent_in=0.6095 ent_out=0.1897 rowmax_in=0.7180 rowmax_out=0.9048 discrete_mse=40.496948 best_discrete=5.865830 hash=False elapsed=66.9s
step   800/900 tau=0.0443 loss=0.317868 mse_soft=0.317619 ent_in=0.6235 ent_out=0.2069 rowmax_in=0.7027 rowmax_out=0.8938 discrete_mse=40.496948 best_discrete=5.865830 hash=False elapsed=69.1s
step   825/900 tau=0.0402 loss=0.311453 mse_soft=0.311199 ent_in=0.6452 ent_out=0.2013 rowmax_in=0.6869 rowmax_out=0.8946 discrete_mse=30.271524 best_discrete=5.865830 hash=False elapsed=71.5s
step   850/900 tau=0.0365 loss=0.307083 mse_soft=0.306821 ent_in=0.6581 ent_out=0.2152 rowmax_in=0.6753 rowmax_out=0.8869 discrete_mse=39.021545 best_discrete=5.865830 hash=False elapsed=73.9s
step   875/900 tau=0.0331 loss=0.529456 mse_soft=0.529248 ent_in=0.5066 ent_out=0.1857 rowmax_in=0.7828 rowmax_out=0.8981 discrete_mse=93.453445 best_discrete=5.865830 hash=False elapsed=76.2s
step   900/900 tau=0.0300 loss=0.459989 mse_soft=0.459847 ent_in=0.3021 ent_out=0.1718 rowmax_in=0.8547 rowmax_out=0.8983 discrete_mse=38.791328 best_discrete=5.865830 hash=False elapsed=78.6s

Final metrics:
  soft_mse_full=0.458972
  rowmax_in_mean=0.8529
  rowmax_out_mean=0.8969
  ent_in_mean=0.3056
  ent_out_mean=0.1766
  final_discrete_mse=38.791328
  hash_match=False
  best_discrete_mse_seen=5.865830
Saved results to overnight_b104_j1.json
