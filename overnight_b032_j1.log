Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.071773 mse_soft=1.069450 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=83.404572 best_discrete=83.404572 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.864093 mse_soft=0.861903 ent_in=3.6335 ent_out=3.6650 rowmax_in=0.0455 rowmax_out=0.0441 discrete_mse=3839.971924 best_discrete=83.404572 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.641259 mse_soft=0.639355 ent_in=3.1326 ent_out=3.2155 rowmax_in=0.0934 rowmax_out=0.0871 discrete_mse=8589.478516 best_discrete=83.404572 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.498778 mse_soft=0.497192 ent_in=2.6030 ent_out=2.6830 rowmax_in=0.2075 rowmax_out=0.2009 discrete_mse=4612.633301 best_discrete=83.404572 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.397989 mse_soft=0.396820 ent_in=2.0121 ent_out=1.8829 rowmax_in=0.3525 rowmax_out=0.4002 discrete_mse=65.956001 best_discrete=65.956001 hash=False elapsed=9.6s
step   125/900 tau=0.6165 loss=0.330535 mse_soft=0.329724 ent_in=1.6040 ent_out=1.1004 rowmax_in=0.4415 rowmax_out=0.6613 discrete_mse=225.427750 best_discrete=65.956001 hash=False elapsed=11.7s
step   150/900 tau=0.5592 loss=0.298165 mse_soft=0.297546 ent_in=1.4235 ent_out=0.6400 rowmax_in=0.4690 rowmax_out=0.7996 discrete_mse=46.805428 best_discrete=46.805428 hash=False elapsed=13.9s
step   175/900 tau=0.5073 loss=0.284136 mse_soft=0.283614 ent_in=1.2934 ent_out=0.4466 rowmax_in=0.4915 rowmax_out=0.8420 discrete_mse=69.966240 best_discrete=46.805428 hash=False elapsed=16.2s
step   200/900 tau=0.4602 loss=0.277388 mse_soft=0.276904 ent_in=1.2233 ent_out=0.3880 rowmax_in=0.5032 rowmax_out=0.8573 discrete_mse=84.902435 best_discrete=46.805428 hash=False elapsed=18.4s
step   225/900 tau=0.4174 loss=0.273207 mse_soft=0.272740 ent_in=1.1836 ent_out=0.3702 rowmax_in=0.5107 rowmax_out=0.8598 discrete_mse=41.329079 best_discrete=41.329079 hash=False elapsed=20.7s
step   250/900 tau=0.3786 loss=0.269288 mse_soft=0.268843 ent_in=1.1466 ent_out=0.3341 rowmax_in=0.5186 rowmax_out=0.8726 discrete_mse=77.591171 best_discrete=41.329079 hash=False elapsed=23.0s
step   275/900 tau=0.3434 loss=0.266689 mse_soft=0.266263 ent_in=1.1225 ent_out=0.2964 rowmax_in=0.5227 rowmax_out=0.8822 discrete_mse=58.279705 best_discrete=41.329079 hash=False elapsed=25.3s
step   300/900 tau=0.3115 loss=0.264328 mse_soft=0.263910 ent_in=1.1121 ent_out=0.2808 rowmax_in=0.5258 rowmax_out=0.8845 discrete_mse=63.599312 best_discrete=41.329079 hash=False elapsed=27.8s
step   325/900 tau=0.2826 loss=0.269907 mse_soft=0.269494 ent_in=1.1066 ent_out=0.2699 rowmax_in=0.5227 rowmax_out=0.8861 discrete_mse=63.599312 best_discrete=41.329079 hash=False elapsed=30.1s
step   350/900 tau=0.2563 loss=0.263539 mse_soft=0.263132 ent_in=1.1009 ent_out=0.2567 rowmax_in=0.5263 rowmax_out=0.8893 discrete_mse=63.599312 best_discrete=41.329079 hash=False elapsed=32.5s
step   375/900 tau=0.2325 loss=0.262095 mse_soft=0.261689 ent_in=1.1023 ent_out=0.2506 rowmax_in=0.5263 rowmax_out=0.8916 discrete_mse=77.591171 best_discrete=41.329079 hash=False elapsed=34.6s
step   400/900 tau=0.2109 loss=0.265444 mse_soft=0.265042 ent_in=1.0993 ent_out=0.2433 rowmax_in=0.5265 rowmax_out=0.8923 discrete_mse=77.591171 best_discrete=41.329079 hash=False elapsed=36.7s
step   425/900 tau=0.1913 loss=0.261273 mse_soft=0.260872 ent_in=1.0975 ent_out=0.2398 rowmax_in=0.5281 rowmax_out=0.8930 discrete_mse=47.506744 best_discrete=41.329079 hash=False elapsed=38.9s
step   450/900 tau=0.1735 loss=0.260987 mse_soft=0.260588 ent_in=1.0947 ent_out=0.2342 rowmax_in=0.5285 rowmax_out=0.8942 discrete_mse=47.506744 best_discrete=41.329079 hash=False elapsed=41.3s
step   475/900 tau=0.1574 loss=0.264555 mse_soft=0.264162 ent_in=1.0878 ent_out=0.2220 rowmax_in=0.5319 rowmax_out=0.8972 discrete_mse=41.634903 best_discrete=41.329079 hash=False elapsed=43.5s
step   500/900 tau=0.1428 loss=0.261263 mse_soft=0.260870 ent_in=1.0867 ent_out=0.2222 rowmax_in=0.5302 rowmax_out=0.8994 discrete_mse=44.257557 best_discrete=41.329079 hash=False elapsed=45.8s
step   525/900 tau=0.1295 loss=0.265856 mse_soft=0.265464 ent_in=1.0910 ent_out=0.2169 rowmax_in=0.5285 rowmax_out=0.8991 discrete_mse=33.197739 best_discrete=33.197739 hash=False elapsed=48.1s
step   550/900 tau=0.1175 loss=0.263851 mse_soft=0.263461 ent_in=1.0873 ent_out=0.2122 rowmax_in=0.5294 rowmax_out=0.9008 discrete_mse=41.831139 best_discrete=33.197739 hash=False elapsed=50.4s
step   575/900 tau=0.1066 loss=0.269676 mse_soft=0.269288 ent_in=1.0830 ent_out=0.2105 rowmax_in=0.5310 rowmax_out=0.9014 discrete_mse=41.831139 best_discrete=33.197739 hash=False elapsed=52.7s
step   600/900 tau=0.0967 loss=0.263018 mse_soft=0.262632 ent_in=1.0824 ent_out=0.2064 rowmax_in=0.5264 rowmax_out=0.9014 discrete_mse=41.831139 best_discrete=33.197739 hash=False elapsed=55.2s
step   625/900 tau=0.0877 loss=0.276223 mse_soft=0.275841 ent_in=1.0731 ent_out=0.2032 rowmax_in=0.5279 rowmax_out=0.9013 discrete_mse=21.632477 best_discrete=21.632477 hash=False elapsed=57.6s
step   650/900 tau=0.0795 loss=0.276606 mse_soft=0.276226 ent_in=1.0657 ent_out=0.2015 rowmax_in=0.5300 rowmax_out=0.9018 discrete_mse=21.632477 best_discrete=21.632477 hash=False elapsed=60.0s
step   675/900 tau=0.0722 loss=0.265049 mse_soft=0.264675 ent_in=1.0494 ent_out=0.1987 rowmax_in=0.5387 rowmax_out=0.9043 discrete_mse=22.606178 best_discrete=21.632477 hash=False elapsed=62.2s
step   700/900 tau=0.0655 loss=0.293479 mse_soft=0.293111 ent_in=1.0325 ent_out=0.1927 rowmax_in=0.5441 rowmax_out=0.9054 discrete_mse=34.045948 best_discrete=21.632477 hash=False elapsed=64.3s
step   725/900 tau=0.0594 loss=0.277088 mse_soft=0.276738 ent_in=0.9818 ent_out=0.1852 rowmax_in=0.5557 rowmax_out=0.9080 discrete_mse=19.406107 best_discrete=19.406107 hash=False elapsed=66.6s
step   750/900 tau=0.0539 loss=0.333044 mse_soft=0.332762 ent_in=0.7934 ent_out=0.1483 rowmax_in=0.6247 rowmax_out=0.9173 discrete_mse=36.856617 best_discrete=19.406107 hash=False elapsed=68.8s
step   775/900 tau=0.0489 loss=0.286104 mse_soft=0.285817 ent_in=0.7924 ent_out=0.1649 rowmax_in=0.6255 rowmax_out=0.9085 discrete_mse=67.678864 best_discrete=19.406107 hash=False elapsed=71.0s
step   800/900 tau=0.0443 loss=0.280645 mse_soft=0.280364 ent_in=0.7806 ent_out=0.1575 rowmax_in=0.6263 rowmax_out=0.9110 discrete_mse=71.129570 best_discrete=19.406107 hash=False elapsed=73.2s
step   825/900 tau=0.0402 loss=0.320582 mse_soft=0.320345 ent_in=0.6347 ent_out=0.1565 rowmax_in=0.6930 rowmax_out=0.9112 discrete_mse=37.299606 best_discrete=19.406107 hash=False elapsed=75.3s
step   850/900 tau=0.0365 loss=0.301179 mse_soft=0.300932 ent_in=0.6610 ent_out=0.1609 rowmax_in=0.6518 rowmax_out=0.9112 discrete_mse=54.836872 best_discrete=19.406107 hash=False elapsed=77.4s
step   875/900 tau=0.0331 loss=0.292127 mse_soft=0.291881 ent_in=0.6631 ent_out=0.1563 rowmax_in=0.6536 rowmax_out=0.9140 discrete_mse=16.688318 best_discrete=16.688318 hash=False elapsed=79.5s
step   900/900 tau=0.0300 loss=0.312647 mse_soft=0.312422 ent_in=0.5902 ent_out=0.1609 rowmax_in=0.6929 rowmax_out=0.9112 discrete_mse=38.627682 best_discrete=16.688318 hash=False elapsed=81.6s

Final metrics:
  soft_mse_full=0.333435
  rowmax_in_mean=0.6908
  rowmax_out_mean=0.9108
  ent_in_mean=0.5891
  ent_out_mean=0.1612
  final_discrete_mse=73.638611
  hash_match=False
  best_discrete_mse_seen=16.688318
Saved results to overnight_b032_j1.json
