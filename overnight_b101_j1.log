Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.054195 mse_soft=1.051872 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=115.939423 best_discrete=115.939423 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.854400 mse_soft=0.852211 ent_in=3.6331 ent_out=3.6661 rowmax_in=0.0460 rowmax_out=0.0447 discrete_mse=641.294983 best_discrete=115.939423 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.646827 mse_soft=0.644920 ent_in=3.1320 ent_out=3.2251 rowmax_in=0.0923 rowmax_out=0.0873 discrete_mse=1335.333374 best_discrete=115.939423 hash=False elapsed=4.8s
step    75/900 tau=0.7493 loss=0.505256 mse_soft=0.503681 ent_in=2.5995 ent_out=2.6507 rowmax_in=0.2020 rowmax_out=0.2020 discrete_mse=1111.848389 best_discrete=115.939423 hash=False elapsed=7.1s
step   100/900 tau=0.6797 loss=0.397465 mse_soft=0.396311 ent_in=2.0258 ent_out=1.8220 rowmax_in=0.3418 rowmax_out=0.4254 discrete_mse=3422.203857 best_discrete=115.939423 hash=False elapsed=9.3s
step   125/900 tau=0.6165 loss=0.340609 mse_soft=0.339773 ent_in=1.6671 ent_out=1.1222 rowmax_in=0.4161 rowmax_out=0.6305 discrete_mse=360.413818 best_discrete=115.939423 hash=False elapsed=11.5s
step   150/900 tau=0.5592 loss=0.317327 mse_soft=0.316660 ent_in=1.4791 ent_out=0.7445 rowmax_in=0.4463 rowmax_out=0.7439 discrete_mse=288.666229 best_discrete=115.939423 hash=False elapsed=13.8s
step   175/900 tau=0.5073 loss=0.303593 mse_soft=0.303019 ent_in=1.3520 ent_out=0.5636 rowmax_in=0.4693 rowmax_out=0.7847 discrete_mse=577.363464 best_discrete=115.939423 hash=False elapsed=16.0s
step   200/900 tau=0.4602 loss=0.296056 mse_soft=0.295526 ent_in=1.2922 ent_out=0.4752 rowmax_in=0.4801 rowmax_out=0.8149 discrete_mse=1836.384399 best_discrete=115.939423 hash=False elapsed=18.4s
step   225/900 tau=0.4174 loss=0.289262 mse_soft=0.288763 ent_in=1.2590 ent_out=0.4029 rowmax_in=0.4858 rowmax_out=0.8401 discrete_mse=705.613159 best_discrete=115.939423 hash=False elapsed=20.7s
step   250/900 tau=0.3786 loss=0.285424 mse_soft=0.284945 ent_in=1.2317 ent_out=0.3651 rowmax_in=0.4925 rowmax_out=0.8472 discrete_mse=705.613159 best_discrete=115.939423 hash=False elapsed=23.1s
step   275/900 tau=0.3434 loss=0.282317 mse_soft=0.281850 ent_in=1.1996 ent_out=0.3566 rowmax_in=0.4970 rowmax_out=0.8463 discrete_mse=772.637695 best_discrete=115.939423 hash=False elapsed=25.2s
step   300/900 tau=0.3115 loss=0.280676 mse_soft=0.280223 ent_in=1.1778 ent_out=0.3305 rowmax_in=0.5023 rowmax_out=0.8520 discrete_mse=591.114380 best_discrete=115.939423 hash=False elapsed=27.4s
step   325/900 tau=0.2826 loss=0.279006 mse_soft=0.278567 ent_in=1.1614 ent_out=0.3025 rowmax_in=0.5067 rowmax_out=0.8605 discrete_mse=714.281006 best_discrete=115.939423 hash=False elapsed=29.7s
step   350/900 tau=0.2563 loss=0.275415 mse_soft=0.274991 ent_in=1.1397 ent_out=0.2714 rowmax_in=0.5144 rowmax_out=0.8774 discrete_mse=819.479492 best_discrete=115.939423 hash=False elapsed=31.9s
step   375/900 tau=0.2325 loss=0.274481 mse_soft=0.274069 ent_in=1.1168 ent_out=0.2557 rowmax_in=0.5194 rowmax_out=0.8859 discrete_mse=531.894531 best_discrete=115.939423 hash=False elapsed=34.0s
step   400/900 tau=0.2109 loss=0.274816 mse_soft=0.274406 ent_in=1.1171 ent_out=0.2496 rowmax_in=0.5160 rowmax_out=0.8886 discrete_mse=531.894531 best_discrete=115.939423 hash=False elapsed=36.3s
step   425/900 tau=0.1913 loss=0.274899 mse_soft=0.274490 ent_in=1.1147 ent_out=0.2477 rowmax_in=0.5175 rowmax_out=0.8895 discrete_mse=581.497070 best_discrete=115.939423 hash=False elapsed=38.4s
step   450/900 tau=0.1735 loss=0.274343 mse_soft=0.273943 ent_in=1.1062 ent_out=0.2284 rowmax_in=0.5237 rowmax_out=0.8995 discrete_mse=581.497070 best_discrete=115.939423 hash=False elapsed=40.6s
step   475/900 tau=0.1574 loss=0.276901 mse_soft=0.276507 ent_in=1.1041 ent_out=0.2103 rowmax_in=0.5251 rowmax_out=0.9083 discrete_mse=581.497070 best_discrete=115.939423 hash=False elapsed=42.7s
step   500/900 tau=0.1428 loss=0.275513 mse_soft=0.275119 ent_in=1.1067 ent_out=0.2086 rowmax_in=0.5228 rowmax_out=0.9080 discrete_mse=581.497070 best_discrete=115.939423 hash=False elapsed=45.1s
step   525/900 tau=0.1295 loss=0.273507 mse_soft=0.273112 ent_in=1.1071 ent_out=0.2109 rowmax_in=0.5219 rowmax_out=0.9059 discrete_mse=273.216156 best_discrete=115.939423 hash=False elapsed=47.3s
step   550/900 tau=0.1175 loss=0.277542 mse_soft=0.277147 ent_in=1.1059 ent_out=0.2105 rowmax_in=0.5211 rowmax_out=0.9055 discrete_mse=581.497070 best_discrete=115.939423 hash=False elapsed=49.5s
step   575/900 tau=0.1066 loss=0.277220 mse_soft=0.276826 ent_in=1.1049 ent_out=0.2095 rowmax_in=0.5233 rowmax_out=0.9066 discrete_mse=581.497070 best_discrete=115.939423 hash=False elapsed=52.0s
step   600/900 tau=0.0967 loss=0.277760 mse_soft=0.277363 ent_in=1.1119 ent_out=0.2120 rowmax_in=0.5166 rowmax_out=0.9027 discrete_mse=273.216156 best_discrete=115.939423 hash=False elapsed=54.1s
step   625/900 tau=0.0877 loss=0.283020 mse_soft=0.282630 ent_in=1.0983 ent_out=0.2022 rowmax_in=0.5262 rowmax_out=0.9111 discrete_mse=466.297729 best_discrete=115.939423 hash=False elapsed=56.3s
step   650/900 tau=0.0795 loss=0.291054 mse_soft=0.290666 ent_in=1.0832 ent_out=0.2087 rowmax_in=0.5293 rowmax_out=0.9030 discrete_mse=577.984192 best_discrete=115.939423 hash=False elapsed=58.6s
step   675/900 tau=0.0722 loss=0.287220 mse_soft=0.286843 ent_in=1.0564 ent_out=0.2015 rowmax_in=0.5344 rowmax_out=0.9059 discrete_mse=152.692764 best_discrete=115.939423 hash=False elapsed=61.0s
step   700/900 tau=0.0655 loss=0.281815 mse_soft=0.281436 ent_in=1.0686 ent_out=0.1942 rowmax_in=0.5310 rowmax_out=0.9154 discrete_mse=168.394119 best_discrete=115.939423 hash=False elapsed=63.2s
step   725/900 tau=0.0594 loss=0.327215 mse_soft=0.326878 ent_in=0.9517 ent_out=0.1714 rowmax_in=0.5809 rowmax_out=0.9251 discrete_mse=477.552032 best_discrete=115.939423 hash=False elapsed=65.4s
step   750/900 tau=0.0539 loss=0.516933 mse_soft=0.516762 ent_in=0.4640 ent_out=0.1080 rowmax_in=0.8050 rowmax_out=0.9544 discrete_mse=18.903494 best_discrete=18.903494 hash=False elapsed=67.6s
step   775/900 tau=0.0489 loss=0.413680 mse_soft=0.413532 ent_in=0.3779 ent_out=0.1139 rowmax_in=0.8199 rowmax_out=0.9444 discrete_mse=1.044281 best_discrete=1.044281 hash=False elapsed=69.8s
step   800/900 tau=0.0443 loss=0.382109 mse_soft=0.381959 ent_in=0.3552 ent_out=0.1424 rowmax_in=0.8148 rowmax_out=0.9290 discrete_mse=0.856539 best_discrete=0.856539 hash=False elapsed=71.9s
step   825/900 tau=0.0402 loss=0.395499 mse_soft=0.395359 ent_in=0.3515 ent_out=0.1130 rowmax_in=0.8257 rowmax_out=0.9428 discrete_mse=1.044281 best_discrete=0.856539 hash=False elapsed=74.0s
step   850/900 tau=0.0365 loss=0.381753 mse_soft=0.381613 ent_in=0.3548 ent_out=0.1151 rowmax_in=0.8156 rowmax_out=0.9426 discrete_mse=4.920998 best_discrete=0.856539 hash=False elapsed=76.2s
step   875/900 tau=0.0331 loss=0.550247 mse_soft=0.550090 ent_in=0.3830 ent_out=0.1426 rowmax_in=0.7960 rowmax_out=0.9243 discrete_mse=1.175199 best_discrete=0.856539 hash=False elapsed=78.5s
step   900/900 tau=0.0300 loss=0.430029 mse_soft=0.429909 ent_in=0.3033 ent_out=0.0952 rowmax_in=0.8540 rowmax_out=0.9510 discrete_mse=3.842077 best_discrete=0.856539 hash=False elapsed=80.6s

Final metrics:
  soft_mse_full=0.426219
  rowmax_in_mean=0.8514
  rowmax_out_mean=0.9509
  ent_in_mean=0.3055
  ent_out_mean=0.0950
  final_discrete_mse=3.842077
  hash_match=False
  best_discrete_mse_seen=0.856539
Saved results to overnight_b101_j1.json
