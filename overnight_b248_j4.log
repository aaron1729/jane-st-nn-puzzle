Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.015
step     1/700 tau=1.0000 loss=1.064180 mse_soft=1.063405 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=81.686104 best_discrete=81.686104 hash=False elapsed=0.5s
step    25/700 tau=0.8810 loss=0.971790 mse_soft=0.971030 ent_in=3.7933 ent_out=3.8053 rowmax_in=0.0332 rowmax_out=0.0323 discrete_mse=4102.314941 best_discrete=81.686104 hash=False elapsed=2.6s
step    50/700 tau=0.7721 loss=0.785446 mse_soft=0.784738 ent_in=3.5141 ent_out=3.5645 rowmax_in=0.0578 rowmax_out=0.0546 discrete_mse=5066.291504 best_discrete=81.686104 hash=False elapsed=4.6s
step    75/700 tau=0.6767 loss=0.642080 mse_soft=0.641444 ent_in=3.1277 ent_out=3.2259 rowmax_in=0.0982 rowmax_out=0.0908 discrete_mse=3658.601562 best_discrete=81.686104 hash=False elapsed=6.7s
step   100/700 tau=0.5931 loss=0.533610 mse_soft=0.533056 ent_in=2.7207 ent_out=2.8174 rowmax_in=0.1781 rowmax_out=0.1672 discrete_mse=679.438110 best_discrete=81.686104 hash=False elapsed=9.1s
step   125/700 tau=0.5198 loss=0.433768 mse_soft=0.433335 ent_in=2.1931 ent_out=2.1400 rowmax_in=0.2993 rowmax_out=0.3251 discrete_mse=849.409790 best_discrete=81.686104 hash=False elapsed=11.5s
step   150/700 tau=0.4555 loss=0.360943 mse_soft=0.360636 ent_in=1.6531 ent_out=1.4159 rowmax_in=0.4302 rowmax_out=0.5458 discrete_mse=485.195587 best_discrete=81.686104 hash=False elapsed=13.7s
step   175/700 tau=0.3992 loss=0.324761 mse_soft=0.324530 ent_in=1.3572 ent_out=0.9536 rowmax_in=0.4945 rowmax_out=0.6897 discrete_mse=182.833145 best_discrete=81.686104 hash=False elapsed=15.9s
step   200/700 tau=0.3499 loss=0.306740 mse_soft=0.306547 ent_in=1.2150 ent_out=0.7199 rowmax_in=0.5271 rowmax_out=0.7281 discrete_mse=79.248344 best_discrete=79.248344 hash=False elapsed=18.0s
step   225/700 tau=0.3066 loss=0.294408 mse_soft=0.294235 ent_in=1.1580 ent_out=0.5641 rowmax_in=0.5304 rowmax_out=0.7660 discrete_mse=78.533966 best_discrete=78.533966 hash=False elapsed=20.4s
step   250/700 tau=0.2687 loss=0.288711 mse_soft=0.288549 ent_in=1.1113 ent_out=0.5052 rowmax_in=0.5328 rowmax_out=0.7894 discrete_mse=43.808548 best_discrete=43.808548 hash=False elapsed=22.5s
step   275/700 tau=0.2355 loss=0.285349 mse_soft=0.285193 ent_in=1.0759 ent_out=0.4799 rowmax_in=0.5367 rowmax_out=0.7936 discrete_mse=95.749489 best_discrete=43.808548 hash=False elapsed=24.8s
step   300/700 tau=0.2064 loss=0.282053 mse_soft=0.281902 ent_in=1.0613 ent_out=0.4500 rowmax_in=0.5336 rowmax_out=0.8087 discrete_mse=67.795914 best_discrete=43.808548 hash=False elapsed=27.1s
step   325/700 tau=0.1809 loss=0.280572 mse_soft=0.280427 ent_in=1.0433 ent_out=0.4127 rowmax_in=0.5374 rowmax_out=0.8175 discrete_mse=30.948711 best_discrete=30.948711 hash=False elapsed=29.4s
step   350/700 tau=0.1585 loss=0.278101 mse_soft=0.277960 ent_in=1.0200 ent_out=0.3947 rowmax_in=0.5432 rowmax_out=0.8239 discrete_mse=64.867310 best_discrete=30.948711 hash=False elapsed=31.9s
step   375/700 tau=0.1389 loss=0.275275 mse_soft=0.275136 ent_in=1.0047 ent_out=0.3804 rowmax_in=0.5462 rowmax_out=0.8277 discrete_mse=64.867310 best_discrete=30.948711 hash=False elapsed=34.2s
step   400/700 tau=0.1218 loss=0.274487 mse_soft=0.274351 ent_in=0.9954 ent_out=0.3661 rowmax_in=0.5512 rowmax_out=0.8336 discrete_mse=57.951336 best_discrete=30.948711 hash=False elapsed=36.5s
step   425/700 tau=0.1067 loss=0.272919 mse_soft=0.272785 ent_in=0.9886 ent_out=0.3571 rowmax_in=0.5534 rowmax_out=0.8359 discrete_mse=57.951336 best_discrete=30.948711 hash=False elapsed=38.9s
step   450/700 tau=0.0935 loss=0.273534 mse_soft=0.273401 ent_in=0.9799 ent_out=0.3510 rowmax_in=0.5548 rowmax_out=0.8389 discrete_mse=136.996170 best_discrete=30.948711 hash=False elapsed=41.2s
step   475/700 tau=0.0820 loss=0.274550 mse_soft=0.274418 ent_in=0.9760 ent_out=0.3482 rowmax_in=0.5541 rowmax_out=0.8388 discrete_mse=57.951336 best_discrete=30.948711 hash=False elapsed=43.7s
step   500/700 tau=0.0718 loss=0.275423 mse_soft=0.275291 ent_in=0.9729 ent_out=0.3434 rowmax_in=0.5531 rowmax_out=0.8379 discrete_mse=88.869827 best_discrete=30.948711 hash=False elapsed=45.8s
step   525/700 tau=0.0630 loss=0.272507 mse_soft=0.272377 ent_in=0.9694 ent_out=0.3335 rowmax_in=0.5570 rowmax_out=0.8450 discrete_mse=89.506317 best_discrete=30.948711 hash=False elapsed=48.0s
step   550/700 tau=0.0552 loss=0.288369 mse_soft=0.288243 ent_in=0.9571 ent_out=0.3037 rowmax_in=0.5695 rowmax_out=0.8615 discrete_mse=92.643776 best_discrete=30.948711 hash=False elapsed=50.2s
step   575/700 tau=0.0484 loss=0.288238 mse_soft=0.288110 ent_in=0.9450 ent_out=0.3306 rowmax_in=0.5672 rowmax_out=0.8427 discrete_mse=162.163849 best_discrete=30.948711 hash=False elapsed=52.6s
step   600/700 tau=0.0424 loss=0.275843 mse_soft=0.275718 ent_in=0.9418 ent_out=0.3113 rowmax_in=0.5665 rowmax_out=0.8517 discrete_mse=184.060913 best_discrete=30.948711 hash=False elapsed=54.8s
step   625/700 tau=0.0371 loss=0.278984 mse_soft=0.278862 ent_in=0.9200 ent_out=0.3045 rowmax_in=0.5756 rowmax_out=0.8499 discrete_mse=44.001541 best_discrete=30.948711 hash=False elapsed=56.8s
step   650/700 tau=0.0325 loss=0.451432 mse_soft=0.451320 ent_in=0.8511 ent_out=0.2696 rowmax_in=0.5969 rowmax_out=0.8458 discrete_mse=134.298889 best_discrete=30.948711 hash=False elapsed=58.9s
step   675/700 tau=0.0285 loss=0.313371 mse_soft=0.313279 ent_in=0.7040 ent_out=0.2161 rowmax_in=0.6667 rowmax_out=0.8822 discrete_mse=98.504311 best_discrete=30.948711 hash=False elapsed=60.9s
step   700/700 tau=0.0250 loss=0.331718 mse_soft=0.331628 ent_in=0.7005 ent_out=0.1977 rowmax_in=0.6666 rowmax_out=0.8891 discrete_mse=18.768684 best_discrete=18.768684 hash=False elapsed=62.9s

Final metrics:
  soft_mse_full=0.342783
  rowmax_in_mean=0.6939
  rowmax_out_mean=0.8893
  ent_in_mean=0.6600
  ent_out_mean=0.1974
  final_discrete_mse=18.768684
  hash_match=False
  best_discrete_mse_seen=18.768684
Saved results to overnight_b248_j4.json
