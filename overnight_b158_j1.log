Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.069013 mse_soft=1.066690 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=5.879698 best_discrete=5.879698 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.865927 mse_soft=0.863737 ent_in=3.6349 ent_out=3.6675 rowmax_in=0.0459 rowmax_out=0.0442 discrete_mse=3370.042236 best_discrete=5.879698 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.657434 mse_soft=0.655524 ent_in=3.1382 ent_out=3.2280 rowmax_in=0.0952 rowmax_out=0.0873 discrete_mse=477.961578 best_discrete=5.879698 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.524360 mse_soft=0.522755 ent_in=2.6408 ent_out=2.7103 rowmax_in=0.2034 rowmax_out=0.2002 discrete_mse=6035.878906 best_discrete=5.879698 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.415500 mse_soft=0.414338 ent_in=2.0330 ent_out=1.8409 rowmax_in=0.3548 rowmax_out=0.4262 discrete_mse=2944.777100 best_discrete=5.879698 hash=False elapsed=9.4s
step   125/900 tau=0.6165 loss=0.347185 mse_soft=0.346345 ent_in=1.6201 ent_out=1.1808 rowmax_in=0.4514 rowmax_out=0.6066 discrete_mse=1540.058105 best_discrete=5.879698 hash=False elapsed=11.3s
step   150/900 tau=0.5592 loss=0.322157 mse_soft=0.321435 ent_in=1.4618 ent_out=0.9466 rowmax_in=0.4762 rowmax_out=0.6635 discrete_mse=2678.882324 best_discrete=5.879698 hash=False elapsed=13.3s
step   175/900 tau=0.5073 loss=0.304805 mse_soft=0.304169 ent_in=1.3321 ent_out=0.7876 rowmax_in=0.4986 rowmax_out=0.7081 discrete_mse=1408.776733 best_discrete=5.879698 hash=False elapsed=15.4s
step   200/900 tau=0.4602 loss=0.296528 mse_soft=0.295934 ent_in=1.2815 ent_out=0.7010 rowmax_in=0.5043 rowmax_out=0.7325 discrete_mse=937.298401 best_discrete=5.879698 hash=False elapsed=17.7s
step   225/900 tau=0.4174 loss=0.293933 mse_soft=0.293367 ent_in=1.2454 ent_out=0.6403 rowmax_in=0.5073 rowmax_out=0.7484 discrete_mse=926.515869 best_discrete=5.879698 hash=False elapsed=20.0s
step   250/900 tau=0.3786 loss=0.289617 mse_soft=0.289074 ent_in=1.2162 ent_out=0.5952 rowmax_in=0.5112 rowmax_out=0.7641 discrete_mse=612.667969 best_discrete=5.879698 hash=False elapsed=22.0s
step   275/900 tau=0.3434 loss=0.284003 mse_soft=0.283478 ent_in=1.1963 ent_out=0.5555 rowmax_in=0.5123 rowmax_out=0.7791 discrete_mse=612.667969 best_discrete=5.879698 hash=False elapsed=24.3s
step   300/900 tau=0.3115 loss=0.285090 mse_soft=0.284578 ent_in=1.1814 ent_out=0.5239 rowmax_in=0.5130 rowmax_out=0.7889 discrete_mse=612.667969 best_discrete=5.879698 hash=False elapsed=26.5s
step   325/900 tau=0.2826 loss=0.280278 mse_soft=0.279781 ent_in=1.1604 ent_out=0.4980 rowmax_in=0.5163 rowmax_out=0.7986 discrete_mse=612.667969 best_discrete=5.879698 hash=False elapsed=28.7s
step   350/900 tau=0.2563 loss=0.284673 mse_soft=0.284187 ent_in=1.1471 ent_out=0.4713 rowmax_in=0.5182 rowmax_out=0.8079 discrete_mse=942.835388 best_discrete=5.879698 hash=False elapsed=30.9s
step   375/900 tau=0.2325 loss=0.280409 mse_soft=0.279929 ent_in=1.1380 ent_out=0.4622 rowmax_in=0.5191 rowmax_out=0.8078 discrete_mse=942.835388 best_discrete=5.879698 hash=False elapsed=33.1s
step   400/900 tau=0.2109 loss=0.285542 mse_soft=0.285065 ent_in=1.1311 ent_out=0.4574 rowmax_in=0.5190 rowmax_out=0.8080 discrete_mse=942.835388 best_discrete=5.879698 hash=False elapsed=35.4s
step   425/900 tau=0.1913 loss=0.280214 mse_soft=0.279739 ent_in=1.1267 ent_out=0.4544 rowmax_in=0.5193 rowmax_out=0.8082 discrete_mse=1324.748779 best_discrete=5.879698 hash=False elapsed=37.5s
step   450/900 tau=0.1735 loss=0.283771 mse_soft=0.283299 ent_in=1.1220 ent_out=0.4524 rowmax_in=0.5214 rowmax_out=0.8097 discrete_mse=1324.748779 best_discrete=5.879698 hash=False elapsed=39.7s
step   475/900 tau=0.1574 loss=0.289773 mse_soft=0.289302 ent_in=1.1195 ent_out=0.4491 rowmax_in=0.5195 rowmax_out=0.8093 discrete_mse=1324.748779 best_discrete=5.879698 hash=False elapsed=41.9s
step   500/900 tau=0.1428 loss=0.281334 mse_soft=0.280866 ent_in=1.1143 ent_out=0.4451 rowmax_in=0.5225 rowmax_out=0.8127 discrete_mse=300.105255 best_discrete=5.879698 hash=False elapsed=44.2s
step   525/900 tau=0.1295 loss=0.289692 mse_soft=0.289236 ent_in=1.1039 ent_out=0.4172 rowmax_in=0.5250 rowmax_out=0.8192 discrete_mse=700.731934 best_discrete=5.879698 hash=False elapsed=46.4s
step   550/900 tau=0.1175 loss=0.283421 mse_soft=0.282973 ent_in=1.0947 ent_out=0.3994 rowmax_in=0.5228 rowmax_out=0.8253 discrete_mse=126.060425 best_discrete=5.879698 hash=False elapsed=48.6s
step   575/900 tau=0.1066 loss=0.283197 mse_soft=0.282751 ent_in=1.0888 ent_out=0.3965 rowmax_in=0.5243 rowmax_out=0.8319 discrete_mse=682.585693 best_discrete=5.879698 hash=False elapsed=50.8s
step   600/900 tau=0.0967 loss=0.288392 mse_soft=0.287952 ent_in=1.0860 ent_out=0.3822 rowmax_in=0.5233 rowmax_out=0.8327 discrete_mse=762.558289 best_discrete=5.879698 hash=False elapsed=53.1s
step   625/900 tau=0.0877 loss=0.285353 mse_soft=0.284914 ent_in=1.0784 ent_out=0.3835 rowmax_in=0.5227 rowmax_out=0.8266 discrete_mse=1256.645386 best_discrete=5.879698 hash=False elapsed=55.2s
step   650/900 tau=0.0795 loss=0.290290 mse_soft=0.289856 ent_in=1.0740 ent_out=0.3722 rowmax_in=0.5235 rowmax_out=0.8269 discrete_mse=279.682404 best_discrete=5.879698 hash=False elapsed=57.3s
step   675/900 tau=0.0722 loss=0.394095 mse_soft=0.393678 ent_in=1.0417 ent_out=0.3498 rowmax_in=0.5337 rowmax_out=0.8325 discrete_mse=139.232529 best_discrete=5.879698 hash=False elapsed=59.4s
step   700/900 tau=0.0655 loss=0.355327 mse_soft=0.354962 ent_in=0.8503 ent_out=0.3660 rowmax_in=0.6164 rowmax_out=0.8167 discrete_mse=53.789936 best_discrete=5.879698 hash=False elapsed=61.5s
step   725/900 tau=0.0594 loss=0.320807 mse_soft=0.320464 ent_in=0.8171 ent_out=0.3252 rowmax_in=0.6240 rowmax_out=0.8363 discrete_mse=48.274235 best_discrete=5.879698 hash=False elapsed=63.6s
step   750/900 tau=0.0539 loss=0.310497 mse_soft=0.310154 ent_in=0.8119 ent_out=0.3327 rowmax_in=0.6237 rowmax_out=0.8324 discrete_mse=3.641801 best_discrete=3.641801 hash=False elapsed=65.6s
step   775/900 tau=0.0489 loss=0.486901 mse_soft=0.486660 ent_in=0.5388 ent_out=0.2620 rowmax_in=0.7676 rowmax_out=0.8861 discrete_mse=0.732168 best_discrete=0.732168 hash=False elapsed=67.7s
step   800/900 tau=0.0443 loss=0.380292 mse_soft=0.380087 ent_in=0.4752 ent_out=0.2102 rowmax_in=0.7681 rowmax_out=0.9066 discrete_mse=22.372643 best_discrete=0.732168 hash=False elapsed=69.8s
step   825/900 tau=0.0402 loss=0.370051 mse_soft=0.369850 ent_in=0.4624 ent_out=0.2052 rowmax_in=0.7781 rowmax_out=0.9062 discrete_mse=19.753263 best_discrete=0.732168 hash=False elapsed=71.8s
step   850/900 tau=0.0365 loss=0.372394 mse_soft=0.372196 ent_in=0.4609 ent_out=0.1997 rowmax_in=0.7740 rowmax_out=0.9087 discrete_mse=22.372643 best_discrete=0.732168 hash=False elapsed=73.7s
step   875/900 tau=0.0331 loss=0.368348 mse_soft=0.368151 ent_in=0.4610 ent_out=0.1965 rowmax_in=0.7744 rowmax_out=0.9103 discrete_mse=17.905975 best_discrete=0.732168 hash=False elapsed=75.8s
step   900/900 tau=0.0300 loss=0.376082 mse_soft=0.375891 ent_in=0.4446 ent_out=0.1938 rowmax_in=0.7813 rowmax_out=0.9040 discrete_mse=19.918076 best_discrete=0.732168 hash=False elapsed=77.9s

Final metrics:
  soft_mse_full=0.378298
  rowmax_in_mean=0.7791
  rowmax_out_mean=0.9069
  ent_in_mean=0.4446
  ent_out_mean=0.1914
  final_discrete_mse=89.226639
  hash_match=False
  best_discrete_mse_seen=0.732168
Saved results to overnight_b158_j1.json
