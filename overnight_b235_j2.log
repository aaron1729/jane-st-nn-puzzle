Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.059344 mse_soft=1.057021 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=203.788589 best_discrete=203.788589 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.854080 mse_soft=0.851890 ent_in=3.6312 ent_out=3.6670 rowmax_in=0.0457 rowmax_out=0.0439 discrete_mse=5766.306641 best_discrete=203.788589 hash=False elapsed=2.5s
step    50/900 tau=0.8229 loss=0.641295 mse_soft=0.639392 ent_in=3.1205 ent_out=3.2212 rowmax_in=0.0924 rowmax_out=0.0880 discrete_mse=555.175110 best_discrete=203.788589 hash=False elapsed=4.7s
step    75/900 tau=0.7450 loss=0.508705 mse_soft=0.507121 ent_in=2.5853 ent_out=2.6935 rowmax_in=0.2029 rowmax_out=0.1956 discrete_mse=764.324707 best_discrete=203.788589 hash=False elapsed=7.1s
step   100/900 tau=0.6745 loss=0.419068 mse_soft=0.417877 ent_in=2.0129 ent_out=1.9569 rowmax_in=0.3362 rowmax_out=0.3831 discrete_mse=403.469849 best_discrete=203.788589 hash=False elapsed=9.4s
step   125/900 tau=0.6107 loss=0.344914 mse_soft=0.344074 ent_in=1.5501 ent_out=1.2518 rowmax_in=0.4534 rowmax_out=0.5982 discrete_mse=805.689941 best_discrete=203.788589 hash=False elapsed=11.6s
step   150/900 tau=0.5529 loss=0.314256 mse_soft=0.313585 ent_in=1.3577 ent_out=0.8782 rowmax_in=0.5059 rowmax_out=0.6969 discrete_mse=520.731079 best_discrete=203.788589 hash=False elapsed=13.6s
step   175/900 tau=0.5006 loss=0.302867 mse_soft=0.302274 ent_in=1.2751 ent_out=0.7021 rowmax_in=0.5162 rowmax_out=0.7431 discrete_mse=198.198914 best_discrete=198.198914 hash=False elapsed=15.7s
step   200/900 tau=0.4532 loss=0.293281 mse_soft=0.292729 ent_in=1.2391 ent_out=0.6004 rowmax_in=0.5218 rowmax_out=0.7786 discrete_mse=110.934601 best_discrete=110.934601 hash=False elapsed=17.8s
step   225/900 tau=0.4103 loss=0.286827 mse_soft=0.286310 ent_in=1.2060 ent_out=0.5164 rowmax_in=0.5316 rowmax_out=0.7970 discrete_mse=156.934692 best_discrete=110.934601 hash=False elapsed=20.2s
step   250/900 tau=0.3715 loss=0.284017 mse_soft=0.283521 ent_in=1.1762 ent_out=0.4761 rowmax_in=0.5364 rowmax_out=0.7997 discrete_mse=156.934692 best_discrete=110.934601 hash=False elapsed=22.5s
step   275/900 tau=0.3363 loss=0.281552 mse_soft=0.281068 ent_in=1.1609 ent_out=0.4531 rowmax_in=0.5366 rowmax_out=0.8024 discrete_mse=568.716919 best_discrete=110.934601 hash=False elapsed=24.9s
step   300/900 tau=0.3045 loss=0.281768 mse_soft=0.281292 ent_in=1.1475 ent_out=0.4372 rowmax_in=0.5386 rowmax_out=0.8023 discrete_mse=426.380829 best_discrete=110.934601 hash=False elapsed=27.3s
step   325/900 tau=0.2756 loss=0.277983 mse_soft=0.277516 ent_in=1.1308 ent_out=0.4267 rowmax_in=0.5411 rowmax_out=0.8047 discrete_mse=468.011292 best_discrete=110.934601 hash=False elapsed=29.7s
step   350/900 tau=0.2496 loss=0.281291 mse_soft=0.280830 ent_in=1.1184 ent_out=0.4185 rowmax_in=0.5452 rowmax_out=0.8068 discrete_mse=468.011292 best_discrete=110.934601 hash=False elapsed=32.2s
step   375/900 tau=0.2259 loss=0.278672 mse_soft=0.278216 ent_in=1.1106 ent_out=0.4091 rowmax_in=0.5450 rowmax_out=0.8096 discrete_mse=468.011292 best_discrete=110.934601 hash=False elapsed=34.4s
step   400/900 tau=0.2046 loss=0.276420 mse_soft=0.275967 ent_in=1.1069 ent_out=0.4026 rowmax_in=0.5455 rowmax_out=0.8136 discrete_mse=468.011292 best_discrete=110.934601 hash=False elapsed=36.7s
step   425/900 tau=0.1852 loss=0.278542 mse_soft=0.278093 ent_in=1.1026 ent_out=0.3950 rowmax_in=0.5462 rowmax_out=0.8176 discrete_mse=468.011292 best_discrete=110.934601 hash=False elapsed=39.1s
step   450/900 tau=0.1677 loss=0.280335 mse_soft=0.279889 ent_in=1.1012 ent_out=0.3864 rowmax_in=0.5458 rowmax_out=0.8220 discrete_mse=468.011292 best_discrete=110.934601 hash=False elapsed=41.4s
step   475/900 tau=0.1518 loss=0.287058 mse_soft=0.286615 ent_in=1.0984 ent_out=0.3757 rowmax_in=0.5469 rowmax_out=0.8271 discrete_mse=468.011292 best_discrete=110.934601 hash=False elapsed=43.6s
step   500/900 tau=0.1374 loss=0.284188 mse_soft=0.283749 ent_in=1.0960 ent_out=0.3671 rowmax_in=0.5474 rowmax_out=0.8316 discrete_mse=468.011292 best_discrete=110.934601 hash=False elapsed=46.0s
step   525/900 tau=0.1244 loss=0.285076 mse_soft=0.284641 ent_in=1.0945 ent_out=0.3559 rowmax_in=0.5465 rowmax_out=0.8372 discrete_mse=356.688049 best_discrete=110.934601 hash=False elapsed=48.1s
step   550/900 tau=0.1126 loss=0.317787 mse_soft=0.317359 ent_in=1.0853 ent_out=0.3436 rowmax_in=0.5512 rowmax_out=0.8446 discrete_mse=356.688049 best_discrete=110.934601 hash=False elapsed=50.3s
step   575/900 tau=0.1020 loss=0.283146 mse_soft=0.282732 ent_in=1.0409 ent_out=0.3398 rowmax_in=0.5704 rowmax_out=0.8420 discrete_mse=174.043427 best_discrete=110.934601 hash=False elapsed=53.1s
step   600/900 tau=0.0923 loss=0.284665 mse_soft=0.284251 ent_in=1.0471 ent_out=0.3301 rowmax_in=0.5645 rowmax_out=0.8466 discrete_mse=69.681999 best_discrete=69.681999 hash=False elapsed=55.2s
step   625/900 tau=0.0836 loss=0.284560 mse_soft=0.284149 ent_in=1.0399 ent_out=0.3298 rowmax_in=0.5648 rowmax_out=0.8480 discrete_mse=96.487106 best_discrete=69.681999 hash=False elapsed=57.6s
step   650/900 tau=0.0757 loss=0.304331 mse_soft=0.303931 ent_in=1.0202 ent_out=0.3145 rowmax_in=0.5713 rowmax_out=0.8432 discrete_mse=30.984245 best_discrete=30.984245 hash=False elapsed=59.8s
step   675/900 tau=0.0685 loss=0.284780 mse_soft=0.284390 ent_in=0.9836 ent_out=0.3160 rowmax_in=0.5885 rowmax_out=0.8463 discrete_mse=452.420776 best_discrete=30.984245 hash=False elapsed=61.9s
step   700/900 tau=0.0620 loss=0.327397 mse_soft=0.327022 ent_in=0.9479 ent_out=0.3012 rowmax_in=0.6041 rowmax_out=0.8548 discrete_mse=64.297470 best_discrete=30.984245 hash=False elapsed=64.2s
step   725/900 tau=0.0562 loss=0.365984 mse_soft=0.365658 ent_in=0.8173 ent_out=0.2711 rowmax_in=0.6435 rowmax_out=0.8531 discrete_mse=757.243591 best_discrete=30.984245 hash=False elapsed=66.4s
step   750/900 tau=0.0508 loss=0.317930 mse_soft=0.317623 ent_in=0.7587 ent_out=0.2647 rowmax_in=0.6558 rowmax_out=0.8549 discrete_mse=330.163330 best_discrete=30.984245 hash=False elapsed=68.6s
step   775/900 tau=0.0460 loss=0.302612 mse_soft=0.302309 ent_in=0.7475 ent_out=0.2625 rowmax_in=0.6554 rowmax_out=0.8580 discrete_mse=79.797043 best_discrete=30.984245 hash=False elapsed=71.0s
step   800/900 tau=0.0417 loss=0.299952 mse_soft=0.299641 ent_in=0.7721 ent_out=0.2639 rowmax_in=0.6450 rowmax_out=0.8573 discrete_mse=159.472000 best_discrete=30.984245 hash=False elapsed=73.2s
step   825/900 tau=0.0377 loss=0.494002 mse_soft=0.493815 ent_in=0.4431 ent_out=0.1795 rowmax_in=0.7996 rowmax_out=0.9091 discrete_mse=8.040030 best_discrete=8.040030 hash=False elapsed=75.4s
step   850/900 tau=0.0342 loss=0.466406 mse_soft=0.466251 ent_in=0.3828 ent_out=0.1364 rowmax_in=0.8230 rowmax_out=0.9262 discrete_mse=4.112041 best_discrete=4.112041 hash=False elapsed=77.3s
step   875/900 tau=0.0309 loss=0.431899 mse_soft=0.431737 ent_in=0.4193 ent_out=0.1216 rowmax_in=0.7929 rowmax_out=0.9306 discrete_mse=15.756489 best_discrete=4.112041 hash=False elapsed=79.7s
step   900/900 tau=0.0280 loss=0.432429 mse_soft=0.432270 ent_in=0.4104 ent_out=0.1206 rowmax_in=0.7980 rowmax_out=0.9312 discrete_mse=36.091747 best_discrete=4.112041 hash=False elapsed=81.9s

Final metrics:
  soft_mse_full=0.444964
  rowmax_in_mean=0.7980
  rowmax_out_mean=0.9310
  ent_in_mean=0.4105
  ent_out_mean=0.1208
  final_discrete_mse=36.091747
  hash_match=False
  best_discrete_mse_seen=4.112041
Saved results to overnight_b235_j2.json
