Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.074198 mse_soft=1.071876 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=25.429388 best_discrete=25.429388 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.874329 mse_soft=0.872139 ent_in=3.6312 ent_out=3.6670 rowmax_in=0.0459 rowmax_out=0.0442 discrete_mse=1359.983398 best_discrete=25.429388 hash=False elapsed=2.5s
step    50/900 tau=0.8260 loss=0.660010 mse_soft=0.658107 ent_in=3.1224 ent_out=3.2201 rowmax_in=0.0947 rowmax_out=0.0884 discrete_mse=2108.743652 best_discrete=25.429388 hash=False elapsed=4.6s
step    75/900 tau=0.7493 loss=0.527866 mse_soft=0.526279 ent_in=2.6130 ent_out=2.6749 rowmax_in=0.2084 rowmax_out=0.1990 discrete_mse=1721.569214 best_discrete=25.429388 hash=False elapsed=6.6s
step   100/900 tau=0.6797 loss=0.414798 mse_soft=0.413639 ent_in=1.9739 ent_out=1.8915 rowmax_in=0.3663 rowmax_out=0.4058 discrete_mse=603.864441 best_discrete=25.429388 hash=False elapsed=8.7s
step   125/900 tau=0.6165 loss=0.352100 mse_soft=0.351268 ent_in=1.5753 ent_out=1.1955 rowmax_in=0.4491 rowmax_out=0.6136 discrete_mse=104.615936 best_discrete=25.429388 hash=False elapsed=11.1s
step   150/900 tau=0.5592 loss=0.321710 mse_soft=0.321074 ent_in=1.3633 ent_out=0.7556 rowmax_in=0.4795 rowmax_out=0.7528 discrete_mse=152.519928 best_discrete=25.429388 hash=False elapsed=13.5s
step   175/900 tau=0.5073 loss=0.306403 mse_soft=0.305832 ent_in=1.2856 ent_out=0.6181 rowmax_in=0.4906 rowmax_out=0.7818 discrete_mse=194.001404 best_discrete=25.429388 hash=False elapsed=15.9s
step   200/900 tau=0.4602 loss=0.295851 mse_soft=0.295333 ent_in=1.2009 ent_out=0.5244 rowmax_in=0.5012 rowmax_out=0.8064 discrete_mse=46.379757 best_discrete=25.429388 hash=False elapsed=18.3s
step   225/900 tau=0.4174 loss=0.291191 mse_soft=0.290705 ent_in=1.1447 ent_out=0.4736 rowmax_in=0.5118 rowmax_out=0.8087 discrete_mse=33.451618 best_discrete=25.429388 hash=False elapsed=20.5s
step   250/900 tau=0.3786 loss=0.286694 mse_soft=0.286225 ent_in=1.1221 ent_out=0.4408 rowmax_in=0.5159 rowmax_out=0.8103 discrete_mse=82.396400 best_discrete=25.429388 hash=False elapsed=22.7s
step   275/900 tau=0.3434 loss=0.285699 mse_soft=0.285240 ent_in=1.1100 ent_out=0.4222 rowmax_in=0.5206 rowmax_out=0.8073 discrete_mse=58.453804 best_discrete=25.429388 hash=False elapsed=25.0s
step   300/900 tau=0.3115 loss=0.282470 mse_soft=0.282017 ent_in=1.1025 ent_out=0.4077 rowmax_in=0.5227 rowmax_out=0.8081 discrete_mse=182.315613 best_discrete=25.429388 hash=False elapsed=27.0s
step   325/900 tau=0.2826 loss=0.282546 mse_soft=0.282097 ent_in=1.1011 ent_out=0.3956 rowmax_in=0.5239 rowmax_out=0.8115 discrete_mse=176.761826 best_discrete=25.429388 hash=False elapsed=29.0s
step   350/900 tau=0.2563 loss=0.277853 mse_soft=0.277410 ent_in=1.1006 ent_out=0.3787 rowmax_in=0.5210 rowmax_out=0.8182 discrete_mse=208.901764 best_discrete=25.429388 hash=False elapsed=31.3s
step   375/900 tau=0.2325 loss=0.277089 mse_soft=0.276649 ent_in=1.0956 ent_out=0.3729 rowmax_in=0.5184 rowmax_out=0.8220 discrete_mse=208.901764 best_discrete=25.429388 hash=False elapsed=33.6s
step   400/900 tau=0.2109 loss=0.276214 mse_soft=0.275776 ent_in=1.0964 ent_out=0.3629 rowmax_in=0.5152 rowmax_out=0.8279 discrete_mse=166.513260 best_discrete=25.429388 hash=False elapsed=35.7s
step   425/900 tau=0.1913 loss=0.275559 mse_soft=0.275126 ent_in=1.0917 ent_out=0.3519 rowmax_in=0.5134 rowmax_out=0.8346 discrete_mse=152.270828 best_discrete=25.429388 hash=False elapsed=37.8s
step   450/900 tau=0.1735 loss=0.274779 mse_soft=0.274350 ent_in=1.0857 ent_out=0.3433 rowmax_in=0.5130 rowmax_out=0.8397 discrete_mse=152.270828 best_discrete=25.429388 hash=False elapsed=40.0s
step   475/900 tau=0.1574 loss=0.279525 mse_soft=0.279099 ent_in=1.0850 ent_out=0.3366 rowmax_in=0.5119 rowmax_out=0.8439 discrete_mse=152.270828 best_discrete=25.429388 hash=False elapsed=42.2s
step   500/900 tau=0.1428 loss=0.278468 mse_soft=0.278043 ent_in=1.0810 ent_out=0.3339 rowmax_in=0.5127 rowmax_out=0.8458 discrete_mse=152.270828 best_discrete=25.429388 hash=False elapsed=44.4s
step   525/900 tau=0.1295 loss=0.278328 mse_soft=0.277904 ent_in=1.0800 ent_out=0.3320 rowmax_in=0.5139 rowmax_out=0.8444 discrete_mse=152.270828 best_discrete=25.429388 hash=False elapsed=46.7s
step   550/900 tau=0.1175 loss=0.275184 mse_soft=0.274761 ent_in=1.0801 ent_out=0.3307 rowmax_in=0.5131 rowmax_out=0.8438 discrete_mse=152.270828 best_discrete=25.429388 hash=False elapsed=48.8s
step   575/900 tau=0.1066 loss=0.275061 mse_soft=0.274639 ent_in=1.0802 ent_out=0.3270 rowmax_in=0.5109 rowmax_out=0.8458 discrete_mse=126.807350 best_discrete=25.429388 hash=False elapsed=51.0s
step   600/900 tau=0.0967 loss=0.276818 mse_soft=0.276398 ent_in=1.0646 ent_out=0.3336 rowmax_in=0.5174 rowmax_out=0.8386 discrete_mse=201.059769 best_discrete=25.429388 hash=False elapsed=53.3s
step   625/900 tau=0.0877 loss=0.287916 mse_soft=0.287493 ent_in=1.0812 ent_out=0.3271 rowmax_in=0.5090 rowmax_out=0.8432 discrete_mse=126.807350 best_discrete=25.429388 hash=False elapsed=55.7s
step   650/900 tau=0.0795 loss=0.385047 mse_soft=0.384635 ent_in=1.0477 ent_out=0.3263 rowmax_in=0.5226 rowmax_out=0.8426 discrete_mse=154.408615 best_discrete=25.429388 hash=False elapsed=58.2s
step   675/900 tau=0.0722 loss=0.329349 mse_soft=0.328986 ent_in=0.9383 ent_out=0.2688 rowmax_in=0.5646 rowmax_out=0.8785 discrete_mse=4.857857 best_discrete=4.857857 hash=False elapsed=60.4s
step   700/900 tau=0.0655 loss=0.312323 mse_soft=0.311948 ent_in=0.9586 ent_out=0.2909 rowmax_in=0.5357 rowmax_out=0.8524 discrete_mse=472.288788 best_discrete=4.857857 hash=False elapsed=62.6s
step   725/900 tau=0.0594 loss=0.347113 mse_soft=0.346755 ent_in=0.9140 ent_out=0.2769 rowmax_in=0.5794 rowmax_out=0.8674 discrete_mse=29.766317 best_discrete=4.857857 hash=False elapsed=64.7s
step   750/900 tau=0.0539 loss=0.331061 mse_soft=0.330741 ent_in=0.7665 ent_out=0.3007 rowmax_in=0.6307 rowmax_out=0.8440 discrete_mse=1.369123 best_discrete=1.369123 hash=False elapsed=66.7s
step   775/900 tau=0.0489 loss=0.312582 mse_soft=0.312254 ent_in=0.7999 ent_out=0.2952 rowmax_in=0.5992 rowmax_out=0.8436 discrete_mse=37.386772 best_discrete=1.369123 hash=False elapsed=68.8s
step   800/900 tau=0.0443 loss=0.312994 mse_soft=0.312664 ent_in=0.8167 ent_out=0.2842 rowmax_in=0.5909 rowmax_out=0.8523 discrete_mse=160.958664 best_discrete=1.369123 hash=False elapsed=71.0s
step   825/900 tau=0.0402 loss=0.592400 mse_soft=0.592089 ent_in=0.7712 ent_out=0.2680 rowmax_in=0.6344 rowmax_out=0.8639 discrete_mse=53.615311 best_discrete=1.369123 hash=False elapsed=73.1s
step   850/900 tau=0.0365 loss=0.568311 mse_soft=0.568122 ent_in=0.4690 ent_out=0.1641 rowmax_in=0.7691 rowmax_out=0.9163 discrete_mse=51.800976 best_discrete=1.369123 hash=False elapsed=75.1s
step   875/900 tau=0.0331 loss=0.515626 mse_soft=0.515524 ent_in=0.2126 ent_out=0.1285 rowmax_in=0.8951 rowmax_out=0.9284 discrete_mse=5.147328 best_discrete=1.369123 hash=False elapsed=77.3s
step   900/900 tau=0.0300 loss=0.478890 mse_soft=0.478780 ent_in=0.2489 ent_out=0.1188 rowmax_in=0.8737 rowmax_out=0.9325 discrete_mse=2.988368 best_discrete=1.369123 hash=False elapsed=79.6s

Final metrics:
  soft_mse_full=0.475703
  rowmax_in_mean=0.8736
  rowmax_out_mean=0.9328
  ent_in_mean=0.2488
  ent_out_mean=0.1186
  final_discrete_mse=2.988368
  hash_match=False
  best_discrete_mse_seen=1.369123
Saved results to overnight_b100_j1.json
