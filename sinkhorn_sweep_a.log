Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.037357 mse_soft=1.035034 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=57.175724 best_discrete=57.175724 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.841229 mse_soft=0.839040 ent_in=3.6330 ent_out=3.6659 rowmax_in=0.0453 rowmax_out=0.0448 discrete_mse=2517.089600 best_discrete=57.175724 hash=False elapsed=2.2s
step    50/900 tau=0.8260 loss=0.638831 mse_soft=0.636925 ent_in=3.1364 ent_out=3.2186 rowmax_in=0.0923 rowmax_out=0.0881 discrete_mse=17441.488281 best_discrete=57.175724 hash=False elapsed=4.2s
step    75/900 tau=0.7493 loss=0.511024 mse_soft=0.509442 ent_in=2.5986 ent_out=2.6742 rowmax_in=0.1993 rowmax_out=0.1865 discrete_mse=1178.850708 best_discrete=57.175724 hash=False elapsed=6.2s
step   100/900 tau=0.6797 loss=0.409664 mse_soft=0.408522 ent_in=1.9507 ent_out=1.8567 rowmax_in=0.3641 rowmax_out=0.3812 discrete_mse=231.634750 best_discrete=57.175724 hash=False elapsed=8.2s
step   125/900 tau=0.6165 loss=0.349962 mse_soft=0.349170 ent_in=1.5350 ent_out=1.1027 rowmax_in=0.4640 rowmax_out=0.6425 discrete_mse=445.156036 best_discrete=57.175724 hash=False elapsed=10.1s
step   150/900 tau=0.5592 loss=0.324103 mse_soft=0.323474 ent_in=1.3967 ent_out=0.6985 rowmax_in=0.4898 rowmax_out=0.7531 discrete_mse=183.790787 best_discrete=57.175724 hash=False elapsed=12.0s
step   175/900 tau=0.5073 loss=0.309854 mse_soft=0.309308 ent_in=1.3061 ent_out=0.5115 rowmax_in=0.4967 rowmax_out=0.8067 discrete_mse=203.135651 best_discrete=57.175724 hash=False elapsed=14.0s
step   200/900 tau=0.4602 loss=0.300012 mse_soft=0.299511 ent_in=1.2516 ent_out=0.4190 rowmax_in=0.5088 rowmax_out=0.8390 discrete_mse=364.867554 best_discrete=57.175724 hash=False elapsed=15.8s
step   225/900 tau=0.4174 loss=0.291458 mse_soft=0.290990 ent_in=1.2096 ent_out=0.3508 rowmax_in=0.5098 rowmax_out=0.8567 discrete_mse=467.897644 best_discrete=57.175724 hash=False elapsed=17.6s
step   250/900 tau=0.3786 loss=0.286248 mse_soft=0.285808 ent_in=1.1683 ent_out=0.2983 rowmax_in=0.5177 rowmax_out=0.8703 discrete_mse=1215.465454 best_discrete=57.175724 hash=False elapsed=19.4s
step   275/900 tau=0.3434 loss=0.284509 mse_soft=0.284078 ent_in=1.1471 ent_out=0.2876 rowmax_in=0.5161 rowmax_out=0.8711 discrete_mse=756.493164 best_discrete=57.175724 hash=False elapsed=21.2s
step   300/900 tau=0.3115 loss=0.282771 mse_soft=0.282348 ent_in=1.1265 ent_out=0.2826 rowmax_in=0.5207 rowmax_out=0.8687 discrete_mse=1384.643799 best_discrete=57.175724 hash=False elapsed=23.2s
step   325/900 tau=0.2826 loss=0.281631 mse_soft=0.281214 ent_in=1.1155 ent_out=0.2754 rowmax_in=0.5232 rowmax_out=0.8670 discrete_mse=878.825562 best_discrete=57.175724 hash=False elapsed=25.0s
step   350/900 tau=0.2563 loss=0.283016 mse_soft=0.282603 ent_in=1.1072 ent_out=0.2685 rowmax_in=0.5223 rowmax_out=0.8664 discrete_mse=59.751736 best_discrete=57.175724 hash=False elapsed=26.9s
step   375/900 tau=0.2325 loss=0.281846 mse_soft=0.281438 ent_in=1.0987 ent_out=0.2628 rowmax_in=0.5249 rowmax_out=0.8669 discrete_mse=150.070221 best_discrete=57.175724 hash=False elapsed=28.7s
step   400/900 tau=0.2109 loss=0.283108 mse_soft=0.282701 ent_in=1.0987 ent_out=0.2582 rowmax_in=0.5242 rowmax_out=0.8680 discrete_mse=49.948578 best_discrete=49.948578 hash=False elapsed=30.6s
step   425/900 tau=0.1913 loss=0.283792 mse_soft=0.283388 ent_in=1.0923 ent_out=0.2547 rowmax_in=0.5271 rowmax_out=0.8676 discrete_mse=59.751736 best_discrete=49.948578 hash=False elapsed=32.4s
step   450/900 tau=0.1735 loss=0.284811 mse_soft=0.284407 ent_in=1.0934 ent_out=0.2541 rowmax_in=0.5240 rowmax_out=0.8669 discrete_mse=49.948578 best_discrete=49.948578 hash=False elapsed=34.3s
step   475/900 tau=0.1574 loss=0.284830 mse_soft=0.284429 ent_in=1.0872 ent_out=0.2521 rowmax_in=0.5280 rowmax_out=0.8679 discrete_mse=49.948578 best_discrete=49.948578 hash=False elapsed=36.1s
step   500/900 tau=0.1428 loss=0.289748 mse_soft=0.289345 ent_in=1.0900 ent_out=0.2512 rowmax_in=0.5238 rowmax_out=0.8685 discrete_mse=23.726114 best_discrete=23.726114 hash=False elapsed=37.9s
step   525/900 tau=0.1295 loss=0.280334 mse_soft=0.279934 ent_in=1.0835 ent_out=0.2506 rowmax_in=0.5259 rowmax_out=0.8682 discrete_mse=196.571350 best_discrete=23.726114 hash=False elapsed=39.6s
step   550/900 tau=0.1175 loss=0.284793 mse_soft=0.284395 ent_in=1.0773 ent_out=0.2474 rowmax_in=0.5292 rowmax_out=0.8710 discrete_mse=46.321350 best_discrete=23.726114 hash=False elapsed=41.5s
step   575/900 tau=0.1066 loss=0.285453 mse_soft=0.285055 ent_in=1.0760 ent_out=0.2505 rowmax_in=0.5267 rowmax_out=0.8673 discrete_mse=19.364620 best_discrete=19.364620 hash=False elapsed=43.3s
step   600/900 tau=0.0967 loss=0.292828 mse_soft=0.292432 ent_in=1.0718 ent_out=0.2471 rowmax_in=0.5286 rowmax_out=0.8699 discrete_mse=19.364620 best_discrete=19.364620 hash=False elapsed=45.2s
step   625/900 tau=0.0877 loss=0.294368 mse_soft=0.293973 ent_in=1.0712 ent_out=0.2485 rowmax_in=0.5271 rowmax_out=0.8673 discrete_mse=119.513924 best_discrete=19.364620 hash=False elapsed=47.0s
step   650/900 tau=0.0795 loss=0.300931 mse_soft=0.300537 ent_in=1.0693 ent_out=0.2451 rowmax_in=0.5263 rowmax_out=0.8700 discrete_mse=19.364620 best_discrete=19.364620 hash=False elapsed=48.9s
step   675/900 tau=0.0722 loss=0.296963 mse_soft=0.296574 ent_in=1.0599 ent_out=0.2373 rowmax_in=0.5309 rowmax_out=0.8742 discrete_mse=176.087814 best_discrete=19.364620 hash=False elapsed=50.7s
step   700/900 tau=0.0655 loss=0.294873 mse_soft=0.294493 ent_in=1.0430 ent_out=0.2264 rowmax_in=0.5306 rowmax_out=0.8746 discrete_mse=593.792114 best_discrete=19.364620 hash=False elapsed=52.5s
step   725/900 tau=0.0594 loss=0.346502 mse_soft=0.346131 ent_in=1.0065 ent_out=0.2293 rowmax_in=0.5543 rowmax_out=0.8578 discrete_mse=66.707062 best_discrete=19.364620 hash=False elapsed=54.3s
step   750/900 tau=0.0539 loss=0.410898 mse_soft=0.410619 ent_in=0.7504 ent_out=0.1794 rowmax_in=0.6614 rowmax_out=0.9094 discrete_mse=65.453827 best_discrete=19.364620 hash=False elapsed=56.2s
step   775/900 tau=0.0489 loss=0.346166 mse_soft=0.345910 ent_in=0.6822 ent_out=0.1710 rowmax_in=0.6518 rowmax_out=0.9100 discrete_mse=20.753584 best_discrete=19.364620 hash=False elapsed=58.0s
step   800/900 tau=0.0443 loss=0.335105 mse_soft=0.334846 ent_in=0.6958 ent_out=0.1678 rowmax_in=0.6444 rowmax_out=0.9133 discrete_mse=100.613007 best_discrete=19.364620 hash=False elapsed=59.8s
step   825/900 tau=0.0402 loss=0.513061 mse_soft=0.512850 ent_in=0.5492 ent_out=0.1563 rowmax_in=0.7385 rowmax_out=0.9266 discrete_mse=24.282549 best_discrete=19.364620 hash=False elapsed=61.6s
step   850/900 tau=0.0365 loss=0.384552 mse_soft=0.384338 ent_in=0.5532 ent_out=0.1589 rowmax_in=0.7137 rowmax_out=0.9208 discrete_mse=5.956500 best_discrete=5.956500 hash=False elapsed=63.5s
step   875/900 tau=0.0331 loss=0.373335 mse_soft=0.373116 ent_in=0.5669 ent_out=0.1627 rowmax_in=0.6988 rowmax_out=0.9164 discrete_mse=1.591209 best_discrete=1.591209 hash=False elapsed=65.3s
step   900/900 tau=0.0300 loss=0.364170 mse_soft=0.363944 ent_in=0.5779 ent_out=0.1747 rowmax_in=0.6915 rowmax_out=0.9114 discrete_mse=1.534189 best_discrete=1.534189 hash=False elapsed=67.1s

Final metrics:
  soft_mse_full=0.366720
  rowmax_in_mean=0.6929
  rowmax_out_mean=0.9106
  ent_in_mean=0.5781
  ent_out_mean=0.1754
  final_discrete_mse=1.534189
  hash_match=False
  best_discrete_mse_seen=1.534189
Saved results to sinkhorn_sweep_a.json
