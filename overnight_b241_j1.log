Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.064640 mse_soft=1.062317 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=19.963255 best_discrete=19.963255 hash=False elapsed=0.6s
step    25/900 tau=0.9106 loss=0.861738 mse_soft=0.859547 ent_in=3.6347 ent_out=3.6674 rowmax_in=0.0455 rowmax_out=0.0443 discrete_mse=693.553162 best_discrete=19.963255 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.650816 mse_soft=0.648909 ent_in=3.1302 ent_out=3.2256 rowmax_in=0.0919 rowmax_out=0.0880 discrete_mse=1880.930908 best_discrete=19.963255 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.526122 mse_soft=0.524526 ent_in=2.6204 ent_out=2.6996 rowmax_in=0.1928 rowmax_out=0.1947 discrete_mse=5332.571289 best_discrete=19.963255 hash=False elapsed=7.0s
step   100/900 tau=0.6797 loss=0.416466 mse_soft=0.415299 ent_in=2.0440 ent_out=1.8448 rowmax_in=0.3408 rowmax_out=0.4198 discrete_mse=393.908508 best_discrete=19.963255 hash=False elapsed=9.2s
step   125/900 tau=0.6165 loss=0.351165 mse_soft=0.350355 ent_in=1.5794 ent_out=1.1220 rowmax_in=0.4619 rowmax_out=0.6456 discrete_mse=2831.722900 best_discrete=19.963255 hash=False elapsed=11.3s
step   150/900 tau=0.5592 loss=0.320367 mse_soft=0.319741 ent_in=1.3842 ent_out=0.7009 rowmax_in=0.4947 rowmax_out=0.7724 discrete_mse=409.558502 best_discrete=19.963255 hash=False elapsed=13.5s
step   175/900 tau=0.5073 loss=0.304296 mse_soft=0.303759 ent_in=1.3018 ent_out=0.4883 rowmax_in=0.5048 rowmax_out=0.8400 discrete_mse=194.010452 best_discrete=19.963255 hash=False elapsed=15.7s
step   200/900 tau=0.4602 loss=0.297137 mse_soft=0.296647 ent_in=1.2441 ent_out=0.3880 rowmax_in=0.5152 rowmax_out=0.8607 discrete_mse=1134.696167 best_discrete=19.963255 hash=False elapsed=17.8s
step   225/900 tau=0.4174 loss=0.294204 mse_soft=0.293735 ent_in=1.2176 ent_out=0.3449 rowmax_in=0.5173 rowmax_out=0.8705 discrete_mse=1134.696167 best_discrete=19.963255 hash=False elapsed=19.9s
step   250/900 tau=0.3786 loss=0.291943 mse_soft=0.291485 ent_in=1.2053 ent_out=0.3234 rowmax_in=0.5161 rowmax_out=0.8741 discrete_mse=1066.396118 best_discrete=19.963255 hash=False elapsed=22.1s
step   275/900 tau=0.3434 loss=0.291830 mse_soft=0.291379 ent_in=1.1942 ent_out=0.3104 rowmax_in=0.5173 rowmax_out=0.8761 discrete_mse=855.736755 best_discrete=19.963255 hash=False elapsed=24.2s
step   300/900 tau=0.3115 loss=0.291648 mse_soft=0.291202 ent_in=1.1853 ent_out=0.3004 rowmax_in=0.5194 rowmax_out=0.8776 discrete_mse=1370.965332 best_discrete=19.963255 hash=False elapsed=26.6s
step   325/900 tau=0.2826 loss=0.289718 mse_soft=0.289278 ent_in=1.1774 ent_out=0.2910 rowmax_in=0.5203 rowmax_out=0.8788 discrete_mse=318.864655 best_discrete=19.963255 hash=False elapsed=28.9s
step   350/900 tau=0.2563 loss=0.288891 mse_soft=0.288454 ent_in=1.1719 ent_out=0.2856 rowmax_in=0.5218 rowmax_out=0.8777 discrete_mse=2131.458496 best_discrete=19.963255 hash=False elapsed=31.1s
step   375/900 tau=0.2325 loss=0.290142 mse_soft=0.289708 ent_in=1.1637 ent_out=0.2817 rowmax_in=0.5224 rowmax_out=0.8788 discrete_mse=2727.945557 best_discrete=19.963255 hash=False elapsed=33.3s
step   400/900 tau=0.2109 loss=0.287601 mse_soft=0.287169 ent_in=1.1607 ent_out=0.2801 rowmax_in=0.5215 rowmax_out=0.8786 discrete_mse=2727.945557 best_discrete=19.963255 hash=False elapsed=35.5s
step   425/900 tau=0.1913 loss=0.290471 mse_soft=0.290039 ent_in=1.1594 ent_out=0.2798 rowmax_in=0.5193 rowmax_out=0.8774 discrete_mse=2727.945557 best_discrete=19.963255 hash=False elapsed=37.7s
step   450/900 tau=0.1735 loss=0.291590 mse_soft=0.291159 ent_in=1.1560 ent_out=0.2806 rowmax_in=0.5185 rowmax_out=0.8766 discrete_mse=2010.023926 best_discrete=19.963255 hash=False elapsed=40.0s
step   475/900 tau=0.1574 loss=0.288710 mse_soft=0.288279 ent_in=1.1565 ent_out=0.2796 rowmax_in=0.5181 rowmax_out=0.8762 discrete_mse=334.080780 best_discrete=19.963255 hash=False elapsed=42.5s
step   500/900 tau=0.1428 loss=0.303418 mse_soft=0.302986 ent_in=1.1559 ent_out=0.2840 rowmax_in=0.5180 rowmax_out=0.8745 discrete_mse=334.080780 best_discrete=19.963255 hash=False elapsed=44.8s
step   525/900 tau=0.1295 loss=0.304850 mse_soft=0.304419 ent_in=1.1516 ent_out=0.2856 rowmax_in=0.5175 rowmax_out=0.8727 discrete_mse=217.945343 best_discrete=19.963255 hash=False elapsed=47.2s
step   550/900 tau=0.1175 loss=0.309148 mse_soft=0.308718 ent_in=1.1534 ent_out=0.2800 rowmax_in=0.5163 rowmax_out=0.8739 discrete_mse=217.945343 best_discrete=19.963255 hash=False elapsed=49.6s
step   575/900 tau=0.1066 loss=0.292759 mse_soft=0.292331 ent_in=1.1462 ent_out=0.2798 rowmax_in=0.5208 rowmax_out=0.8730 discrete_mse=187.103073 best_discrete=19.963255 hash=False elapsed=51.9s
step   600/900 tau=0.0967 loss=0.295922 mse_soft=0.295496 ent_in=1.1417 ent_out=0.2775 rowmax_in=0.5244 rowmax_out=0.8731 discrete_mse=1418.725952 best_discrete=19.963255 hash=False elapsed=54.2s
step   625/900 tau=0.0877 loss=0.295838 mse_soft=0.295414 ent_in=1.1330 ent_out=0.2797 rowmax_in=0.5232 rowmax_out=0.8700 discrete_mse=132.019272 best_discrete=19.963255 hash=False elapsed=56.5s
step   650/900 tau=0.0795 loss=0.358276 mse_soft=0.357870 ent_in=1.0890 ent_out=0.2633 rowmax_in=0.5410 rowmax_out=0.8776 discrete_mse=139.469147 best_discrete=19.963255 hash=False elapsed=58.7s
step   675/900 tau=0.0722 loss=0.338424 mse_soft=0.338043 ent_in=1.0252 ent_out=0.2443 rowmax_in=0.5395 rowmax_out=0.8894 discrete_mse=76.907936 best_discrete=19.963255 hash=False elapsed=60.8s
step   700/900 tau=0.0655 loss=0.363217 mse_soft=0.362876 ent_in=0.9255 ent_out=0.2115 rowmax_in=0.5815 rowmax_out=0.9048 discrete_mse=51.960953 best_discrete=19.963255 hash=False elapsed=63.0s
step   725/900 tau=0.0594 loss=0.313070 mse_soft=0.312724 ent_in=0.9250 ent_out=0.2274 rowmax_in=0.5916 rowmax_out=0.8832 discrete_mse=88.355629 best_discrete=19.963255 hash=False elapsed=65.1s
step   750/900 tau=0.0539 loss=0.386581 mse_soft=0.386298 ent_in=0.7453 ent_out=0.1961 rowmax_in=0.6570 rowmax_out=0.9117 discrete_mse=28.286240 best_discrete=19.963255 hash=False elapsed=67.2s
step   775/900 tau=0.0489 loss=0.346770 mse_soft=0.346492 ent_in=0.7103 ent_out=0.2159 rowmax_in=0.6511 rowmax_out=0.8939 discrete_mse=73.122673 best_discrete=19.963255 hash=False elapsed=69.2s
step   800/900 tau=0.0443 loss=0.326834 mse_soft=0.326559 ent_in=0.7327 ent_out=0.1816 rowmax_in=0.6349 rowmax_out=0.9027 discrete_mse=52.779480 best_discrete=19.963255 hash=False elapsed=71.3s
step   825/900 tau=0.0402 loss=0.366903 mse_soft=0.366626 ent_in=0.7399 ent_out=0.1826 rowmax_in=0.6315 rowmax_out=0.9013 discrete_mse=65.964989 best_discrete=19.963255 hash=False elapsed=73.4s
step   850/900 tau=0.0365 loss=0.439969 mse_soft=0.439737 ent_in=0.6077 ent_out=0.1646 rowmax_in=0.6950 rowmax_out=0.9151 discrete_mse=127.622498 best_discrete=19.963255 hash=False elapsed=75.5s
step   875/900 tau=0.0331 loss=0.393684 mse_soft=0.393487 ent_in=0.4890 ent_out=0.1699 rowmax_in=0.7397 rowmax_out=0.8939 discrete_mse=75.014732 best_discrete=19.963255 hash=False elapsed=77.8s
step   900/900 tau=0.0300 loss=0.379137 mse_soft=0.378931 ent_in=0.5096 ent_out=0.1759 rowmax_in=0.7275 rowmax_out=0.8832 discrete_mse=49.903881 best_discrete=19.963255 hash=False elapsed=79.8s

Final metrics:
  soft_mse_full=0.380572
  rowmax_in_mean=0.7286
  rowmax_out_mean=0.8839
  ent_in_mean=0.5084
  ent_out_mean=0.1760
  final_discrete_mse=45.947060
  hash_match=False
  best_discrete_mse_seen=19.963255
Saved results to overnight_b241_j1.json
