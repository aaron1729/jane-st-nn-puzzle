Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.064896 mse_soft=1.062573 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=62.641712 best_discrete=62.641712 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.856087 mse_soft=0.853897 ent_in=3.6318 ent_out=3.6660 rowmax_in=0.0461 rowmax_out=0.0441 discrete_mse=1552.104004 best_discrete=62.641712 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.643408 mse_soft=0.641502 ent_in=3.1263 ent_out=3.2265 rowmax_in=0.0933 rowmax_out=0.0868 discrete_mse=10671.844727 best_discrete=62.641712 hash=False elapsed=5.0s
step    75/900 tau=0.7450 loss=0.499131 mse_soft=0.497555 ent_in=2.5669 ent_out=2.6845 rowmax_in=0.2085 rowmax_out=0.1951 discrete_mse=1598.640503 best_discrete=62.641712 hash=False elapsed=7.2s
step   100/900 tau=0.6745 loss=0.389499 mse_soft=0.388368 ent_in=1.9010 ent_out=1.8669 rowmax_in=0.3828 rowmax_out=0.4011 discrete_mse=2485.527832 best_discrete=62.641712 hash=False elapsed=9.5s
step   125/900 tau=0.6107 loss=0.334153 mse_soft=0.333310 ent_in=1.5326 ent_out=1.2765 rowmax_in=0.4615 rowmax_out=0.5722 discrete_mse=225.295441 best_discrete=62.641712 hash=False elapsed=11.7s
step   150/900 tau=0.5529 loss=0.307975 mse_soft=0.307284 ent_in=1.3677 ent_out=0.9365 rowmax_in=0.4946 rowmax_out=0.6538 discrete_mse=1070.170898 best_discrete=62.641712 hash=False elapsed=14.0s
step   175/900 tau=0.5006 loss=0.293764 mse_soft=0.293159 ent_in=1.2884 ent_out=0.7292 rowmax_in=0.5058 rowmax_out=0.7164 discrete_mse=547.790527 best_discrete=62.641712 hash=False elapsed=16.1s
step   200/900 tau=0.4532 loss=0.285161 mse_soft=0.284598 ent_in=1.2249 ent_out=0.6522 rowmax_in=0.5150 rowmax_out=0.7302 discrete_mse=296.659851 best_discrete=62.641712 hash=False elapsed=18.2s
step   225/900 tau=0.4103 loss=0.282555 mse_soft=0.282021 ent_in=1.1797 ent_out=0.5992 rowmax_in=0.5191 rowmax_out=0.7350 discrete_mse=384.243713 best_discrete=62.641712 hash=False elapsed=20.4s
step   250/900 tau=0.3715 loss=0.279077 mse_soft=0.278561 ent_in=1.1507 ent_out=0.5679 rowmax_in=0.5255 rowmax_out=0.7406 discrete_mse=606.542419 best_discrete=62.641712 hash=False elapsed=22.5s
step   275/900 tau=0.3363 loss=0.277283 mse_soft=0.276781 ent_in=1.1300 ent_out=0.5426 rowmax_in=0.5278 rowmax_out=0.7446 discrete_mse=442.957489 best_discrete=62.641712 hash=False elapsed=24.6s
step   300/900 tau=0.3045 loss=0.275872 mse_soft=0.275382 ent_in=1.1129 ent_out=0.5190 rowmax_in=0.5314 rowmax_out=0.7500 discrete_mse=669.307373 best_discrete=62.641712 hash=False elapsed=26.8s
step   325/900 tau=0.2756 loss=0.275302 mse_soft=0.274821 ent_in=1.1035 ent_out=0.5025 rowmax_in=0.5328 rowmax_out=0.7535 discrete_mse=506.121002 best_discrete=62.641712 hash=False elapsed=28.8s
step   350/900 tau=0.2496 loss=0.274023 mse_soft=0.273546 ent_in=1.0984 ent_out=0.4922 rowmax_in=0.5344 rowmax_out=0.7576 discrete_mse=993.558044 best_discrete=62.641712 hash=False elapsed=31.0s
step   375/900 tau=0.2259 loss=0.275988 mse_soft=0.275514 ent_in=1.0928 ent_out=0.4871 rowmax_in=0.5328 rowmax_out=0.7652 discrete_mse=515.712463 best_discrete=62.641712 hash=False elapsed=33.0s
step   400/900 tau=0.2046 loss=0.273636 mse_soft=0.273171 ent_in=1.0850 ent_out=0.4658 rowmax_in=0.5313 rowmax_out=0.7819 discrete_mse=570.343506 best_discrete=62.641712 hash=False elapsed=35.2s
step   425/900 tau=0.1852 loss=0.277337 mse_soft=0.276878 ent_in=1.0787 ent_out=0.4505 rowmax_in=0.5315 rowmax_out=0.7890 discrete_mse=1474.184082 best_discrete=62.641712 hash=False elapsed=37.3s
step   450/900 tau=0.1677 loss=0.273533 mse_soft=0.273079 ent_in=1.0725 ent_out=0.4412 rowmax_in=0.5331 rowmax_out=0.7938 discrete_mse=1474.184082 best_discrete=62.641712 hash=False elapsed=39.3s
step   475/900 tau=0.1518 loss=0.271497 mse_soft=0.271046 ent_in=1.0690 ent_out=0.4339 rowmax_in=0.5332 rowmax_out=0.7961 discrete_mse=1474.184082 best_discrete=62.641712 hash=False elapsed=41.4s
step   500/900 tau=0.1374 loss=0.271442 mse_soft=0.270993 ent_in=1.0668 ent_out=0.4299 rowmax_in=0.5319 rowmax_out=0.7938 discrete_mse=1474.184082 best_discrete=62.641712 hash=False elapsed=43.4s
step   525/900 tau=0.1244 loss=0.277543 mse_soft=0.277095 ent_in=1.0633 ent_out=0.4303 rowmax_in=0.5331 rowmax_out=0.7935 discrete_mse=1474.184082 best_discrete=62.641712 hash=False elapsed=45.5s
step   550/900 tau=0.1126 loss=0.274916 mse_soft=0.274468 ent_in=1.0594 ent_out=0.4347 rowmax_in=0.5339 rowmax_out=0.7858 discrete_mse=894.682495 best_discrete=62.641712 hash=False elapsed=47.7s
step   575/900 tau=0.1020 loss=0.295796 mse_soft=0.295348 ent_in=1.0494 ent_out=0.4438 rowmax_in=0.5412 rowmax_out=0.7829 discrete_mse=877.827148 best_discrete=62.641712 hash=False elapsed=49.8s
step   600/900 tau=0.0923 loss=0.291402 mse_soft=0.290956 ent_in=1.0386 ent_out=0.4462 rowmax_in=0.5401 rowmax_out=0.7744 discrete_mse=503.501038 best_discrete=62.641712 hash=False elapsed=52.0s
step   625/900 tau=0.0836 loss=0.283842 mse_soft=0.283392 ent_in=1.0429 ent_out=0.4565 rowmax_in=0.5333 rowmax_out=0.7709 discrete_mse=450.487579 best_discrete=62.641712 hash=False elapsed=54.3s
step   650/900 tau=0.0757 loss=0.330420 mse_soft=0.330021 ent_in=0.9031 ent_out=0.4267 rowmax_in=0.5804 rowmax_out=0.7750 discrete_mse=237.473175 best_discrete=62.641712 hash=False elapsed=56.3s
step   675/900 tau=0.0685 loss=0.293727 mse_soft=0.293327 ent_in=0.9002 ent_out=0.4332 rowmax_in=0.5765 rowmax_out=0.7685 discrete_mse=505.588379 best_discrete=62.641712 hash=False elapsed=58.4s
step   700/900 tau=0.0620 loss=0.281090 mse_soft=0.280682 ent_in=0.9214 ent_out=0.4389 rowmax_in=0.5630 rowmax_out=0.7710 discrete_mse=2040.842773 best_discrete=62.641712 hash=False elapsed=60.4s
step   725/900 tau=0.0562 loss=0.290055 mse_soft=0.289651 ent_in=0.9094 ent_out=0.4367 rowmax_in=0.5677 rowmax_out=0.7716 discrete_mse=2030.241089 best_discrete=62.641712 hash=False elapsed=62.5s
step   750/900 tau=0.0508 loss=0.298459 mse_soft=0.298063 ent_in=0.8896 ent_out=0.4312 rowmax_in=0.5755 rowmax_out=0.7664 discrete_mse=118.513649 best_discrete=62.641712 hash=False elapsed=64.5s
step   775/900 tau=0.0460 loss=0.343083 mse_soft=0.342763 ent_in=0.6965 ent_out=0.3706 rowmax_in=0.6546 rowmax_out=0.8065 discrete_mse=230.848648 best_discrete=62.641712 hash=False elapsed=66.8s
step   800/900 tau=0.0417 loss=0.328254 mse_soft=0.327951 ent_in=0.6212 ent_out=0.3895 rowmax_in=0.6865 rowmax_out=0.7945 discrete_mse=7.687695 best_discrete=7.687695 hash=False elapsed=68.8s
step   825/900 tau=0.0377 loss=0.469157 mse_soft=0.468960 ent_in=0.3769 ent_out=0.2780 rowmax_in=0.8205 rowmax_out=0.8595 discrete_mse=318.384766 best_discrete=7.687695 hash=False elapsed=70.8s
step   850/900 tau=0.0342 loss=0.495086 mse_soft=0.494904 ent_in=0.3705 ent_out=0.2382 rowmax_in=0.8082 rowmax_out=0.8615 discrete_mse=16.154781 best_discrete=7.687695 hash=False elapsed=73.2s
step   875/900 tau=0.0309 loss=0.449318 mse_soft=0.449163 ent_in=0.2881 ent_out=0.2260 rowmax_in=0.8453 rowmax_out=0.8704 discrete_mse=268.679657 best_discrete=7.687695 hash=False elapsed=75.4s
step   900/900 tau=0.0280 loss=0.434099 mse_soft=0.433935 ent_in=0.3048 ent_out=0.2414 rowmax_in=0.8335 rowmax_out=0.8606 discrete_mse=874.745972 best_discrete=7.687695 hash=False elapsed=77.9s

Final metrics:
  soft_mse_full=0.449031
  rowmax_in_mean=0.8317
  rowmax_out_mean=0.8606
  ent_in_mean=0.3073
  ent_out_mean=0.2414
  final_discrete_mse=1101.428955
  hash_match=False
  best_discrete_mse_seen=7.687695
Saved results to overnight_b131_j2.json
