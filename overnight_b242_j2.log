Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.064703 mse_soft=1.062380 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=61.376434 best_discrete=61.376434 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.863775 mse_soft=0.861585 ent_in=3.6341 ent_out=3.6655 rowmax_in=0.0456 rowmax_out=0.0444 discrete_mse=934.880249 best_discrete=61.376434 hash=False elapsed=2.7s
step    50/900 tau=0.8229 loss=0.643053 mse_soft=0.641151 ent_in=3.1229 ent_out=3.2164 rowmax_in=0.0923 rowmax_out=0.0892 discrete_mse=6730.986816 best_discrete=61.376434 hash=False elapsed=4.8s
step    75/900 tau=0.7450 loss=0.501300 mse_soft=0.499733 ent_in=2.5870 ent_out=2.6349 rowmax_in=0.1993 rowmax_out=0.2028 discrete_mse=1044.904419 best_discrete=61.376434 hash=False elapsed=7.0s
step   100/900 tau=0.6745 loss=0.400359 mse_soft=0.399203 ent_in=1.9995 ent_out=1.8558 rowmax_in=0.3349 rowmax_out=0.3995 discrete_mse=428.311829 best_discrete=61.376434 hash=False elapsed=9.2s
step   125/900 tau=0.6107 loss=0.340949 mse_soft=0.340092 ent_in=1.5989 ent_out=1.2608 rowmax_in=0.4289 rowmax_out=0.5687 discrete_mse=274.436798 best_discrete=61.376434 hash=False elapsed=11.4s
step   150/900 tau=0.5529 loss=0.304608 mse_soft=0.303941 ent_in=1.3794 ent_out=0.8455 rowmax_in=0.4777 rowmax_out=0.7023 discrete_mse=535.411621 best_discrete=61.376434 hash=False elapsed=13.8s
step   175/900 tau=0.5006 loss=0.290807 mse_soft=0.290224 ent_in=1.2683 ent_out=0.6747 rowmax_in=0.5006 rowmax_out=0.7455 discrete_mse=739.297668 best_discrete=61.376434 hash=False elapsed=16.1s
step   200/900 tau=0.4532 loss=0.283858 mse_soft=0.283319 ent_in=1.2127 ent_out=0.5852 rowmax_in=0.5086 rowmax_out=0.7641 discrete_mse=527.222473 best_discrete=61.376434 hash=False elapsed=18.6s
step   225/900 tau=0.4103 loss=0.278818 mse_soft=0.278306 ent_in=1.1796 ent_out=0.5267 rowmax_in=0.5084 rowmax_out=0.7812 discrete_mse=823.367004 best_discrete=61.376434 hash=False elapsed=21.1s
step   250/900 tau=0.3715 loss=0.276753 mse_soft=0.276266 ent_in=1.1590 ent_out=0.4657 rowmax_in=0.5132 rowmax_out=0.8005 discrete_mse=405.370850 best_discrete=61.376434 hash=False elapsed=23.5s
step   275/900 tau=0.3363 loss=0.273679 mse_soft=0.273213 ent_in=1.1368 ent_out=0.4149 rowmax_in=0.5214 rowmax_out=0.8168 discrete_mse=431.097504 best_discrete=61.376434 hash=False elapsed=25.8s
step   300/900 tau=0.3045 loss=0.273514 mse_soft=0.273068 ent_in=1.1100 ent_out=0.3780 rowmax_in=0.5305 rowmax_out=0.8273 discrete_mse=946.263367 best_discrete=61.376434 hash=False elapsed=28.1s
step   325/900 tau=0.2756 loss=0.270096 mse_soft=0.269662 ent_in=1.0918 ent_out=0.3566 rowmax_in=0.5351 rowmax_out=0.8335 discrete_mse=946.263367 best_discrete=61.376434 hash=False elapsed=30.2s
step   350/900 tau=0.2496 loss=0.270480 mse_soft=0.270054 ent_in=1.0761 ent_out=0.3449 rowmax_in=0.5404 rowmax_out=0.8354 discrete_mse=312.638550 best_discrete=61.376434 hash=False elapsed=32.6s
step   375/900 tau=0.2259 loss=0.267191 mse_soft=0.266771 ent_in=1.0642 ent_out=0.3360 rowmax_in=0.5462 rowmax_out=0.8391 discrete_mse=312.638550 best_discrete=61.376434 hash=False elapsed=34.6s
step   400/900 tau=0.2046 loss=0.267826 mse_soft=0.267411 ent_in=1.0534 ent_out=0.3317 rowmax_in=0.5507 rowmax_out=0.8408 discrete_mse=312.638550 best_discrete=61.376434 hash=False elapsed=36.8s
step   425/900 tau=0.1852 loss=0.266808 mse_soft=0.266395 ent_in=1.0480 ent_out=0.3286 rowmax_in=0.5501 rowmax_out=0.8436 discrete_mse=314.875610 best_discrete=61.376434 hash=False elapsed=39.1s
step   450/900 tau=0.1677 loss=0.269165 mse_soft=0.268753 ent_in=1.0427 ent_out=0.3301 rowmax_in=0.5488 rowmax_out=0.8429 discrete_mse=314.875610 best_discrete=61.376434 hash=False elapsed=41.3s
step   475/900 tau=0.1518 loss=0.276616 mse_soft=0.276203 ent_in=1.0356 ent_out=0.3389 rowmax_in=0.5506 rowmax_out=0.8384 discrete_mse=314.875610 best_discrete=61.376434 hash=False elapsed=43.7s
step   500/900 tau=0.1374 loss=0.267529 mse_soft=0.267117 ent_in=1.0322 ent_out=0.3401 rowmax_in=0.5523 rowmax_out=0.8364 discrete_mse=314.875610 best_discrete=61.376434 hash=False elapsed=45.9s
step   525/900 tau=0.1244 loss=0.272054 mse_soft=0.271646 ent_in=1.0263 ent_out=0.3356 rowmax_in=0.5537 rowmax_out=0.8396 discrete_mse=314.875610 best_discrete=61.376434 hash=False elapsed=48.1s
step   550/900 tau=0.1126 loss=0.271697 mse_soft=0.271291 ent_in=1.0218 ent_out=0.3310 rowmax_in=0.5561 rowmax_out=0.8416 discrete_mse=312.638550 best_discrete=61.376434 hash=False elapsed=50.6s
step   575/900 tau=0.1020 loss=0.267278 mse_soft=0.266876 ent_in=1.0175 ent_out=0.3240 rowmax_in=0.5553 rowmax_out=0.8408 discrete_mse=222.829102 best_discrete=61.376434 hash=False elapsed=53.1s
step   600/900 tau=0.0923 loss=0.270822 mse_soft=0.270423 ent_in=1.0128 ent_out=0.3194 rowmax_in=0.5546 rowmax_out=0.8472 discrete_mse=345.374481 best_discrete=61.376434 hash=False elapsed=55.7s
step   625/900 tau=0.0836 loss=0.268355 mse_soft=0.267957 ent_in=1.0117 ent_out=0.3130 rowmax_in=0.5543 rowmax_out=0.8498 discrete_mse=394.138428 best_discrete=61.376434 hash=False elapsed=58.0s
step   650/900 tau=0.0757 loss=0.308699 mse_soft=0.308330 ent_in=0.9304 ent_out=0.2995 rowmax_in=0.5710 rowmax_out=0.8388 discrete_mse=58.650536 best_discrete=58.650536 hash=False elapsed=60.3s
step   675/900 tau=0.0685 loss=0.337466 mse_soft=0.337110 ent_in=0.9169 ent_out=0.2687 rowmax_in=0.5759 rowmax_out=0.8571 discrete_mse=162.160522 best_discrete=58.650536 hash=False elapsed=62.6s
step   700/900 tau=0.0620 loss=0.285096 mse_soft=0.284741 ent_in=0.9142 ent_out=0.2667 rowmax_in=0.5727 rowmax_out=0.8599 discrete_mse=69.861328 best_discrete=58.650536 hash=False elapsed=65.0s
step   725/900 tau=0.0562 loss=0.290417 mse_soft=0.290064 ent_in=0.9098 ent_out=0.2694 rowmax_in=0.5757 rowmax_out=0.8655 discrete_mse=211.584595 best_discrete=58.650536 hash=False elapsed=67.4s
step   750/900 tau=0.0508 loss=0.288449 mse_soft=0.288095 ent_in=0.9123 ent_out=0.2692 rowmax_in=0.5818 rowmax_out=0.8618 discrete_mse=255.381790 best_discrete=58.650536 hash=False elapsed=69.6s
step   775/900 tau=0.0460 loss=0.326550 mse_soft=0.326218 ent_in=0.8351 ent_out=0.2731 rowmax_in=0.6067 rowmax_out=0.8657 discrete_mse=159.945160 best_discrete=58.650536 hash=False elapsed=71.8s
step   800/900 tau=0.0417 loss=0.337164 mse_soft=0.336880 ent_in=0.7299 ent_out=0.2168 rowmax_in=0.6425 rowmax_out=0.8907 discrete_mse=20.154764 best_discrete=20.154764 hash=False elapsed=74.3s
step   825/900 tau=0.0377 loss=0.312912 mse_soft=0.312617 ent_in=0.7434 ent_out=0.2402 rowmax_in=0.6280 rowmax_out=0.8735 discrete_mse=18.636738 best_discrete=18.636738 hash=False elapsed=76.4s
step   850/900 tau=0.0342 loss=0.313659 mse_soft=0.313388 ent_in=0.6963 ent_out=0.2094 rowmax_in=0.6563 rowmax_out=0.9008 discrete_mse=67.738525 best_discrete=18.636738 hash=False elapsed=78.6s
step   875/900 tau=0.0309 loss=0.315493 mse_soft=0.315223 ent_in=0.6706 ent_out=0.2306 rowmax_in=0.6553 rowmax_out=0.8701 discrete_mse=51.314323 best_discrete=18.636738 hash=False elapsed=81.1s
step   900/900 tau=0.0280 loss=0.522989 mse_soft=0.522834 ent_in=0.4184 ent_out=0.0980 rowmax_in=0.7731 rowmax_out=0.9528 discrete_mse=8.114570 best_discrete=8.114570 hash=False elapsed=83.4s

Final metrics:
  soft_mse_full=0.542321
  rowmax_in_mean=0.7797
  rowmax_out_mean=0.9543
  ent_in_mean=0.4078
  ent_out_mean=0.0958
  final_discrete_mse=6.861517
  hash_match=False
  best_discrete_mse_seen=8.114570
Saved results to overnight_b242_j2.json
