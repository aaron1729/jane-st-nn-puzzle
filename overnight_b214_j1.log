Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.062243 mse_soft=1.059920 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=191.826004 best_discrete=191.826004 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.856674 mse_soft=0.854483 ent_in=3.6333 ent_out=3.6695 rowmax_in=0.0459 rowmax_out=0.0439 discrete_mse=1658.485962 best_discrete=191.826004 hash=False elapsed=2.5s
step    50/900 tau=0.8260 loss=0.637653 mse_soft=0.635751 ent_in=3.1176 ent_out=3.2212 rowmax_in=0.0944 rowmax_out=0.0871 discrete_mse=21980.503906 best_discrete=191.826004 hash=False elapsed=4.8s
step    75/900 tau=0.7493 loss=0.503198 mse_soft=0.501617 ent_in=2.5935 ent_out=2.6777 rowmax_in=0.1984 rowmax_out=0.1976 discrete_mse=150.204971 best_discrete=150.204971 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.388733 mse_soft=0.387594 ent_in=1.9725 ent_out=1.8240 rowmax_in=0.3344 rowmax_out=0.4317 discrete_mse=495.634399 best_discrete=150.204971 hash=False elapsed=9.6s
step   125/900 tau=0.6165 loss=0.332880 mse_soft=0.332053 ent_in=1.5542 ent_out=1.2037 rowmax_in=0.4390 rowmax_out=0.5895 discrete_mse=1380.853149 best_discrete=150.204971 hash=False elapsed=12.0s
step   150/900 tau=0.5592 loss=0.310607 mse_soft=0.309902 ent_in=1.4138 ent_out=0.9356 rowmax_in=0.4709 rowmax_out=0.6556 discrete_mse=998.637451 best_discrete=150.204971 hash=False elapsed=14.4s
step   175/900 tau=0.5073 loss=0.293698 mse_soft=0.293091 ent_in=1.3054 ent_out=0.7180 rowmax_in=0.4960 rowmax_out=0.7156 discrete_mse=473.761383 best_discrete=150.204971 hash=False elapsed=17.0s
step   200/900 tau=0.4602 loss=0.284281 mse_soft=0.283738 ent_in=1.2340 ent_out=0.5769 rowmax_in=0.5080 rowmax_out=0.7580 discrete_mse=390.343842 best_discrete=150.204971 hash=False elapsed=19.4s
step   225/900 tau=0.4174 loss=0.280038 mse_soft=0.279521 ent_in=1.1940 ent_out=0.5300 rowmax_in=0.5146 rowmax_out=0.7669 discrete_mse=210.176147 best_discrete=150.204971 hash=False elapsed=21.5s
step   250/900 tau=0.3786 loss=0.276730 mse_soft=0.276226 ent_in=1.1758 ent_out=0.5033 rowmax_in=0.5163 rowmax_out=0.7734 discrete_mse=231.588837 best_discrete=150.204971 hash=False elapsed=23.8s
step   275/900 tau=0.3434 loss=0.275884 mse_soft=0.275387 ent_in=1.1650 ent_out=0.4914 rowmax_in=0.5137 rowmax_out=0.7704 discrete_mse=191.507446 best_discrete=150.204971 hash=False elapsed=26.2s
step   300/900 tau=0.3115 loss=0.275144 mse_soft=0.274650 ent_in=1.1631 ent_out=0.4836 rowmax_in=0.5112 rowmax_out=0.7688 discrete_mse=427.078552 best_discrete=150.204971 hash=False elapsed=28.9s
step   325/900 tau=0.2826 loss=0.274877 mse_soft=0.274388 ent_in=1.1616 ent_out=0.4709 rowmax_in=0.5104 rowmax_out=0.7708 discrete_mse=510.241028 best_discrete=150.204971 hash=False elapsed=31.3s
step   350/900 tau=0.2563 loss=0.272939 mse_soft=0.272451 ent_in=1.1595 ent_out=0.4667 rowmax_in=0.5089 rowmax_out=0.7695 discrete_mse=510.241028 best_discrete=150.204971 hash=False elapsed=33.7s
step   375/900 tau=0.2325 loss=0.273401 mse_soft=0.272918 ent_in=1.1603 ent_out=0.4495 rowmax_in=0.5073 rowmax_out=0.7722 discrete_mse=1095.976196 best_discrete=150.204971 hash=False elapsed=35.9s
step   400/900 tau=0.2109 loss=0.272606 mse_soft=0.272135 ent_in=1.1452 ent_out=0.4251 rowmax_in=0.5085 rowmax_out=0.7788 discrete_mse=114.104607 best_discrete=114.104607 hash=False elapsed=38.2s
step   425/900 tau=0.1913 loss=0.271944 mse_soft=0.271479 ent_in=1.1373 ent_out=0.4137 rowmax_in=0.5082 rowmax_out=0.7813 discrete_mse=849.589050 best_discrete=114.104607 hash=False elapsed=40.5s
step   450/900 tau=0.1735 loss=0.272901 mse_soft=0.272437 ent_in=1.1364 ent_out=0.4093 rowmax_in=0.5060 rowmax_out=0.7849 discrete_mse=23.928627 best_discrete=23.928627 hash=False elapsed=42.7s
step   475/900 tau=0.1574 loss=0.271326 mse_soft=0.270866 ent_in=1.1278 ent_out=0.4056 rowmax_in=0.5101 rowmax_out=0.7853 discrete_mse=97.767075 best_discrete=23.928627 hash=False elapsed=45.0s
step   500/900 tau=0.1428 loss=0.270813 mse_soft=0.270356 ent_in=1.1226 ent_out=0.4000 rowmax_in=0.5106 rowmax_out=0.7893 discrete_mse=14.506462 best_discrete=14.506462 hash=False elapsed=47.3s
step   525/900 tau=0.1295 loss=0.274991 mse_soft=0.274535 ent_in=1.1220 ent_out=0.3966 rowmax_in=0.5105 rowmax_out=0.7902 discrete_mse=12.706213 best_discrete=12.706213 hash=False elapsed=49.6s
step   550/900 tau=0.1175 loss=0.283516 mse_soft=0.283063 ent_in=1.1196 ent_out=0.3910 rowmax_in=0.5071 rowmax_out=0.7951 discrete_mse=116.669945 best_discrete=12.706213 hash=False elapsed=52.0s
step   575/900 tau=0.1066 loss=0.269394 mse_soft=0.268942 ent_in=1.1191 ent_out=0.3866 rowmax_in=0.5123 rowmax_out=0.7934 discrete_mse=148.991669 best_discrete=12.706213 hash=False elapsed=54.5s
step   600/900 tau=0.0967 loss=0.281446 mse_soft=0.281004 ent_in=1.0960 ent_out=0.3783 rowmax_in=0.5165 rowmax_out=0.8001 discrete_mse=153.526276 best_discrete=12.706213 hash=False elapsed=56.8s
step   625/900 tau=0.0877 loss=0.284283 mse_soft=0.283864 ent_in=1.0375 ent_out=0.3581 rowmax_in=0.5387 rowmax_out=0.8032 discrete_mse=26.068024 best_discrete=12.706213 hash=False elapsed=59.0s
step   650/900 tau=0.0795 loss=0.290459 mse_soft=0.290042 ent_in=1.0326 ent_out=0.3561 rowmax_in=0.5408 rowmax_out=0.8086 discrete_mse=128.679352 best_discrete=12.706213 hash=False elapsed=61.2s
step   675/900 tau=0.0722 loss=0.281416 mse_soft=0.280995 ent_in=1.0466 ent_out=0.3567 rowmax_in=0.5358 rowmax_out=0.8039 discrete_mse=74.105850 best_discrete=12.706213 hash=False elapsed=63.4s
step   700/900 tau=0.0655 loss=0.280833 mse_soft=0.280419 ent_in=1.0296 ent_out=0.3523 rowmax_in=0.5395 rowmax_out=0.8130 discrete_mse=100.703148 best_discrete=12.706213 hash=False elapsed=65.5s
step   725/900 tau=0.0594 loss=0.294025 mse_soft=0.293612 ent_in=1.0291 ent_out=0.3460 rowmax_in=0.5395 rowmax_out=0.8207 discrete_mse=13.298292 best_discrete=12.706213 hash=False elapsed=67.9s
step   750/900 tau=0.0539 loss=0.365104 mse_soft=0.364869 ent_in=0.6244 ent_out=0.1594 rowmax_in=0.7021 rowmax_out=0.9270 discrete_mse=18.824881 best_discrete=12.706213 hash=False elapsed=70.3s
step   775/900 tau=0.0489 loss=0.344484 mse_soft=0.344230 ent_in=0.6508 ent_out=0.1987 rowmax_in=0.6613 rowmax_out=0.9043 discrete_mse=44.604622 best_discrete=12.706213 hash=False elapsed=72.7s
step   800/900 tau=0.0443 loss=0.332686 mse_soft=0.332425 ent_in=0.6652 ent_out=0.2025 rowmax_in=0.6510 rowmax_out=0.9001 discrete_mse=24.094667 best_discrete=12.706213 hash=False elapsed=75.0s
step   825/900 tau=0.0402 loss=0.409293 mse_soft=0.409081 ent_in=0.5344 ent_out=0.1734 rowmax_in=0.7312 rowmax_out=0.9196 discrete_mse=10.956078 best_discrete=10.956078 hash=False elapsed=77.3s
step   850/900 tau=0.0365 loss=0.388361 mse_soft=0.388201 ent_in=0.3628 ent_out=0.1693 rowmax_in=0.8223 rowmax_out=0.9265 discrete_mse=34.914719 best_discrete=10.956078 hash=False elapsed=79.7s
step   875/900 tau=0.0331 loss=0.378000 mse_soft=0.377825 ent_in=0.3764 ent_out=0.2049 rowmax_in=0.8052 rowmax_out=0.8956 discrete_mse=107.379219 best_discrete=10.956078 hash=False elapsed=82.1s
step   900/900 tau=0.0300 loss=0.399354 mse_soft=0.399213 ent_in=0.2710 ent_out=0.1966 rowmax_in=0.8657 rowmax_out=0.8984 discrete_mse=24.022322 best_discrete=10.956078 hash=False elapsed=84.2s

Final metrics:
  soft_mse_full=0.414861
  rowmax_in_mean=0.8649
  rowmax_out_mean=0.8982
  ent_in_mean=0.2721
  ent_out_mean=0.1974
  final_discrete_mse=24.022322
  hash_match=False
  best_discrete_mse_seen=10.956078
Saved results to overnight_b214_j1.json
