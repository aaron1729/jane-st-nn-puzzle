Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.053047 mse_soft=1.050725 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=11.759195 best_discrete=11.759195 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.854882 mse_soft=0.852692 ent_in=3.6338 ent_out=3.6676 rowmax_in=0.0467 rowmax_out=0.0443 discrete_mse=2051.921631 best_discrete=11.759195 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.647105 mse_soft=0.645201 ent_in=3.1255 ent_out=3.2211 rowmax_in=0.0944 rowmax_out=0.0896 discrete_mse=5628.761230 best_discrete=11.759195 hash=False elapsed=5.3s
step    75/900 tau=0.7450 loss=0.509177 mse_soft=0.507607 ent_in=2.5707 ent_out=2.6604 rowmax_in=0.2143 rowmax_out=0.2071 discrete_mse=2217.608643 best_discrete=11.759195 hash=False elapsed=7.6s
step   100/900 tau=0.6745 loss=0.396510 mse_soft=0.395390 ent_in=1.9018 ent_out=1.8301 rowmax_in=0.3856 rowmax_out=0.4339 discrete_mse=1468.929077 best_discrete=11.759195 hash=False elapsed=9.9s
step   125/900 tau=0.6107 loss=0.336245 mse_soft=0.335430 ent_in=1.5008 ent_out=1.2175 rowmax_in=0.4788 rowmax_out=0.6124 discrete_mse=2790.986816 best_discrete=11.759195 hash=False elapsed=12.2s
step   150/900 tau=0.5529 loss=0.317648 mse_soft=0.316950 ent_in=1.3644 ent_out=0.9621 rowmax_in=0.5078 rowmax_out=0.6527 discrete_mse=1776.285400 best_discrete=11.759195 hash=False elapsed=14.5s
step   175/900 tau=0.5006 loss=0.308932 mse_soft=0.308296 ent_in=1.2906 ent_out=0.8310 rowmax_in=0.5159 rowmax_out=0.6755 discrete_mse=1010.954773 best_discrete=11.759195 hash=False elapsed=16.9s
step   200/900 tau=0.4532 loss=0.304429 mse_soft=0.303838 ent_in=1.2459 ent_out=0.7266 rowmax_in=0.5189 rowmax_out=0.7000 discrete_mse=248.633148 best_discrete=11.759195 hash=False elapsed=19.5s
step   225/900 tau=0.4103 loss=0.300671 mse_soft=0.300104 ent_in=1.2232 ent_out=0.6665 rowmax_in=0.5184 rowmax_out=0.7127 discrete_mse=1037.400513 best_discrete=11.759195 hash=False elapsed=22.2s
step   250/900 tau=0.3715 loss=0.296117 mse_soft=0.295573 ent_in=1.1960 ent_out=0.6183 rowmax_in=0.5190 rowmax_out=0.7303 discrete_mse=1037.400513 best_discrete=11.759195 hash=False elapsed=24.5s
step   275/900 tau=0.3363 loss=0.296101 mse_soft=0.295571 ent_in=1.1786 ent_out=0.5899 rowmax_in=0.5175 rowmax_out=0.7341 discrete_mse=824.144958 best_discrete=11.759195 hash=False elapsed=26.6s
step   300/900 tau=0.3045 loss=0.294072 mse_soft=0.293553 ent_in=1.1662 ent_out=0.5626 rowmax_in=0.5213 rowmax_out=0.7398 discrete_mse=824.144958 best_discrete=11.759195 hash=False elapsed=28.7s
step   325/900 tau=0.2756 loss=0.290945 mse_soft=0.290441 ent_in=1.1527 ent_out=0.5273 rowmax_in=0.5240 rowmax_out=0.7522 discrete_mse=314.543854 best_discrete=11.759195 hash=False elapsed=31.0s
step   350/900 tau=0.2496 loss=0.291777 mse_soft=0.291286 ent_in=1.1356 ent_out=0.5013 rowmax_in=0.5269 rowmax_out=0.7595 discrete_mse=614.169495 best_discrete=11.759195 hash=False elapsed=33.5s
step   375/900 tau=0.2259 loss=0.289053 mse_soft=0.288573 ent_in=1.1164 ent_out=0.4854 rowmax_in=0.5312 rowmax_out=0.7615 discrete_mse=1381.920410 best_discrete=11.759195 hash=False elapsed=35.7s
step   400/900 tau=0.2046 loss=0.290206 mse_soft=0.289733 ent_in=1.1024 ent_out=0.4729 rowmax_in=0.5330 rowmax_out=0.7702 discrete_mse=1381.920410 best_discrete=11.759195 hash=False elapsed=37.9s
step   425/900 tau=0.1852 loss=0.296300 mse_soft=0.295833 ent_in=1.0945 ent_out=0.4617 rowmax_in=0.5338 rowmax_out=0.7765 discrete_mse=916.232300 best_discrete=11.759195 hash=False elapsed=40.2s
step   450/900 tau=0.1677 loss=0.294460 mse_soft=0.293998 ent_in=1.0899 ent_out=0.4493 rowmax_in=0.5345 rowmax_out=0.7785 discrete_mse=1417.461914 best_discrete=11.759195 hash=False elapsed=42.5s
step   475/900 tau=0.1518 loss=0.297987 mse_soft=0.297531 ent_in=1.0859 ent_out=0.4361 rowmax_in=0.5339 rowmax_out=0.7852 discrete_mse=916.232300 best_discrete=11.759195 hash=False elapsed=44.6s
step   500/900 tau=0.1374 loss=0.303656 mse_soft=0.303201 ent_in=1.0876 ent_out=0.4279 rowmax_in=0.5315 rowmax_out=0.7838 discrete_mse=916.232300 best_discrete=11.759195 hash=False elapsed=47.1s
step   525/900 tau=0.1244 loss=0.286236 mse_soft=0.285786 ent_in=1.0791 ent_out=0.4211 rowmax_in=0.5346 rowmax_out=0.7857 discrete_mse=788.362305 best_discrete=11.759195 hash=False elapsed=49.7s
step   550/900 tau=0.1126 loss=0.302463 mse_soft=0.302038 ent_in=1.0294 ent_out=0.3870 rowmax_in=0.5512 rowmax_out=0.7984 discrete_mse=1138.268555 best_discrete=11.759195 hash=False elapsed=52.1s
step   575/900 tau=0.1020 loss=0.318008 mse_soft=0.317586 ent_in=1.0152 ent_out=0.3911 rowmax_in=0.5584 rowmax_out=0.7989 discrete_mse=621.432556 best_discrete=11.759195 hash=False elapsed=54.1s
step   600/900 tau=0.0923 loss=0.295211 mse_soft=0.294793 ent_in=1.0068 ent_out=0.3858 rowmax_in=0.5578 rowmax_out=0.8078 discrete_mse=91.933357 best_discrete=11.759195 hash=False elapsed=56.4s
step   625/900 tau=0.0836 loss=0.349064 mse_soft=0.348708 ent_in=0.9094 ent_out=0.2780 rowmax_in=0.5808 rowmax_out=0.8660 discrete_mse=54.022175 best_discrete=11.759195 hash=False elapsed=58.8s
step   650/900 tau=0.0757 loss=0.331912 mse_soft=0.331582 ent_in=0.8117 ent_out=0.2880 rowmax_in=0.6028 rowmax_out=0.8578 discrete_mse=131.992325 best_discrete=11.759195 hash=False elapsed=61.2s
step   675/900 tau=0.0685 loss=0.324199 mse_soft=0.323870 ent_in=0.8049 ent_out=0.2930 rowmax_in=0.6040 rowmax_out=0.8612 discrete_mse=111.760384 best_discrete=11.759195 hash=False elapsed=63.6s
step   700/900 tau=0.0620 loss=0.322519 mse_soft=0.322186 ent_in=0.8059 ent_out=0.3025 rowmax_in=0.6121 rowmax_out=0.8535 discrete_mse=35.018295 best_discrete=11.759195 hash=False elapsed=66.0s
step   725/900 tau=0.0562 loss=0.326673 mse_soft=0.326348 ent_in=0.7963 ent_out=0.2888 rowmax_in=0.6177 rowmax_out=0.8609 discrete_mse=180.052521 best_discrete=11.759195 hash=False elapsed=68.4s
step   750/900 tau=0.0508 loss=0.323155 mse_soft=0.322831 ent_in=0.7915 ent_out=0.2880 rowmax_in=0.6202 rowmax_out=0.8606 discrete_mse=30.216980 best_discrete=11.759195 hash=False elapsed=70.7s
step   775/900 tau=0.0460 loss=0.322108 mse_soft=0.321788 ent_in=0.7833 ent_out=0.2842 rowmax_in=0.6259 rowmax_out=0.8633 discrete_mse=57.348961 best_discrete=11.759195 hash=False elapsed=72.9s
step   800/900 tau=0.0417 loss=0.325390 mse_soft=0.325077 ent_in=0.7767 ent_out=0.2697 rowmax_in=0.6160 rowmax_out=0.8720 discrete_mse=115.633934 best_discrete=11.759195 hash=False elapsed=75.3s
step   825/900 tau=0.0377 loss=0.955006 mse_soft=0.954868 ent_in=0.3498 ent_out=0.1106 rowmax_in=0.8352 rowmax_out=0.9357 discrete_mse=38.564953 best_discrete=11.759195 hash=False elapsed=77.6s
step   850/900 tau=0.0342 loss=0.555873 mse_soft=0.555773 ent_in=0.2294 ent_out=0.1054 rowmax_in=0.8704 rowmax_out=0.9419 discrete_mse=5.621871 best_discrete=5.621871 hash=False elapsed=79.8s
step   875/900 tau=0.0309 loss=0.489735 mse_soft=0.489642 ent_in=0.1820 ent_out=0.1272 rowmax_in=0.8996 rowmax_out=0.9214 discrete_mse=71.844421 best_discrete=5.621871 hash=False elapsed=81.8s
step   900/900 tau=0.0280 loss=0.475573 mse_soft=0.475478 ent_in=0.2004 ent_out=0.1166 rowmax_in=0.8922 rowmax_out=0.9249 discrete_mse=5.621871 best_discrete=5.621871 hash=False elapsed=84.0s

Final metrics:
  soft_mse_full=0.480321
  rowmax_in_mean=0.8928
  rowmax_out_mean=0.9245
  ent_in_mean=0.1995
  ent_out_mean=0.1159
  final_discrete_mse=8.039940
  hash_match=False
  best_discrete_mse_seen=5.621871
Saved results to overnight_b113_j2.json
