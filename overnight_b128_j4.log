Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.015
step     1/700 tau=1.0000 loss=1.064155 mse_soft=1.063381 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=91.936584 best_discrete=91.936584 hash=False elapsed=0.5s
step    25/700 tau=0.8810 loss=0.972084 mse_soft=0.971325 ent_in=3.7933 ent_out=3.8052 rowmax_in=0.0331 rowmax_out=0.0322 discrete_mse=2818.395020 best_discrete=91.936584 hash=False elapsed=2.7s
step    50/700 tau=0.7721 loss=0.786193 mse_soft=0.785485 ent_in=3.5170 ent_out=3.5653 rowmax_in=0.0569 rowmax_out=0.0543 discrete_mse=763.865173 best_discrete=91.936584 hash=False elapsed=4.8s
step    75/700 tau=0.6767 loss=0.640898 mse_soft=0.640262 ent_in=3.1281 ent_out=3.2310 rowmax_in=0.0976 rowmax_out=0.0926 discrete_mse=871.769348 best_discrete=91.936584 hash=False elapsed=7.0s
step   100/700 tau=0.5931 loss=0.531097 mse_soft=0.530543 ent_in=2.7171 ent_out=2.8173 rowmax_in=0.1839 rowmax_out=0.1737 discrete_mse=723.320190 best_discrete=91.936584 hash=False elapsed=9.4s
step   125/700 tau=0.5198 loss=0.438365 mse_soft=0.437930 ent_in=2.1888 ent_out=2.1657 rowmax_in=0.3016 rowmax_out=0.3182 discrete_mse=938.751648 best_discrete=91.936584 hash=False elapsed=11.7s
step   150/700 tau=0.4555 loss=0.373422 mse_soft=0.373091 ent_in=1.7634 ent_out=1.5426 rowmax_in=0.4051 rowmax_out=0.4960 discrete_mse=114.417847 best_discrete=91.936584 hash=False elapsed=13.9s
step   175/700 tau=0.3992 loss=0.334240 mse_soft=0.333989 ent_in=1.4988 ent_out=1.0069 rowmax_in=0.4547 rowmax_out=0.6688 discrete_mse=749.562500 best_discrete=91.936584 hash=False elapsed=16.1s
step   200/700 tau=0.3499 loss=0.316555 mse_soft=0.316345 ent_in=1.3907 ent_out=0.7078 rowmax_in=0.4655 rowmax_out=0.7453 discrete_mse=731.148254 best_discrete=91.936584 hash=False elapsed=18.2s
step   225/700 tau=0.3066 loss=0.307582 mse_soft=0.307397 ent_in=1.3166 ent_out=0.5335 rowmax_in=0.4795 rowmax_out=0.7915 discrete_mse=224.065887 best_discrete=91.936584 hash=False elapsed=20.4s
step   250/700 tau=0.2687 loss=0.302722 mse_soft=0.302548 ent_in=1.2714 ent_out=0.4700 rowmax_in=0.4811 rowmax_out=0.8029 discrete_mse=393.396088 best_discrete=91.936584 hash=False elapsed=22.5s
step   275/700 tau=0.2355 loss=0.298304 mse_soft=0.298139 ent_in=1.2235 ent_out=0.4289 rowmax_in=0.4867 rowmax_out=0.8136 discrete_mse=242.185547 best_discrete=91.936584 hash=False elapsed=24.6s
step   300/700 tau=0.2064 loss=0.296066 mse_soft=0.295906 ent_in=1.1954 ent_out=0.4024 rowmax_in=0.4890 rowmax_out=0.8200 discrete_mse=571.023926 best_discrete=91.936584 hash=False elapsed=26.8s
step   325/700 tau=0.1809 loss=0.296975 mse_soft=0.296821 ent_in=1.1774 ent_out=0.3669 rowmax_in=0.4920 rowmax_out=0.8333 discrete_mse=571.023926 best_discrete=91.936584 hash=False elapsed=29.0s
step   350/700 tau=0.1585 loss=0.295240 mse_soft=0.295089 ent_in=1.1643 ent_out=0.3539 rowmax_in=0.4959 rowmax_out=0.8363 discrete_mse=518.117798 best_discrete=91.936584 hash=False elapsed=31.2s
step   375/700 tau=0.1389 loss=0.296426 mse_soft=0.296275 ent_in=1.1597 ent_out=0.3518 rowmax_in=0.4956 rowmax_out=0.8352 discrete_mse=315.452881 best_discrete=91.936584 hash=False elapsed=33.4s
step   400/700 tau=0.1218 loss=0.294955 mse_soft=0.294804 ent_in=1.1519 ent_out=0.3533 rowmax_in=0.4981 rowmax_out=0.8329 discrete_mse=315.452881 best_discrete=91.936584 hash=False elapsed=35.7s
step   425/700 tau=0.1067 loss=0.295162 mse_soft=0.295013 ent_in=1.1427 ent_out=0.3522 rowmax_in=0.5016 rowmax_out=0.8303 discrete_mse=315.452881 best_discrete=91.936584 hash=False elapsed=37.7s
step   450/700 tau=0.0935 loss=0.296034 mse_soft=0.295885 ent_in=1.1413 ent_out=0.3469 rowmax_in=0.5011 rowmax_out=0.8342 discrete_mse=315.452881 best_discrete=91.936584 hash=False elapsed=40.0s
step   475/700 tau=0.0820 loss=0.295303 mse_soft=0.295154 ent_in=1.1407 ent_out=0.3496 rowmax_in=0.5014 rowmax_out=0.8306 discrete_mse=315.452881 best_discrete=91.936584 hash=False elapsed=42.4s
step   500/700 tau=0.0718 loss=0.326985 mse_soft=0.326837 ent_in=1.1307 ent_out=0.3493 rowmax_in=0.5054 rowmax_out=0.8328 discrete_mse=237.356674 best_discrete=91.936584 hash=False elapsed=44.6s
step   525/700 tau=0.0630 loss=0.295871 mse_soft=0.295725 ent_in=1.1177 ent_out=0.3438 rowmax_in=0.5021 rowmax_out=0.8340 discrete_mse=611.084106 best_discrete=91.936584 hash=False elapsed=46.8s
step   550/700 tau=0.0552 loss=0.305603 mse_soft=0.305457 ent_in=1.1046 ent_out=0.3539 rowmax_in=0.5012 rowmax_out=0.8283 discrete_mse=142.657227 best_discrete=91.936584 hash=False elapsed=49.0s
step   575/700 tau=0.0484 loss=0.444451 mse_soft=0.444306 ent_in=1.1072 ent_out=0.3471 rowmax_in=0.5067 rowmax_out=0.8331 discrete_mse=82.771065 best_discrete=82.771065 hash=False elapsed=51.3s
step   600/700 tau=0.0424 loss=0.338512 mse_soft=0.338391 ent_in=0.8911 ent_out=0.3217 rowmax_in=0.5845 rowmax_out=0.8445 discrete_mse=167.561493 best_discrete=82.771065 hash=False elapsed=53.7s
step   625/700 tau=0.0371 loss=0.323680 mse_soft=0.323561 ent_in=0.8969 ent_out=0.2984 rowmax_in=0.5808 rowmax_out=0.8547 discrete_mse=206.174164 best_discrete=82.771065 hash=False elapsed=55.9s
step   650/700 tau=0.0325 loss=0.321314 mse_soft=0.321197 ent_in=0.8780 ent_out=0.2928 rowmax_in=0.5858 rowmax_out=0.8516 discrete_mse=196.705688 best_discrete=82.771065 hash=False elapsed=58.1s
step   675/700 tau=0.0285 loss=0.340738 mse_soft=0.340625 ent_in=0.8548 ent_out=0.2801 rowmax_in=0.6028 rowmax_out=0.8610 discrete_mse=351.067535 best_discrete=82.771065 hash=False elapsed=60.2s
step   700/700 tau=0.0250 loss=0.403588 mse_soft=0.403486 ent_in=0.7138 ent_out=0.3123 rowmax_in=0.6506 rowmax_out=0.8422 discrete_mse=27.290499 best_discrete=27.290499 hash=False elapsed=62.5s

Final metrics:
  soft_mse_full=0.388241
  rowmax_in_mean=0.6693
  rowmax_out_mean=0.8413
  ent_in_mean=0.6917
  ent_out_mean=0.3136
  final_discrete_mse=45.979053
  hash_match=False
  best_discrete_mse_seen=27.290499
Saved results to overnight_b128_j4.json
