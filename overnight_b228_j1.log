Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.046989 mse_soft=1.044666 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=68.334671 best_discrete=68.334671 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.849721 mse_soft=0.847531 ent_in=3.6329 ent_out=3.6663 rowmax_in=0.0467 rowmax_out=0.0444 discrete_mse=2680.791992 best_discrete=68.334671 hash=False elapsed=2.5s
step    50/900 tau=0.8260 loss=0.638231 mse_soft=0.636329 ent_in=3.1200 ent_out=3.2179 rowmax_in=0.0968 rowmax_out=0.0886 discrete_mse=3771.281006 best_discrete=68.334671 hash=False elapsed=4.7s
step    75/900 tau=0.7493 loss=0.504837 mse_soft=0.503256 ent_in=2.5905 ent_out=2.6784 rowmax_in=0.2116 rowmax_out=0.2034 discrete_mse=125.028824 best_discrete=68.334671 hash=False elapsed=6.8s
step   100/900 tau=0.6797 loss=0.400108 mse_soft=0.398948 ent_in=2.0315 ent_out=1.8339 rowmax_in=0.3477 rowmax_out=0.4385 discrete_mse=3141.151611 best_discrete=68.334671 hash=False elapsed=8.9s
step   125/900 tau=0.6165 loss=0.331827 mse_soft=0.330997 ent_in=1.6507 ent_out=1.1166 rowmax_in=0.4285 rowmax_out=0.6520 discrete_mse=743.931335 best_discrete=68.334671 hash=False elapsed=11.0s
step   150/900 tau=0.5592 loss=0.300982 mse_soft=0.300348 ent_in=1.4023 ent_out=0.7130 rowmax_in=0.4780 rowmax_out=0.7671 discrete_mse=178.811539 best_discrete=68.334671 hash=False elapsed=13.1s
step   175/900 tau=0.5073 loss=0.287435 mse_soft=0.286886 ent_in=1.2756 ent_out=0.5519 rowmax_in=0.4969 rowmax_out=0.8004 discrete_mse=54.077972 best_discrete=54.077972 hash=False elapsed=15.4s
step   200/900 tau=0.4602 loss=0.280471 mse_soft=0.279967 ent_in=1.2222 ent_out=0.4563 rowmax_in=0.4999 rowmax_out=0.8210 discrete_mse=218.933426 best_discrete=54.077972 hash=False elapsed=17.4s
step   225/900 tau=0.4174 loss=0.275997 mse_soft=0.275531 ent_in=1.1731 ent_out=0.3801 rowmax_in=0.5111 rowmax_out=0.8440 discrete_mse=185.041962 best_discrete=54.077972 hash=False elapsed=19.6s
step   250/900 tau=0.3786 loss=0.271558 mse_soft=0.271117 ent_in=1.1437 ent_out=0.3292 rowmax_in=0.5157 rowmax_out=0.8593 discrete_mse=340.241730 best_discrete=54.077972 hash=False elapsed=21.8s
step   275/900 tau=0.3434 loss=0.267552 mse_soft=0.267121 ent_in=1.1358 ent_out=0.3009 rowmax_in=0.5144 rowmax_out=0.8713 discrete_mse=432.486450 best_discrete=54.077972 hash=False elapsed=24.1s
step   300/900 tau=0.3115 loss=0.265197 mse_soft=0.264772 ent_in=1.1276 ent_out=0.2904 rowmax_in=0.5139 rowmax_out=0.8673 discrete_mse=199.211426 best_discrete=54.077972 hash=False elapsed=26.3s
step   325/900 tau=0.2826 loss=0.264201 mse_soft=0.263781 ent_in=1.1186 ent_out=0.2840 rowmax_in=0.5152 rowmax_out=0.8669 discrete_mse=6.514146 best_discrete=6.514146 hash=False elapsed=28.6s
step   350/900 tau=0.2563 loss=0.263691 mse_soft=0.263271 ent_in=1.1105 ent_out=0.2877 rowmax_in=0.5171 rowmax_out=0.8638 discrete_mse=10.910383 best_discrete=6.514146 hash=False elapsed=30.8s
step   375/900 tau=0.2325 loss=0.264000 mse_soft=0.263583 ent_in=1.1054 ent_out=0.2838 rowmax_in=0.5172 rowmax_out=0.8633 discrete_mse=33.937080 best_discrete=6.514146 hash=False elapsed=33.0s
step   400/900 tau=0.2109 loss=0.262947 mse_soft=0.262533 ent_in=1.1012 ent_out=0.2778 rowmax_in=0.5192 rowmax_out=0.8649 discrete_mse=33.937080 best_discrete=6.514146 hash=False elapsed=35.3s
step   425/900 tau=0.1913 loss=0.261985 mse_soft=0.261576 ent_in=1.0916 ent_out=0.2736 rowmax_in=0.5225 rowmax_out=0.8620 discrete_mse=33.937080 best_discrete=6.514146 hash=False elapsed=37.4s
step   450/900 tau=0.1735 loss=0.261027 mse_soft=0.260622 ent_in=1.0785 ent_out=0.2712 rowmax_in=0.5258 rowmax_out=0.8595 discrete_mse=27.607637 best_discrete=6.514146 hash=False elapsed=39.6s
step   475/900 tau=0.1574 loss=0.263496 mse_soft=0.263095 ent_in=1.0694 ent_out=0.2650 rowmax_in=0.5268 rowmax_out=0.8577 discrete_mse=27.607637 best_discrete=6.514146 hash=False elapsed=42.0s
step   500/900 tau=0.1428 loss=0.265079 mse_soft=0.264683 ent_in=1.0625 ent_out=0.2594 rowmax_in=0.5295 rowmax_out=0.8586 discrete_mse=18.302256 best_discrete=6.514146 hash=False elapsed=44.2s
step   525/900 tau=0.1295 loss=0.262456 mse_soft=0.262063 ent_in=1.0546 ent_out=0.2560 rowmax_in=0.5305 rowmax_out=0.8577 discrete_mse=94.425713 best_discrete=6.514146 hash=False elapsed=46.4s
step   550/900 tau=0.1175 loss=0.261159 mse_soft=0.260768 ent_in=1.0519 ent_out=0.2510 rowmax_in=0.5300 rowmax_out=0.8601 discrete_mse=27.607637 best_discrete=6.514146 hash=False elapsed=48.5s
step   575/900 tau=0.1066 loss=0.262521 mse_soft=0.262133 ent_in=1.0495 ent_out=0.2426 rowmax_in=0.5288 rowmax_out=0.8625 discrete_mse=195.107468 best_discrete=6.514146 hash=False elapsed=50.8s
step   600/900 tau=0.0967 loss=0.275291 mse_soft=0.274909 ent_in=1.0298 ent_out=0.2435 rowmax_in=0.5377 rowmax_out=0.8586 discrete_mse=20.046947 best_discrete=6.514146 hash=False elapsed=53.1s
step   625/900 tau=0.0877 loss=0.261190 mse_soft=0.260809 ent_in=1.0409 ent_out=0.2298 rowmax_in=0.5260 rowmax_out=0.8687 discrete_mse=43.075241 best_discrete=6.514146 hash=False elapsed=55.3s
step   650/900 tau=0.0795 loss=0.289271 mse_soft=0.288896 ent_in=1.0134 ent_out=0.2371 rowmax_in=0.5372 rowmax_out=0.8675 discrete_mse=20.996916 best_discrete=6.514146 hash=False elapsed=57.4s
step   675/900 tau=0.0722 loss=0.305258 mse_soft=0.304942 ent_in=0.8693 ent_out=0.1852 rowmax_in=0.5841 rowmax_out=0.9026 discrete_mse=215.045898 best_discrete=6.514146 hash=False elapsed=59.5s
step   700/900 tau=0.0655 loss=0.281082 mse_soft=0.280772 ent_in=0.8383 ent_out=0.1947 rowmax_in=0.5859 rowmax_out=0.8882 discrete_mse=57.756725 best_discrete=6.514146 hash=False elapsed=61.6s
step   725/900 tau=0.0594 loss=0.333071 mse_soft=0.332768 ent_in=0.8218 ent_out=0.1897 rowmax_in=0.5958 rowmax_out=0.8969 discrete_mse=33.994442 best_discrete=6.514146 hash=False elapsed=63.7s
step   750/900 tau=0.0539 loss=0.419222 mse_soft=0.418989 ent_in=0.6127 ent_out=0.1660 rowmax_in=0.7189 rowmax_out=0.9159 discrete_mse=8.995470 best_discrete=6.514146 hash=False elapsed=65.7s
step   775/900 tau=0.0489 loss=0.571873 mse_soft=0.571646 ent_in=0.5705 ent_out=0.1839 rowmax_in=0.7235 rowmax_out=0.9041 discrete_mse=84.549339 best_discrete=6.514146 hash=False elapsed=67.9s
step   800/900 tau=0.0443 loss=0.549827 mse_soft=0.549689 ent_in=0.3335 ent_out=0.1282 rowmax_in=0.8277 rowmax_out=0.9284 discrete_mse=1.012064 best_discrete=1.012064 hash=False elapsed=70.2s
step   825/900 tau=0.0402 loss=0.567127 mse_soft=0.566990 ent_in=0.3566 ent_out=0.1012 rowmax_in=0.8072 rowmax_out=0.9412 discrete_mse=11.388514 best_discrete=1.012064 hash=False elapsed=72.4s
step   850/900 tau=0.0365 loss=0.529944 mse_soft=0.529823 ent_in=0.3123 ent_out=0.0900 rowmax_in=0.8274 rowmax_out=0.9462 discrete_mse=5.899938 best_discrete=1.012064 hash=False elapsed=74.6s
step   875/900 tau=0.0331 loss=0.520802 mse_soft=0.520680 ent_in=0.3145 ent_out=0.0900 rowmax_in=0.8284 rowmax_out=0.9462 discrete_mse=6.166526 best_discrete=1.012064 hash=False elapsed=76.9s
step   900/900 tau=0.0300 loss=0.494034 mse_soft=0.493914 ent_in=0.3235 ent_out=0.0756 rowmax_in=0.8240 rowmax_out=0.9462 discrete_mse=5.215529 best_discrete=1.012064 hash=False elapsed=79.2s

Final metrics:
  soft_mse_full=0.509457
  rowmax_in_mean=0.8240
  rowmax_out_mean=0.9462
  ent_in_mean=0.3237
  ent_out_mean=0.0756
  final_discrete_mse=5.215529
  hash_match=False
  best_discrete_mse_seen=1.012064
Saved results to overnight_b228_j1.json
