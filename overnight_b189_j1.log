Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.063496 mse_soft=1.061174 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=22.829462 best_discrete=22.829462 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.858227 mse_soft=0.856037 ent_in=3.6332 ent_out=3.6675 rowmax_in=0.0458 rowmax_out=0.0445 discrete_mse=2179.885498 best_discrete=22.829462 hash=False elapsed=2.9s
step    50/900 tau=0.8260 loss=0.645041 mse_soft=0.643133 ent_in=3.1336 ent_out=3.2248 rowmax_in=0.0923 rowmax_out=0.0871 discrete_mse=974.552856 best_discrete=22.829462 hash=False elapsed=5.2s
step    75/900 tau=0.7493 loss=0.511415 mse_soft=0.509836 ent_in=2.5935 ent_out=2.6699 rowmax_in=0.2115 rowmax_out=0.1969 discrete_mse=573.002197 best_discrete=22.829462 hash=False elapsed=7.5s
step   100/900 tau=0.6797 loss=0.407325 mse_soft=0.406172 ent_in=1.9969 ent_out=1.8451 rowmax_in=0.3479 rowmax_out=0.4089 discrete_mse=936.019897 best_discrete=22.829462 hash=False elapsed=9.9s
step   125/900 tau=0.6165 loss=0.349810 mse_soft=0.348970 ent_in=1.6674 ent_out=1.1321 rowmax_in=0.4185 rowmax_out=0.6330 discrete_mse=729.480957 best_discrete=22.829462 hash=False elapsed=12.2s
step   150/900 tau=0.5592 loss=0.325333 mse_soft=0.324663 ent_in=1.4930 ent_out=0.7403 rowmax_in=0.4605 rowmax_out=0.7382 discrete_mse=71.674995 best_discrete=22.829462 hash=False elapsed=14.4s
step   175/900 tau=0.5073 loss=0.308895 mse_soft=0.308315 ent_in=1.3664 ent_out=0.5656 rowmax_in=0.4958 rowmax_out=0.7832 discrete_mse=462.382690 best_discrete=22.829462 hash=False elapsed=16.8s
step   200/900 tau=0.4602 loss=0.299326 mse_soft=0.298803 ent_in=1.2595 ent_out=0.4832 rowmax_in=0.5241 rowmax_out=0.8092 discrete_mse=2740.058838 best_discrete=22.829462 hash=False elapsed=18.9s
step   225/900 tau=0.4174 loss=0.290945 mse_soft=0.290443 ent_in=1.2228 ent_out=0.4521 rowmax_in=0.5244 rowmax_out=0.8221 discrete_mse=1481.986938 best_discrete=22.829462 hash=False elapsed=21.3s
step   250/900 tau=0.3786 loss=0.288237 mse_soft=0.287753 ent_in=1.1915 ent_out=0.4212 rowmax_in=0.5290 rowmax_out=0.8266 discrete_mse=1481.986938 best_discrete=22.829462 hash=False elapsed=23.5s
step   275/900 tau=0.3434 loss=0.286678 mse_soft=0.286208 ent_in=1.1677 ent_out=0.3977 rowmax_in=0.5338 rowmax_out=0.8351 discrete_mse=2705.384033 best_discrete=22.829462 hash=False elapsed=25.9s
step   300/900 tau=0.3115 loss=0.286041 mse_soft=0.285578 ent_in=1.1557 ent_out=0.3887 rowmax_in=0.5340 rowmax_out=0.8358 discrete_mse=2462.741455 best_discrete=22.829462 hash=False elapsed=28.1s
step   325/900 tau=0.2826 loss=0.283342 mse_soft=0.282885 ent_in=1.1483 ent_out=0.3767 rowmax_in=0.5334 rowmax_out=0.8362 discrete_mse=1462.572510 best_discrete=22.829462 hash=False elapsed=30.3s
step   350/900 tau=0.2563 loss=0.283625 mse_soft=0.283170 ent_in=1.1421 ent_out=0.3731 rowmax_in=0.5339 rowmax_out=0.8334 discrete_mse=1462.572510 best_discrete=22.829462 hash=False elapsed=32.7s
step   375/900 tau=0.2325 loss=0.281168 mse_soft=0.280715 ent_in=1.1380 ent_out=0.3715 rowmax_in=0.5336 rowmax_out=0.8298 discrete_mse=1462.572510 best_discrete=22.829462 hash=False elapsed=34.8s
step   400/900 tau=0.2109 loss=0.281636 mse_soft=0.281187 ent_in=1.1269 ent_out=0.3687 rowmax_in=0.5364 rowmax_out=0.8248 discrete_mse=1462.572510 best_discrete=22.829462 hash=False elapsed=37.1s
step   425/900 tau=0.1913 loss=0.279770 mse_soft=0.279324 ent_in=1.1209 ent_out=0.3663 rowmax_in=0.5367 rowmax_out=0.8248 discrete_mse=1462.572510 best_discrete=22.829462 hash=False elapsed=39.2s
step   450/900 tau=0.1735 loss=0.280396 mse_soft=0.279952 ent_in=1.1169 ent_out=0.3627 rowmax_in=0.5369 rowmax_out=0.8262 discrete_mse=1462.572510 best_discrete=22.829462 hash=False elapsed=41.6s
step   475/900 tau=0.1574 loss=0.281192 mse_soft=0.280753 ent_in=1.1058 ent_out=0.3557 rowmax_in=0.5433 rowmax_out=0.8298 discrete_mse=1462.572510 best_discrete=22.829462 hash=False elapsed=44.0s
step   500/900 tau=0.1428 loss=0.280495 mse_soft=0.280059 ent_in=1.1012 ent_out=0.3534 rowmax_in=0.5449 rowmax_out=0.8299 discrete_mse=1462.572510 best_discrete=22.829462 hash=False elapsed=46.4s
step   525/900 tau=0.1295 loss=0.309300 mse_soft=0.308866 ent_in=1.0900 ent_out=0.3552 rowmax_in=0.5504 rowmax_out=0.8292 discrete_mse=523.592896 best_discrete=22.829462 hash=False elapsed=48.8s
step   550/900 tau=0.1175 loss=0.288497 mse_soft=0.288068 ent_in=1.0845 ent_out=0.3446 rowmax_in=0.5498 rowmax_out=0.8350 discrete_mse=1041.482910 best_discrete=22.829462 hash=False elapsed=51.1s
step   575/900 tau=0.1066 loss=0.282867 mse_soft=0.282440 ent_in=1.0782 ent_out=0.3450 rowmax_in=0.5522 rowmax_out=0.8339 discrete_mse=1545.185913 best_discrete=22.829462 hash=False elapsed=53.5s
step   600/900 tau=0.0967 loss=0.298572 mse_soft=0.298147 ent_in=1.0765 ent_out=0.3397 rowmax_in=0.5503 rowmax_out=0.8365 discrete_mse=1146.570679 best_discrete=22.829462 hash=False elapsed=55.8s
step   625/900 tau=0.0877 loss=0.308098 mse_soft=0.307678 ent_in=1.0669 ent_out=0.3327 rowmax_in=0.5486 rowmax_out=0.8384 discrete_mse=203.787415 best_discrete=22.829462 hash=False elapsed=57.8s
step   650/900 tau=0.0795 loss=0.304384 mse_soft=0.303975 ent_in=1.0386 ent_out=0.3245 rowmax_in=0.5468 rowmax_out=0.8359 discrete_mse=226.660095 best_discrete=22.829462 hash=False elapsed=60.0s
step   675/900 tau=0.0722 loss=0.292269 mse_soft=0.291871 ent_in=1.0127 ent_out=0.3156 rowmax_in=0.5628 rowmax_out=0.8445 discrete_mse=140.511017 best_discrete=22.829462 hash=False elapsed=62.5s
step   700/900 tau=0.0655 loss=0.451810 mse_soft=0.451482 ent_in=0.8676 ent_out=0.2272 rowmax_in=0.6289 rowmax_out=0.9072 discrete_mse=229.151993 best_discrete=22.829462 hash=False elapsed=64.9s
step   725/900 tau=0.0594 loss=0.372413 mse_soft=0.372135 ent_in=0.7277 ent_out=0.1983 rowmax_in=0.6461 rowmax_out=0.8933 discrete_mse=1.179866 best_discrete=1.179866 hash=False elapsed=67.1s
step   750/900 tau=0.0539 loss=0.404295 mse_soft=0.404073 ent_in=0.5940 ent_out=0.1449 rowmax_in=0.6951 rowmax_out=0.9370 discrete_mse=41.286480 best_discrete=1.179866 hash=False elapsed=69.4s
step   775/900 tau=0.0489 loss=0.413635 mse_soft=0.413418 ent_in=0.5721 ent_out=0.1518 rowmax_in=0.7003 rowmax_out=0.9213 discrete_mse=38.355007 best_discrete=1.179866 hash=False elapsed=71.6s
step   800/900 tau=0.0443 loss=0.380834 mse_soft=0.380627 ent_in=0.5383 ent_out=0.1513 rowmax_in=0.7130 rowmax_out=0.9191 discrete_mse=65.867371 best_discrete=1.179866 hash=False elapsed=73.9s
step   825/900 tau=0.0402 loss=0.390400 mse_soft=0.390218 ent_in=0.4881 ent_out=0.1182 rowmax_in=0.7399 rowmax_out=0.9324 discrete_mse=27.562080 best_discrete=1.179866 hash=False elapsed=76.3s
step   850/900 tau=0.0365 loss=0.368962 mse_soft=0.368761 ent_in=0.5308 ent_out=0.1398 rowmax_in=0.7156 rowmax_out=0.9241 discrete_mse=38.182575 best_discrete=1.179866 hash=False elapsed=78.5s
step   875/900 tau=0.0331 loss=0.419894 mse_soft=0.419703 ent_in=0.4955 ent_out=0.1422 rowmax_in=0.7361 rowmax_out=0.9237 discrete_mse=34.756855 best_discrete=1.179866 hash=False elapsed=80.8s
step   900/900 tau=0.0300 loss=0.412484 mse_soft=0.412332 ent_in=0.4542 ent_out=0.0518 rowmax_in=0.7683 rowmax_out=0.9493 discrete_mse=54.219360 best_discrete=1.179866 hash=False elapsed=83.2s

Final metrics:
  soft_mse_full=0.428078
  rowmax_in_mean=0.7752
  rowmax_out_mean=0.9493
  ent_in_mean=0.4435
  ent_out_mean=0.0517
  final_discrete_mse=54.219360
  hash_match=False
  best_discrete_mse_seen=1.179866
Saved results to overnight_b189_j1.json
