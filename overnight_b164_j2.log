Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.078654 mse_soft=1.076331 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=55.048660 best_discrete=55.048660 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.873872 mse_soft=0.871683 ent_in=3.6310 ent_out=3.6652 rowmax_in=0.0450 rowmax_out=0.0450 discrete_mse=4052.805176 best_discrete=55.048660 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.660004 mse_soft=0.658101 ent_in=3.1277 ent_out=3.2156 rowmax_in=0.0906 rowmax_out=0.0873 discrete_mse=2200.792236 best_discrete=55.048660 hash=False elapsed=5.3s
step    75/900 tau=0.7450 loss=0.513981 mse_soft=0.512411 ent_in=2.5890 ent_out=2.6450 rowmax_in=0.1995 rowmax_out=0.2054 discrete_mse=369.952637 best_discrete=55.048660 hash=False elapsed=7.7s
step   100/900 tau=0.6745 loss=0.397990 mse_soft=0.396849 ent_in=1.9822 ent_out=1.8216 rowmax_in=0.3459 rowmax_out=0.4147 discrete_mse=5871.417480 best_discrete=55.048660 hash=False elapsed=10.1s
step   125/900 tau=0.6107 loss=0.339037 mse_soft=0.338199 ent_in=1.5730 ent_out=1.2227 rowmax_in=0.4313 rowmax_out=0.5816 discrete_mse=312.500519 best_discrete=55.048660 hash=False elapsed=12.4s
step   150/900 tau=0.5529 loss=0.313636 mse_soft=0.312939 ent_in=1.3683 ent_out=0.9556 rowmax_in=0.4735 rowmax_out=0.6365 discrete_mse=332.318512 best_discrete=55.048660 hash=False elapsed=14.7s
step   175/900 tau=0.5006 loss=0.300430 mse_soft=0.299837 ent_in=1.2328 ent_out=0.7468 rowmax_in=0.5090 rowmax_out=0.6988 discrete_mse=582.991882 best_discrete=55.048660 hash=False elapsed=17.0s
step   200/900 tau=0.4532 loss=0.295006 mse_soft=0.294457 ent_in=1.1919 ent_out=0.6371 rowmax_in=0.5113 rowmax_out=0.7281 discrete_mse=267.209686 best_discrete=55.048660 hash=False elapsed=19.5s
step   225/900 tau=0.4103 loss=0.290834 mse_soft=0.290305 ent_in=1.1637 ent_out=0.5993 rowmax_in=0.5171 rowmax_out=0.7394 discrete_mse=249.351913 best_discrete=55.048660 hash=False elapsed=22.1s
step   250/900 tau=0.3715 loss=0.289122 mse_soft=0.288608 ent_in=1.1401 ent_out=0.5736 rowmax_in=0.5227 rowmax_out=0.7462 discrete_mse=385.153351 best_discrete=55.048660 hash=False elapsed=24.8s
step   275/900 tau=0.3363 loss=0.284005 mse_soft=0.283506 ent_in=1.1232 ent_out=0.5409 rowmax_in=0.5274 rowmax_out=0.7574 discrete_mse=1961.319580 best_discrete=55.048660 hash=False elapsed=27.2s
step   300/900 tau=0.3045 loss=0.281204 mse_soft=0.280723 ent_in=1.0965 ent_out=0.5066 rowmax_in=0.5353 rowmax_out=0.7703 discrete_mse=2639.798096 best_discrete=55.048660 hash=False elapsed=29.6s
step   325/900 tau=0.2756 loss=0.280775 mse_soft=0.280305 ent_in=1.0850 ent_out=0.4817 rowmax_in=0.5357 rowmax_out=0.7773 discrete_mse=1293.597534 best_discrete=55.048660 hash=False elapsed=32.1s
step   350/900 tau=0.2496 loss=0.282841 mse_soft=0.282378 ent_in=1.0746 ent_out=0.4683 rowmax_in=0.5370 rowmax_out=0.7803 discrete_mse=1293.597534 best_discrete=55.048660 hash=False elapsed=34.6s
step   375/900 tau=0.2259 loss=0.283050 mse_soft=0.282594 ent_in=1.0643 ent_out=0.4544 rowmax_in=0.5379 rowmax_out=0.7820 discrete_mse=1215.915527 best_discrete=55.048660 hash=False elapsed=36.9s
step   400/900 tau=0.2046 loss=0.284272 mse_soft=0.283821 ent_in=1.0569 ent_out=0.4454 rowmax_in=0.5383 rowmax_out=0.7830 discrete_mse=554.197327 best_discrete=55.048660 hash=False elapsed=39.1s
step   425/900 tau=0.1852 loss=0.283733 mse_soft=0.283286 ent_in=1.0535 ent_out=0.4389 rowmax_in=0.5377 rowmax_out=0.7824 discrete_mse=1215.915527 best_discrete=55.048660 hash=False elapsed=41.5s
step   450/900 tau=0.1677 loss=0.283999 mse_soft=0.283555 ent_in=1.0476 ent_out=0.4332 rowmax_in=0.5389 rowmax_out=0.7840 discrete_mse=554.197327 best_discrete=55.048660 hash=False elapsed=44.0s
step   475/900 tau=0.1518 loss=0.285483 mse_soft=0.285042 ent_in=1.0396 ent_out=0.4301 rowmax_in=0.5403 rowmax_out=0.7838 discrete_mse=554.197327 best_discrete=55.048660 hash=False elapsed=46.3s
step   500/900 tau=0.1374 loss=0.277826 mse_soft=0.277387 ent_in=1.0399 ent_out=0.4260 rowmax_in=0.5373 rowmax_out=0.7858 discrete_mse=554.197327 best_discrete=55.048660 hash=False elapsed=48.7s
step   525/900 tau=0.1244 loss=0.284880 mse_soft=0.284442 ent_in=1.0426 ent_out=0.4185 rowmax_in=0.5349 rowmax_out=0.7905 discrete_mse=1157.032227 best_discrete=55.048660 hash=False elapsed=51.0s
step   550/900 tau=0.1126 loss=0.305526 mse_soft=0.305092 ent_in=1.0499 ent_out=0.3959 rowmax_in=0.5248 rowmax_out=0.8033 discrete_mse=1148.397949 best_discrete=55.048660 hash=False elapsed=53.6s
step   575/900 tau=0.1020 loss=0.299327 mse_soft=0.298903 ent_in=1.0189 ent_out=0.3954 rowmax_in=0.5390 rowmax_out=0.7989 discrete_mse=782.767639 best_discrete=55.048660 hash=False elapsed=55.9s
step   600/900 tau=0.0923 loss=0.285809 mse_soft=0.285399 ent_in=0.9837 ent_out=0.3831 rowmax_in=0.5499 rowmax_out=0.8013 discrete_mse=843.788208 best_discrete=55.048660 hash=False elapsed=58.3s
step   625/900 tau=0.0836 loss=0.367962 mse_soft=0.367552 ent_in=0.9817 ent_out=0.3846 rowmax_in=0.5374 rowmax_out=0.8063 discrete_mse=238.998322 best_discrete=55.048660 hash=False elapsed=60.7s
step   650/900 tau=0.0757 loss=0.377192 mse_soft=0.376904 ent_in=0.7171 ent_out=0.2428 rowmax_in=0.6489 rowmax_out=0.8958 discrete_mse=314.954865 best_discrete=55.048660 hash=False elapsed=63.2s
step   675/900 tau=0.0685 loss=0.368782 mse_soft=0.368495 ent_in=0.6698 ent_out=0.2879 rowmax_in=0.6634 rowmax_out=0.8543 discrete_mse=728.567566 best_discrete=55.048660 hash=False elapsed=65.4s
step   700/900 tau=0.0620 loss=0.346597 mse_soft=0.346317 ent_in=0.6553 ent_out=0.2750 rowmax_in=0.6769 rowmax_out=0.8619 discrete_mse=283.159454 best_discrete=55.048660 hash=False elapsed=67.5s
step   725/900 tau=0.0562 loss=0.347765 mse_soft=0.347484 ent_in=0.6543 ent_out=0.2838 rowmax_in=0.6725 rowmax_out=0.8531 discrete_mse=283.159454 best_discrete=55.048660 hash=False elapsed=69.7s
step   750/900 tau=0.0508 loss=0.343202 mse_soft=0.342925 ent_in=0.6540 ent_out=0.2686 rowmax_in=0.6611 rowmax_out=0.8652 discrete_mse=196.441666 best_discrete=55.048660 hash=False elapsed=72.0s
step   775/900 tau=0.0460 loss=0.361701 mse_soft=0.361423 ent_in=0.6541 ent_out=0.2726 rowmax_in=0.6476 rowmax_out=0.8515 discrete_mse=144.317841 best_discrete=55.048660 hash=False elapsed=74.1s
step   800/900 tau=0.0417 loss=0.472758 mse_soft=0.472577 ent_in=0.4074 ent_out=0.1965 rowmax_in=0.8053 rowmax_out=0.8926 discrete_mse=24.646099 best_discrete=24.646099 hash=False elapsed=76.1s
step   825/900 tau=0.0377 loss=0.416128 mse_soft=0.415951 ent_in=0.4003 ent_out=0.1897 rowmax_in=0.8117 rowmax_out=0.8966 discrete_mse=32.236145 best_discrete=24.646099 hash=False elapsed=78.3s
step   850/900 tau=0.0342 loss=0.396550 mse_soft=0.396364 ent_in=0.4199 ent_out=0.2022 rowmax_in=0.7916 rowmax_out=0.8889 discrete_mse=11.203324 best_discrete=11.203324 hash=False elapsed=80.5s
step   875/900 tau=0.0309 loss=0.409979 mse_soft=0.409802 ent_in=0.3824 ent_out=0.2069 rowmax_in=0.8147 rowmax_out=0.8830 discrete_mse=82.062698 best_discrete=11.203324 hash=False elapsed=82.8s
step   900/900 tau=0.0280 loss=0.395341 mse_soft=0.395152 ent_in=0.4197 ent_out=0.2125 rowmax_in=0.7868 rowmax_out=0.8748 discrete_mse=28.465790 best_discrete=11.203324 hash=False elapsed=85.3s

Final metrics:
  soft_mse_full=0.394200
  rowmax_in_mean=0.7863
  rowmax_out_mean=0.8719
  ent_in_mean=0.4184
  ent_out_mean=0.2150
  final_discrete_mse=123.205872
  hash_match=False
  best_discrete_mse_seen=11.203324
Saved results to overnight_b164_j2.json
