Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.072393 mse_soft=1.070070 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=35.054356 best_discrete=35.054356 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.870161 mse_soft=0.867971 ent_in=3.6305 ent_out=3.6695 rowmax_in=0.0460 rowmax_out=0.0442 discrete_mse=2258.082764 best_discrete=35.054356 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.659524 mse_soft=0.657619 ent_in=3.1195 ent_out=3.2317 rowmax_in=0.0941 rowmax_out=0.0868 discrete_mse=3803.836670 best_discrete=35.054356 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.516233 mse_soft=0.514663 ent_in=2.5725 ent_out=2.6587 rowmax_in=0.2058 rowmax_out=0.1922 discrete_mse=8464.091797 best_discrete=35.054356 hash=False elapsed=7.1s
step   100/900 tau=0.6797 loss=0.397104 mse_soft=0.395965 ent_in=1.9517 ent_out=1.8454 rowmax_in=0.3434 rowmax_out=0.4052 discrete_mse=65.534035 best_discrete=35.054356 hash=False elapsed=9.3s
step   125/900 tau=0.6165 loss=0.337698 mse_soft=0.336876 ent_in=1.5583 ent_out=1.1815 rowmax_in=0.4400 rowmax_out=0.5912 discrete_mse=597.101868 best_discrete=35.054356 hash=False elapsed=11.7s
step   150/900 tau=0.5592 loss=0.314750 mse_soft=0.314079 ent_in=1.3920 ent_out=0.8438 rowmax_in=0.4715 rowmax_out=0.6979 discrete_mse=262.002991 best_discrete=35.054356 hash=False elapsed=14.2s
step   175/900 tau=0.5073 loss=0.299657 mse_soft=0.299075 ent_in=1.2834 ent_out=0.6565 rowmax_in=0.4961 rowmax_out=0.7533 discrete_mse=271.940155 best_discrete=35.054356 hash=False elapsed=16.5s
step   200/900 tau=0.4602 loss=0.291616 mse_soft=0.291084 ent_in=1.2194 ent_out=0.5545 rowmax_in=0.5096 rowmax_out=0.7940 discrete_mse=249.729568 best_discrete=35.054356 hash=False elapsed=18.8s
step   225/900 tau=0.4174 loss=0.286434 mse_soft=0.285940 ent_in=1.1673 ent_out=0.4806 rowmax_in=0.5226 rowmax_out=0.8225 discrete_mse=249.729568 best_discrete=35.054356 hash=False elapsed=21.1s
step   250/900 tau=0.3786 loss=0.283575 mse_soft=0.283102 ent_in=1.1357 ent_out=0.4416 rowmax_in=0.5305 rowmax_out=0.8305 discrete_mse=202.140488 best_discrete=35.054356 hash=False elapsed=23.4s
step   275/900 tau=0.3434 loss=0.280793 mse_soft=0.280332 ent_in=1.1199 ent_out=0.4157 rowmax_in=0.5322 rowmax_out=0.8363 discrete_mse=154.613678 best_discrete=35.054356 hash=False elapsed=25.5s
step   300/900 tau=0.3115 loss=0.276944 mse_soft=0.276492 ent_in=1.1087 ent_out=0.3982 rowmax_in=0.5358 rowmax_out=0.8412 discrete_mse=154.613678 best_discrete=35.054356 hash=False elapsed=27.7s
step   325/900 tau=0.2826 loss=0.275493 mse_soft=0.275052 ent_in=1.0991 ent_out=0.3725 rowmax_in=0.5375 rowmax_out=0.8510 discrete_mse=154.613678 best_discrete=35.054356 hash=False elapsed=29.9s
step   350/900 tau=0.2563 loss=0.275154 mse_soft=0.274721 ent_in=1.0956 ent_out=0.3471 rowmax_in=0.5350 rowmax_out=0.8598 discrete_mse=106.623894 best_discrete=35.054356 hash=False elapsed=32.0s
step   375/900 tau=0.2325 loss=0.274029 mse_soft=0.273605 ent_in=1.0860 ent_out=0.3272 rowmax_in=0.5327 rowmax_out=0.8658 discrete_mse=145.223297 best_discrete=35.054356 hash=False elapsed=34.3s
step   400/900 tau=0.2109 loss=0.283426 mse_soft=0.283008 ent_in=1.0782 ent_out=0.3133 rowmax_in=0.5329 rowmax_out=0.8720 discrete_mse=154.251846 best_discrete=35.054356 hash=False elapsed=36.8s
step   425/900 tau=0.1913 loss=0.275127 mse_soft=0.274709 ent_in=1.0752 ent_out=0.3183 rowmax_in=0.5339 rowmax_out=0.8669 discrete_mse=145.223297 best_discrete=35.054356 hash=False elapsed=39.0s
step   450/900 tau=0.1735 loss=0.276743 mse_soft=0.276328 ent_in=1.0716 ent_out=0.3112 rowmax_in=0.5334 rowmax_out=0.8700 discrete_mse=145.223297 best_discrete=35.054356 hash=False elapsed=41.4s
step   475/900 tau=0.1574 loss=0.281546 mse_soft=0.281136 ent_in=1.0648 ent_out=0.3005 rowmax_in=0.5340 rowmax_out=0.8738 discrete_mse=142.655487 best_discrete=35.054356 hash=False elapsed=43.7s
step   500/900 tau=0.1428 loss=0.274166 mse_soft=0.273758 ent_in=1.0641 ent_out=0.2936 rowmax_in=0.5312 rowmax_out=0.8756 discrete_mse=112.213173 best_discrete=35.054356 hash=False elapsed=45.8s
step   525/900 tau=0.1295 loss=0.273482 mse_soft=0.273078 ent_in=1.0615 ent_out=0.2852 rowmax_in=0.5298 rowmax_out=0.8774 discrete_mse=146.007614 best_discrete=35.054356 hash=False elapsed=48.2s
step   550/900 tau=0.1175 loss=0.272953 mse_soft=0.272550 ent_in=1.0614 ent_out=0.2821 rowmax_in=0.5258 rowmax_out=0.8752 discrete_mse=146.007614 best_discrete=35.054356 hash=False elapsed=50.7s
step   575/900 tau=0.1066 loss=0.278536 mse_soft=0.278136 ent_in=1.0525 ent_out=0.2819 rowmax_in=0.5318 rowmax_out=0.8748 discrete_mse=97.142632 best_discrete=35.054356 hash=False elapsed=52.9s
step   600/900 tau=0.0967 loss=0.282293 mse_soft=0.281900 ent_in=1.0423 ent_out=0.2671 rowmax_in=0.5249 rowmax_out=0.8779 discrete_mse=167.676865 best_discrete=35.054356 hash=False elapsed=55.2s
step   625/900 tau=0.0877 loss=0.285348 mse_soft=0.284959 ent_in=1.0306 ent_out=0.2650 rowmax_in=0.5329 rowmax_out=0.8795 discrete_mse=45.088448 best_discrete=35.054356 hash=False elapsed=57.7s
step   650/900 tau=0.0795 loss=0.275595 mse_soft=0.275205 ent_in=1.0357 ent_out=0.2635 rowmax_in=0.5293 rowmax_out=0.8784 discrete_mse=85.210487 best_discrete=35.054356 hash=False elapsed=60.0s
step   675/900 tau=0.0722 loss=0.284600 mse_soft=0.284217 ent_in=1.0223 ent_out=0.2573 rowmax_in=0.5354 rowmax_out=0.8785 discrete_mse=170.030731 best_discrete=35.054356 hash=False elapsed=62.2s
step   700/900 tau=0.0655 loss=0.298224 mse_soft=0.297862 ent_in=0.9739 ent_out=0.2326 rowmax_in=0.5577 rowmax_out=0.8895 discrete_mse=38.576633 best_discrete=35.054356 hash=False elapsed=64.5s
step   725/900 tau=0.0594 loss=0.285943 mse_soft=0.285583 ent_in=0.9675 ent_out=0.2324 rowmax_in=0.5464 rowmax_out=0.8853 discrete_mse=59.698898 best_discrete=35.054356 hash=False elapsed=66.6s
step   750/900 tau=0.0539 loss=0.282390 mse_soft=0.282032 ent_in=0.9647 ent_out=0.2263 rowmax_in=0.5477 rowmax_out=0.8866 discrete_mse=49.294323 best_discrete=35.054356 hash=False elapsed=68.6s
step   775/900 tau=0.0489 loss=0.368523 mse_soft=0.368219 ent_in=0.8100 ent_out=0.2018 rowmax_in=0.6346 rowmax_out=0.8987 discrete_mse=20.369793 best_discrete=20.369793 hash=False elapsed=70.7s
step   800/900 tau=0.0443 loss=0.372760 mse_soft=0.372545 ent_in=0.5338 ent_out=0.1819 rowmax_in=0.7261 rowmax_out=0.9056 discrete_mse=12.638286 best_discrete=12.638286 hash=False elapsed=72.7s
step   825/900 tau=0.0402 loss=0.357108 mse_soft=0.356886 ent_in=0.5556 ent_out=0.1832 rowmax_in=0.7042 rowmax_out=0.9085 discrete_mse=14.098582 best_discrete=12.638286 hash=False elapsed=74.6s
step   850/900 tau=0.0365 loss=0.353754 mse_soft=0.353529 ent_in=0.5553 ent_out=0.1942 rowmax_in=0.7009 rowmax_out=0.8977 discrete_mse=3.044918 best_discrete=3.044918 hash=False elapsed=76.8s
step   875/900 tau=0.0331 loss=0.365001 mse_soft=0.364784 ent_in=0.5416 ent_out=0.1833 rowmax_in=0.7188 rowmax_out=0.8999 discrete_mse=7.041459 best_discrete=3.044918 hash=False elapsed=79.0s
step   900/900 tau=0.0300 loss=0.352096 mse_soft=0.351880 ent_in=0.5422 ent_out=0.1794 rowmax_in=0.7175 rowmax_out=0.9021 discrete_mse=3.044918 best_discrete=3.044918 hash=False elapsed=81.3s

Final metrics:
  soft_mse_full=0.357189
  rowmax_in_mean=0.7171
  rowmax_out_mean=0.9007
  ent_in_mean=0.5415
  ent_out_mean=0.1803
  final_discrete_mse=3.044918
  hash_match=False
  best_discrete_mse_seen=3.044918
Saved results to overnight_b150_j1.json
