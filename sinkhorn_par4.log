Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.076205 mse_soft=1.073883 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=200.457275 best_discrete=200.457275 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.865556 mse_soft=0.863366 ent_in=3.6313 ent_out=3.6688 rowmax_in=0.0458 rowmax_out=0.0444 discrete_mse=1221.220337 best_discrete=200.457275 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.651621 mse_soft=0.649711 ent_in=3.1392 ent_out=3.2292 rowmax_in=0.0935 rowmax_out=0.0854 discrete_mse=9354.316406 best_discrete=200.457275 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.519335 mse_soft=0.517735 ent_in=2.6418 ent_out=2.6920 rowmax_in=0.1969 rowmax_out=0.1980 discrete_mse=1546.523438 best_discrete=200.457275 hash=False elapsed=7.1s
step   100/900 tau=0.6797 loss=0.409886 mse_soft=0.408709 ent_in=2.0401 ent_out=1.8826 rowmax_in=0.3371 rowmax_out=0.3977 discrete_mse=7006.770996 best_discrete=200.457275 hash=False elapsed=9.4s
step   125/900 tau=0.6165 loss=0.345877 mse_soft=0.345014 ent_in=1.6228 ent_out=1.2549 rowmax_in=0.4320 rowmax_out=0.5897 discrete_mse=170.638748 best_discrete=170.638748 hash=False elapsed=11.8s
step   150/900 tau=0.5592 loss=0.309005 mse_soft=0.308339 ent_in=1.3787 ent_out=0.8401 rowmax_in=0.4914 rowmax_out=0.7233 discrete_mse=1.575143 best_discrete=1.575143 hash=False elapsed=14.1s
step   175/900 tau=0.5073 loss=0.291036 mse_soft=0.290466 ent_in=1.2560 ent_out=0.6443 rowmax_in=0.5099 rowmax_out=0.7790 discrete_mse=227.697922 best_discrete=1.575143 hash=False elapsed=16.5s
step   200/900 tau=0.4602 loss=0.280705 mse_soft=0.280187 ent_in=1.1798 ent_out=0.5493 rowmax_in=0.5258 rowmax_out=0.7948 discrete_mse=20.122597 best_discrete=1.575143 hash=False elapsed=18.7s
step   225/900 tau=0.4174 loss=0.275021 mse_soft=0.274542 ent_in=1.1179 ent_out=0.4804 rowmax_in=0.5399 rowmax_out=0.8034 discrete_mse=297.657806 best_discrete=1.575143 hash=False elapsed=20.9s
step   250/900 tau=0.3786 loss=0.271987 mse_soft=0.271528 ent_in=1.0869 ent_out=0.4429 rowmax_in=0.5473 rowmax_out=0.8094 discrete_mse=170.444153 best_discrete=1.575143 hash=False elapsed=23.2s
step   275/900 tau=0.3434 loss=0.268618 mse_soft=0.268176 ent_in=1.0598 ent_out=0.4141 rowmax_in=0.5545 rowmax_out=0.8152 discrete_mse=170.444153 best_discrete=1.575143 hash=False elapsed=25.6s
step   300/900 tau=0.3115 loss=0.267527 mse_soft=0.267097 ent_in=1.0460 ent_out=0.3882 rowmax_in=0.5564 rowmax_out=0.8237 discrete_mse=170.444153 best_discrete=1.575143 hash=False elapsed=27.9s
step   325/900 tau=0.2826 loss=0.265915 mse_soft=0.265493 ent_in=1.0314 ent_out=0.3752 rowmax_in=0.5607 rowmax_out=0.8280 discrete_mse=1006.459473 best_discrete=1.575143 hash=False elapsed=30.3s
step   350/900 tau=0.2563 loss=0.266300 mse_soft=0.265882 ent_in=1.0296 ent_out=0.3645 rowmax_in=0.5604 rowmax_out=0.8340 discrete_mse=786.718750 best_discrete=1.575143 hash=False elapsed=32.4s
step   375/900 tau=0.2325 loss=0.265647 mse_soft=0.265232 ent_in=1.0268 ent_out=0.3570 rowmax_in=0.5602 rowmax_out=0.8373 discrete_mse=786.718750 best_discrete=1.575143 hash=False elapsed=34.5s
step   400/900 tau=0.2109 loss=0.267418 mse_soft=0.267007 ent_in=1.0183 ent_out=0.3528 rowmax_in=0.5635 rowmax_out=0.8390 discrete_mse=599.071106 best_discrete=1.575143 hash=False elapsed=36.9s
step   425/900 tau=0.1913 loss=0.264481 mse_soft=0.264072 ent_in=1.0171 ent_out=0.3463 rowmax_in=0.5612 rowmax_out=0.8428 discrete_mse=599.071106 best_discrete=1.575143 hash=False elapsed=39.1s
step   450/900 tau=0.1735 loss=0.264476 mse_soft=0.264070 ent_in=1.0139 ent_out=0.3408 rowmax_in=0.5589 rowmax_out=0.8442 discrete_mse=275.766846 best_discrete=1.575143 hash=False elapsed=41.3s
step   475/900 tau=0.1574 loss=0.263614 mse_soft=0.263210 ent_in=1.0057 ent_out=0.3431 rowmax_in=0.5630 rowmax_out=0.8434 discrete_mse=180.933578 best_discrete=1.575143 hash=False elapsed=43.6s
step   500/900 tau=0.1428 loss=0.266667 mse_soft=0.266263 ent_in=1.0032 ent_out=0.3438 rowmax_in=0.5616 rowmax_out=0.8421 discrete_mse=278.606842 best_discrete=1.575143 hash=False elapsed=46.1s
step   525/900 tau=0.1295 loss=0.273641 mse_soft=0.273239 ent_in=1.0023 ent_out=0.3405 rowmax_in=0.5615 rowmax_out=0.8443 discrete_mse=240.073990 best_discrete=1.575143 hash=False elapsed=48.4s
step   550/900 tau=0.1175 loss=0.278233 mse_soft=0.277831 ent_in=1.0002 ent_out=0.3396 rowmax_in=0.5610 rowmax_out=0.8446 discrete_mse=240.073990 best_discrete=1.575143 hash=False elapsed=50.6s
step   575/900 tau=0.1066 loss=0.268730 mse_soft=0.268333 ent_in=0.9862 ent_out=0.3377 rowmax_in=0.5697 rowmax_out=0.8452 discrete_mse=52.702194 best_discrete=1.575143 hash=False elapsed=52.9s
step   600/900 tau=0.0967 loss=0.275188 mse_soft=0.274795 ent_in=0.9730 ent_out=0.3358 rowmax_in=0.5744 rowmax_out=0.8451 discrete_mse=312.376892 best_discrete=1.575143 hash=False elapsed=55.4s
step   625/900 tau=0.0877 loss=0.276695 mse_soft=0.276308 ent_in=0.9672 ent_out=0.3229 rowmax_in=0.5673 rowmax_out=0.8531 discrete_mse=101.278214 best_discrete=1.575143 hash=False elapsed=57.9s
step   650/900 tau=0.0795 loss=0.289247 mse_soft=0.288868 ent_in=0.9483 ent_out=0.3119 rowmax_in=0.5784 rowmax_out=0.8572 discrete_mse=98.669182 best_discrete=1.575143 hash=False elapsed=60.3s
step   675/900 tau=0.0722 loss=0.349245 mse_soft=0.348894 ent_in=0.8790 ent_out=0.2901 rowmax_in=0.6060 rowmax_out=0.8613 discrete_mse=1.708881 best_discrete=1.575143 hash=False elapsed=62.8s
step   700/900 tau=0.0655 loss=0.287052 mse_soft=0.286711 ent_in=0.8564 ent_out=0.2806 rowmax_in=0.6003 rowmax_out=0.8690 discrete_mse=413.334137 best_discrete=1.575143 hash=False elapsed=65.5s
step   725/900 tau=0.0594 loss=0.280764 mse_soft=0.280413 ent_in=0.8584 ent_out=0.3127 rowmax_in=0.5960 rowmax_out=0.8447 discrete_mse=143.325439 best_discrete=1.575143 hash=False elapsed=67.9s
step   750/900 tau=0.0539 loss=0.282258 mse_soft=0.281917 ent_in=0.8385 ent_out=0.2957 rowmax_in=0.6090 rowmax_out=0.8646 discrete_mse=248.294846 best_discrete=1.575143 hash=False elapsed=70.3s
step   775/900 tau=0.0489 loss=0.425763 mse_soft=0.425605 ent_in=0.4427 ent_out=0.0829 rowmax_in=0.7761 rowmax_out=0.9579 discrete_mse=1.039356 best_discrete=1.039356 hash=False elapsed=72.5s
step   800/900 tau=0.0443 loss=0.402603 mse_soft=0.402442 ent_in=0.4486 ent_out=0.0888 rowmax_in=0.7747 rowmax_out=0.9551 discrete_mse=1.233729 best_discrete=1.039356 hash=False elapsed=75.1s
step   825/900 tau=0.0402 loss=0.408304 mse_soft=0.408142 ent_in=0.4469 ent_out=0.0936 rowmax_in=0.7779 rowmax_out=0.9534 discrete_mse=0.944213 best_discrete=0.944213 hash=False elapsed=77.6s
step   850/900 tau=0.0365 loss=0.400817 mse_soft=0.400651 ent_in=0.4547 ent_out=0.0996 rowmax_in=0.7679 rowmax_out=0.9507 discrete_mse=1.166541 best_discrete=0.944213 hash=False elapsed=80.3s
step   875/900 tau=0.0331 loss=0.399988 mse_soft=0.399825 ent_in=0.4528 ent_out=0.0922 rowmax_in=0.7657 rowmax_out=0.9545 discrete_mse=1.166541 best_discrete=0.944213 hash=False elapsed=82.8s
step   900/900 tau=0.0300 loss=0.388355 mse_soft=0.388190 ent_in=0.4519 ent_out=0.0970 rowmax_in=0.7641 rowmax_out=0.9513 discrete_mse=1.166541 best_discrete=0.944213 hash=False elapsed=85.1s

Final metrics:
  soft_mse_full=0.386725
  rowmax_in_mean=0.7640
  rowmax_out_mean=0.9510
  ent_in_mean=0.4524
  ent_out_mean=0.0974
  final_discrete_mse=1.166541
  hash_match=False
  best_discrete_mse_seen=0.944213
Saved results to sinkhorn_par4.json
