Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.069734 mse_soft=1.067411 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=35.270313 best_discrete=35.270313 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.862578 mse_soft=0.860388 ent_in=3.6353 ent_out=3.6655 rowmax_in=0.0450 rowmax_out=0.0454 discrete_mse=1674.363892 best_discrete=35.270313 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.645077 mse_soft=0.643168 ent_in=3.1421 ent_out=3.2200 rowmax_in=0.0907 rowmax_out=0.0890 discrete_mse=6178.597656 best_discrete=35.270313 hash=False elapsed=5.2s
step    75/900 tau=0.7493 loss=0.503718 mse_soft=0.502130 ent_in=2.6288 ent_out=2.6669 rowmax_in=0.1975 rowmax_out=0.1960 discrete_mse=631.228882 best_discrete=35.270313 hash=False elapsed=7.6s
step   100/900 tau=0.6797 loss=0.396575 mse_soft=0.395391 ent_in=2.0604 ent_out=1.8855 rowmax_in=0.3299 rowmax_out=0.3986 discrete_mse=1088.999146 best_discrete=35.270313 hash=False elapsed=9.9s
step   125/900 tau=0.6165 loss=0.329852 mse_soft=0.329026 ent_in=1.5913 ent_out=1.1618 rowmax_in=0.4404 rowmax_out=0.6119 discrete_mse=2164.056885 best_discrete=35.270313 hash=False elapsed=12.4s
step   150/900 tau=0.5592 loss=0.306694 mse_soft=0.306013 ent_in=1.4407 ent_out=0.8316 rowmax_in=0.4638 rowmax_out=0.7199 discrete_mse=1872.427734 best_discrete=35.270313 hash=False elapsed=14.9s
step   175/900 tau=0.5073 loss=0.291975 mse_soft=0.291369 ent_in=1.3720 ent_out=0.6458 rowmax_in=0.4745 rowmax_out=0.7697 discrete_mse=1876.168579 best_discrete=35.270313 hash=False elapsed=17.0s
step   200/900 tau=0.4602 loss=0.282679 mse_soft=0.282117 ent_in=1.3109 ent_out=0.5614 rowmax_in=0.4900 rowmax_out=0.7885 discrete_mse=1037.659180 best_discrete=35.270313 hash=False elapsed=19.6s
step   225/900 tau=0.4174 loss=0.278498 mse_soft=0.277968 ent_in=1.2692 ent_out=0.4991 rowmax_in=0.4982 rowmax_out=0.8056 discrete_mse=1037.659180 best_discrete=35.270313 hash=False elapsed=22.1s
step   250/900 tau=0.3786 loss=0.276777 mse_soft=0.276266 ent_in=1.2366 ent_out=0.4652 rowmax_in=0.4981 rowmax_out=0.8161 discrete_mse=1037.659180 best_discrete=35.270313 hash=False elapsed=24.5s
step   275/900 tau=0.3434 loss=0.272864 mse_soft=0.272370 ent_in=1.2101 ent_out=0.4381 rowmax_in=0.5026 rowmax_out=0.8235 discrete_mse=1037.659180 best_discrete=35.270313 hash=False elapsed=27.0s
step   300/900 tau=0.3115 loss=0.272209 mse_soft=0.271724 ent_in=1.1951 ent_out=0.4195 rowmax_in=0.5040 rowmax_out=0.8303 discrete_mse=1037.659180 best_discrete=35.270313 hash=False elapsed=29.4s
step   325/900 tau=0.2826 loss=0.270466 mse_soft=0.269989 ent_in=1.1877 ent_out=0.4035 rowmax_in=0.5027 rowmax_out=0.8340 discrete_mse=1037.659180 best_discrete=35.270313 hash=False elapsed=31.8s
step   350/900 tau=0.2563 loss=0.269352 mse_soft=0.268880 ent_in=1.1827 ent_out=0.3897 rowmax_in=0.5019 rowmax_out=0.8377 discrete_mse=1037.659180 best_discrete=35.270313 hash=False elapsed=34.2s
step   375/900 tau=0.2325 loss=0.273299 mse_soft=0.272830 ent_in=1.1774 ent_out=0.3853 rowmax_in=0.5032 rowmax_out=0.8375 discrete_mse=1037.659180 best_discrete=35.270313 hash=False elapsed=36.6s
step   400/900 tau=0.2109 loss=0.272584 mse_soft=0.272116 ent_in=1.1749 ent_out=0.3832 rowmax_in=0.5034 rowmax_out=0.8374 discrete_mse=1037.659180 best_discrete=35.270313 hash=False elapsed=39.1s
step   425/900 tau=0.1913 loss=0.271074 mse_soft=0.270608 ent_in=1.1697 ent_out=0.3821 rowmax_in=0.5053 rowmax_out=0.8364 discrete_mse=1037.659180 best_discrete=35.270313 hash=False elapsed=41.7s
step   450/900 tau=0.1735 loss=0.269823 mse_soft=0.269358 ent_in=1.1694 ent_out=0.3824 rowmax_in=0.5051 rowmax_out=0.8349 discrete_mse=1037.659180 best_discrete=35.270313 hash=False elapsed=44.3s
step   475/900 tau=0.1574 loss=0.269226 mse_soft=0.268761 ent_in=1.1676 ent_out=0.3805 rowmax_in=0.5042 rowmax_out=0.8354 discrete_mse=721.946960 best_discrete=35.270313 hash=False elapsed=46.7s
step   500/900 tau=0.1428 loss=0.276482 mse_soft=0.276019 ent_in=1.1650 ent_out=0.3787 rowmax_in=0.5068 rowmax_out=0.8351 discrete_mse=847.535400 best_discrete=35.270313 hash=False elapsed=49.1s
step   525/900 tau=0.1295 loss=0.299349 mse_soft=0.298886 ent_in=1.1663 ent_out=0.3758 rowmax_in=0.5039 rowmax_out=0.8349 discrete_mse=478.196899 best_discrete=35.270313 hash=False elapsed=51.5s
step   550/900 tau=0.1175 loss=0.272343 mse_soft=0.271891 ent_in=1.1445 ent_out=0.3611 rowmax_in=0.5115 rowmax_out=0.8348 discrete_mse=702.650635 best_discrete=35.270313 hash=False elapsed=54.0s
step   575/900 tau=0.1066 loss=0.269346 mse_soft=0.268898 ent_in=1.1440 ent_out=0.3514 rowmax_in=0.5142 rowmax_out=0.8406 discrete_mse=312.679504 best_discrete=35.270313 hash=False elapsed=56.4s
step   600/900 tau=0.0967 loss=0.281888 mse_soft=0.281444 ent_in=1.1355 ent_out=0.3421 rowmax_in=0.5134 rowmax_out=0.8454 discrete_mse=300.018799 best_discrete=35.270313 hash=False elapsed=58.6s
step   625/900 tau=0.0877 loss=0.272399 mse_soft=0.271973 ent_in=1.0864 ent_out=0.3349 rowmax_in=0.5394 rowmax_out=0.8459 discrete_mse=205.901566 best_discrete=35.270313 hash=False elapsed=60.9s
step   650/900 tau=0.0795 loss=0.273228 mse_soft=0.272805 ent_in=1.0736 ent_out=0.3345 rowmax_in=0.5403 rowmax_out=0.8431 discrete_mse=205.901566 best_discrete=35.270313 hash=False elapsed=63.2s
step   675/900 tau=0.0722 loss=0.284636 mse_soft=0.284226 ent_in=1.0305 ent_out=0.3348 rowmax_in=0.5417 rowmax_out=0.8414 discrete_mse=166.670151 best_discrete=35.270313 hash=False elapsed=65.5s
step   700/900 tau=0.0655 loss=0.391850 mse_soft=0.391500 ent_in=0.8899 ent_out=0.2793 rowmax_in=0.6160 rowmax_out=0.8746 discrete_mse=48.405548 best_discrete=35.270313 hash=False elapsed=67.8s
step   725/900 tau=0.0594 loss=0.360309 mse_soft=0.359995 ent_in=0.8027 ent_out=0.2449 rowmax_in=0.6118 rowmax_out=0.8835 discrete_mse=145.814346 best_discrete=35.270313 hash=False elapsed=70.0s
step   750/900 tau=0.0539 loss=0.311195 mse_soft=0.310878 ent_in=0.8023 ent_out=0.2536 rowmax_in=0.6167 rowmax_out=0.8737 discrete_mse=71.063324 best_discrete=35.270313 hash=False elapsed=72.3s
step   775/900 tau=0.0489 loss=0.309648 mse_soft=0.309328 ent_in=0.8118 ent_out=0.2533 rowmax_in=0.6093 rowmax_out=0.8620 discrete_mse=3.256811 best_discrete=3.256811 hash=False elapsed=74.6s
step   800/900 tau=0.0443 loss=0.294374 mse_soft=0.294049 ent_in=0.8216 ent_out=0.2610 rowmax_in=0.6092 rowmax_out=0.8552 discrete_mse=82.128677 best_discrete=3.256811 hash=False elapsed=76.8s
step   825/900 tau=0.0402 loss=0.352246 mse_soft=0.351991 ent_in=0.6491 ent_out=0.2025 rowmax_in=0.6966 rowmax_out=0.8904 discrete_mse=67.401657 best_discrete=3.256811 hash=False elapsed=79.0s
step   850/900 tau=0.0365 loss=0.318164 mse_soft=0.317912 ent_in=0.6425 ent_out=0.1971 rowmax_in=0.6676 rowmax_out=0.8898 discrete_mse=58.699966 best_discrete=3.256811 hash=False elapsed=81.3s
step   875/900 tau=0.0331 loss=0.312753 mse_soft=0.312497 ent_in=0.6608 ent_out=0.1924 rowmax_in=0.6557 rowmax_out=0.8913 discrete_mse=50.102306 best_discrete=3.256811 hash=False elapsed=83.6s
step   900/900 tau=0.0300 loss=0.577823 mse_soft=0.577690 ent_in=0.3316 ent_out=0.1108 rowmax_in=0.8217 rowmax_out=0.9331 discrete_mse=221.675522 best_discrete=3.256811 hash=False elapsed=85.8s

Final metrics:
  soft_mse_full=0.590332
  rowmax_in_mean=0.8372
  rowmax_out_mean=0.9331
  ent_in_mean=0.3101
  ent_out_mean=0.1105
  final_discrete_mse=464.382050
  hash_match=False
  best_discrete_mse_seen=3.256811
Saved results to overnight_b181_j1.json
