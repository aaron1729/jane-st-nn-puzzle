Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.081283 mse_soft=1.078961 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=5.014468 best_discrete=5.014468 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.870473 mse_soft=0.868283 ent_in=3.6336 ent_out=3.6663 rowmax_in=0.0466 rowmax_out=0.0440 discrete_mse=4780.228516 best_discrete=5.014468 hash=False elapsed=2.4s
step    50/900 tau=0.8229 loss=0.651159 mse_soft=0.649247 ent_in=3.1413 ent_out=3.2332 rowmax_in=0.0945 rowmax_out=0.0876 discrete_mse=9335.740234 best_discrete=5.014468 hash=False elapsed=4.5s
step    75/900 tau=0.7450 loss=0.502914 mse_soft=0.501331 ent_in=2.5977 ent_out=2.6788 rowmax_in=0.2125 rowmax_out=0.1991 discrete_mse=4780.501953 best_discrete=5.014468 hash=False elapsed=6.6s
step   100/900 tau=0.6745 loss=0.402126 mse_soft=0.400936 ent_in=1.9992 ent_out=1.9657 rowmax_in=0.3545 rowmax_out=0.3764 discrete_mse=1084.238403 best_discrete=5.014468 hash=False elapsed=8.7s
step   125/900 tau=0.6107 loss=0.337715 mse_soft=0.336857 ent_in=1.5927 ent_out=1.2683 rowmax_in=0.4400 rowmax_out=0.5869 discrete_mse=487.899597 best_discrete=5.014468 hash=False elapsed=10.9s
step   150/900 tau=0.5529 loss=0.308228 mse_soft=0.307554 ent_in=1.3929 ent_out=0.8546 rowmax_in=0.4841 rowmax_out=0.6917 discrete_mse=839.239502 best_discrete=5.014468 hash=False elapsed=13.2s
step   175/900 tau=0.5006 loss=0.291921 mse_soft=0.291335 ent_in=1.2805 ent_out=0.6703 rowmax_in=0.4959 rowmax_out=0.7439 discrete_mse=411.378693 best_discrete=5.014468 hash=False elapsed=15.7s
step   200/900 tau=0.4532 loss=0.283723 mse_soft=0.283186 ent_in=1.2383 ent_out=0.5527 rowmax_in=0.5023 rowmax_out=0.7804 discrete_mse=343.090302 best_discrete=5.014468 hash=False elapsed=18.2s
step   225/900 tau=0.4103 loss=0.276797 mse_soft=0.276303 ent_in=1.1920 ent_out=0.4545 rowmax_in=0.5157 rowmax_out=0.8148 discrete_mse=395.298889 best_discrete=5.014468 hash=False elapsed=20.5s
step   250/900 tau=0.3715 loss=0.272588 mse_soft=0.272116 ent_in=1.1626 ent_out=0.4097 rowmax_in=0.5210 rowmax_out=0.8250 discrete_mse=273.844940 best_discrete=5.014468 hash=False elapsed=22.8s
step   275/900 tau=0.3363 loss=0.270307 mse_soft=0.269847 ent_in=1.1482 ent_out=0.3853 rowmax_in=0.5209 rowmax_out=0.8308 discrete_mse=375.683746 best_discrete=5.014468 hash=False elapsed=25.0s
step   300/900 tau=0.3045 loss=0.269453 mse_soft=0.269001 ent_in=1.1289 ent_out=0.3774 rowmax_in=0.5238 rowmax_out=0.8297 discrete_mse=293.871979 best_discrete=5.014468 hash=False elapsed=27.3s
step   325/900 tau=0.2756 loss=0.268203 mse_soft=0.267757 ent_in=1.1206 ent_out=0.3669 rowmax_in=0.5233 rowmax_out=0.8305 discrete_mse=375.683746 best_discrete=5.014468 hash=False elapsed=29.5s
step   350/900 tau=0.2496 loss=0.268958 mse_soft=0.268517 ent_in=1.1105 ent_out=0.3611 rowmax_in=0.5250 rowmax_out=0.8300 discrete_mse=293.871979 best_discrete=5.014468 hash=False elapsed=31.7s
step   375/900 tau=0.2259 loss=0.266081 mse_soft=0.265645 ent_in=1.0990 ent_out=0.3550 rowmax_in=0.5274 rowmax_out=0.8284 discrete_mse=375.683746 best_discrete=5.014468 hash=False elapsed=33.9s
step   400/900 tau=0.2046 loss=0.266241 mse_soft=0.265808 ent_in=1.0901 ent_out=0.3507 rowmax_in=0.5292 rowmax_out=0.8289 discrete_mse=375.683746 best_discrete=5.014468 hash=False elapsed=36.0s
step   425/900 tau=0.1852 loss=0.266607 mse_soft=0.266179 ent_in=1.0810 ent_out=0.3457 rowmax_in=0.5305 rowmax_out=0.8299 discrete_mse=375.683746 best_discrete=5.014468 hash=False elapsed=38.2s
step   450/900 tau=0.1677 loss=0.265058 mse_soft=0.264633 ent_in=1.0768 ent_out=0.3418 rowmax_in=0.5298 rowmax_out=0.8316 discrete_mse=375.683746 best_discrete=5.014468 hash=False elapsed=40.4s
step   475/900 tau=0.1518 loss=0.273452 mse_soft=0.273029 ent_in=1.0740 ent_out=0.3370 rowmax_in=0.5293 rowmax_out=0.8352 discrete_mse=371.447083 best_discrete=5.014468 hash=False elapsed=42.6s
step   500/900 tau=0.1374 loss=0.267798 mse_soft=0.267377 ent_in=1.0728 ent_out=0.3333 rowmax_in=0.5303 rowmax_out=0.8350 discrete_mse=532.474915 best_discrete=5.014468 hash=False elapsed=44.8s
step   525/900 tau=0.1244 loss=0.269010 mse_soft=0.268591 ent_in=1.0691 ent_out=0.3303 rowmax_in=0.5328 rowmax_out=0.8358 discrete_mse=538.224243 best_discrete=5.014468 hash=False elapsed=47.0s
step   550/900 tau=0.1126 loss=0.273261 mse_soft=0.272842 ent_in=1.0699 ent_out=0.3266 rowmax_in=0.5282 rowmax_out=0.8382 discrete_mse=397.331940 best_discrete=5.014468 hash=False elapsed=49.2s
step   575/900 tau=0.1020 loss=0.267188 mse_soft=0.266771 ent_in=1.0665 ent_out=0.3239 rowmax_in=0.5332 rowmax_out=0.8340 discrete_mse=458.621338 best_discrete=5.014468 hash=False elapsed=51.7s
step   600/900 tau=0.0923 loss=0.275065 mse_soft=0.274654 ent_in=1.0551 ent_out=0.3136 rowmax_in=0.5418 rowmax_out=0.8399 discrete_mse=628.526672 best_discrete=5.014468 hash=False elapsed=54.1s
step   625/900 tau=0.0836 loss=0.316150 mse_soft=0.315804 ent_in=0.9218 ent_out=0.2312 rowmax_in=0.5878 rowmax_out=0.8947 discrete_mse=175.031540 best_discrete=5.014468 hash=False elapsed=56.3s
step   650/900 tau=0.0757 loss=0.304694 mse_soft=0.304346 ent_in=0.9047 ent_out=0.2559 rowmax_in=0.5713 rowmax_out=0.8640 discrete_mse=142.532440 best_discrete=5.014468 hash=False elapsed=58.7s
step   675/900 tau=0.0685 loss=0.286258 mse_soft=0.285924 ent_in=0.8771 ent_out=0.2387 rowmax_in=0.5833 rowmax_out=0.8797 discrete_mse=132.533798 best_discrete=5.014468 hash=False elapsed=60.9s
step   700/900 tau=0.0620 loss=0.287404 mse_soft=0.287061 ent_in=0.8915 ent_out=0.2496 rowmax_in=0.5703 rowmax_out=0.8700 discrete_mse=125.761749 best_discrete=5.014468 hash=False elapsed=63.2s
step   725/900 tau=0.0562 loss=0.293141 mse_soft=0.292799 ent_in=0.8935 ent_out=0.2474 rowmax_in=0.5679 rowmax_out=0.8669 discrete_mse=132.533798 best_discrete=5.014468 hash=False elapsed=65.4s
step   750/900 tau=0.0508 loss=0.430830 mse_soft=0.430669 ent_in=0.4362 ent_out=0.1014 rowmax_in=0.7975 rowmax_out=0.9535 discrete_mse=33.146366 best_discrete=5.014468 hash=False elapsed=67.7s
step   775/900 tau=0.0460 loss=0.394383 mse_soft=0.394207 ent_in=0.4691 ent_out=0.1171 rowmax_in=0.7636 rowmax_out=0.9423 discrete_mse=76.896973 best_discrete=5.014468 hash=False elapsed=69.9s
step   800/900 tau=0.0417 loss=0.369450 mse_soft=0.369277 ent_in=0.4618 ent_out=0.1146 rowmax_in=0.7650 rowmax_out=0.9356 discrete_mse=20.596581 best_discrete=5.014468 hash=False elapsed=72.2s
step   825/900 tau=0.0377 loss=0.363228 mse_soft=0.363054 ent_in=0.4746 ent_out=0.1077 rowmax_in=0.7578 rowmax_out=0.9430 discrete_mse=21.937162 best_discrete=5.014468 hash=False elapsed=74.5s
step   850/900 tau=0.0342 loss=0.360928 mse_soft=0.360750 ent_in=0.4850 ent_out=0.1086 rowmax_in=0.7569 rowmax_out=0.9417 discrete_mse=31.736217 best_discrete=5.014468 hash=False elapsed=76.7s
step   875/900 tau=0.0309 loss=0.403891 mse_soft=0.403739 ent_in=0.4132 ent_out=0.0947 rowmax_in=0.8040 rowmax_out=0.9485 discrete_mse=27.705275 best_discrete=5.014468 hash=False elapsed=79.0s
step   900/900 tau=0.0280 loss=0.411697 mse_soft=0.411576 ent_in=0.3441 ent_out=0.0594 rowmax_in=0.8269 rowmax_out=0.9678 discrete_mse=17.700237 best_discrete=5.014468 hash=False elapsed=81.3s

Final metrics:
  soft_mse_full=0.431319
  rowmax_in_mean=0.8094
  rowmax_out_mean=0.9680
  ent_in_mean=0.3577
  ent_out_mean=0.0589
  final_discrete_mse=17.700237
  hash_match=False
  best_discrete_mse_seen=5.014468
Saved results to overnight_b186_j2.json
