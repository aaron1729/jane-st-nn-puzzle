Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.073271 mse_soft=1.070948 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=46.499397 best_discrete=46.499397 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.868425 mse_soft=0.866233 ent_in=3.6373 ent_out=3.6682 rowmax_in=0.0456 rowmax_out=0.0447 discrete_mse=1478.718018 best_discrete=46.499397 hash=False elapsed=2.3s
step    50/900 tau=0.8260 loss=0.649105 mse_soft=0.647191 ent_in=3.1459 ent_out=3.2329 rowmax_in=0.0914 rowmax_out=0.0878 discrete_mse=1383.282715 best_discrete=46.499397 hash=False elapsed=4.2s
step    75/900 tau=0.7493 loss=0.506057 mse_soft=0.504468 ent_in=2.6130 ent_out=2.6843 rowmax_in=0.2149 rowmax_out=0.2055 discrete_mse=88.527275 best_discrete=46.499397 hash=False elapsed=6.2s
step   100/900 tau=0.6797 loss=0.399915 mse_soft=0.398751 ent_in=1.9695 ent_out=1.9101 rowmax_in=0.3743 rowmax_out=0.4107 discrete_mse=253.261963 best_discrete=46.499397 hash=False elapsed=8.3s
step   125/900 tau=0.6165 loss=0.335993 mse_soft=0.335161 ent_in=1.5686 ent_out=1.2049 rowmax_in=0.4694 rowmax_out=0.6159 discrete_mse=758.375488 best_discrete=46.499397 hash=False elapsed=10.3s
step   150/900 tau=0.5592 loss=0.309610 mse_soft=0.308932 ent_in=1.4279 ent_out=0.8323 rowmax_in=0.4789 rowmax_out=0.7310 discrete_mse=703.275085 best_discrete=46.499397 hash=False elapsed=12.2s
step   175/900 tau=0.5073 loss=0.292799 mse_soft=0.292216 ent_in=1.3273 ent_out=0.6150 rowmax_in=0.4956 rowmax_out=0.7977 discrete_mse=768.309082 best_discrete=46.499397 hash=False elapsed=14.3s
step   200/900 tau=0.4602 loss=0.281716 mse_soft=0.281183 ent_in=1.2680 ent_out=0.5072 rowmax_in=0.4988 rowmax_out=0.8211 discrete_mse=495.025482 best_discrete=46.499397 hash=False elapsed=16.3s
step   225/900 tau=0.4174 loss=0.273611 mse_soft=0.273118 ent_in=1.2148 ent_out=0.4283 rowmax_in=0.5108 rowmax_out=0.8432 discrete_mse=641.158569 best_discrete=46.499397 hash=False elapsed=18.5s
step   250/900 tau=0.3786 loss=0.269718 mse_soft=0.269250 ent_in=1.1730 ent_out=0.3882 rowmax_in=0.5174 rowmax_out=0.8528 discrete_mse=1339.909790 best_discrete=46.499397 hash=False elapsed=20.6s
step   275/900 tau=0.3434 loss=0.266968 mse_soft=0.266510 ent_in=1.1499 ent_out=0.3759 rowmax_in=0.5209 rowmax_out=0.8526 discrete_mse=784.393677 best_discrete=46.499397 hash=False elapsed=22.7s
step   300/900 tau=0.3115 loss=0.265296 mse_soft=0.264848 ent_in=1.1372 ent_out=0.3568 rowmax_in=0.5231 rowmax_out=0.8589 discrete_mse=784.393677 best_discrete=46.499397 hash=False elapsed=24.9s
step   325/900 tau=0.2826 loss=0.264421 mse_soft=0.263980 ent_in=1.1277 ent_out=0.3441 rowmax_in=0.5242 rowmax_out=0.8638 discrete_mse=784.393677 best_discrete=46.499397 hash=False elapsed=27.0s
step   350/900 tau=0.2563 loss=0.263154 mse_soft=0.262720 ent_in=1.1143 ent_out=0.3335 rowmax_in=0.5263 rowmax_out=0.8664 discrete_mse=784.393677 best_discrete=46.499397 hash=False elapsed=29.1s
step   375/900 tau=0.2325 loss=0.262803 mse_soft=0.262374 ent_in=1.1069 ent_out=0.3238 rowmax_in=0.5263 rowmax_out=0.8691 discrete_mse=784.393677 best_discrete=46.499397 hash=False elapsed=31.1s
step   400/900 tau=0.2109 loss=0.266763 mse_soft=0.266339 ent_in=1.0989 ent_out=0.3158 rowmax_in=0.5273 rowmax_out=0.8713 discrete_mse=784.393677 best_discrete=46.499397 hash=False elapsed=33.3s
step   425/900 tau=0.1913 loss=0.265505 mse_soft=0.265084 ent_in=1.0945 ent_out=0.3094 rowmax_in=0.5278 rowmax_out=0.8729 discrete_mse=837.940979 best_discrete=46.499397 hash=False elapsed=35.3s
step   450/900 tau=0.1735 loss=0.262576 mse_soft=0.262158 ent_in=1.0902 ent_out=0.3033 rowmax_in=0.5286 rowmax_out=0.8748 discrete_mse=821.395020 best_discrete=46.499397 hash=False elapsed=37.4s
step   475/900 tau=0.1574 loss=0.263448 mse_soft=0.263032 ent_in=1.0857 ent_out=0.2995 rowmax_in=0.5299 rowmax_out=0.8760 discrete_mse=781.372192 best_discrete=46.499397 hash=False elapsed=39.5s
step   500/900 tau=0.1428 loss=0.273234 mse_soft=0.272821 ent_in=1.0828 ent_out=0.2941 rowmax_in=0.5289 rowmax_out=0.8789 discrete_mse=810.974487 best_discrete=46.499397 hash=False elapsed=41.8s
step   525/900 tau=0.1295 loss=0.270439 mse_soft=0.270027 ent_in=1.0788 ent_out=0.2961 rowmax_in=0.5319 rowmax_out=0.8766 discrete_mse=747.976501 best_discrete=46.499397 hash=False elapsed=43.8s
step   550/900 tau=0.1175 loss=0.263939 mse_soft=0.263528 ent_in=1.0802 ent_out=0.2889 rowmax_in=0.5301 rowmax_out=0.8804 discrete_mse=1036.338989 best_discrete=46.499397 hash=False elapsed=45.9s
step   575/900 tau=0.1066 loss=0.291622 mse_soft=0.291218 ent_in=1.0762 ent_out=0.2731 rowmax_in=0.5300 rowmax_out=0.8906 discrete_mse=375.842590 best_discrete=46.499397 hash=False elapsed=48.1s
step   600/900 tau=0.0967 loss=0.271465 mse_soft=0.271061 ent_in=1.0645 ent_out=0.2812 rowmax_in=0.5309 rowmax_out=0.8819 discrete_mse=999.712769 best_discrete=46.499397 hash=False elapsed=50.5s
step   625/900 tau=0.0877 loss=0.275507 mse_soft=0.275111 ent_in=1.0553 ent_out=0.2670 rowmax_in=0.5334 rowmax_out=0.8911 discrete_mse=1887.898315 best_discrete=46.499397 hash=False elapsed=52.8s
step   650/900 tau=0.0795 loss=0.270633 mse_soft=0.270238 ent_in=1.0481 ent_out=0.2703 rowmax_in=0.5297 rowmax_out=0.8864 discrete_mse=1524.486816 best_discrete=46.499397 hash=False elapsed=55.1s
step   675/900 tau=0.0722 loss=0.291007 mse_soft=0.290618 ent_in=1.0392 ent_out=0.2592 rowmax_in=0.5377 rowmax_out=0.8937 discrete_mse=2143.929443 best_discrete=46.499397 hash=False elapsed=57.5s
step   700/900 tau=0.0655 loss=0.373838 mse_soft=0.373457 ent_in=0.9948 ent_out=0.2761 rowmax_in=0.5525 rowmax_out=0.8809 discrete_mse=298.114044 best_discrete=46.499397 hash=False elapsed=59.7s
step   725/900 tau=0.0594 loss=0.315208 mse_soft=0.314885 ent_in=0.8185 ent_out=0.2556 rowmax_in=0.6129 rowmax_out=0.8938 discrete_mse=252.019043 best_discrete=46.499397 hash=False elapsed=62.2s
step   750/900 tau=0.0539 loss=0.355547 mse_soft=0.355279 ent_in=0.6906 ent_out=0.2006 rowmax_in=0.6525 rowmax_out=0.9008 discrete_mse=71.931664 best_discrete=46.499397 hash=False elapsed=64.3s
step   775/900 tau=0.0489 loss=0.323931 mse_soft=0.323671 ent_in=0.6460 ent_out=0.2236 rowmax_in=0.6796 rowmax_out=0.8926 discrete_mse=178.671249 best_discrete=46.499397 hash=False elapsed=66.4s
step   800/900 tau=0.0443 loss=0.362242 mse_soft=0.362004 ent_in=0.5904 ent_out=0.2028 rowmax_in=0.7010 rowmax_out=0.8961 discrete_mse=148.348694 best_discrete=46.499397 hash=False elapsed=68.3s
step   825/900 tau=0.0402 loss=0.377160 mse_soft=0.376928 ent_in=0.5683 ent_out=0.2029 rowmax_in=0.7096 rowmax_out=0.8993 discrete_mse=65.406082 best_discrete=46.499397 hash=False elapsed=70.6s
step   850/900 tau=0.0365 loss=0.376116 mse_soft=0.375907 ent_in=0.5169 ent_out=0.1790 rowmax_in=0.7309 rowmax_out=0.9137 discrete_mse=19.498070 best_discrete=19.498070 hash=False elapsed=72.8s
step   875/900 tau=0.0331 loss=0.329213 mse_soft=0.328994 ent_in=0.5420 ent_out=0.1879 rowmax_in=0.7117 rowmax_out=0.9077 discrete_mse=145.954453 best_discrete=19.498070 hash=False elapsed=75.2s
step   900/900 tau=0.0300 loss=0.355834 mse_soft=0.355632 ent_in=0.4920 ent_out=0.1808 rowmax_in=0.7399 rowmax_out=0.9116 discrete_mse=248.586243 best_discrete=19.498070 hash=False elapsed=77.5s

Final metrics:
  soft_mse_full=0.362087
  rowmax_in_mean=0.7427
  rowmax_out_mean=0.9119
  ent_in_mean=0.4930
  ent_out_mean=0.1801
  final_discrete_mse=8.961797
  hash_match=False
  best_discrete_mse_seen=19.498070
Saved results to overnight_b021_j1.json
