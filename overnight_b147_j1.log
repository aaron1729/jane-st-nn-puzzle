Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.070135 mse_soft=1.067812 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=90.904709 best_discrete=90.904709 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.866371 mse_soft=0.864181 ent_in=3.6342 ent_out=3.6671 rowmax_in=0.0456 rowmax_out=0.0439 discrete_mse=2513.469971 best_discrete=90.904709 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.657178 mse_soft=0.655262 ent_in=3.1401 ent_out=3.2471 rowmax_in=0.0935 rowmax_out=0.0833 discrete_mse=2454.341064 best_discrete=90.904709 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.514712 mse_soft=0.513124 ent_in=2.5889 ent_out=2.7046 rowmax_in=0.2104 rowmax_out=0.2046 discrete_mse=315.307831 best_discrete=90.904709 hash=False elapsed=7.2s
step   100/900 tau=0.6797 loss=0.413477 mse_soft=0.412304 ent_in=2.0281 ent_out=1.8817 rowmax_in=0.3370 rowmax_out=0.4213 discrete_mse=172.153076 best_discrete=90.904709 hash=False elapsed=9.4s
step   125/900 tau=0.6165 loss=0.335653 mse_soft=0.334866 ent_in=1.5327 ent_out=1.0912 rowmax_in=0.4451 rowmax_out=0.6358 discrete_mse=211.513992 best_discrete=90.904709 hash=False elapsed=11.5s
step   150/900 tau=0.5592 loss=0.315460 mse_soft=0.314820 ent_in=1.3657 ent_out=0.7694 rowmax_in=0.4731 rowmax_out=0.7235 discrete_mse=634.357910 best_discrete=90.904709 hash=False elapsed=13.8s
step   175/900 tau=0.5073 loss=0.302882 mse_soft=0.302325 ent_in=1.2895 ent_out=0.5668 rowmax_in=0.4848 rowmax_out=0.7812 discrete_mse=137.226303 best_discrete=90.904709 hash=False elapsed=16.0s
step   200/900 tau=0.4602 loss=0.293090 mse_soft=0.292589 ent_in=1.2320 ent_out=0.4380 rowmax_in=0.4944 rowmax_out=0.8184 discrete_mse=631.714966 best_discrete=90.904709 hash=False elapsed=18.2s
step   225/900 tau=0.4174 loss=0.287084 mse_soft=0.286614 ent_in=1.1853 ent_out=0.3805 rowmax_in=0.4985 rowmax_out=0.8417 discrete_mse=208.689514 best_discrete=90.904709 hash=False elapsed=20.5s
step   250/900 tau=0.3786 loss=0.282104 mse_soft=0.281659 ent_in=1.1362 ent_out=0.3469 rowmax_in=0.5102 rowmax_out=0.8560 discrete_mse=223.703690 best_discrete=90.904709 hash=False elapsed=22.7s
step   275/900 tau=0.3434 loss=0.278891 mse_soft=0.278464 ent_in=1.1128 ent_out=0.3109 rowmax_in=0.5130 rowmax_out=0.8696 discrete_mse=278.789856 best_discrete=90.904709 hash=False elapsed=24.9s
step   300/900 tau=0.3115 loss=0.278821 mse_soft=0.278402 ent_in=1.1080 ent_out=0.2864 rowmax_in=0.5134 rowmax_out=0.8769 discrete_mse=208.591965 best_discrete=90.904709 hash=False elapsed=27.3s
step   325/900 tau=0.2826 loss=0.276007 mse_soft=0.275596 ent_in=1.1072 ent_out=0.2626 rowmax_in=0.5103 rowmax_out=0.8872 discrete_mse=220.873672 best_discrete=90.904709 hash=False elapsed=29.7s
step   350/900 tau=0.2563 loss=0.275056 mse_soft=0.274651 ent_in=1.1058 ent_out=0.2444 rowmax_in=0.5092 rowmax_out=0.8932 discrete_mse=203.232712 best_discrete=90.904709 hash=False elapsed=31.9s
step   375/900 tau=0.2325 loss=0.275362 mse_soft=0.274963 ent_in=1.1024 ent_out=0.2283 rowmax_in=0.5082 rowmax_out=0.8977 discrete_mse=203.232712 best_discrete=90.904709 hash=False elapsed=34.2s
step   400/900 tau=0.2109 loss=0.273970 mse_soft=0.273578 ent_in=1.0935 ent_out=0.2133 rowmax_in=0.5109 rowmax_out=0.9038 discrete_mse=193.545425 best_discrete=90.904709 hash=False elapsed=36.2s
step   425/900 tau=0.1913 loss=0.275021 mse_soft=0.274632 ent_in=1.0892 ent_out=0.2091 rowmax_in=0.5112 rowmax_out=0.9048 discrete_mse=193.545425 best_discrete=90.904709 hash=False elapsed=38.5s
step   450/900 tau=0.1735 loss=0.273668 mse_soft=0.273282 ent_in=1.0841 ent_out=0.2023 rowmax_in=0.5123 rowmax_out=0.9061 discrete_mse=203.232712 best_discrete=90.904709 hash=False elapsed=40.7s
step   475/900 tau=0.1574 loss=0.275670 mse_soft=0.275286 ent_in=1.0815 ent_out=0.1981 rowmax_in=0.5111 rowmax_out=0.9078 discrete_mse=235.990494 best_discrete=90.904709 hash=False elapsed=42.7s
step   500/900 tau=0.1428 loss=0.274604 mse_soft=0.274222 ent_in=1.0801 ent_out=0.1951 rowmax_in=0.5124 rowmax_out=0.9082 discrete_mse=167.763367 best_discrete=90.904709 hash=False elapsed=44.8s
step   525/900 tau=0.1295 loss=0.274041 mse_soft=0.273659 ent_in=1.0803 ent_out=0.1941 rowmax_in=0.5120 rowmax_out=0.9080 discrete_mse=193.849472 best_discrete=90.904709 hash=False elapsed=46.9s
step   550/900 tau=0.1175 loss=0.292269 mse_soft=0.291888 ent_in=1.0717 ent_out=0.1958 rowmax_in=0.5196 rowmax_out=0.9045 discrete_mse=227.960663 best_discrete=90.904709 hash=False elapsed=49.2s
step   575/900 tau=0.1066 loss=0.277156 mse_soft=0.276781 ent_in=1.0499 ent_out=0.2024 rowmax_in=0.5191 rowmax_out=0.8991 discrete_mse=480.628998 best_discrete=90.904709 hash=False elapsed=51.4s
step   600/900 tau=0.0967 loss=0.273804 mse_soft=0.273430 ent_in=1.0480 ent_out=0.1995 rowmax_in=0.5244 rowmax_out=0.9014 discrete_mse=427.560547 best_discrete=90.904709 hash=False elapsed=53.7s
step   625/900 tau=0.0877 loss=0.277877 mse_soft=0.277512 ent_in=1.0090 ent_out=0.2089 rowmax_in=0.5439 rowmax_out=0.8890 discrete_mse=371.528778 best_discrete=90.904709 hash=False elapsed=55.9s
step   650/900 tau=0.0795 loss=0.284544 mse_soft=0.284184 ent_in=0.9922 ent_out=0.2079 rowmax_in=0.5457 rowmax_out=0.8918 discrete_mse=149.721680 best_discrete=90.904709 hash=False elapsed=58.2s
step   675/900 tau=0.0722 loss=0.301703 mse_soft=0.301350 ent_in=0.9746 ent_out=0.2031 rowmax_in=0.5551 rowmax_out=0.8984 discrete_mse=533.556763 best_discrete=90.904709 hash=False elapsed=60.4s
step   700/900 tau=0.0655 loss=0.286043 mse_soft=0.285709 ent_in=0.9112 ent_out=0.2004 rowmax_in=0.5721 rowmax_out=0.8928 discrete_mse=233.440445 best_discrete=90.904709 hash=False elapsed=62.7s
step   725/900 tau=0.0594 loss=0.276958 mse_soft=0.276621 ent_in=0.9196 ent_out=0.2032 rowmax_in=0.5562 rowmax_out=0.8885 discrete_mse=299.689941 best_discrete=90.904709 hash=False elapsed=64.7s
step   750/900 tau=0.0539 loss=0.363854 mse_soft=0.363540 ent_in=0.8532 ent_out=0.1911 rowmax_in=0.6005 rowmax_out=0.8989 discrete_mse=368.643097 best_discrete=90.904709 hash=False elapsed=66.7s
step   775/900 tau=0.0489 loss=0.402408 mse_soft=0.402239 ent_in=0.4657 ent_out=0.0974 rowmax_in=0.7692 rowmax_out=0.9501 discrete_mse=21.540688 best_discrete=21.540688 hash=False elapsed=68.7s
step   800/900 tau=0.0443 loss=0.401811 mse_soft=0.401643 ent_in=0.4567 ent_out=0.1021 rowmax_in=0.7619 rowmax_out=0.9492 discrete_mse=18.011196 best_discrete=18.011196 hash=False elapsed=70.7s
step   825/900 tau=0.0402 loss=0.419674 mse_soft=0.419518 ent_in=0.4159 ent_out=0.1042 rowmax_in=0.7983 rowmax_out=0.9491 discrete_mse=0.948208 best_discrete=0.948208 hash=False elapsed=73.0s
step   850/900 tau=0.0365 loss=0.421260 mse_soft=0.421114 ent_in=0.3837 ent_out=0.1041 rowmax_in=0.8066 rowmax_out=0.9488 discrete_mse=0.948208 best_discrete=0.948208 hash=False elapsed=75.2s
step   875/900 tau=0.0331 loss=0.391613 mse_soft=0.391461 ent_in=0.4114 ent_out=0.0941 rowmax_in=0.7664 rowmax_out=0.9539 discrete_mse=2.846721 best_discrete=0.948208 hash=False elapsed=77.4s
step   900/900 tau=0.0300 loss=0.390596 mse_soft=0.390446 ent_in=0.3804 ent_out=0.1167 rowmax_in=0.7808 rowmax_out=0.9422 discrete_mse=22.959343 best_discrete=0.948208 hash=False elapsed=79.7s

Final metrics:
  soft_mse_full=0.399139
  rowmax_in_mean=0.7768
  rowmax_out_mean=0.9422
  ent_in_mean=0.3815
  ent_out_mean=0.1167
  final_discrete_mse=51.600498
  hash_match=False
  best_discrete_mse_seen=0.948208
Saved results to overnight_b147_j1.json
