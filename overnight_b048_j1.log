Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.052260 mse_soft=1.049937 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=174.521667 best_discrete=174.521667 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.858452 mse_soft=0.856263 ent_in=3.6303 ent_out=3.6667 rowmax_in=0.0460 rowmax_out=0.0441 discrete_mse=564.000610 best_discrete=174.521667 hash=False elapsed=2.5s
step    50/900 tau=0.8260 loss=0.653861 mse_soft=0.651958 ent_in=3.1235 ent_out=3.2189 rowmax_in=0.0932 rowmax_out=0.0887 discrete_mse=27743.064453 best_discrete=174.521667 hash=False elapsed=4.7s
step    75/900 tau=0.7493 loss=0.523486 mse_soft=0.521905 ent_in=2.5987 ent_out=2.6718 rowmax_in=0.2032 rowmax_out=0.1954 discrete_mse=871.759949 best_discrete=174.521667 hash=False elapsed=6.9s
step   100/900 tau=0.6797 loss=0.422842 mse_soft=0.421671 ent_in=2.0164 ent_out=1.8875 rowmax_in=0.3326 rowmax_out=0.3943 discrete_mse=493.222198 best_discrete=174.521667 hash=False elapsed=9.1s
step   125/900 tau=0.6165 loss=0.359831 mse_soft=0.359001 ent_in=1.5485 ent_out=1.2178 rowmax_in=0.4588 rowmax_out=0.5853 discrete_mse=51.628197 best_discrete=51.628197 hash=False elapsed=11.4s
step   150/900 tau=0.5592 loss=0.331030 mse_soft=0.330336 ent_in=1.3776 ent_out=0.9358 rowmax_in=0.4875 rowmax_out=0.6453 discrete_mse=362.128296 best_discrete=51.628197 hash=False elapsed=13.5s
step   175/900 tau=0.5073 loss=0.317481 mse_soft=0.316864 ent_in=1.2908 ent_out=0.7688 rowmax_in=0.4960 rowmax_out=0.6850 discrete_mse=349.027771 best_discrete=51.628197 hash=False elapsed=15.7s
step   200/900 tau=0.4602 loss=0.308970 mse_soft=0.308403 ent_in=1.2253 ent_out=0.6663 rowmax_in=0.5073 rowmax_out=0.7189 discrete_mse=185.659241 best_discrete=51.628197 hash=False elapsed=18.0s
step   225/900 tau=0.4174 loss=0.304743 mse_soft=0.304200 ent_in=1.1843 ent_out=0.6235 rowmax_in=0.5138 rowmax_out=0.7253 discrete_mse=185.659241 best_discrete=51.628197 hash=False elapsed=20.1s
step   250/900 tau=0.3786 loss=0.302146 mse_soft=0.301621 ent_in=1.1567 ent_out=0.5906 rowmax_in=0.5201 rowmax_out=0.7343 discrete_mse=243.411789 best_discrete=51.628197 hash=False elapsed=22.3s
step   275/900 tau=0.3434 loss=0.298764 mse_soft=0.298251 ent_in=1.1427 ent_out=0.5673 rowmax_in=0.5247 rowmax_out=0.7455 discrete_mse=224.192688 best_discrete=51.628197 hash=False elapsed=24.4s
step   300/900 tau=0.3115 loss=0.296078 mse_soft=0.295576 ent_in=1.1334 ent_out=0.5400 rowmax_in=0.5271 rowmax_out=0.7616 discrete_mse=217.185562 best_discrete=51.628197 hash=False elapsed=26.7s
step   325/900 tau=0.2826 loss=0.301635 mse_soft=0.301143 ent_in=1.1183 ent_out=0.5204 rowmax_in=0.5260 rowmax_out=0.7670 discrete_mse=1024.065552 best_discrete=51.628197 hash=False elapsed=28.7s
step   350/900 tau=0.2563 loss=0.292814 mse_soft=0.292336 ent_in=1.0925 ent_out=0.5005 rowmax_in=0.5352 rowmax_out=0.7758 discrete_mse=706.626038 best_discrete=51.628197 hash=False elapsed=30.9s
step   375/900 tau=0.2325 loss=0.289859 mse_soft=0.289390 ent_in=1.0659 ent_out=0.4963 rowmax_in=0.5437 rowmax_out=0.7737 discrete_mse=877.044189 best_discrete=51.628197 hash=False elapsed=33.1s
step   400/900 tau=0.2109 loss=0.296776 mse_soft=0.296313 ent_in=1.0550 ent_out=0.4903 rowmax_in=0.5451 rowmax_out=0.7739 discrete_mse=1716.879150 best_discrete=51.628197 hash=False elapsed=35.4s
step   425/900 tau=0.1913 loss=0.291143 mse_soft=0.290687 ent_in=1.0424 ent_out=0.4797 rowmax_in=0.5499 rowmax_out=0.7743 discrete_mse=2917.234131 best_discrete=51.628197 hash=False elapsed=37.7s
step   450/900 tau=0.1735 loss=0.292744 mse_soft=0.292291 ent_in=1.0417 ent_out=0.4707 rowmax_in=0.5466 rowmax_out=0.7778 discrete_mse=754.301086 best_discrete=51.628197 hash=False elapsed=39.8s
step   475/900 tau=0.1574 loss=0.289097 mse_soft=0.288649 ent_in=1.0272 ent_out=0.4642 rowmax_in=0.5543 rowmax_out=0.7774 discrete_mse=2917.234131 best_discrete=51.628197 hash=False elapsed=42.2s
step   500/900 tau=0.1428 loss=0.293747 mse_soft=0.293299 ent_in=1.0321 ent_out=0.4621 rowmax_in=0.5482 rowmax_out=0.7762 discrete_mse=754.301086 best_discrete=51.628197 hash=False elapsed=44.4s
step   525/900 tau=0.1295 loss=0.289165 mse_soft=0.288724 ent_in=1.0214 ent_out=0.4490 rowmax_in=0.5552 rowmax_out=0.7824 discrete_mse=754.301086 best_discrete=51.628197 hash=False elapsed=46.6s
step   550/900 tau=0.1175 loss=0.293773 mse_soft=0.293333 ent_in=1.0203 ent_out=0.4480 rowmax_in=0.5538 rowmax_out=0.7874 discrete_mse=754.301086 best_discrete=51.628197 hash=False elapsed=49.0s
step   575/900 tau=0.1066 loss=0.307897 mse_soft=0.307459 ent_in=1.0161 ent_out=0.4430 rowmax_in=0.5538 rowmax_out=0.7914 discrete_mse=754.301086 best_discrete=51.628197 hash=False elapsed=51.2s
step   600/900 tau=0.0967 loss=0.295722 mse_soft=0.295291 ent_in=0.9933 ent_out=0.4448 rowmax_in=0.5618 rowmax_out=0.7841 discrete_mse=468.607697 best_discrete=51.628197 hash=False elapsed=53.4s
step   625/900 tau=0.0877 loss=0.321069 mse_soft=0.320638 ent_in=0.9900 ent_out=0.4474 rowmax_in=0.5522 rowmax_out=0.7813 discrete_mse=156.448624 best_discrete=51.628197 hash=False elapsed=55.5s
step   650/900 tau=0.0795 loss=0.302117 mse_soft=0.301693 ent_in=0.9897 ent_out=0.4246 rowmax_in=0.5560 rowmax_out=0.7946 discrete_mse=533.621887 best_discrete=51.628197 hash=False elapsed=57.6s
step   675/900 tau=0.0722 loss=0.310836 mse_soft=0.310418 ent_in=0.9629 ent_out=0.4310 rowmax_in=0.5670 rowmax_out=0.7853 discrete_mse=151.037140 best_discrete=51.628197 hash=False elapsed=59.8s
step   700/900 tau=0.0655 loss=0.355228 mse_soft=0.354825 ent_in=0.9328 ent_out=0.4096 rowmax_in=0.5764 rowmax_out=0.7995 discrete_mse=89.281021 best_discrete=51.628197 hash=False elapsed=62.0s
step   725/900 tau=0.0594 loss=0.360079 mse_soft=0.359757 ent_in=0.7359 ent_out=0.3370 rowmax_in=0.6391 rowmax_out=0.8360 discrete_mse=82.182976 best_discrete=51.628197 hash=False elapsed=64.1s
step   750/900 tau=0.0539 loss=0.349270 mse_soft=0.348949 ent_in=0.7245 ent_out=0.3465 rowmax_in=0.6500 rowmax_out=0.8213 discrete_mse=225.834824 best_discrete=51.628197 hash=False elapsed=66.2s
step   775/900 tau=0.0489 loss=0.345639 mse_soft=0.345334 ent_in=0.6989 ent_out=0.3153 rowmax_in=0.6757 rowmax_out=0.8431 discrete_mse=45.600018 best_discrete=45.600018 hash=False elapsed=68.3s
step   800/900 tau=0.0443 loss=0.354926 mse_soft=0.354657 ent_in=0.5973 ent_out=0.2984 rowmax_in=0.7097 rowmax_out=0.8466 discrete_mse=137.429703 best_discrete=45.600018 hash=False elapsed=70.4s
step   825/900 tau=0.0402 loss=0.377042 mse_soft=0.376788 ent_in=0.5399 ent_out=0.3072 rowmax_in=0.7282 rowmax_out=0.8326 discrete_mse=84.958801 best_discrete=45.600018 hash=False elapsed=72.6s
step   850/900 tau=0.0365 loss=0.356521 mse_soft=0.356263 ent_in=0.5659 ent_out=0.2951 rowmax_in=0.7172 rowmax_out=0.8457 discrete_mse=120.938271 best_discrete=45.600018 hash=False elapsed=74.9s
step   875/900 tau=0.0331 loss=0.361305 mse_soft=0.361051 ent_in=0.5517 ent_out=0.2945 rowmax_in=0.7240 rowmax_out=0.8464 discrete_mse=227.357101 best_discrete=45.600018 hash=False elapsed=77.0s
step   900/900 tau=0.0300 loss=0.443097 mse_soft=0.442888 ent_in=0.4515 ent_out=0.2459 rowmax_in=0.7696 rowmax_out=0.8708 discrete_mse=22.672758 best_discrete=22.672758 hash=False elapsed=79.3s

Final metrics:
  soft_mse_full=0.436920
  rowmax_in_mean=0.7728
  rowmax_out_mean=0.8711
  ent_in_mean=0.4466
  ent_out_mean=0.2453
  final_discrete_mse=87.949898
  hash_match=False
  best_discrete_mse_seen=22.672758
Saved results to overnight_b048_j1.json
