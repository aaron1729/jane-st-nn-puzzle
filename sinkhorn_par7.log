Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.02
step     1/700 tau=1.0000 loss=1.065737 mse_soft=1.063414 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=63.883312 best_discrete=63.883312 hash=False elapsed=0.5s
step    25/700 tau=0.8866 loss=0.935318 mse_soft=0.933066 ent_in=3.7426 ent_out=3.7626 rowmax_in=0.0374 rowmax_out=0.0364 discrete_mse=1507.204102 best_discrete=63.883312 hash=False elapsed=2.5s
step    50/700 tau=0.7821 loss=0.711956 mse_soft=0.709921 ent_in=3.3594 ent_out=3.4242 rowmax_in=0.0698 rowmax_out=0.0666 discrete_mse=4128.299316 best_discrete=63.883312 hash=False elapsed=4.5s
step    75/700 tau=0.6899 loss=0.584266 mse_soft=0.582473 ent_in=2.9293 ent_out=3.0483 rowmax_in=0.1333 rowmax_out=0.1216 discrete_mse=3267.947021 best_discrete=63.883312 hash=False elapsed=6.5s
step   100/700 tau=0.6086 loss=0.465575 mse_soft=0.464143 ent_in=2.3699 ent_out=2.4017 rowmax_in=0.2554 rowmax_out=0.2572 discrete_mse=579.975403 best_discrete=63.883312 hash=False elapsed=8.6s
step   125/700 tau=0.5368 loss=0.383524 mse_soft=0.382455 ent_in=1.8495 ent_out=1.7108 rowmax_in=0.3866 rowmax_out=0.4528 discrete_mse=859.893982 best_discrete=63.883312 hash=False elapsed=11.0s
step   150/700 tau=0.4736 loss=0.336899 mse_soft=0.336096 ent_in=1.5270 ent_out=1.1501 rowmax_in=0.4484 rowmax_out=0.6197 discrete_mse=1428.051270 best_discrete=63.883312 hash=False elapsed=13.1s
step   175/700 tau=0.4177 loss=0.313476 mse_soft=0.312812 ent_in=1.3520 ent_out=0.8629 rowmax_in=0.4797 rowmax_out=0.6976 discrete_mse=115.335136 best_discrete=63.883312 hash=False elapsed=15.2s
step   200/700 tau=0.3685 loss=0.299193 mse_soft=0.298646 ent_in=1.1990 ent_out=0.6260 rowmax_in=0.5159 rowmax_out=0.7852 discrete_mse=445.530884 best_discrete=63.883312 hash=False elapsed=17.3s
step   225/700 tau=0.3251 loss=0.292143 mse_soft=0.291662 ent_in=1.1168 ent_out=0.4894 rowmax_in=0.5340 rowmax_out=0.8280 discrete_mse=521.132324 best_discrete=63.883312 hash=False elapsed=19.4s
step   250/700 tau=0.2868 loss=0.286319 mse_soft=0.285862 ent_in=1.0785 ent_out=0.4444 rowmax_in=0.5406 rowmax_out=0.8366 discrete_mse=185.635391 best_discrete=63.883312 hash=False elapsed=21.5s
step   275/700 tau=0.2530 loss=0.283174 mse_soft=0.282730 ent_in=1.0600 ent_out=0.4190 rowmax_in=0.5438 rowmax_out=0.8395 discrete_mse=185.635391 best_discrete=63.883312 hash=False elapsed=23.7s
step   300/700 tau=0.2231 loss=0.281147 mse_soft=0.280716 ent_in=1.0428 ent_out=0.3950 rowmax_in=0.5491 rowmax_out=0.8439 discrete_mse=646.922607 best_discrete=63.883312 hash=False elapsed=25.8s
step   325/700 tau=0.1968 loss=0.279754 mse_soft=0.279333 ent_in=1.0365 ent_out=0.3658 rowmax_in=0.5514 rowmax_out=0.8575 discrete_mse=232.126389 best_discrete=63.883312 hash=False elapsed=27.9s
step   350/700 tau=0.1736 loss=0.279632 mse_soft=0.279219 ent_in=1.0289 ent_out=0.3457 rowmax_in=0.5526 rowmax_out=0.8642 discrete_mse=232.126389 best_discrete=63.883312 hash=False elapsed=30.1s
step   375/700 tau=0.1532 loss=0.278614 mse_soft=0.278207 ent_in=1.0229 ent_out=0.3329 rowmax_in=0.5525 rowmax_out=0.8710 discrete_mse=417.429840 best_discrete=63.883312 hash=False elapsed=32.3s
step   400/700 tau=0.1351 loss=0.280829 mse_soft=0.280426 ent_in=1.0181 ent_out=0.3254 rowmax_in=0.5525 rowmax_out=0.8740 discrete_mse=283.433197 best_discrete=63.883312 hash=False elapsed=34.5s
step   425/700 tau=0.1192 loss=0.281038 mse_soft=0.280638 ent_in=1.0111 ent_out=0.3226 rowmax_in=0.5572 rowmax_out=0.8746 discrete_mse=417.429840 best_discrete=63.883312 hash=False elapsed=36.7s
step   450/700 tau=0.1051 loss=0.280588 mse_soft=0.280190 ent_in=0.9979 ent_out=0.3268 rowmax_in=0.5595 rowmax_out=0.8700 discrete_mse=87.621559 best_discrete=63.883312 hash=False elapsed=38.8s
step   475/700 tau=0.0928 loss=0.278628 mse_soft=0.278235 ent_in=0.9879 ent_out=0.3222 rowmax_in=0.5620 rowmax_out=0.8684 discrete_mse=366.439697 best_discrete=63.883312 hash=False elapsed=41.1s
step   500/700 tau=0.0818 loss=0.282489 mse_soft=0.282101 ent_in=0.9780 ent_out=0.3149 rowmax_in=0.5614 rowmax_out=0.8713 discrete_mse=283.433197 best_discrete=63.883312 hash=False elapsed=43.4s
step   525/700 tau=0.0722 loss=0.290921 mse_soft=0.290542 ent_in=0.9465 ent_out=0.3166 rowmax_in=0.5769 rowmax_out=0.8666 discrete_mse=130.534866 best_discrete=63.883312 hash=False elapsed=45.5s
step   550/700 tau=0.0637 loss=0.297336 mse_soft=0.296979 ent_in=0.8979 ent_out=0.2925 rowmax_in=0.5993 rowmax_out=0.8716 discrete_mse=142.841965 best_discrete=63.883312 hash=False elapsed=47.6s
step   575/700 tau=0.0562 loss=0.285222 mse_soft=0.284863 ent_in=0.9075 ent_out=0.2877 rowmax_in=0.5916 rowmax_out=0.8728 discrete_mse=357.335480 best_discrete=63.883312 hash=False elapsed=49.6s
step   600/700 tau=0.0495 loss=0.302176 mse_soft=0.301858 ent_in=0.8074 ent_out=0.2524 rowmax_in=0.6254 rowmax_out=0.8814 discrete_mse=226.734146 best_discrete=63.883312 hash=False elapsed=51.6s
step   625/700 tau=0.0437 loss=0.382410 mse_soft=0.382141 ent_in=0.6463 ent_out=0.2503 rowmax_in=0.7060 rowmax_out=0.8713 discrete_mse=91.407082 best_discrete=63.883312 hash=False elapsed=53.7s
step   650/700 tau=0.0386 loss=0.430384 mse_soft=0.430155 ent_in=0.5596 ent_out=0.2046 rowmax_in=0.7194 rowmax_out=0.8958 discrete_mse=30.682081 best_discrete=30.682081 hash=False elapsed=55.8s
step   675/700 tau=0.0340 loss=0.350035 mse_soft=0.349830 ent_in=0.4870 ent_out=0.1951 rowmax_in=0.7543 rowmax_out=0.8993 discrete_mse=301.598633 best_discrete=30.682081 hash=False elapsed=57.9s
step   700/700 tau=0.0300 loss=0.337673 mse_soft=0.337465 ent_in=0.4980 ent_out=0.1969 rowmax_in=0.7458 rowmax_out=0.8982 discrete_mse=347.222931 best_discrete=30.682081 hash=False elapsed=60.3s

Final metrics:
  soft_mse_full=0.337424
  rowmax_in_mean=0.7472
  rowmax_out_mean=0.8998
  ent_in_mean=0.4971
  ent_out_mean=0.1960
  final_discrete_mse=347.222931
  hash_match=False
  best_discrete_mse_seen=30.682081
Saved results to sinkhorn_par7.json
