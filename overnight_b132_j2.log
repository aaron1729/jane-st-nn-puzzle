Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.043662 mse_soft=1.041339 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=147.959854 best_discrete=147.959854 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.839646 mse_soft=0.837457 ent_in=3.6304 ent_out=3.6668 rowmax_in=0.0461 rowmax_out=0.0447 discrete_mse=513.652710 best_discrete=147.959854 hash=False elapsed=3.0s
step    50/900 tau=0.8229 loss=0.636497 mse_soft=0.634587 ent_in=3.1353 ent_out=3.2287 rowmax_in=0.0931 rowmax_out=0.0882 discrete_mse=1683.654785 best_discrete=147.959854 hash=False elapsed=5.3s
step    75/900 tau=0.7450 loss=0.504804 mse_soft=0.503215 ent_in=2.6000 ent_out=2.6979 rowmax_in=0.2071 rowmax_out=0.1904 discrete_mse=235.980789 best_discrete=147.959854 hash=False elapsed=7.8s
step   100/900 tau=0.6745 loss=0.406928 mse_soft=0.405750 ent_in=2.0206 ent_out=1.9043 rowmax_in=0.3407 rowmax_out=0.3870 discrete_mse=324.513580 best_discrete=147.959854 hash=False elapsed=10.3s
step   125/900 tau=0.6107 loss=0.342783 mse_soft=0.341942 ent_in=1.6016 ent_out=1.2027 rowmax_in=0.4372 rowmax_out=0.5862 discrete_mse=619.887207 best_discrete=147.959854 hash=False elapsed=12.8s
step   150/900 tau=0.5529 loss=0.320542 mse_soft=0.319862 ent_in=1.4106 ent_out=0.8561 rowmax_in=0.4673 rowmax_out=0.6897 discrete_mse=708.044250 best_discrete=147.959854 hash=False elapsed=15.1s
step   175/900 tau=0.5006 loss=0.305768 mse_soft=0.305182 ent_in=1.2852 ent_out=0.6665 rowmax_in=0.4863 rowmax_out=0.7487 discrete_mse=131.781845 best_discrete=131.781845 hash=False elapsed=17.1s
step   200/900 tau=0.4532 loss=0.293526 mse_soft=0.293013 ent_in=1.2114 ent_out=0.4971 rowmax_in=0.4968 rowmax_out=0.8063 discrete_mse=109.701294 best_discrete=109.701294 hash=False elapsed=19.2s
step   225/900 tau=0.4103 loss=0.288928 mse_soft=0.288449 ent_in=1.1600 ent_out=0.4379 rowmax_in=0.5095 rowmax_out=0.8138 discrete_mse=51.510918 best_discrete=51.510918 hash=False elapsed=21.2s
step   250/900 tau=0.3715 loss=0.284957 mse_soft=0.284495 ent_in=1.1372 ent_out=0.4022 rowmax_in=0.5144 rowmax_out=0.8166 discrete_mse=136.804901 best_discrete=51.510918 hash=False elapsed=23.2s
step   275/900 tau=0.3363 loss=0.284217 mse_soft=0.283762 ent_in=1.1310 ent_out=0.3863 rowmax_in=0.5132 rowmax_out=0.8188 discrete_mse=136.804901 best_discrete=51.510918 hash=False elapsed=25.5s
step   300/900 tau=0.3045 loss=0.281514 mse_soft=0.281059 ent_in=1.1243 ent_out=0.3904 rowmax_in=0.5152 rowmax_out=0.8136 discrete_mse=59.776993 best_discrete=51.510918 hash=False elapsed=27.9s
step   325/900 tau=0.2756 loss=0.281567 mse_soft=0.281117 ent_in=1.1119 ent_out=0.3901 rowmax_in=0.5150 rowmax_out=0.8138 discrete_mse=59.776993 best_discrete=51.510918 hash=False elapsed=30.4s
step   350/900 tau=0.2496 loss=0.279404 mse_soft=0.278953 ent_in=1.1108 ent_out=0.3911 rowmax_in=0.5147 rowmax_out=0.8139 discrete_mse=112.375969 best_discrete=51.510918 hash=False elapsed=32.6s
step   375/900 tau=0.2259 loss=0.280033 mse_soft=0.279584 ent_in=1.1009 ent_out=0.3963 rowmax_in=0.5169 rowmax_out=0.8124 discrete_mse=153.563965 best_discrete=51.510918 hash=False elapsed=34.9s
step   400/900 tau=0.2046 loss=0.283530 mse_soft=0.283081 ent_in=1.0968 ent_out=0.4001 rowmax_in=0.5196 rowmax_out=0.8114 discrete_mse=43.107056 best_discrete=43.107056 hash=False elapsed=36.9s
step   425/900 tau=0.1852 loss=0.278478 mse_soft=0.278033 ent_in=1.0872 ent_out=0.3971 rowmax_in=0.5237 rowmax_out=0.8128 discrete_mse=7.940854 best_discrete=7.940854 hash=False elapsed=39.3s
step   450/900 tau=0.1677 loss=0.284209 mse_soft=0.283766 ent_in=1.0805 ent_out=0.3964 rowmax_in=0.5268 rowmax_out=0.8128 discrete_mse=98.792503 best_discrete=7.940854 hash=False elapsed=41.6s
step   475/900 tau=0.1518 loss=0.280250 mse_soft=0.279810 ent_in=1.0743 ent_out=0.3910 rowmax_in=0.5286 rowmax_out=0.8134 discrete_mse=15.841665 best_discrete=7.940854 hash=False elapsed=43.6s
step   500/900 tau=0.1374 loss=0.287363 mse_soft=0.286923 ent_in=1.0745 ent_out=0.3892 rowmax_in=0.5280 rowmax_out=0.8144 discrete_mse=53.078461 best_discrete=7.940854 hash=False elapsed=45.8s
step   525/900 tau=0.1244 loss=0.279437 mse_soft=0.278999 ent_in=1.0740 ent_out=0.3865 rowmax_in=0.5275 rowmax_out=0.8145 discrete_mse=15.841665 best_discrete=7.940854 hash=False elapsed=48.3s
step   550/900 tau=0.1126 loss=0.282396 mse_soft=0.281956 ent_in=1.0742 ent_out=0.3898 rowmax_in=0.5287 rowmax_out=0.8117 discrete_mse=12.208047 best_discrete=7.940854 hash=False elapsed=50.6s
step   575/900 tau=0.1020 loss=0.282987 mse_soft=0.282551 ent_in=1.0677 ent_out=0.3853 rowmax_in=0.5263 rowmax_out=0.8147 discrete_mse=12.208047 best_discrete=7.940854 hash=False elapsed=52.8s
step   600/900 tau=0.0923 loss=0.324914 mse_soft=0.324481 ent_in=1.0591 ent_out=0.3872 rowmax_in=0.5376 rowmax_out=0.8130 discrete_mse=204.223663 best_discrete=7.940854 hash=False elapsed=55.1s
step   625/900 tau=0.0836 loss=0.301654 mse_soft=0.301242 ent_in=0.9936 ent_out=0.3803 rowmax_in=0.5565 rowmax_out=0.8174 discrete_mse=160.490524 best_discrete=7.940854 hash=False elapsed=57.4s
step   650/900 tau=0.0757 loss=0.292030 mse_soft=0.291620 ent_in=0.9938 ent_out=0.3723 rowmax_in=0.5438 rowmax_out=0.8218 discrete_mse=102.684494 best_discrete=7.940854 hash=False elapsed=59.7s
step   675/900 tau=0.0685 loss=0.318334 mse_soft=0.317931 ent_in=0.9701 ent_out=0.3737 rowmax_in=0.5570 rowmax_out=0.8214 discrete_mse=139.202454 best_discrete=7.940854 hash=False elapsed=61.9s
step   700/900 tau=0.0620 loss=0.294684 mse_soft=0.294290 ent_in=0.9475 ent_out=0.3663 rowmax_in=0.5603 rowmax_out=0.8216 discrete_mse=91.658897 best_discrete=7.940854 hash=False elapsed=64.0s
step   725/900 tau=0.0562 loss=0.320055 mse_soft=0.319665 ent_in=0.9274 ent_out=0.3702 rowmax_in=0.5746 rowmax_out=0.8192 discrete_mse=28.444624 best_discrete=7.940854 hash=False elapsed=66.3s
step   750/900 tau=0.0508 loss=0.309872 mse_soft=0.309498 ent_in=0.8966 ent_out=0.3511 rowmax_in=0.5845 rowmax_out=0.8356 discrete_mse=70.527596 best_discrete=7.940854 hash=False elapsed=68.5s
step   775/900 tau=0.0460 loss=0.326211 mse_soft=0.325863 ent_in=0.8266 ent_out=0.3330 rowmax_in=0.6137 rowmax_out=0.8405 discrete_mse=34.417847 best_discrete=7.940854 hash=False elapsed=70.7s
step   800/900 tau=0.0417 loss=0.400605 mse_soft=0.400312 ent_in=0.7065 ent_out=0.2710 rowmax_in=0.6638 rowmax_out=0.8743 discrete_mse=19.486744 best_discrete=7.940854 hash=False elapsed=72.8s
step   825/900 tau=0.0377 loss=0.362235 mse_soft=0.361987 ent_in=0.5752 ent_out=0.2499 rowmax_in=0.7249 rowmax_out=0.8762 discrete_mse=42.097225 best_discrete=7.940854 hash=False elapsed=74.9s
step   850/900 tau=0.0342 loss=0.354375 mse_soft=0.354124 ent_in=0.5616 ent_out=0.2764 rowmax_in=0.7136 rowmax_out=0.8562 discrete_mse=8.468994 best_discrete=7.940854 hash=False elapsed=77.0s
step   875/900 tau=0.0309 loss=0.339195 mse_soft=0.338944 ent_in=0.5637 ent_out=0.2761 rowmax_in=0.7097 rowmax_out=0.8554 discrete_mse=31.208502 best_discrete=7.940854 hash=False elapsed=79.3s
step   900/900 tau=0.0280 loss=0.344779 mse_soft=0.344540 ent_in=0.5296 ent_out=0.2672 rowmax_in=0.7245 rowmax_out=0.8626 discrete_mse=2.466414 best_discrete=2.466414 hash=False elapsed=81.5s

Final metrics:
  soft_mse_full=0.354328
  rowmax_in_mean=0.7330
  rowmax_out_mean=0.8618
  ent_in_mean=0.5245
  ent_out_mean=0.2675
  final_discrete_mse=3.097748
  hash_match=False
  best_discrete_mse_seen=2.466414
Saved results to overnight_b132_j2.json
