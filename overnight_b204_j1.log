Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.057076 mse_soft=1.054754 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=107.597160 best_discrete=107.597160 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.858180 mse_soft=0.855990 ent_in=3.6329 ent_out=3.6682 rowmax_in=0.0454 rowmax_out=0.0439 discrete_mse=2082.780762 best_discrete=107.597160 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.650204 mse_soft=0.648300 ent_in=3.1264 ent_out=3.2227 rowmax_in=0.0941 rowmax_out=0.0876 discrete_mse=3903.682373 best_discrete=107.597160 hash=False elapsed=5.1s
step    75/900 tau=0.7493 loss=0.509950 mse_soft=0.508373 ent_in=2.5832 ent_out=2.6749 rowmax_in=0.2022 rowmax_out=0.1964 discrete_mse=4159.115723 best_discrete=107.597160 hash=False elapsed=7.1s
step   100/900 tau=0.6797 loss=0.396410 mse_soft=0.395272 ent_in=1.9492 ent_out=1.8445 rowmax_in=0.3649 rowmax_out=0.4279 discrete_mse=499.623688 best_discrete=107.597160 hash=False elapsed=9.5s
step   125/900 tau=0.6165 loss=0.331716 mse_soft=0.330894 ent_in=1.5384 ent_out=1.2032 rowmax_in=0.4636 rowmax_out=0.5997 discrete_mse=345.157928 best_discrete=107.597160 hash=False elapsed=11.7s
step   150/900 tau=0.5592 loss=0.307198 mse_soft=0.306543 ent_in=1.3325 ent_out=0.8506 rowmax_in=0.5014 rowmax_out=0.6960 discrete_mse=65.315186 best_discrete=65.315186 hash=False elapsed=14.0s
step   175/900 tau=0.5073 loss=0.291993 mse_soft=0.291439 ent_in=1.1951 ent_out=0.6501 rowmax_in=0.5267 rowmax_out=0.7604 discrete_mse=183.140472 best_discrete=65.315186 hash=False elapsed=16.5s
step   200/900 tau=0.4602 loss=0.284155 mse_soft=0.283661 ent_in=1.1270 ent_out=0.5197 rowmax_in=0.5409 rowmax_out=0.7939 discrete_mse=120.116684 best_discrete=65.315186 hash=False elapsed=18.9s
step   225/900 tau=0.4174 loss=0.278681 mse_soft=0.278220 ent_in=1.0939 ent_out=0.4407 rowmax_in=0.5562 rowmax_out=0.8214 discrete_mse=44.324261 best_discrete=44.324261 hash=False elapsed=21.1s
step   250/900 tau=0.3786 loss=0.274277 mse_soft=0.273833 ent_in=1.0815 ent_out=0.4000 rowmax_in=0.5607 rowmax_out=0.8312 discrete_mse=73.319588 best_discrete=44.324261 hash=False elapsed=23.5s
step   275/900 tau=0.3434 loss=0.271961 mse_soft=0.271528 ent_in=1.0703 ent_out=0.3747 rowmax_in=0.5667 rowmax_out=0.8351 discrete_mse=73.319588 best_discrete=44.324261 hash=False elapsed=25.7s
step   300/900 tau=0.3115 loss=0.270466 mse_soft=0.270037 ent_in=1.0721 ent_out=0.3553 rowmax_in=0.5662 rowmax_out=0.8421 discrete_mse=89.345757 best_discrete=44.324261 hash=False elapsed=27.8s
step   325/900 tau=0.2826 loss=0.267328 mse_soft=0.266907 ent_in=1.0590 ent_out=0.3458 rowmax_in=0.5673 rowmax_out=0.8443 discrete_mse=71.779793 best_discrete=44.324261 hash=False elapsed=30.0s
step   350/900 tau=0.2563 loss=0.265801 mse_soft=0.265386 ent_in=1.0494 ent_out=0.3316 rowmax_in=0.5656 rowmax_out=0.8497 discrete_mse=49.936115 best_discrete=44.324261 hash=False elapsed=32.5s
step   375/900 tau=0.2325 loss=0.267938 mse_soft=0.267527 ent_in=1.0443 ent_out=0.3249 rowmax_in=0.5662 rowmax_out=0.8508 discrete_mse=49.936115 best_discrete=44.324261 hash=False elapsed=34.8s
step   400/900 tau=0.2109 loss=0.265433 mse_soft=0.265023 ent_in=1.0451 ent_out=0.3227 rowmax_in=0.5662 rowmax_out=0.8513 discrete_mse=71.779793 best_discrete=44.324261 hash=False elapsed=37.1s
step   425/900 tau=0.1913 loss=0.265577 mse_soft=0.265169 ent_in=1.0412 ent_out=0.3188 rowmax_in=0.5674 rowmax_out=0.8539 discrete_mse=53.146660 best_discrete=44.324261 hash=False elapsed=39.5s
step   450/900 tau=0.1735 loss=0.269758 mse_soft=0.269352 ent_in=1.0364 ent_out=0.3164 rowmax_in=0.5674 rowmax_out=0.8541 discrete_mse=123.644600 best_discrete=44.324261 hash=False elapsed=42.0s
step   475/900 tau=0.1574 loss=0.264902 mse_soft=0.264498 ent_in=1.0357 ent_out=0.3107 rowmax_in=0.5662 rowmax_out=0.8597 discrete_mse=53.146660 best_discrete=44.324261 hash=False elapsed=44.3s
step   500/900 tau=0.1428 loss=0.265966 mse_soft=0.265563 ent_in=1.0328 ent_out=0.3095 rowmax_in=0.5668 rowmax_out=0.8597 discrete_mse=53.146660 best_discrete=44.324261 hash=False elapsed=46.7s
step   525/900 tau=0.1295 loss=0.274950 mse_soft=0.274553 ent_in=1.0230 ent_out=0.3024 rowmax_in=0.5688 rowmax_out=0.8656 discrete_mse=53.146660 best_discrete=44.324261 hash=False elapsed=49.3s
step   550/900 tau=0.1175 loss=0.268233 mse_soft=0.267835 ent_in=1.0181 ent_out=0.3082 rowmax_in=0.5686 rowmax_out=0.8616 discrete_mse=292.115356 best_discrete=44.324261 hash=False elapsed=51.8s
step   575/900 tau=0.1066 loss=0.276016 mse_soft=0.275621 ent_in=1.0116 ent_out=0.3036 rowmax_in=0.5695 rowmax_out=0.8654 discrete_mse=181.119568 best_discrete=44.324261 hash=False elapsed=54.2s
step   600/900 tau=0.0967 loss=0.294658 mse_soft=0.294266 ent_in=1.0054 ent_out=0.3015 rowmax_in=0.5698 rowmax_out=0.8686 discrete_mse=139.286102 best_discrete=44.324261 hash=False elapsed=56.7s
step   625/900 tau=0.0877 loss=0.267907 mse_soft=0.267519 ent_in=1.0015 ent_out=0.2949 rowmax_in=0.5710 rowmax_out=0.8708 discrete_mse=107.380287 best_discrete=44.324261 hash=False elapsed=59.2s
step   650/900 tau=0.0795 loss=0.270126 mse_soft=0.269740 ent_in=0.9939 ent_out=0.2946 rowmax_in=0.5703 rowmax_out=0.8717 discrete_mse=69.279175 best_discrete=44.324261 hash=False elapsed=61.5s
step   675/900 tau=0.0722 loss=0.272449 mse_soft=0.272074 ent_in=0.9639 ent_out=0.2859 rowmax_in=0.5784 rowmax_out=0.8754 discrete_mse=7.391470 best_discrete=7.391470 hash=False elapsed=63.8s
step   700/900 tau=0.0655 loss=0.311603 mse_soft=0.311232 ent_in=0.9531 ent_out=0.2836 rowmax_in=0.5789 rowmax_out=0.8762 discrete_mse=50.034115 best_discrete=7.391470 hash=False elapsed=66.2s
step   725/900 tau=0.0594 loss=0.285118 mse_soft=0.284759 ent_in=0.8960 ent_out=0.3004 rowmax_in=0.6036 rowmax_out=0.8509 discrete_mse=10.690775 best_discrete=7.391470 hash=False elapsed=68.5s
step   750/900 tau=0.0539 loss=0.304865 mse_soft=0.304523 ent_in=0.8554 ent_out=0.2831 rowmax_in=0.6094 rowmax_out=0.8719 discrete_mse=71.304115 best_discrete=7.391470 hash=False elapsed=70.9s
step   775/900 tau=0.0489 loss=0.346574 mse_soft=0.346224 ent_in=0.8772 ent_out=0.2879 rowmax_in=0.5928 rowmax_out=0.8633 discrete_mse=116.789223 best_discrete=7.391470 hash=False elapsed=73.2s
step   800/900 tau=0.0443 loss=0.332024 mse_soft=0.331747 ent_in=0.6631 ent_out=0.2574 rowmax_in=0.6778 rowmax_out=0.8752 discrete_mse=71.652222 best_discrete=7.391470 hash=False elapsed=75.5s
step   825/900 tau=0.0402 loss=0.317562 mse_soft=0.317285 ent_in=0.6559 ent_out=0.2659 rowmax_in=0.6784 rowmax_out=0.8647 discrete_mse=60.184574 best_discrete=7.391470 hash=False elapsed=77.8s
step   850/900 tau=0.0365 loss=0.315413 mse_soft=0.315126 ent_in=0.6816 ent_out=0.2744 rowmax_in=0.6556 rowmax_out=0.8557 discrete_mse=41.499092 best_discrete=7.391470 hash=False elapsed=80.0s
step   875/900 tau=0.0331 loss=0.372537 mse_soft=0.372302 ent_in=0.5555 ent_out=0.2276 rowmax_in=0.7209 rowmax_out=0.8743 discrete_mse=33.577644 best_discrete=7.391470 hash=False elapsed=82.3s
step   900/900 tau=0.0300 loss=0.332545 mse_soft=0.332314 ent_in=0.5225 ent_out=0.2473 rowmax_in=0.7246 rowmax_out=0.8690 discrete_mse=58.211250 best_discrete=7.391470 hash=False elapsed=84.7s

Final metrics:
  soft_mse_full=0.350050
  rowmax_in_mean=0.7247
  rowmax_out_mean=0.8690
  ent_in_mean=0.5235
  ent_out_mean=0.2476
  final_discrete_mse=6.517975
  hash_match=False
  best_discrete_mse_seen=7.391470
Saved results to overnight_b204_j1.json
