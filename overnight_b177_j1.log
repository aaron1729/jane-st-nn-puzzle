Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.054953 mse_soft=1.052630 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=4.073954 best_discrete=4.073954 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.852640 mse_soft=0.850450 ent_in=3.6327 ent_out=3.6666 rowmax_in=0.0454 rowmax_out=0.0441 discrete_mse=2249.237549 best_discrete=4.073954 hash=False elapsed=2.9s
step    50/900 tau=0.8260 loss=0.645365 mse_soft=0.643456 ent_in=3.1342 ent_out=3.2283 rowmax_in=0.0943 rowmax_out=0.0857 discrete_mse=1976.948730 best_discrete=4.073954 hash=False elapsed=5.4s
step    75/900 tau=0.7493 loss=0.507078 mse_soft=0.505491 ent_in=2.6096 ent_out=2.6825 rowmax_in=0.2080 rowmax_out=0.1995 discrete_mse=152.271057 best_discrete=4.073954 hash=False elapsed=8.2s
step   100/900 tau=0.6797 loss=0.395735 mse_soft=0.394571 ent_in=2.0047 ent_out=1.8726 rowmax_in=0.3689 rowmax_out=0.4115 discrete_mse=65.200920 best_discrete=4.073954 hash=False elapsed=10.8s
step   125/900 tau=0.6165 loss=0.333659 mse_soft=0.332842 ent_in=1.5898 ent_out=1.1318 rowmax_in=0.4599 rowmax_out=0.6495 discrete_mse=268.116821 best_discrete=4.073954 hash=False elapsed=13.5s
step   150/900 tau=0.5592 loss=0.299325 mse_soft=0.298706 ent_in=1.3751 ent_out=0.6862 rowmax_in=0.4882 rowmax_out=0.7863 discrete_mse=527.367798 best_discrete=4.073954 hash=False elapsed=16.1s
step   175/900 tau=0.5073 loss=0.287942 mse_soft=0.287414 ent_in=1.2802 ent_out=0.4824 rowmax_in=0.5064 rowmax_out=0.8352 discrete_mse=160.391663 best_discrete=4.073954 hash=False elapsed=18.4s
step   200/900 tau=0.4602 loss=0.280448 mse_soft=0.279952 ent_in=1.2380 ent_out=0.4149 rowmax_in=0.5058 rowmax_out=0.8411 discrete_mse=382.478607 best_discrete=4.073954 hash=False elapsed=21.3s
step   225/900 tau=0.4174 loss=0.275757 mse_soft=0.275281 ent_in=1.1973 ent_out=0.3906 rowmax_in=0.5125 rowmax_out=0.8463 discrete_mse=856.253784 best_discrete=4.073954 hash=False elapsed=24.1s
step   250/900 tau=0.3786 loss=0.273165 mse_soft=0.272707 ent_in=1.1689 ent_out=0.3555 rowmax_in=0.5183 rowmax_out=0.8541 discrete_mse=766.336304 best_discrete=4.073954 hash=False elapsed=26.7s
step   275/900 tau=0.3434 loss=0.271037 mse_soft=0.270591 ent_in=1.1524 ent_out=0.3331 rowmax_in=0.5197 rowmax_out=0.8574 discrete_mse=766.336304 best_discrete=4.073954 hash=False elapsed=29.3s
step   300/900 tau=0.3115 loss=0.269643 mse_soft=0.269203 ent_in=1.1428 ent_out=0.3230 rowmax_in=0.5199 rowmax_out=0.8634 discrete_mse=181.081467 best_discrete=4.073954 hash=False elapsed=32.1s
step   325/900 tau=0.2826 loss=0.268348 mse_soft=0.267915 ent_in=1.1342 ent_out=0.3088 rowmax_in=0.5206 rowmax_out=0.8677 discrete_mse=462.115479 best_discrete=4.073954 hash=False elapsed=34.7s
step   350/900 tau=0.2563 loss=0.266988 mse_soft=0.266563 ent_in=1.1199 ent_out=0.2949 rowmax_in=0.5236 rowmax_out=0.8734 discrete_mse=196.945602 best_discrete=4.073954 hash=False elapsed=37.2s
step   375/900 tau=0.2325 loss=0.275098 mse_soft=0.274678 ent_in=1.1137 ent_out=0.2855 rowmax_in=0.5229 rowmax_out=0.8758 discrete_mse=72.211159 best_discrete=4.073954 hash=False elapsed=39.7s
step   400/900 tau=0.2109 loss=0.266572 mse_soft=0.266155 ent_in=1.1133 ent_out=0.2755 rowmax_in=0.5237 rowmax_out=0.8780 discrete_mse=79.391029 best_discrete=4.073954 hash=False elapsed=42.2s
step   425/900 tau=0.1913 loss=0.272525 mse_soft=0.272113 ent_in=1.1041 ent_out=0.2698 rowmax_in=0.5249 rowmax_out=0.8787 discrete_mse=82.451042 best_discrete=4.073954 hash=False elapsed=44.9s
step   450/900 tau=0.1735 loss=0.265798 mse_soft=0.265388 ent_in=1.0985 ent_out=0.2676 rowmax_in=0.5252 rowmax_out=0.8774 discrete_mse=140.476471 best_discrete=4.073954 hash=False elapsed=47.7s
step   475/900 tau=0.1574 loss=0.266255 mse_soft=0.265849 ent_in=1.0933 ent_out=0.2619 rowmax_in=0.5256 rowmax_out=0.8795 discrete_mse=90.423103 best_discrete=4.073954 hash=False elapsed=50.4s
step   500/900 tau=0.1428 loss=0.266699 mse_soft=0.266295 ent_in=1.0907 ent_out=0.2552 rowmax_in=0.5256 rowmax_out=0.8817 discrete_mse=89.449394 best_discrete=4.073954 hash=False elapsed=53.1s
step   525/900 tau=0.1295 loss=0.268974 mse_soft=0.268572 ent_in=1.0849 ent_out=0.2527 rowmax_in=0.5269 rowmax_out=0.8813 discrete_mse=159.905960 best_discrete=4.073954 hash=False elapsed=55.7s
step   550/900 tau=0.1175 loss=0.271595 mse_soft=0.271196 ent_in=1.0796 ent_out=0.2520 rowmax_in=0.5285 rowmax_out=0.8811 discrete_mse=104.958244 best_discrete=4.073954 hash=False elapsed=58.3s
step   575/900 tau=0.1066 loss=0.266689 mse_soft=0.266290 ent_in=1.0801 ent_out=0.2507 rowmax_in=0.5260 rowmax_out=0.8812 discrete_mse=161.042526 best_discrete=4.073954 hash=False elapsed=60.9s
step   600/900 tau=0.0967 loss=0.291200 mse_soft=0.290801 ent_in=1.0816 ent_out=0.2494 rowmax_in=0.5245 rowmax_out=0.8823 discrete_mse=55.250267 best_discrete=4.073954 hash=False elapsed=63.6s
step   625/900 tau=0.0877 loss=0.267124 mse_soft=0.266729 ent_in=1.0709 ent_out=0.2462 rowmax_in=0.5243 rowmax_out=0.8811 discrete_mse=32.197304 best_discrete=4.073954 hash=False elapsed=66.3s
step   650/900 tau=0.0795 loss=0.284508 mse_soft=0.284119 ent_in=1.0545 ent_out=0.2439 rowmax_in=0.5346 rowmax_out=0.8831 discrete_mse=82.122337 best_discrete=4.073954 hash=False elapsed=68.7s
step   675/900 tau=0.0722 loss=0.278200 mse_soft=0.277810 ent_in=1.0531 ent_out=0.2461 rowmax_in=0.5265 rowmax_out=0.8797 discrete_mse=99.866646 best_discrete=4.073954 hash=False elapsed=71.4s
step   700/900 tau=0.0655 loss=0.284873 mse_soft=0.284491 ent_in=1.0266 ent_out=0.2444 rowmax_in=0.5437 rowmax_out=0.8816 discrete_mse=10.171677 best_discrete=4.073954 hash=False elapsed=73.8s
step   725/900 tau=0.0594 loss=0.287563 mse_soft=0.287196 ent_in=0.9779 ent_out=0.2437 rowmax_in=0.5636 rowmax_out=0.8817 discrete_mse=40.024132 best_discrete=4.073954 hash=False elapsed=76.3s
step   750/900 tau=0.0539 loss=0.357789 mse_soft=0.357477 ent_in=0.8503 ent_out=0.1903 rowmax_in=0.6165 rowmax_out=0.9140 discrete_mse=15.933714 best_discrete=4.073954 hash=False elapsed=78.8s
step   775/900 tau=0.0489 loss=0.311372 mse_soft=0.311089 ent_in=0.7434 ent_out=0.1983 rowmax_in=0.6604 rowmax_out=0.8968 discrete_mse=5.106478 best_discrete=4.073954 hash=False elapsed=81.2s
step   800/900 tau=0.0443 loss=0.296116 mse_soft=0.295830 ent_in=0.7615 ent_out=0.1916 rowmax_in=0.6279 rowmax_out=0.8928 discrete_mse=14.800231 best_discrete=4.073954 hash=False elapsed=83.8s
step   825/900 tau=0.0402 loss=0.292364 mse_soft=0.292082 ent_in=0.7478 ent_out=0.1916 rowmax_in=0.6345 rowmax_out=0.8913 discrete_mse=10.064865 best_discrete=4.073954 hash=False elapsed=86.2s
step   850/900 tau=0.0365 loss=0.295620 mse_soft=0.295330 ent_in=0.7726 ent_out=0.1934 rowmax_in=0.6223 rowmax_out=0.8892 discrete_mse=9.957183 best_discrete=4.073954 hash=False elapsed=88.6s
step   875/900 tau=0.0331 loss=0.320184 mse_soft=0.319909 ent_in=0.7237 ent_out=0.1933 rowmax_in=0.6512 rowmax_out=0.8924 discrete_mse=0.766072 best_discrete=0.766072 hash=False elapsed=91.1s
step   900/900 tau=0.0300 loss=0.470262 mse_soft=0.470105 ent_in=0.4013 ent_out=0.1222 rowmax_in=0.7991 rowmax_out=0.9284 discrete_mse=4.450125 best_discrete=0.766072 hash=False elapsed=93.9s

Final metrics:
  soft_mse_full=0.484816
  rowmax_in_mean=0.7957
  rowmax_out_mean=0.9284
  ent_in_mean=0.4051
  ent_out_mean=0.1222
  final_discrete_mse=3.512459
  hash_match=False
  best_discrete_mse_seen=0.766072
Saved results to overnight_b177_j1.json
