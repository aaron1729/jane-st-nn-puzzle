Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.066718 mse_soft=1.064395 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=10.889833 best_discrete=10.889833 hash=False elapsed=0.6s
step    25/900 tau=0.9106 loss=0.863243 mse_soft=0.861052 ent_in=3.6351 ent_out=3.6695 rowmax_in=0.0457 rowmax_out=0.0441 discrete_mse=6425.882812 best_discrete=10.889833 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.649628 mse_soft=0.647717 ent_in=3.1369 ent_out=3.2314 rowmax_in=0.0926 rowmax_out=0.0867 discrete_mse=1672.463989 best_discrete=10.889833 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.511713 mse_soft=0.510124 ent_in=2.6039 ent_out=2.6930 rowmax_in=0.2035 rowmax_out=0.2012 discrete_mse=1600.364136 best_discrete=10.889833 hash=False elapsed=7.2s
step   100/900 tau=0.6797 loss=0.413794 mse_soft=0.412600 ent_in=2.0123 ent_out=1.9661 rowmax_in=0.3403 rowmax_out=0.3708 discrete_mse=3631.165039 best_discrete=10.889833 hash=False elapsed=9.5s
step   125/900 tau=0.6165 loss=0.344801 mse_soft=0.343958 ent_in=1.5731 ent_out=1.2382 rowmax_in=0.4433 rowmax_out=0.5897 discrete_mse=487.269043 best_discrete=10.889833 hash=False elapsed=11.7s
step   150/900 tau=0.5592 loss=0.315270 mse_soft=0.314592 ent_in=1.3762 ent_out=0.8861 rowmax_in=0.4806 rowmax_out=0.6788 discrete_mse=483.683136 best_discrete=10.889833 hash=False elapsed=13.9s
step   175/900 tau=0.5073 loss=0.298921 mse_soft=0.298339 ent_in=1.2504 ent_out=0.6901 rowmax_in=0.5120 rowmax_out=0.7520 discrete_mse=666.539856 best_discrete=10.889833 hash=False elapsed=16.2s
step   200/900 tau=0.4602 loss=0.289037 mse_soft=0.288507 ent_in=1.1786 ent_out=0.5885 rowmax_in=0.5266 rowmax_out=0.7850 discrete_mse=232.489044 best_discrete=10.889833 hash=False elapsed=18.4s
step   225/900 tau=0.4174 loss=0.284134 mse_soft=0.283626 ent_in=1.1452 ent_out=0.5481 rowmax_in=0.5301 rowmax_out=0.7850 discrete_mse=749.561646 best_discrete=10.889833 hash=False elapsed=20.7s
step   250/900 tau=0.3786 loss=0.279391 mse_soft=0.278901 ent_in=1.1173 ent_out=0.5157 rowmax_in=0.5338 rowmax_out=0.7850 discrete_mse=993.317078 best_discrete=10.889833 hash=False elapsed=23.0s
step   275/900 tau=0.3434 loss=0.277027 mse_soft=0.276550 ent_in=1.1008 ent_out=0.4878 rowmax_in=0.5340 rowmax_out=0.7909 discrete_mse=871.955200 best_discrete=10.889833 hash=False elapsed=25.3s
step   300/900 tau=0.3115 loss=0.274215 mse_soft=0.273746 ent_in=1.0932 ent_out=0.4721 rowmax_in=0.5377 rowmax_out=0.7931 discrete_mse=1323.349976 best_discrete=10.889833 hash=False elapsed=27.6s
step   325/900 tau=0.2826 loss=0.270549 mse_soft=0.270091 ent_in=1.0649 ent_out=0.4621 rowmax_in=0.5500 rowmax_out=0.7938 discrete_mse=2288.610840 best_discrete=10.889833 hash=False elapsed=29.8s
step   350/900 tau=0.2563 loss=0.268870 mse_soft=0.268419 ent_in=1.0470 ent_out=0.4576 rowmax_in=0.5552 rowmax_out=0.7911 discrete_mse=2288.610840 best_discrete=10.889833 hash=False elapsed=32.0s
step   375/900 tau=0.2325 loss=0.269711 mse_soft=0.269262 ent_in=1.0399 ent_out=0.4559 rowmax_in=0.5555 rowmax_out=0.7875 discrete_mse=825.165955 best_discrete=10.889833 hash=False elapsed=34.1s
step   400/900 tau=0.2109 loss=0.268829 mse_soft=0.268385 ent_in=1.0298 ent_out=0.4498 rowmax_in=0.5600 rowmax_out=0.7899 discrete_mse=596.733215 best_discrete=10.889833 hash=False elapsed=35.9s
step   425/900 tau=0.1913 loss=0.269091 mse_soft=0.268652 ent_in=1.0214 ent_out=0.4408 rowmax_in=0.5637 rowmax_out=0.7923 discrete_mse=596.733215 best_discrete=10.889833 hash=False elapsed=38.1s
step   450/900 tau=0.1735 loss=0.270104 mse_soft=0.269668 ent_in=1.0198 ent_out=0.4310 rowmax_in=0.5636 rowmax_out=0.7951 discrete_mse=596.733215 best_discrete=10.889833 hash=False elapsed=40.3s
step   475/900 tau=0.1574 loss=0.268161 mse_soft=0.267731 ent_in=1.0098 ent_out=0.4226 rowmax_in=0.5701 rowmax_out=0.7968 discrete_mse=333.732727 best_discrete=10.889833 hash=False elapsed=42.5s
step   500/900 tau=0.1428 loss=0.271450 mse_soft=0.271022 ent_in=1.0090 ent_out=0.4167 rowmax_in=0.5682 rowmax_out=0.7982 discrete_mse=333.732727 best_discrete=10.889833 hash=False elapsed=44.8s
step   525/900 tau=0.1295 loss=0.268641 mse_soft=0.268215 ent_in=1.0077 ent_out=0.4111 rowmax_in=0.5695 rowmax_out=0.7985 discrete_mse=333.732727 best_discrete=10.889833 hash=False elapsed=47.1s
step   550/900 tau=0.1175 loss=0.340093 mse_soft=0.339712 ent_in=0.9187 ent_out=0.3532 rowmax_in=0.6007 rowmax_out=0.8370 discrete_mse=66.238678 best_discrete=10.889833 hash=False elapsed=49.5s
step   575/900 tau=0.1066 loss=0.281210 mse_soft=0.280846 ent_in=0.8569 ent_out=0.3553 rowmax_in=0.6144 rowmax_out=0.8142 discrete_mse=12.314398 best_discrete=10.889833 hash=False elapsed=51.9s
step   600/900 tau=0.0967 loss=0.274104 mse_soft=0.273743 ent_in=0.8473 ent_out=0.3552 rowmax_in=0.6198 rowmax_out=0.8147 discrete_mse=8.664250 best_discrete=8.664250 hash=False elapsed=54.3s
step   625/900 tau=0.0877 loss=0.273931 mse_soft=0.273578 ent_in=0.8319 ent_out=0.3439 rowmax_in=0.6299 rowmax_out=0.8189 discrete_mse=77.885681 best_discrete=8.664250 hash=False elapsed=56.6s
step   650/900 tau=0.0795 loss=0.278530 mse_soft=0.278178 ent_in=0.8345 ent_out=0.3390 rowmax_in=0.6275 rowmax_out=0.8214 discrete_mse=85.025383 best_discrete=8.664250 hash=False elapsed=58.8s
step   675/900 tau=0.0722 loss=0.273988 mse_soft=0.273637 ent_in=0.8359 ent_out=0.3345 rowmax_in=0.6242 rowmax_out=0.8232 discrete_mse=77.885681 best_discrete=8.664250 hash=False elapsed=61.1s
step   700/900 tau=0.0655 loss=0.369654 mse_soft=0.369377 ent_in=0.6243 ent_out=0.3005 rowmax_in=0.7117 rowmax_out=0.8559 discrete_mse=128.805359 best_discrete=8.664250 hash=False elapsed=63.6s
step   725/900 tau=0.0594 loss=0.364044 mse_soft=0.363804 ent_in=0.5149 ent_out=0.2857 rowmax_in=0.7671 rowmax_out=0.8417 discrete_mse=24.504622 best_discrete=8.664250 hash=False elapsed=65.9s
step   750/900 tau=0.0539 loss=0.336863 mse_soft=0.336634 ent_in=0.4834 ent_out=0.2786 rowmax_in=0.7723 rowmax_out=0.8413 discrete_mse=187.283371 best_discrete=8.664250 hash=False elapsed=68.2s
step   775/900 tau=0.0489 loss=0.325514 mse_soft=0.325269 ent_in=0.5358 ent_out=0.2789 rowmax_in=0.7392 rowmax_out=0.8408 discrete_mse=75.381996 best_discrete=8.664250 hash=False elapsed=70.5s
step   800/900 tau=0.0443 loss=0.376284 mse_soft=0.376085 ent_in=0.4393 ent_out=0.2240 rowmax_in=0.7956 rowmax_out=0.8739 discrete_mse=23.371469 best_discrete=8.664250 hash=False elapsed=72.9s
step   825/900 tau=0.0402 loss=0.362098 mse_soft=0.361907 ent_in=0.4455 ent_out=0.1915 rowmax_in=0.7852 rowmax_out=0.8776 discrete_mse=2.426716 best_discrete=2.426716 hash=False elapsed=75.5s
step   850/900 tau=0.0365 loss=0.349244 mse_soft=0.349032 ent_in=0.5102 ent_out=0.1943 rowmax_in=0.7367 rowmax_out=0.8728 discrete_mse=5.919604 best_discrete=2.426716 hash=False elapsed=77.9s
step   875/900 tau=0.0331 loss=0.457644 mse_soft=0.457496 ent_in=0.3089 ent_out=0.1858 rowmax_in=0.8258 rowmax_out=0.8764 discrete_mse=40.866550 best_discrete=2.426716 hash=False elapsed=80.4s
step   900/900 tau=0.0300 loss=0.410901 mse_soft=0.410776 ent_in=0.2783 ent_out=0.1369 rowmax_in=0.8389 rowmax_out=0.9046 discrete_mse=35.417332 best_discrete=2.426716 hash=False elapsed=82.8s

Final metrics:
  soft_mse_full=0.420734
  rowmax_in_mean=0.8392
  rowmax_out_mean=0.9047
  ent_in_mean=0.2779
  ent_out_mean=0.1368
  final_discrete_mse=35.417332
  hash_match=False
  best_discrete_mse_seen=2.426716
Saved results to overnight_b161_j1.json
