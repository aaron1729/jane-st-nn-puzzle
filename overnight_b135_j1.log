Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.062882 mse_soft=1.060559 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=23.760267 best_discrete=23.760267 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.860410 mse_soft=0.858220 ent_in=3.6336 ent_out=3.6672 rowmax_in=0.0452 rowmax_out=0.0448 discrete_mse=3521.722656 best_discrete=23.760267 hash=False elapsed=2.9s
step    50/900 tau=0.8260 loss=0.652587 mse_soft=0.650681 ent_in=3.1402 ent_out=3.2135 rowmax_in=0.0929 rowmax_out=0.0920 discrete_mse=5315.537109 best_discrete=23.760267 hash=False elapsed=5.4s
step    75/900 tau=0.7493 loss=0.510363 mse_soft=0.508797 ent_in=2.5848 ent_out=2.6355 rowmax_in=0.2076 rowmax_out=0.2024 discrete_mse=916.777649 best_discrete=23.760267 hash=False elapsed=7.7s
step   100/900 tau=0.6797 loss=0.409211 mse_soft=0.408066 ent_in=1.9902 ent_out=1.8296 rowmax_in=0.3390 rowmax_out=0.4221 discrete_mse=2525.295654 best_discrete=23.760267 hash=False elapsed=10.0s
step   125/900 tau=0.6165 loss=0.353230 mse_soft=0.352392 ent_in=1.6280 ent_out=1.1652 rowmax_in=0.4209 rowmax_out=0.6325 discrete_mse=490.579376 best_discrete=23.760267 hash=False elapsed=12.5s
step   150/900 tau=0.5592 loss=0.324798 mse_soft=0.324138 ent_in=1.4091 ent_out=0.7906 rowmax_in=0.4521 rowmax_out=0.7377 discrete_mse=582.928101 best_discrete=23.760267 hash=False elapsed=14.7s
step   175/900 tau=0.5073 loss=0.308932 mse_soft=0.308366 ent_in=1.2744 ent_out=0.6115 rowmax_in=0.4850 rowmax_out=0.7851 discrete_mse=2864.764648 best_discrete=23.760267 hash=False elapsed=16.9s
step   200/900 tau=0.4602 loss=0.301854 mse_soft=0.301335 ent_in=1.1948 ent_out=0.5345 rowmax_in=0.5000 rowmax_out=0.7958 discrete_mse=580.892395 best_discrete=23.760267 hash=False elapsed=19.2s
step   225/900 tau=0.4174 loss=0.298535 mse_soft=0.298047 ent_in=1.1458 ent_out=0.4816 rowmax_in=0.5042 rowmax_out=0.8025 discrete_mse=41.342316 best_discrete=23.760267 hash=False elapsed=21.6s
step   250/900 tau=0.3786 loss=0.295495 mse_soft=0.295027 ent_in=1.1102 ent_out=0.4498 rowmax_in=0.5120 rowmax_out=0.8124 discrete_mse=273.287903 best_discrete=23.760267 hash=False elapsed=23.9s
step   275/900 tau=0.3434 loss=0.294538 mse_soft=0.294084 ent_in=1.0902 ent_out=0.4222 rowmax_in=0.5171 rowmax_out=0.8228 discrete_mse=1406.961304 best_discrete=23.760267 hash=False elapsed=26.3s
step   300/900 tau=0.3115 loss=0.291504 mse_soft=0.291061 ent_in=1.0829 ent_out=0.3915 rowmax_in=0.5174 rowmax_out=0.8322 discrete_mse=3819.579590 best_discrete=23.760267 hash=False elapsed=28.7s
step   325/900 tau=0.2826 loss=0.290065 mse_soft=0.289632 ent_in=1.0738 ent_out=0.3699 rowmax_in=0.5239 rowmax_out=0.8380 discrete_mse=3539.065430 best_discrete=23.760267 hash=False elapsed=31.1s
step   350/900 tau=0.2563 loss=0.290840 mse_soft=0.290413 ent_in=1.0687 ent_out=0.3553 rowmax_in=0.5244 rowmax_out=0.8404 discrete_mse=3539.065430 best_discrete=23.760267 hash=False elapsed=33.3s
step   375/900 tau=0.2325 loss=0.291103 mse_soft=0.290678 ent_in=1.0672 ent_out=0.3508 rowmax_in=0.5227 rowmax_out=0.8417 discrete_mse=3539.065430 best_discrete=23.760267 hash=False elapsed=35.7s
step   400/900 tau=0.2109 loss=0.292825 mse_soft=0.292402 ent_in=1.0616 ent_out=0.3467 rowmax_in=0.5220 rowmax_out=0.8438 discrete_mse=3819.579590 best_discrete=23.760267 hash=False elapsed=38.1s
step   425/900 tau=0.1913 loss=0.287416 mse_soft=0.286998 ent_in=1.0594 ent_out=0.3325 rowmax_in=0.5193 rowmax_out=0.8511 discrete_mse=3668.083984 best_discrete=23.760267 hash=False elapsed=40.4s
step   450/900 tau=0.1735 loss=0.286284 mse_soft=0.285869 ent_in=1.0553 ent_out=0.3309 rowmax_in=0.5188 rowmax_out=0.8503 discrete_mse=3668.083984 best_discrete=23.760267 hash=False elapsed=42.8s
step   475/900 tau=0.1574 loss=0.287816 mse_soft=0.287401 ent_in=1.0547 ent_out=0.3283 rowmax_in=0.5183 rowmax_out=0.8496 discrete_mse=3017.763916 best_discrete=23.760267 hash=False elapsed=45.2s
step   500/900 tau=0.1428 loss=0.290807 mse_soft=0.290394 ent_in=1.0496 ent_out=0.3282 rowmax_in=0.5202 rowmax_out=0.8446 discrete_mse=395.114105 best_discrete=23.760267 hash=False elapsed=47.7s
step   525/900 tau=0.1295 loss=0.293892 mse_soft=0.293481 ent_in=1.0438 ent_out=0.3237 rowmax_in=0.5167 rowmax_out=0.8434 discrete_mse=1074.368042 best_discrete=23.760267 hash=False elapsed=49.9s
step   550/900 tau=0.1175 loss=0.302072 mse_soft=0.301665 ent_in=1.0391 ent_out=0.3184 rowmax_in=0.5218 rowmax_out=0.8501 discrete_mse=1268.404907 best_discrete=23.760267 hash=False elapsed=52.3s
step   575/900 tau=0.1066 loss=0.286287 mse_soft=0.285882 ent_in=1.0361 ent_out=0.3147 rowmax_in=0.5205 rowmax_out=0.8499 discrete_mse=1268.404907 best_discrete=23.760267 hash=False elapsed=54.6s
step   600/900 tau=0.0967 loss=0.308775 mse_soft=0.308367 ent_in=1.0389 ent_out=0.3225 rowmax_in=0.5102 rowmax_out=0.8427 discrete_mse=1169.168213 best_discrete=23.760267 hash=False elapsed=57.1s
step   625/900 tau=0.0877 loss=0.291751 mse_soft=0.291355 ent_in=1.0107 ent_out=0.3107 rowmax_in=0.5342 rowmax_out=0.8464 discrete_mse=525.382812 best_discrete=23.760267 hash=False elapsed=59.6s
step   650/900 tau=0.0795 loss=0.312491 mse_soft=0.312133 ent_in=0.9169 ent_out=0.2779 rowmax_in=0.5766 rowmax_out=0.8580 discrete_mse=423.429291 best_discrete=23.760267 hash=False elapsed=61.9s
step   675/900 tau=0.0722 loss=0.308403 mse_soft=0.308032 ent_in=0.9379 ent_out=0.2975 rowmax_in=0.5511 rowmax_out=0.8396 discrete_mse=7.353751 best_discrete=7.353751 hash=False elapsed=64.1s
step   700/900 tau=0.0655 loss=0.350956 mse_soft=0.350604 ent_in=0.8824 ent_out=0.2915 rowmax_in=0.5723 rowmax_out=0.8468 discrete_mse=9.135138 best_discrete=7.353751 hash=False elapsed=66.5s
step   725/900 tau=0.0594 loss=0.362280 mse_soft=0.361989 ent_in=0.7084 ent_out=0.2592 rowmax_in=0.6732 rowmax_out=0.8630 discrete_mse=0.724360 best_discrete=0.724360 hash=False elapsed=68.8s
step   750/900 tau=0.0539 loss=0.338965 mse_soft=0.338699 ent_in=0.6197 ent_out=0.2651 rowmax_in=0.6914 rowmax_out=0.8653 discrete_mse=1.667417 best_discrete=0.724360 hash=False elapsed=71.2s
step   775/900 tau=0.0489 loss=0.330724 mse_soft=0.330462 ent_in=0.6085 ent_out=0.2663 rowmax_in=0.7005 rowmax_out=0.8624 discrete_mse=0.871180 best_discrete=0.724360 hash=False elapsed=73.6s
step   800/900 tau=0.0443 loss=0.347894 mse_soft=0.347640 ent_in=0.5931 ent_out=0.2528 rowmax_in=0.7066 rowmax_out=0.8707 discrete_mse=2.771596 best_discrete=0.724360 hash=False elapsed=75.7s
step   825/900 tau=0.0402 loss=0.338523 mse_soft=0.338276 ent_in=0.5847 ent_out=0.2384 rowmax_in=0.7047 rowmax_out=0.8789 discrete_mse=2.771596 best_discrete=0.724360 hash=False elapsed=78.0s
step   850/900 tau=0.0365 loss=0.757712 mse_soft=0.757599 ent_in=0.2887 ent_out=0.0880 rowmax_in=0.8566 rowmax_out=0.9417 discrete_mse=27.183825 best_discrete=0.724360 hash=False elapsed=80.2s
step   875/900 tau=0.0331 loss=0.526739 mse_soft=0.526652 ent_in=0.2270 ent_out=0.0650 rowmax_in=0.8796 rowmax_out=0.9492 discrete_mse=3.479126 best_discrete=0.724360 hash=False elapsed=82.4s
step   900/900 tau=0.0300 loss=0.513505 mse_soft=0.513407 ent_in=0.2610 ent_out=0.0649 rowmax_in=0.8654 rowmax_out=0.9493 discrete_mse=13.361739 best_discrete=0.724360 hash=False elapsed=85.0s

Final metrics:
  soft_mse_full=0.514591
  rowmax_in_mean=0.8658
  rowmax_out_mean=0.9493
  ent_in_mean=0.2602
  ent_out_mean=0.0649
  final_discrete_mse=13.361739
  hash_match=False
  best_discrete_mse_seen=0.724360
Saved results to overnight_b135_j1.json
