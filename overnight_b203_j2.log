Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.079210 mse_soft=1.076887 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=18.175611 best_discrete=18.175611 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.876598 mse_soft=0.874408 ent_in=3.6316 ent_out=3.6672 rowmax_in=0.0452 rowmax_out=0.0445 discrete_mse=433.107483 best_discrete=18.175611 hash=False elapsed=2.4s
step    50/900 tau=0.8229 loss=0.665497 mse_soft=0.663593 ent_in=3.1260 ent_out=3.2213 rowmax_in=0.0956 rowmax_out=0.0889 discrete_mse=9888.356445 best_discrete=18.175611 hash=False elapsed=4.5s
step    75/900 tau=0.7450 loss=0.529272 mse_soft=0.527688 ent_in=2.6111 ent_out=2.6682 rowmax_in=0.1985 rowmax_out=0.2070 discrete_mse=503.055542 best_discrete=18.175611 hash=False elapsed=6.6s
step   100/900 tau=0.6745 loss=0.428706 mse_soft=0.427537 ent_in=2.0358 ent_out=1.8623 rowmax_in=0.3314 rowmax_out=0.4109 discrete_mse=487.757874 best_discrete=18.175611 hash=False elapsed=8.8s
step   125/900 tau=0.6107 loss=0.350855 mse_soft=0.350062 ent_in=1.5305 ent_out=1.1102 rowmax_in=0.4567 rowmax_out=0.6561 discrete_mse=271.256256 best_discrete=18.175611 hash=False elapsed=11.0s
step   150/900 tau=0.5529 loss=0.323522 mse_soft=0.322907 ent_in=1.3243 ent_out=0.7247 rowmax_in=0.5040 rowmax_out=0.7611 discrete_mse=449.929047 best_discrete=18.175611 hash=False elapsed=13.1s
step   175/900 tau=0.5006 loss=0.309975 mse_soft=0.309431 ent_in=1.2552 ent_out=0.5588 rowmax_in=0.5086 rowmax_out=0.8143 discrete_mse=177.513641 best_discrete=18.175611 hash=False elapsed=15.2s
step   200/900 tau=0.4532 loss=0.300973 mse_soft=0.300487 ent_in=1.2131 ent_out=0.4076 rowmax_in=0.5045 rowmax_out=0.8664 discrete_mse=9.745522 best_discrete=9.745522 hash=False elapsed=17.2s
step   225/900 tau=0.4103 loss=0.294181 mse_soft=0.293730 ent_in=1.1817 ent_out=0.3212 rowmax_in=0.5004 rowmax_out=0.8864 discrete_mse=71.406059 best_discrete=9.745522 hash=False elapsed=19.4s
step   250/900 tau=0.3715 loss=0.290611 mse_soft=0.290175 ent_in=1.1669 ent_out=0.2893 rowmax_in=0.5002 rowmax_out=0.8894 discrete_mse=45.566364 best_discrete=9.745522 hash=False elapsed=21.2s
step   275/900 tau=0.3363 loss=0.287302 mse_soft=0.286877 ent_in=1.1431 ent_out=0.2740 rowmax_in=0.5032 rowmax_out=0.8928 discrete_mse=31.329681 best_discrete=9.745522 hash=False elapsed=23.1s
step   300/900 tau=0.3045 loss=0.286757 mse_soft=0.286339 ent_in=1.1309 ent_out=0.2607 rowmax_in=0.5018 rowmax_out=0.8958 discrete_mse=18.314449 best_discrete=9.745522 hash=False elapsed=25.0s
step   325/900 tau=0.2756 loss=0.285295 mse_soft=0.284884 ent_in=1.1249 ent_out=0.2466 rowmax_in=0.4990 rowmax_out=0.8977 discrete_mse=18.314449 best_discrete=9.745522 hash=False elapsed=26.8s
step   350/900 tau=0.2496 loss=0.285515 mse_soft=0.285109 ent_in=1.1191 ent_out=0.2356 rowmax_in=0.5011 rowmax_out=0.8978 discrete_mse=18.314449 best_discrete=9.745522 hash=False elapsed=28.9s
step   375/900 tau=0.2259 loss=0.283061 mse_soft=0.282658 ent_in=1.1121 ent_out=0.2302 rowmax_in=0.5054 rowmax_out=0.8983 discrete_mse=14.428609 best_discrete=9.745522 hash=False elapsed=31.2s
step   400/900 tau=0.2046 loss=0.285168 mse_soft=0.284768 ent_in=1.1083 ent_out=0.2268 rowmax_in=0.5052 rowmax_out=0.8990 discrete_mse=14.428609 best_discrete=9.745522 hash=False elapsed=33.4s
step   425/900 tau=0.1852 loss=0.282370 mse_soft=0.281971 ent_in=1.1075 ent_out=0.2230 rowmax_in=0.5060 rowmax_out=0.9000 discrete_mse=18.314449 best_discrete=9.745522 hash=False elapsed=35.7s
step   450/900 tau=0.1677 loss=0.286992 mse_soft=0.286593 ent_in=1.1079 ent_out=0.2212 rowmax_in=0.5060 rowmax_out=0.9003 discrete_mse=3.513808 best_discrete=3.513808 hash=False elapsed=37.7s
step   475/900 tau=0.1518 loss=0.290173 mse_soft=0.289775 ent_in=1.1042 ent_out=0.2204 rowmax_in=0.5086 rowmax_out=0.9007 discrete_mse=6.451132 best_discrete=3.513808 hash=False elapsed=39.7s
step   500/900 tau=0.1374 loss=0.291547 mse_soft=0.291149 ent_in=1.1048 ent_out=0.2219 rowmax_in=0.5087 rowmax_out=0.9004 discrete_mse=3.513808 best_discrete=3.513808 hash=False elapsed=41.7s
step   525/900 tau=0.1244 loss=0.289259 mse_soft=0.288861 ent_in=1.1010 ent_out=0.2252 rowmax_in=0.5098 rowmax_out=0.8985 discrete_mse=3.513808 best_discrete=3.513808 hash=False elapsed=43.6s
step   550/900 tau=0.1126 loss=0.290414 mse_soft=0.290019 ent_in=1.0876 ent_out=0.2311 rowmax_in=0.5130 rowmax_out=0.8957 discrete_mse=2.047802 best_discrete=2.047802 hash=False elapsed=45.6s
step   575/900 tau=0.1020 loss=0.297809 mse_soft=0.297410 ent_in=1.0866 ent_out=0.2424 rowmax_in=0.5151 rowmax_out=0.8864 discrete_mse=1.354293 best_discrete=1.354293 hash=False elapsed=47.8s
step   600/900 tau=0.0923 loss=0.283557 mse_soft=0.283164 ent_in=1.0679 ent_out=0.2398 rowmax_in=0.5184 rowmax_out=0.8831 discrete_mse=22.067591 best_discrete=1.354293 hash=False elapsed=49.9s
step   625/900 tau=0.0836 loss=0.288334 mse_soft=0.287946 ent_in=1.0541 ent_out=0.2375 rowmax_in=0.5195 rowmax_out=0.8821 discrete_mse=28.043655 best_discrete=1.354293 hash=False elapsed=52.0s
step   650/900 tau=0.0757 loss=0.309981 mse_soft=0.309601 ent_in=1.0372 ent_out=0.2268 rowmax_in=0.5253 rowmax_out=0.8850 discrete_mse=15.615228 best_discrete=1.354293 hash=False elapsed=54.3s
step   675/900 tau=0.0685 loss=0.297069 mse_soft=0.296694 ent_in=1.0258 ent_out=0.2217 rowmax_in=0.5328 rowmax_out=0.8847 discrete_mse=32.069466 best_discrete=1.354293 hash=False elapsed=56.5s
step   700/900 tau=0.0620 loss=0.308868 mse_soft=0.308504 ent_in=1.0052 ent_out=0.2087 rowmax_in=0.5379 rowmax_out=0.8897 discrete_mse=32.069466 best_discrete=1.354293 hash=False elapsed=58.6s
step   725/900 tau=0.0562 loss=0.323783 mse_soft=0.323466 ent_in=0.8822 ent_out=0.1758 rowmax_in=0.5923 rowmax_out=0.9024 discrete_mse=73.555313 best_discrete=1.354293 hash=False elapsed=60.9s
step   750/900 tau=0.0508 loss=0.301536 mse_soft=0.301218 ent_in=0.8782 ent_out=0.1808 rowmax_in=0.5980 rowmax_out=0.8927 discrete_mse=133.166565 best_discrete=1.354293 hash=False elapsed=62.9s
step   775/900 tau=0.0460 loss=0.302760 mse_soft=0.302453 ent_in=0.8634 ent_out=0.1590 rowmax_in=0.5998 rowmax_out=0.8988 discrete_mse=74.616547 best_discrete=1.354293 hash=False elapsed=65.0s
step   800/900 tau=0.0417 loss=0.373306 mse_soft=0.373063 ent_in=0.6563 ent_out=0.1555 rowmax_in=0.6876 rowmax_out=0.9074 discrete_mse=5.916686 best_discrete=1.354293 hash=False elapsed=67.1s
step   825/900 tau=0.0377 loss=0.422220 mse_soft=0.422053 ent_in=0.4376 ent_out=0.1174 rowmax_in=0.8031 rowmax_out=0.9389 discrete_mse=3.683908 best_discrete=1.354293 hash=False elapsed=69.0s
step   850/900 tau=0.0342 loss=0.431769 mse_soft=0.431624 ent_in=0.3720 ent_out=0.1121 rowmax_in=0.8279 rowmax_out=0.9339 discrete_mse=1.113519 best_discrete=1.113519 hash=False elapsed=71.0s
step   875/900 tau=0.0309 loss=0.405707 mse_soft=0.405563 ent_in=0.3736 ent_out=0.1041 rowmax_in=0.8176 rowmax_out=0.9367 discrete_mse=24.281242 best_discrete=1.113519 hash=False elapsed=73.2s
step   900/900 tau=0.0280 loss=0.395294 mse_soft=0.395146 ent_in=0.3885 ent_out=0.1040 rowmax_in=0.8071 rowmax_out=0.9367 discrete_mse=12.141802 best_discrete=1.113519 hash=False elapsed=75.3s

Final metrics:
  soft_mse_full=0.393156
  rowmax_in_mean=0.8104
  rowmax_out_mean=0.9369
  ent_in_mean=0.3868
  ent_out_mean=0.1038
  final_discrete_mse=12.141802
  hash_match=False
  best_discrete_mse_seen=1.113519
Saved results to overnight_b203_j2.json
