Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.078053 mse_soft=1.075730 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=29.784990 best_discrete=29.784990 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.869228 mse_soft=0.867038 ent_in=3.6325 ent_out=3.6664 rowmax_in=0.0453 rowmax_out=0.0441 discrete_mse=109.671120 best_discrete=29.784990 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.651003 mse_soft=0.649098 ent_in=3.1294 ent_out=3.2197 rowmax_in=0.0945 rowmax_out=0.0905 discrete_mse=17607.240234 best_discrete=29.784990 hash=False elapsed=4.8s
step    75/900 tau=0.7450 loss=0.516973 mse_soft=0.515376 ent_in=2.6242 ent_out=2.6993 rowmax_in=0.2015 rowmax_out=0.1950 discrete_mse=683.673157 best_discrete=29.784990 hash=False elapsed=6.9s
step   100/900 tau=0.6745 loss=0.395354 mse_soft=0.394203 ent_in=1.9688 ent_out=1.8666 rowmax_in=0.3581 rowmax_out=0.4220 discrete_mse=156.743027 best_discrete=29.784990 hash=False elapsed=9.1s
step   125/900 tau=0.6107 loss=0.332270 mse_soft=0.331447 ent_in=1.5515 ent_out=1.1932 rowmax_in=0.4331 rowmax_out=0.6191 discrete_mse=297.860382 best_discrete=29.784990 hash=False elapsed=11.5s
step   150/900 tau=0.5529 loss=0.307465 mse_soft=0.306791 ent_in=1.4140 ent_out=0.8344 rowmax_in=0.4515 rowmax_out=0.7059 discrete_mse=2285.482666 best_discrete=29.784990 hash=False elapsed=13.7s
step   175/900 tau=0.5006 loss=0.291016 mse_soft=0.290429 ent_in=1.3266 ent_out=0.6275 rowmax_in=0.4659 rowmax_out=0.7774 discrete_mse=1541.094727 best_discrete=29.784990 hash=False elapsed=15.9s
step   200/900 tau=0.4532 loss=0.282220 mse_soft=0.281683 ent_in=1.2770 ent_out=0.5143 rowmax_in=0.4751 rowmax_out=0.8043 discrete_mse=355.845276 best_discrete=29.784990 hash=False elapsed=18.1s
step   225/900 tau=0.4103 loss=0.274642 mse_soft=0.274141 ent_in=1.2193 ent_out=0.4481 rowmax_in=0.4995 rowmax_out=0.8178 discrete_mse=453.573883 best_discrete=29.784990 hash=False elapsed=20.4s
step   250/900 tau=0.3715 loss=0.270877 mse_soft=0.270399 ent_in=1.1907 ent_out=0.4030 rowmax_in=0.5084 rowmax_out=0.8355 discrete_mse=220.563339 best_discrete=29.784990 hash=False elapsed=22.7s
step   275/900 tau=0.3363 loss=0.269751 mse_soft=0.269288 ent_in=1.1688 ent_out=0.3768 rowmax_in=0.5120 rowmax_out=0.8444 discrete_mse=404.638489 best_discrete=29.784990 hash=False elapsed=24.9s
step   300/900 tau=0.3045 loss=0.267431 mse_soft=0.266976 ent_in=1.1585 ent_out=0.3565 rowmax_in=0.5142 rowmax_out=0.8522 discrete_mse=875.103577 best_discrete=29.784990 hash=False elapsed=27.2s
step   325/900 tau=0.2756 loss=0.269036 mse_soft=0.268584 ent_in=1.1525 ent_out=0.3525 rowmax_in=0.5132 rowmax_out=0.8534 discrete_mse=439.547089 best_discrete=29.784990 hash=False elapsed=29.4s
step   350/900 tau=0.2496 loss=0.266002 mse_soft=0.265557 ent_in=1.1432 ent_out=0.3394 rowmax_in=0.5152 rowmax_out=0.8609 discrete_mse=439.547089 best_discrete=29.784990 hash=False elapsed=31.7s
step   375/900 tau=0.2259 loss=0.275761 mse_soft=0.275319 ent_in=1.1325 ent_out=0.3420 rowmax_in=0.5177 rowmax_out=0.8577 discrete_mse=716.538452 best_discrete=29.784990 hash=False elapsed=34.1s
step   400/900 tau=0.2046 loss=0.267532 mse_soft=0.267092 ent_in=1.1269 ent_out=0.3419 rowmax_in=0.5158 rowmax_out=0.8585 discrete_mse=274.002045 best_discrete=29.784990 hash=False elapsed=36.6s
step   425/900 tau=0.1852 loss=0.267124 mse_soft=0.266684 ent_in=1.1252 ent_out=0.3423 rowmax_in=0.5171 rowmax_out=0.8572 discrete_mse=202.977020 best_discrete=29.784990 hash=False elapsed=39.0s
step   450/900 tau=0.1677 loss=0.264315 mse_soft=0.263873 ent_in=1.1220 ent_out=0.3512 rowmax_in=0.5183 rowmax_out=0.8524 discrete_mse=88.060272 best_discrete=29.784990 hash=False elapsed=41.1s
step   475/900 tau=0.1518 loss=0.268348 mse_soft=0.267906 ent_in=1.1226 ent_out=0.3518 rowmax_in=0.5166 rowmax_out=0.8520 discrete_mse=168.021042 best_discrete=29.784990 hash=False elapsed=43.1s
step   500/900 tau=0.1374 loss=0.267374 mse_soft=0.266933 ent_in=1.1213 ent_out=0.3490 rowmax_in=0.5170 rowmax_out=0.8512 discrete_mse=274.002045 best_discrete=29.784990 hash=False elapsed=45.2s
step   525/900 tau=0.1244 loss=0.265819 mse_soft=0.265376 ent_in=1.1209 ent_out=0.3546 rowmax_in=0.5129 rowmax_out=0.8449 discrete_mse=88.060272 best_discrete=29.784990 hash=False elapsed=47.2s
step   550/900 tau=0.1126 loss=0.289411 mse_soft=0.288973 ent_in=1.1057 ent_out=0.3548 rowmax_in=0.5174 rowmax_out=0.8431 discrete_mse=483.133179 best_discrete=29.784990 hash=False elapsed=49.3s
step   575/900 tau=0.1020 loss=0.268426 mse_soft=0.267990 ent_in=1.1043 ent_out=0.3487 rowmax_in=0.5176 rowmax_out=0.8421 discrete_mse=88.498711 best_discrete=29.784990 hash=False elapsed=51.3s
step   600/900 tau=0.0923 loss=0.270288 mse_soft=0.269850 ent_in=1.1098 ent_out=0.3492 rowmax_in=0.5139 rowmax_out=0.8402 discrete_mse=88.498711 best_discrete=29.784990 hash=False elapsed=53.3s
step   625/900 tau=0.0836 loss=0.278749 mse_soft=0.278325 ent_in=1.0780 ent_out=0.3369 rowmax_in=0.5199 rowmax_out=0.8459 discrete_mse=31.720024 best_discrete=29.784990 hash=False elapsed=55.3s
step   650/900 tau=0.0757 loss=0.279229 mse_soft=0.278824 ent_in=1.0392 ent_out=0.3117 rowmax_in=0.5269 rowmax_out=0.8532 discrete_mse=77.297783 best_discrete=29.784990 hash=False elapsed=57.4s
step   675/900 tau=0.0685 loss=0.271866 mse_soft=0.271476 ent_in=0.9954 ent_out=0.3056 rowmax_in=0.5487 rowmax_out=0.8544 discrete_mse=785.071655 best_discrete=29.784990 hash=False elapsed=59.3s
step   700/900 tau=0.0620 loss=0.283387 mse_soft=0.283001 ent_in=0.9801 ent_out=0.3071 rowmax_in=0.5482 rowmax_out=0.8488 discrete_mse=39.168106 best_discrete=29.784990 hash=False elapsed=61.3s
step   725/900 tau=0.0562 loss=0.274444 mse_soft=0.274067 ent_in=0.9584 ent_out=0.2975 rowmax_in=0.5554 rowmax_out=0.8498 discrete_mse=0.930528 best_discrete=0.930528 hash=False elapsed=63.2s
step   750/900 tau=0.0508 loss=0.350401 mse_soft=0.350125 ent_in=0.6810 ent_out=0.2384 rowmax_in=0.6815 rowmax_out=0.8819 discrete_mse=3.892890 best_discrete=0.930528 hash=False elapsed=65.1s
step   775/900 tau=0.0460 loss=0.331929 mse_soft=0.331676 ent_in=0.6937 ent_out=0.1503 rowmax_in=0.6701 rowmax_out=0.9370 discrete_mse=10.378121 best_discrete=0.930528 hash=False elapsed=67.3s
step   800/900 tau=0.0417 loss=0.321577 mse_soft=0.321308 ent_in=0.7348 ent_out=0.1622 rowmax_in=0.6393 rowmax_out=0.9231 discrete_mse=26.736799 best_discrete=0.930528 hash=False elapsed=69.4s
step   825/900 tau=0.0377 loss=0.433741 mse_soft=0.433581 ent_in=0.4147 ent_out=0.1209 rowmax_in=0.8000 rowmax_out=0.9401 discrete_mse=1.004044 best_discrete=0.930528 hash=False elapsed=71.5s
step   850/900 tau=0.0342 loss=0.383635 mse_soft=0.383435 ent_in=0.5247 ent_out=0.1396 rowmax_in=0.7289 rowmax_out=0.9250 discrete_mse=3.664173 best_discrete=0.930528 hash=False elapsed=73.8s
step   875/900 tau=0.0309 loss=0.415992 mse_soft=0.415816 ent_in=0.4429 ent_out=0.1423 rowmax_in=0.7743 rowmax_out=0.9267 discrete_mse=10.159120 best_discrete=0.930528 hash=False elapsed=75.9s
step   900/900 tau=0.0280 loss=0.384095 mse_soft=0.383903 ent_in=0.4801 ent_out=0.1605 rowmax_in=0.7476 rowmax_out=0.9063 discrete_mse=14.406150 best_discrete=0.930528 hash=False elapsed=78.1s

Final metrics:
  soft_mse_full=0.388701
  rowmax_in_mean=0.7417
  rowmax_out_mean=0.9026
  ent_in_mean=0.4853
  ent_out_mean=0.1631
  final_discrete_mse=7.566824
  hash_match=False
  best_discrete_mse_seen=0.930528
Saved results to overnight_b024_j2.json
