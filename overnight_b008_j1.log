Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.065923 mse_soft=1.063600 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=1302.557739 best_discrete=1302.557739 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.862626 mse_soft=0.860436 ent_in=3.6323 ent_out=3.6676 rowmax_in=0.0453 rowmax_out=0.0445 discrete_mse=4700.245117 best_discrete=1302.557739 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.649741 mse_soft=0.647833 ent_in=3.1329 ent_out=3.2287 rowmax_in=0.0929 rowmax_out=0.0884 discrete_mse=1906.074707 best_discrete=1302.557739 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.511662 mse_soft=0.510080 ent_in=2.6056 ent_out=2.6695 rowmax_in=0.2046 rowmax_out=0.2051 discrete_mse=1062.690918 best_discrete=1062.690918 hash=False elapsed=7.2s
step   100/900 tau=0.6797 loss=0.396707 mse_soft=0.395550 ent_in=2.0075 ent_out=1.8474 rowmax_in=0.3606 rowmax_out=0.4260 discrete_mse=28.785593 best_discrete=28.785593 hash=False elapsed=9.7s
step   125/900 tau=0.6165 loss=0.338359 mse_soft=0.337521 ent_in=1.6011 ent_out=1.1915 rowmax_in=0.4445 rowmax_out=0.6015 discrete_mse=40.618233 best_discrete=28.785593 hash=False elapsed=12.2s
step   150/900 tau=0.5592 loss=0.314622 mse_soft=0.313963 ent_in=1.3826 ent_out=0.8141 rowmax_in=0.4775 rowmax_out=0.6992 discrete_mse=66.871689 best_discrete=28.785593 hash=False elapsed=14.5s
step   175/900 tau=0.5073 loss=0.304463 mse_soft=0.303891 ent_in=1.2769 ent_out=0.6280 rowmax_in=0.4891 rowmax_out=0.7604 discrete_mse=8.905961 best_discrete=8.905961 hash=False elapsed=17.0s
step   200/900 tau=0.4602 loss=0.297671 mse_soft=0.297148 ent_in=1.2308 ent_out=0.5140 rowmax_in=0.5009 rowmax_out=0.8026 discrete_mse=14.804012 best_discrete=8.905961 hash=False elapsed=19.1s
step   225/900 tau=0.4174 loss=0.292278 mse_soft=0.291790 ent_in=1.2090 ent_out=0.4162 rowmax_in=0.5069 rowmax_out=0.8381 discrete_mse=104.470993 best_discrete=8.905961 hash=False elapsed=21.3s
step   250/900 tau=0.3786 loss=0.288471 mse_soft=0.288008 ent_in=1.1760 ent_out=0.3646 rowmax_in=0.5109 rowmax_out=0.8585 discrete_mse=104.470993 best_discrete=8.905961 hash=False elapsed=23.6s
step   275/900 tau=0.3434 loss=0.287235 mse_soft=0.286786 ent_in=1.1562 ent_out=0.3428 rowmax_in=0.5141 rowmax_out=0.8664 discrete_mse=5.458910 best_discrete=5.458910 hash=False elapsed=25.8s
step   300/900 tau=0.3115 loss=0.285857 mse_soft=0.285414 ent_in=1.1449 ent_out=0.3316 rowmax_in=0.5155 rowmax_out=0.8709 discrete_mse=2.958211 best_discrete=2.958211 hash=False elapsed=27.9s
step   325/900 tau=0.2826 loss=0.284766 mse_soft=0.284330 ent_in=1.1367 ent_out=0.3158 rowmax_in=0.5130 rowmax_out=0.8741 discrete_mse=2.958211 best_discrete=2.958211 hash=False elapsed=30.3s
step   350/900 tau=0.2563 loss=0.285542 mse_soft=0.285110 ent_in=1.1255 ent_out=0.3125 rowmax_in=0.5163 rowmax_out=0.8729 discrete_mse=2.958211 best_discrete=2.958211 hash=False elapsed=32.7s
step   375/900 tau=0.2325 loss=0.286558 mse_soft=0.286130 ent_in=1.1190 ent_out=0.3090 rowmax_in=0.5177 rowmax_out=0.8728 discrete_mse=2.958211 best_discrete=2.958211 hash=False elapsed=35.0s
step   400/900 tau=0.2109 loss=0.283321 mse_soft=0.282894 ent_in=1.1180 ent_out=0.3054 rowmax_in=0.5179 rowmax_out=0.8730 discrete_mse=2.958211 best_discrete=2.958211 hash=False elapsed=37.2s
step   425/900 tau=0.1913 loss=0.282233 mse_soft=0.281806 ent_in=1.1213 ent_out=0.3004 rowmax_in=0.5154 rowmax_out=0.8762 discrete_mse=70.758598 best_discrete=2.958211 hash=False elapsed=39.5s
step   450/900 tau=0.1735 loss=0.284682 mse_soft=0.284258 ent_in=1.1191 ent_out=0.2945 rowmax_in=0.5148 rowmax_out=0.8774 discrete_mse=100.380524 best_discrete=2.958211 hash=False elapsed=41.8s
step   475/900 tau=0.1574 loss=0.283793 mse_soft=0.283370 ent_in=1.1145 ent_out=0.2973 rowmax_in=0.5160 rowmax_out=0.8744 discrete_mse=5.800113 best_discrete=2.958211 hash=False elapsed=44.1s
step   500/900 tau=0.1428 loss=0.285174 mse_soft=0.284752 ent_in=1.1137 ent_out=0.2943 rowmax_in=0.5173 rowmax_out=0.8739 discrete_mse=15.778818 best_discrete=2.958211 hash=False elapsed=46.2s
step   525/900 tau=0.1295 loss=0.284171 mse_soft=0.283749 ent_in=1.1163 ent_out=0.2884 rowmax_in=0.5140 rowmax_out=0.8765 discrete_mse=2.418152 best_discrete=2.418152 hash=False elapsed=48.5s
step   550/900 tau=0.1175 loss=0.281450 mse_soft=0.281029 ent_in=1.1162 ent_out=0.2840 rowmax_in=0.5151 rowmax_out=0.8785 discrete_mse=9.634304 best_discrete=2.418152 hash=False elapsed=50.7s
step   575/900 tau=0.1066 loss=0.284308 mse_soft=0.283893 ent_in=1.1082 ent_out=0.2782 rowmax_in=0.5160 rowmax_out=0.8798 discrete_mse=100.380524 best_discrete=2.418152 hash=False elapsed=53.0s
step   600/900 tau=0.0967 loss=0.286854 mse_soft=0.286439 ent_in=1.1070 ent_out=0.2779 rowmax_in=0.5171 rowmax_out=0.8784 discrete_mse=9.328761 best_discrete=2.418152 hash=False elapsed=55.3s
step   625/900 tau=0.0877 loss=0.349629 mse_soft=0.349227 ent_in=1.0659 ent_out=0.2728 rowmax_in=0.5417 rowmax_out=0.8794 discrete_mse=75.004883 best_discrete=2.418152 hash=False elapsed=57.6s
step   650/900 tau=0.0795 loss=0.292216 mse_soft=0.291823 ent_in=1.0481 ent_out=0.2617 rowmax_in=0.5368 rowmax_out=0.8855 discrete_mse=23.274441 best_discrete=2.418152 hash=False elapsed=59.7s
step   675/900 tau=0.0722 loss=0.288605 mse_soft=0.288214 ent_in=1.0424 ent_out=0.2615 rowmax_in=0.5413 rowmax_out=0.8851 discrete_mse=6.863171 best_discrete=2.418152 hash=False elapsed=62.0s
step   700/900 tau=0.0655 loss=0.287952 mse_soft=0.287561 ent_in=1.0465 ent_out=0.2566 rowmax_in=0.5401 rowmax_out=0.8873 discrete_mse=10.838451 best_discrete=2.418152 hash=False elapsed=64.2s
step   725/900 tau=0.0594 loss=0.363625 mse_soft=0.363363 ent_in=0.6972 ent_out=0.1759 rowmax_in=0.6922 rowmax_out=0.9163 discrete_mse=9.258932 best_discrete=2.418152 hash=False elapsed=66.3s
step   750/900 tau=0.0539 loss=0.334476 mse_soft=0.334218 ent_in=0.6644 ent_out=0.1959 rowmax_in=0.6782 rowmax_out=0.8946 discrete_mse=27.877861 best_discrete=2.418152 hash=False elapsed=68.5s
step   775/900 tau=0.0489 loss=0.327671 mse_soft=0.327405 ent_in=0.6874 ent_out=0.1987 rowmax_in=0.6668 rowmax_out=0.8936 discrete_mse=56.712879 best_discrete=2.418152 hash=False elapsed=70.8s
step   800/900 tau=0.0443 loss=0.349795 mse_soft=0.349549 ent_in=0.6238 ent_out=0.1957 rowmax_in=0.7007 rowmax_out=0.9042 discrete_mse=28.335955 best_discrete=2.418152 hash=False elapsed=73.0s
step   825/900 tau=0.0402 loss=0.504970 mse_soft=0.504820 ent_in=0.4156 ent_out=0.0859 rowmax_in=0.7980 rowmax_out=0.9729 discrete_mse=35.664467 best_discrete=2.418152 hash=False elapsed=75.4s
step   850/900 tau=0.0365 loss=0.421666 mse_soft=0.421506 ent_in=0.4130 ent_out=0.1208 rowmax_in=0.7771 rowmax_out=0.9423 discrete_mse=35.085575 best_discrete=2.418152 hash=False elapsed=77.6s
step   875/900 tau=0.0331 loss=0.404869 mse_soft=0.404690 ent_in=0.4577 ent_out=0.1379 rowmax_in=0.7473 rowmax_out=0.9327 discrete_mse=32.638149 best_discrete=2.418152 hash=False elapsed=79.8s
step   900/900 tau=0.0300 loss=0.394212 mse_soft=0.394032 ent_in=0.4627 ent_out=0.1386 rowmax_in=0.7362 rowmax_out=0.9200 discrete_mse=34.462288 best_discrete=2.418152 hash=False elapsed=82.0s

Final metrics:
  soft_mse_full=0.402652
  rowmax_in_mean=0.7365
  rowmax_out_mean=0.9205
  ent_in_mean=0.4627
  ent_out_mean=0.1378
  final_discrete_mse=34.462288
  hash_match=False
  best_discrete_mse_seen=2.418152
Saved results to overnight_b008_j1.json
