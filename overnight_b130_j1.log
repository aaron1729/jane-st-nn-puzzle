Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.050296 mse_soft=1.047974 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=61.422848 best_discrete=61.422848 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.850544 mse_soft=0.848354 ent_in=3.6313 ent_out=3.6674 rowmax_in=0.0456 rowmax_out=0.0441 discrete_mse=427.615936 best_discrete=61.422848 hash=False elapsed=2.5s
step    50/900 tau=0.8260 loss=0.641411 mse_soft=0.639505 ent_in=3.1277 ent_out=3.2280 rowmax_in=0.0940 rowmax_out=0.0855 discrete_mse=5269.210449 best_discrete=61.422848 hash=False elapsed=4.8s
step    75/900 tau=0.7493 loss=0.507432 mse_soft=0.505846 ent_in=2.5926 ent_out=2.6936 rowmax_in=0.2038 rowmax_out=0.1939 discrete_mse=586.252869 best_discrete=61.422848 hash=False elapsed=7.1s
step   100/900 tau=0.6797 loss=0.395575 mse_soft=0.394422 ent_in=1.9711 ent_out=1.8727 rowmax_in=0.3604 rowmax_out=0.4020 discrete_mse=1191.459106 best_discrete=61.422848 hash=False elapsed=9.5s
step   125/900 tau=0.6165 loss=0.339032 mse_soft=0.338181 ent_in=1.6400 ent_out=1.1981 rowmax_in=0.4263 rowmax_out=0.6007 discrete_mse=508.517273 best_discrete=61.422848 hash=False elapsed=11.8s
step   150/900 tau=0.5592 loss=0.310784 mse_soft=0.310109 ent_in=1.4728 ent_out=0.7774 rowmax_in=0.4593 rowmax_out=0.7306 discrete_mse=412.022797 best_discrete=61.422848 hash=False elapsed=14.2s
step   175/900 tau=0.5073 loss=0.293620 mse_soft=0.293054 ent_in=1.3570 ent_out=0.5308 rowmax_in=0.4834 rowmax_out=0.8164 discrete_mse=102.295021 best_discrete=61.422848 hash=False elapsed=16.5s
step   200/900 tau=0.4602 loss=0.281801 mse_soft=0.281304 ent_in=1.2360 ent_out=0.4212 rowmax_in=0.5118 rowmax_out=0.8378 discrete_mse=526.888062 best_discrete=61.422848 hash=False elapsed=19.0s
step   225/900 tau=0.4174 loss=0.276208 mse_soft=0.275740 ent_in=1.1850 ent_out=0.3739 rowmax_in=0.5158 rowmax_out=0.8481 discrete_mse=313.874329 best_discrete=61.422848 hash=False elapsed=21.3s
step   250/900 tau=0.3786 loss=0.273093 mse_soft=0.272641 ent_in=1.1693 ent_out=0.3365 rowmax_in=0.5191 rowmax_out=0.8575 discrete_mse=142.140991 best_discrete=61.422848 hash=False elapsed=23.8s
step   275/900 tau=0.3434 loss=0.270323 mse_soft=0.269886 ent_in=1.1415 ent_out=0.3162 rowmax_in=0.5196 rowmax_out=0.8622 discrete_mse=550.083435 best_discrete=61.422848 hash=False elapsed=25.8s
step   300/900 tau=0.3115 loss=0.268539 mse_soft=0.268108 ent_in=1.1235 ent_out=0.3112 rowmax_in=0.5177 rowmax_out=0.8616 discrete_mse=550.083435 best_discrete=61.422848 hash=False elapsed=27.8s
step   325/900 tau=0.2826 loss=0.268235 mse_soft=0.267809 ent_in=1.1150 ent_out=0.3063 rowmax_in=0.5181 rowmax_out=0.8618 discrete_mse=459.132629 best_discrete=61.422848 hash=False elapsed=30.0s
step   350/900 tau=0.2563 loss=0.269198 mse_soft=0.268775 ent_in=1.1084 ent_out=0.3001 rowmax_in=0.5181 rowmax_out=0.8634 discrete_mse=550.083435 best_discrete=61.422848 hash=False elapsed=32.2s
step   375/900 tau=0.2325 loss=0.268651 mse_soft=0.268230 ent_in=1.1033 ent_out=0.3000 rowmax_in=0.5185 rowmax_out=0.8623 discrete_mse=550.083435 best_discrete=61.422848 hash=False elapsed=34.4s
step   400/900 tau=0.2109 loss=0.268117 mse_soft=0.267698 ent_in=1.0996 ent_out=0.2994 rowmax_in=0.5189 rowmax_out=0.8617 discrete_mse=550.083435 best_discrete=61.422848 hash=False elapsed=36.6s
step   425/900 tau=0.1913 loss=0.268818 mse_soft=0.268400 ent_in=1.0956 ent_out=0.2979 rowmax_in=0.5190 rowmax_out=0.8619 discrete_mse=550.083435 best_discrete=61.422848 hash=False elapsed=38.9s
step   450/900 tau=0.1735 loss=0.271982 mse_soft=0.271565 ent_in=1.0937 ent_out=0.2970 rowmax_in=0.5180 rowmax_out=0.8617 discrete_mse=550.083435 best_discrete=61.422848 hash=False elapsed=41.0s
step   475/900 tau=0.1574 loss=0.270446 mse_soft=0.270029 ent_in=1.0923 ent_out=0.2976 rowmax_in=0.5179 rowmax_out=0.8614 discrete_mse=550.083435 best_discrete=61.422848 hash=False elapsed=43.0s
step   500/900 tau=0.1428 loss=0.268091 mse_soft=0.267676 ent_in=1.0897 ent_out=0.2963 rowmax_in=0.5182 rowmax_out=0.8616 discrete_mse=550.083435 best_discrete=61.422848 hash=False elapsed=45.0s
step   525/900 tau=0.1295 loss=0.277481 mse_soft=0.277066 ent_in=1.0877 ent_out=0.2946 rowmax_in=0.5202 rowmax_out=0.8619 discrete_mse=756.189758 best_discrete=61.422848 hash=False elapsed=47.1s
step   550/900 tau=0.1175 loss=0.270313 mse_soft=0.269905 ent_in=1.0629 ent_out=0.2980 rowmax_in=0.5269 rowmax_out=0.8558 discrete_mse=756.189758 best_discrete=61.422848 hash=False elapsed=49.1s
step   575/900 tau=0.1066 loss=0.271290 mse_soft=0.270881 ent_in=1.0726 ent_out=0.2907 rowmax_in=0.5256 rowmax_out=0.8589 discrete_mse=1135.733643 best_discrete=61.422848 hash=False elapsed=51.0s
step   600/900 tau=0.0967 loss=0.271343 mse_soft=0.270936 ent_in=1.0709 ent_out=0.2870 rowmax_in=0.5225 rowmax_out=0.8600 discrete_mse=123.920258 best_discrete=61.422848 hash=False elapsed=53.0s
step   625/900 tau=0.0877 loss=0.270930 mse_soft=0.270522 ent_in=1.0790 ent_out=0.2802 rowmax_in=0.5193 rowmax_out=0.8643 discrete_mse=425.186798 best_discrete=61.422848 hash=False elapsed=55.0s
step   650/900 tau=0.0795 loss=0.497684 mse_soft=0.497299 ent_in=1.0289 ent_out=0.2554 rowmax_in=0.5352 rowmax_out=0.8765 discrete_mse=635.180664 best_discrete=61.422848 hash=False elapsed=56.9s
step   675/900 tau=0.0722 loss=0.351152 mse_soft=0.350855 ent_in=0.6895 ent_out=0.3021 rowmax_in=0.6621 rowmax_out=0.8372 discrete_mse=24.686424 best_discrete=24.686424 hash=False elapsed=58.9s
step   700/900 tau=0.0655 loss=0.392953 mse_soft=0.392651 ent_in=0.7160 ent_out=0.2893 rowmax_in=0.6466 rowmax_out=0.8439 discrete_mse=91.474937 best_discrete=24.686424 hash=False elapsed=61.1s
step   725/900 tau=0.0594 loss=0.339602 mse_soft=0.339322 ent_in=0.6723 ent_out=0.2598 rowmax_in=0.6629 rowmax_out=0.8596 discrete_mse=161.639053 best_discrete=24.686424 hash=False elapsed=63.1s
step   750/900 tau=0.0539 loss=0.328079 mse_soft=0.327798 ent_in=0.6823 ent_out=0.2531 rowmax_in=0.6502 rowmax_out=0.8631 discrete_mse=19.450836 best_discrete=19.450836 hash=False elapsed=65.1s
step   775/900 tau=0.0489 loss=0.332623 mse_soft=0.332340 ent_in=0.7020 ent_out=0.2413 rowmax_in=0.6416 rowmax_out=0.8663 discrete_mse=32.390987 best_discrete=19.450836 hash=False elapsed=67.5s
step   800/900 tau=0.0443 loss=0.323444 mse_soft=0.323161 ent_in=0.7046 ent_out=0.2406 rowmax_in=0.6400 rowmax_out=0.8706 discrete_mse=44.665741 best_discrete=19.450836 hash=False elapsed=69.7s
step   825/900 tau=0.0402 loss=0.385952 mse_soft=0.385699 ent_in=0.6103 ent_out=0.2331 rowmax_in=0.7159 rowmax_out=0.8749 discrete_mse=41.573532 best_discrete=19.450836 hash=False elapsed=71.8s
step   850/900 tau=0.0365 loss=0.486964 mse_soft=0.486819 ent_in=0.2785 ent_out=0.2078 rowmax_in=0.8454 rowmax_out=0.8706 discrete_mse=166.744720 best_discrete=19.450836 hash=False elapsed=73.9s
step   875/900 tau=0.0331 loss=0.475560 mse_soft=0.475412 ent_in=0.2848 ent_out=0.2089 rowmax_in=0.8428 rowmax_out=0.8726 discrete_mse=4.377373 best_discrete=4.377373 hash=False elapsed=75.9s
step   900/900 tau=0.0300 loss=0.530490 mse_soft=0.530360 ent_in=0.2637 ent_out=0.1699 rowmax_in=0.8682 rowmax_out=0.8968 discrete_mse=8.329414 best_discrete=4.377373 hash=False elapsed=78.2s

Final metrics:
  soft_mse_full=0.547260
  rowmax_in_mean=0.8636
  rowmax_out_mean=0.8952
  ent_in_mean=0.2712
  ent_out_mean=0.1726
  final_discrete_mse=8.329414
  hash_match=False
  best_discrete_mse_seen=4.377373
Saved results to overnight_b130_j1.json
