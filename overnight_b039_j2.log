Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.057591 mse_soft=1.055269 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=456.646484 best_discrete=456.646484 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.853442 mse_soft=0.851253 ent_in=3.6298 ent_out=3.6665 rowmax_in=0.0458 rowmax_out=0.0441 discrete_mse=1367.095337 best_discrete=456.646484 hash=False elapsed=2.5s
step    50/900 tau=0.8229 loss=0.649588 mse_soft=0.647678 ent_in=3.1315 ent_out=3.2329 rowmax_in=0.0924 rowmax_out=0.0868 discrete_mse=7619.706055 best_discrete=456.646484 hash=False elapsed=4.8s
step    75/900 tau=0.7450 loss=0.513388 mse_soft=0.511806 ent_in=2.5957 ent_out=2.6782 rowmax_in=0.2080 rowmax_out=0.2031 discrete_mse=4564.214844 best_discrete=456.646484 hash=False elapsed=7.2s
step   100/900 tau=0.6745 loss=0.403438 mse_soft=0.402280 ent_in=1.9614 ent_out=1.8965 rowmax_in=0.3744 rowmax_out=0.4004 discrete_mse=316.171204 best_discrete=316.171204 hash=False elapsed=9.4s
step   125/900 tau=0.6107 loss=0.348097 mse_soft=0.347255 ent_in=1.5588 ent_out=1.2487 rowmax_in=0.4597 rowmax_out=0.5835 discrete_mse=112.427673 best_discrete=112.427673 hash=False elapsed=11.6s
step   150/900 tau=0.5529 loss=0.322832 mse_soft=0.322155 ent_in=1.3738 ent_out=0.8830 rowmax_in=0.4912 rowmax_out=0.6727 discrete_mse=226.266037 best_discrete=112.427673 hash=False elapsed=13.8s
step   175/900 tau=0.5006 loss=0.312251 mse_soft=0.311668 ent_in=1.2666 ent_out=0.6764 rowmax_in=0.5081 rowmax_out=0.7212 discrete_mse=36.576492 best_discrete=36.576492 hash=False elapsed=16.0s
step   200/900 tau=0.4532 loss=0.305506 mse_soft=0.304974 ent_in=1.2149 ent_out=0.5585 rowmax_in=0.5148 rowmax_out=0.7497 discrete_mse=154.394241 best_discrete=36.576492 hash=False elapsed=18.1s
step   225/900 tau=0.4103 loss=0.302122 mse_soft=0.301616 ent_in=1.1895 ent_out=0.4963 rowmax_in=0.5162 rowmax_out=0.7746 discrete_mse=171.844269 best_discrete=36.576492 hash=False elapsed=20.4s
step   250/900 tau=0.3715 loss=0.299915 mse_soft=0.299430 ent_in=1.1712 ent_out=0.4452 rowmax_in=0.5168 rowmax_out=0.7977 discrete_mse=57.872272 best_discrete=36.576492 hash=False elapsed=22.5s
step   275/900 tau=0.3363 loss=0.297566 mse_soft=0.297091 ent_in=1.1581 ent_out=0.4236 rowmax_in=0.5185 rowmax_out=0.8044 discrete_mse=54.042210 best_discrete=36.576492 hash=False elapsed=24.8s
step   300/900 tau=0.3045 loss=0.296426 mse_soft=0.295956 ent_in=1.1436 ent_out=0.4233 rowmax_in=0.5195 rowmax_out=0.8034 discrete_mse=60.112549 best_discrete=36.576492 hash=False elapsed=27.1s
step   325/900 tau=0.2756 loss=0.296198 mse_soft=0.295732 ent_in=1.1316 ent_out=0.4195 rowmax_in=0.5222 rowmax_out=0.8038 discrete_mse=86.784538 best_discrete=36.576492 hash=False elapsed=29.2s
step   350/900 tau=0.2496 loss=0.293731 mse_soft=0.293273 ent_in=1.1201 ent_out=0.4055 rowmax_in=0.5166 rowmax_out=0.8073 discrete_mse=63.775848 best_discrete=36.576492 hash=False elapsed=31.4s
step   375/900 tau=0.2259 loss=0.292539 mse_soft=0.292091 ent_in=1.1114 ent_out=0.3817 rowmax_in=0.5175 rowmax_out=0.8211 discrete_mse=92.401596 best_discrete=36.576492 hash=False elapsed=33.6s
step   400/900 tau=0.2046 loss=0.291542 mse_soft=0.291102 ent_in=1.0991 ent_out=0.3663 rowmax_in=0.5177 rowmax_out=0.8255 discrete_mse=398.156921 best_discrete=36.576492 hash=False elapsed=36.0s
step   425/900 tau=0.1852 loss=0.291352 mse_soft=0.290916 ent_in=1.0921 ent_out=0.3593 rowmax_in=0.5167 rowmax_out=0.8271 discrete_mse=398.156921 best_discrete=36.576492 hash=False elapsed=38.2s
step   450/900 tau=0.1677 loss=0.295216 mse_soft=0.294786 ent_in=1.0807 ent_out=0.3528 rowmax_in=0.5184 rowmax_out=0.8276 discrete_mse=405.516144 best_discrete=36.576492 hash=False elapsed=40.4s
step   475/900 tau=0.1518 loss=0.290716 mse_soft=0.290291 ent_in=1.0750 ent_out=0.3427 rowmax_in=0.5155 rowmax_out=0.8298 discrete_mse=247.373718 best_discrete=36.576492 hash=False elapsed=42.8s
step   500/900 tau=0.1374 loss=0.290276 mse_soft=0.289856 ent_in=1.0619 ent_out=0.3382 rowmax_in=0.5180 rowmax_out=0.8327 discrete_mse=183.886322 best_discrete=36.576492 hash=False elapsed=45.1s
step   525/900 tau=0.1244 loss=0.293444 mse_soft=0.293028 ent_in=1.0506 ent_out=0.3339 rowmax_in=0.5220 rowmax_out=0.8355 discrete_mse=271.924530 best_discrete=36.576492 hash=False elapsed=47.4s
step   550/900 tau=0.1126 loss=0.290847 mse_soft=0.290438 ent_in=1.0386 ent_out=0.3239 rowmax_in=0.5276 rowmax_out=0.8367 discrete_mse=207.270813 best_discrete=36.576492 hash=False elapsed=49.7s
step   575/900 tau=0.1020 loss=0.288645 mse_soft=0.288237 ent_in=1.0336 ent_out=0.3244 rowmax_in=0.5302 rowmax_out=0.8337 discrete_mse=114.231476 best_discrete=36.576492 hash=False elapsed=52.0s
step   600/900 tau=0.0923 loss=0.290482 mse_soft=0.290076 ent_in=1.0292 ent_out=0.3229 rowmax_in=0.5288 rowmax_out=0.8314 discrete_mse=125.904396 best_discrete=36.576492 hash=False elapsed=54.0s
step   625/900 tau=0.0836 loss=0.295866 mse_soft=0.295464 ent_in=1.0177 ent_out=0.3242 rowmax_in=0.5348 rowmax_out=0.8301 discrete_mse=168.630890 best_discrete=36.576492 hash=False elapsed=56.2s
step   650/900 tau=0.0757 loss=0.298436 mse_soft=0.298042 ent_in=0.9915 ent_out=0.3240 rowmax_in=0.5451 rowmax_out=0.8304 discrete_mse=93.951035 best_discrete=36.576492 hash=False elapsed=58.2s
step   675/900 tau=0.0685 loss=0.290160 mse_soft=0.289768 ent_in=0.9881 ent_out=0.3201 rowmax_in=0.5381 rowmax_out=0.8357 discrete_mse=67.253929 best_discrete=36.576492 hash=False elapsed=60.1s
step   700/900 tau=0.0620 loss=0.290965 mse_soft=0.290576 ent_in=0.9675 ent_out=0.3310 rowmax_in=0.5492 rowmax_out=0.8279 discrete_mse=138.508789 best_discrete=36.576492 hash=False elapsed=62.4s
step   725/900 tau=0.0562 loss=0.330536 mse_soft=0.330163 ent_in=0.9225 ent_out=0.3203 rowmax_in=0.5655 rowmax_out=0.8432 discrete_mse=55.278259 best_discrete=36.576492 hash=False elapsed=64.5s
step   750/900 tau=0.0508 loss=0.356958 mse_soft=0.356677 ent_in=0.6906 ent_out=0.2463 rowmax_in=0.6713 rowmax_out=0.8709 discrete_mse=18.180908 best_discrete=18.180908 hash=False elapsed=66.5s
step   775/900 tau=0.0460 loss=0.339609 mse_soft=0.339323 ent_in=0.7051 ent_out=0.2478 rowmax_in=0.6581 rowmax_out=0.8689 discrete_mse=159.225067 best_discrete=18.180908 hash=False elapsed=68.5s
step   800/900 tau=0.0417 loss=0.338239 mse_soft=0.337951 ent_in=0.6931 ent_out=0.2666 rowmax_in=0.6592 rowmax_out=0.8638 discrete_mse=2.099420 best_discrete=2.099420 hash=False elapsed=70.7s
step   825/900 tau=0.0377 loss=0.324577 mse_soft=0.324295 ent_in=0.6726 ent_out=0.2662 rowmax_in=0.6699 rowmax_out=0.8597 discrete_mse=9.272336 best_discrete=2.099420 hash=False elapsed=72.9s
step   850/900 tau=0.0342 loss=0.326704 mse_soft=0.326417 ent_in=0.6647 ent_out=0.2911 rowmax_in=0.6543 rowmax_out=0.8461 discrete_mse=2.099420 best_discrete=2.099420 hash=False elapsed=75.2s
step   875/900 tau=0.0309 loss=0.414138 mse_soft=0.413864 ent_in=0.6320 ent_out=0.2792 rowmax_in=0.6791 rowmax_out=0.8555 discrete_mse=3.395952 best_discrete=2.099420 hash=False elapsed=77.5s
step   900/900 tau=0.0280 loss=0.490857 mse_soft=0.490729 ent_in=0.2480 ent_out=0.1791 rowmax_in=0.8639 rowmax_out=0.8937 discrete_mse=41.023682 best_discrete=2.099420 hash=False elapsed=79.7s

Final metrics:
  soft_mse_full=0.495928
  rowmax_in_mean=0.8690
  rowmax_out_mean=0.8938
  ent_in_mean=0.2440
  ent_out_mean=0.1789
  final_discrete_mse=19.287777
  hash_match=False
  best_discrete_mse_seen=2.099420
Saved results to overnight_b039_j2.json
