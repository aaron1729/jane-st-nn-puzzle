Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.080254 mse_soft=1.077931 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=11.808423 best_discrete=11.808423 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.870273 mse_soft=0.868083 ent_in=3.6335 ent_out=3.6668 rowmax_in=0.0452 rowmax_out=0.0439 discrete_mse=1237.761108 best_discrete=11.808423 hash=False elapsed=2.4s
step    50/900 tau=0.8260 loss=0.651235 mse_soft=0.649323 ent_in=3.1363 ent_out=3.2352 rowmax_in=0.0934 rowmax_out=0.0856 discrete_mse=3229.557617 best_discrete=11.808423 hash=False elapsed=4.4s
step    75/900 tau=0.7493 loss=0.513648 mse_soft=0.512051 ent_in=2.6306 ent_out=2.6917 rowmax_in=0.1978 rowmax_out=0.1961 discrete_mse=2245.127441 best_discrete=11.808423 hash=False elapsed=6.5s
step   100/900 tau=0.6797 loss=0.410246 mse_soft=0.409044 ent_in=2.0738 ent_out=1.9349 rowmax_in=0.3147 rowmax_out=0.3846 discrete_mse=1339.483398 best_discrete=11.808423 hash=False elapsed=8.6s
step   125/900 tau=0.6165 loss=0.348362 mse_soft=0.347453 ent_in=1.6457 ent_out=1.3829 rowmax_in=0.4294 rowmax_out=0.5328 discrete_mse=314.222900 best_discrete=11.808423 hash=False elapsed=10.7s
step   150/900 tau=0.5592 loss=0.320106 mse_soft=0.319344 ent_in=1.4872 ent_out=1.0536 rowmax_in=0.4632 rowmax_out=0.6249 discrete_mse=217.168198 best_discrete=11.808423 hash=False elapsed=12.8s
step   175/900 tau=0.5073 loss=0.300295 mse_soft=0.299643 ent_in=1.3468 ent_out=0.8250 rowmax_in=0.4876 rowmax_out=0.6914 discrete_mse=460.281189 best_discrete=11.808423 hash=False elapsed=15.1s
step   200/900 tau=0.4602 loss=0.288948 mse_soft=0.288372 ent_in=1.2569 ent_out=0.6612 rowmax_in=0.5017 rowmax_out=0.7466 discrete_mse=698.149475 best_discrete=11.808423 hash=False elapsed=17.5s
step   225/900 tau=0.4174 loss=0.283946 mse_soft=0.283406 ent_in=1.2301 ent_out=0.5681 rowmax_in=0.4986 rowmax_out=0.7750 discrete_mse=2486.744629 best_discrete=11.808423 hash=False elapsed=19.9s
step   250/900 tau=0.3786 loss=0.279811 mse_soft=0.279298 ent_in=1.2031 ent_out=0.5090 rowmax_in=0.4998 rowmax_out=0.7884 discrete_mse=770.265686 best_discrete=11.808423 hash=False elapsed=22.1s
step   275/900 tau=0.3434 loss=0.277138 mse_soft=0.276640 ent_in=1.1853 ent_out=0.4751 rowmax_in=0.4988 rowmax_out=0.7939 discrete_mse=762.942261 best_discrete=11.808423 hash=False elapsed=24.3s
step   300/900 tau=0.3115 loss=0.274618 mse_soft=0.274132 ent_in=1.1693 ent_out=0.4488 rowmax_in=0.4984 rowmax_out=0.8017 discrete_mse=217.481552 best_discrete=11.808423 hash=False elapsed=26.5s
step   325/900 tau=0.2826 loss=0.274157 mse_soft=0.273677 ent_in=1.1619 ent_out=0.4405 rowmax_in=0.4983 rowmax_out=0.7993 discrete_mse=2146.806396 best_discrete=11.808423 hash=False elapsed=28.5s
step   350/900 tau=0.2563 loss=0.275332 mse_soft=0.274858 ent_in=1.1497 ent_out=0.4313 rowmax_in=0.5002 rowmax_out=0.7985 discrete_mse=2646.365234 best_discrete=11.808423 hash=False elapsed=30.7s
step   375/900 tau=0.2325 loss=0.274950 mse_soft=0.274483 ent_in=1.1392 ent_out=0.4190 rowmax_in=0.5023 rowmax_out=0.7993 discrete_mse=2646.365234 best_discrete=11.808423 hash=False elapsed=32.9s
step   400/900 tau=0.2109 loss=0.274647 mse_soft=0.274183 ent_in=1.1366 ent_out=0.4102 rowmax_in=0.5015 rowmax_out=0.8012 discrete_mse=4004.159424 best_discrete=11.808423 hash=False elapsed=35.0s
step   425/900 tau=0.1913 loss=0.270553 mse_soft=0.270092 ent_in=1.1354 ent_out=0.4026 rowmax_in=0.5025 rowmax_out=0.7997 discrete_mse=1818.147949 best_discrete=11.808423 hash=False elapsed=37.1s
step   450/900 tau=0.1735 loss=0.274853 mse_soft=0.274393 ent_in=1.1332 ent_out=0.3999 rowmax_in=0.5006 rowmax_out=0.7998 discrete_mse=734.220520 best_discrete=11.808423 hash=False elapsed=39.2s
step   475/900 tau=0.1574 loss=0.274383 mse_soft=0.273927 ent_in=1.1276 ent_out=0.3940 rowmax_in=0.5041 rowmax_out=0.8041 discrete_mse=734.220520 best_discrete=11.808423 hash=False elapsed=41.4s
step   500/900 tau=0.1428 loss=0.271537 mse_soft=0.271081 ent_in=1.1299 ent_out=0.3909 rowmax_in=0.5009 rowmax_out=0.8079 discrete_mse=317.058411 best_discrete=11.808423 hash=False elapsed=43.8s
step   525/900 tau=0.1295 loss=0.269296 mse_soft=0.268841 ent_in=1.1263 ent_out=0.3899 rowmax_in=0.5036 rowmax_out=0.8099 discrete_mse=637.289856 best_discrete=11.808423 hash=False elapsed=46.0s
step   550/900 tau=0.1175 loss=0.282298 mse_soft=0.281842 ent_in=1.1262 ent_out=0.3912 rowmax_in=0.5040 rowmax_out=0.8095 discrete_mse=644.483398 best_discrete=11.808423 hash=False elapsed=48.2s
step   575/900 tau=0.1066 loss=0.275491 mse_soft=0.275037 ent_in=1.1169 ent_out=0.3940 rowmax_in=0.5066 rowmax_out=0.8065 discrete_mse=818.592590 best_discrete=11.808423 hash=False elapsed=50.3s
step   600/900 tau=0.0967 loss=0.281669 mse_soft=0.281218 ent_in=1.1088 ent_out=0.3972 rowmax_in=0.5061 rowmax_out=0.8003 discrete_mse=675.210449 best_discrete=11.808423 hash=False elapsed=52.4s
step   625/900 tau=0.0877 loss=0.279090 mse_soft=0.278643 ent_in=1.1008 ent_out=0.3897 rowmax_in=0.5086 rowmax_out=0.8076 discrete_mse=2109.610596 best_discrete=11.808423 hash=False elapsed=54.6s
step   650/900 tau=0.0795 loss=0.272074 mse_soft=0.271630 ent_in=1.0998 ent_out=0.3802 rowmax_in=0.5111 rowmax_out=0.8079 discrete_mse=761.253052 best_discrete=11.808423 hash=False elapsed=57.0s
step   675/900 tau=0.0722 loss=0.329109 mse_soft=0.328676 ent_in=1.0771 ent_out=0.3663 rowmax_in=0.5220 rowmax_out=0.8125 discrete_mse=45.452473 best_discrete=11.808423 hash=False elapsed=59.1s
step   700/900 tau=0.0655 loss=0.294180 mse_soft=0.293775 ent_in=1.0143 ent_out=0.3374 rowmax_in=0.5427 rowmax_out=0.8329 discrete_mse=18.710060 best_discrete=11.808423 hash=False elapsed=61.2s
step   725/900 tau=0.0594 loss=0.318527 mse_soft=0.318153 ent_in=0.9090 ent_out=0.3351 rowmax_in=0.6013 rowmax_out=0.8298 discrete_mse=40.764530 best_discrete=11.808423 hash=False elapsed=63.4s
step   750/900 tau=0.0539 loss=0.297109 mse_soft=0.296753 ent_in=0.8771 ent_out=0.3099 rowmax_in=0.6074 rowmax_out=0.8332 discrete_mse=8.072102 best_discrete=8.072102 hash=False elapsed=65.6s
step   775/900 tau=0.0489 loss=0.388331 mse_soft=0.388008 ent_in=0.7675 ent_out=0.3082 rowmax_in=0.6469 rowmax_out=0.8301 discrete_mse=225.829865 best_discrete=8.072102 hash=False elapsed=67.8s
step   800/900 tau=0.0443 loss=0.382412 mse_soft=0.382156 ent_in=0.6414 ent_out=0.2119 rowmax_in=0.6737 rowmax_out=0.8907 discrete_mse=12.339052 best_discrete=8.072102 hash=False elapsed=70.1s
step   825/900 tau=0.0402 loss=0.356920 mse_soft=0.356667 ent_in=0.6242 ent_out=0.2177 rowmax_in=0.6948 rowmax_out=0.8892 discrete_mse=26.604010 best_discrete=8.072102 hash=False elapsed=72.3s
step   850/900 tau=0.0365 loss=0.403991 mse_soft=0.403750 ent_in=0.5822 ent_out=0.2202 rowmax_in=0.7137 rowmax_out=0.8848 discrete_mse=22.183874 best_discrete=8.072102 hash=False elapsed=74.5s
step   875/900 tau=0.0331 loss=0.376766 mse_soft=0.376531 ent_in=0.5682 ent_out=0.2166 rowmax_in=0.7170 rowmax_out=0.8815 discrete_mse=28.927217 best_discrete=8.072102 hash=False elapsed=76.6s
step   900/900 tau=0.0300 loss=0.388406 mse_soft=0.388167 ent_in=0.5834 ent_out=0.2105 rowmax_in=0.6974 rowmax_out=0.8864 discrete_mse=23.846458 best_discrete=8.072102 hash=False elapsed=79.0s

Final metrics:
  soft_mse_full=0.440261
  rowmax_in_mean=0.6942
  rowmax_out_mean=0.8843
  ent_in_mean=0.5856
  ent_out_mean=0.2124
  final_discrete_mse=1.016940
  hash_match=False
  best_discrete_mse_seen=8.072102
Saved results to overnight_b186_j1.json
