Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.062284 mse_soft=1.059961 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=15.024863 best_discrete=15.024863 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.861025 mse_soft=0.858835 ent_in=3.6331 ent_out=3.6680 rowmax_in=0.0454 rowmax_out=0.0446 discrete_mse=63.178650 best_discrete=15.024863 hash=False elapsed=2.5s
step    50/900 tau=0.8229 loss=0.653484 mse_soft=0.651572 ent_in=3.1379 ent_out=3.2325 rowmax_in=0.0937 rowmax_out=0.0895 discrete_mse=5126.499023 best_discrete=15.024863 hash=False elapsed=4.7s
step    75/900 tau=0.7450 loss=0.513949 mse_soft=0.512368 ent_in=2.5978 ent_out=2.6738 rowmax_in=0.2174 rowmax_out=0.2076 discrete_mse=574.315918 best_discrete=15.024863 hash=False elapsed=6.9s
step   100/900 tau=0.6745 loss=0.410481 mse_soft=0.409324 ent_in=1.9849 ent_out=1.8712 rowmax_in=0.3579 rowmax_out=0.4096 discrete_mse=258.216309 best_discrete=15.024863 hash=False elapsed=9.2s
step   125/900 tau=0.6107 loss=0.353531 mse_soft=0.352686 ent_in=1.5597 ent_out=1.2595 rowmax_in=0.4631 rowmax_out=0.5673 discrete_mse=10.838540 best_discrete=10.838540 hash=False elapsed=11.5s
step   150/900 tau=0.5529 loss=0.326275 mse_soft=0.325599 ent_in=1.3723 ent_out=0.8812 rowmax_in=0.5032 rowmax_out=0.6756 discrete_mse=169.082886 best_discrete=10.838540 hash=False elapsed=13.8s
step   175/900 tau=0.5006 loss=0.310611 mse_soft=0.310017 ent_in=1.2656 ent_out=0.7134 rowmax_in=0.5152 rowmax_out=0.7269 discrete_mse=203.212738 best_discrete=10.838540 hash=False elapsed=16.1s
step   200/900 tau=0.4532 loss=0.303188 mse_soft=0.302655 ent_in=1.1958 ent_out=0.5801 rowmax_in=0.5232 rowmax_out=0.7577 discrete_mse=349.727570 best_discrete=10.838540 hash=False elapsed=18.3s
step   225/900 tau=0.4103 loss=0.299191 mse_soft=0.298687 ent_in=1.1518 ent_out=0.5265 rowmax_in=0.5335 rowmax_out=0.7699 discrete_mse=349.727570 best_discrete=10.838540 hash=False elapsed=20.6s
step   250/900 tau=0.3715 loss=0.298340 mse_soft=0.297855 ent_in=1.1229 ent_out=0.4932 rowmax_in=0.5413 rowmax_out=0.7801 discrete_mse=311.894501 best_discrete=10.838540 hash=False elapsed=22.9s
step   275/900 tau=0.3363 loss=0.292218 mse_soft=0.291745 ent_in=1.0991 ent_out=0.4757 rowmax_in=0.5469 rowmax_out=0.7791 discrete_mse=152.181519 best_discrete=10.838540 hash=False elapsed=25.2s
step   300/900 tau=0.3045 loss=0.289932 mse_soft=0.289470 ent_in=1.0787 ent_out=0.4641 rowmax_in=0.5526 rowmax_out=0.7864 discrete_mse=106.726944 best_discrete=10.838540 hash=False elapsed=27.4s
step   325/900 tau=0.2756 loss=0.290007 mse_soft=0.289555 ent_in=1.0666 ent_out=0.4385 rowmax_in=0.5551 rowmax_out=0.7962 discrete_mse=84.129021 best_discrete=10.838540 hash=False elapsed=29.8s
step   350/900 tau=0.2496 loss=0.286162 mse_soft=0.285718 ent_in=1.0581 ent_out=0.4235 rowmax_in=0.5567 rowmax_out=0.8012 discrete_mse=100.550369 best_discrete=10.838540 hash=False elapsed=31.9s
step   375/900 tau=0.2259 loss=0.289831 mse_soft=0.289388 ent_in=1.0579 ent_out=0.4174 rowmax_in=0.5560 rowmax_out=0.7999 discrete_mse=84.129021 best_discrete=10.838540 hash=False elapsed=34.1s
step   400/900 tau=0.2046 loss=0.284676 mse_soft=0.284236 ent_in=1.0545 ent_out=0.4124 rowmax_in=0.5567 rowmax_out=0.7994 discrete_mse=84.129021 best_discrete=10.838540 hash=False elapsed=36.4s
step   425/900 tau=0.1852 loss=0.283618 mse_soft=0.283181 ent_in=1.0486 ent_out=0.4080 rowmax_in=0.5592 rowmax_out=0.8002 discrete_mse=84.129021 best_discrete=10.838540 hash=False elapsed=38.7s
step   450/900 tau=0.1677 loss=0.291271 mse_soft=0.290837 ent_in=1.0432 ent_out=0.4029 rowmax_in=0.5615 rowmax_out=0.8055 discrete_mse=76.161232 best_discrete=10.838540 hash=False elapsed=41.0s
step   475/900 tau=0.1518 loss=0.284366 mse_soft=0.283933 ent_in=1.0418 ent_out=0.4003 rowmax_in=0.5606 rowmax_out=0.8059 discrete_mse=110.655212 best_discrete=10.838540 hash=False elapsed=43.4s
step   500/900 tau=0.1374 loss=0.293813 mse_soft=0.293379 ent_in=1.0435 ent_out=0.4007 rowmax_in=0.5604 rowmax_out=0.8035 discrete_mse=126.945999 best_discrete=10.838540 hash=False elapsed=45.6s
step   525/900 tau=0.1244 loss=0.305171 mse_soft=0.304741 ent_in=1.0330 ent_out=0.3991 rowmax_in=0.5645 rowmax_out=0.8084 discrete_mse=76.161232 best_discrete=10.838540 hash=False elapsed=47.8s
step   550/900 tau=0.1126 loss=0.291598 mse_soft=0.291171 ent_in=1.0252 ent_out=0.3986 rowmax_in=0.5681 rowmax_out=0.8086 discrete_mse=126.945999 best_discrete=10.838540 hash=False elapsed=50.2s
step   575/900 tau=0.1020 loss=0.300215 mse_soft=0.299786 ent_in=1.0296 ent_out=0.3994 rowmax_in=0.5660 rowmax_out=0.8050 discrete_mse=126.945999 best_discrete=10.838540 hash=False elapsed=52.4s
step   600/900 tau=0.0923 loss=0.296688 mse_soft=0.296268 ent_in=1.0057 ent_out=0.3927 rowmax_in=0.5788 rowmax_out=0.8146 discrete_mse=120.090469 best_discrete=10.838540 hash=False elapsed=54.7s
step   625/900 tau=0.0836 loss=0.312038 mse_soft=0.311625 ent_in=0.9911 ent_out=0.3868 rowmax_in=0.5853 rowmax_out=0.8109 discrete_mse=120.090469 best_discrete=10.838540 hash=False elapsed=57.1s
step   650/900 tau=0.0757 loss=0.287315 mse_soft=0.286901 ent_in=0.9906 ent_out=0.3885 rowmax_in=0.5844 rowmax_out=0.8064 discrete_mse=77.018898 best_discrete=10.838540 hash=False elapsed=59.3s
step   675/900 tau=0.0685 loss=0.319212 mse_soft=0.318808 ent_in=0.9736 ent_out=0.3738 rowmax_in=0.5985 rowmax_out=0.8151 discrete_mse=77.201820 best_discrete=10.838540 hash=False elapsed=61.7s
step   700/900 tau=0.0620 loss=0.311206 mse_soft=0.310805 ent_in=0.9683 ent_out=0.3685 rowmax_in=0.5908 rowmax_out=0.8217 discrete_mse=87.009872 best_discrete=10.838540 hash=False elapsed=63.8s
step   725/900 tau=0.0562 loss=0.293867 mse_soft=0.293466 ent_in=0.9556 ent_out=0.3818 rowmax_in=0.5947 rowmax_out=0.8036 discrete_mse=103.171051 best_discrete=10.838540 hash=False elapsed=66.0s
step   750/900 tau=0.0508 loss=0.293783 mse_soft=0.293388 ent_in=0.9411 ent_out=0.3758 rowmax_in=0.5915 rowmax_out=0.8024 discrete_mse=128.618530 best_discrete=10.838540 hash=False elapsed=68.5s
step   775/900 tau=0.0460 loss=0.435327 mse_soft=0.435032 ent_in=0.7212 ent_out=0.2622 rowmax_in=0.6864 rowmax_out=0.8741 discrete_mse=36.103500 best_discrete=10.838540 hash=False elapsed=70.7s
step   800/900 tau=0.0417 loss=0.353286 mse_soft=0.353035 ent_in=0.5778 ent_out=0.2585 rowmax_in=0.7128 rowmax_out=0.8577 discrete_mse=154.884338 best_discrete=10.838540 hash=False elapsed=73.0s
step   825/900 tau=0.0377 loss=0.335621 mse_soft=0.335392 ent_in=0.5025 ent_out=0.2607 rowmax_in=0.7466 rowmax_out=0.8524 discrete_mse=41.084217 best_discrete=10.838540 hash=False elapsed=75.1s
step   850/900 tau=0.0342 loss=0.333711 mse_soft=0.333489 ent_in=0.5102 ent_out=0.2320 rowmax_in=0.7446 rowmax_out=0.8644 discrete_mse=41.084217 best_discrete=10.838540 hash=False elapsed=77.2s
step   875/900 tau=0.0309 loss=0.387860 mse_soft=0.387665 ent_in=0.4103 ent_out=0.2390 rowmax_in=0.8004 rowmax_out=0.8569 discrete_mse=62.941017 best_discrete=10.838540 hash=False elapsed=79.4s
step   900/900 tau=0.0280 loss=0.371491 mse_soft=0.371301 ent_in=0.3936 ent_out=0.2368 rowmax_in=0.7813 rowmax_out=0.8623 discrete_mse=97.559669 best_discrete=10.838540 hash=False elapsed=81.5s

Final metrics:
  soft_mse_full=0.374163
  rowmax_in_mean=0.7821
  rowmax_out_mean=0.8584
  ent_in_mean=0.3944
  ent_out_mean=0.2403
  final_discrete_mse=90.112839
  hash_match=False
  best_discrete_mse_seen=10.838540
Saved results to sinkhorn_par6.json
