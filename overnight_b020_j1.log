Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.072291 mse_soft=1.069968 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=22.866159 best_discrete=22.866159 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.867495 mse_soft=0.865305 ent_in=3.6322 ent_out=3.6679 rowmax_in=0.0461 rowmax_out=0.0444 discrete_mse=1294.433716 best_discrete=22.866159 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.646405 mse_soft=0.644501 ent_in=3.1255 ent_out=3.2210 rowmax_in=0.0933 rowmax_out=0.0903 discrete_mse=4583.916016 best_discrete=22.866159 hash=False elapsed=5.2s
step    75/900 tau=0.7493 loss=0.506936 mse_soft=0.505366 ent_in=2.5833 ent_out=2.6513 rowmax_in=0.1986 rowmax_out=0.2015 discrete_mse=3506.256592 best_discrete=22.866159 hash=False elapsed=7.7s
step   100/900 tau=0.6797 loss=0.400033 mse_soft=0.398890 ent_in=1.9415 ent_out=1.8684 rowmax_in=0.3484 rowmax_out=0.4077 discrete_mse=2116.148926 best_discrete=22.866159 hash=False elapsed=10.2s
step   125/900 tau=0.6165 loss=0.346325 mse_soft=0.345490 ent_in=1.5743 ent_out=1.2080 rowmax_in=0.4257 rowmax_out=0.6056 discrete_mse=512.368652 best_discrete=22.866159 hash=False elapsed=12.8s
step   150/900 tau=0.5592 loss=0.320065 mse_soft=0.319380 ent_in=1.4489 ent_out=0.8333 rowmax_in=0.4355 rowmax_out=0.7021 discrete_mse=739.806824 best_discrete=22.866159 hash=False elapsed=15.1s
step   175/900 tau=0.5073 loss=0.307619 mse_soft=0.307003 ent_in=1.3825 ent_out=0.6714 rowmax_in=0.4452 rowmax_out=0.7357 discrete_mse=1419.986816 best_discrete=22.866159 hash=False elapsed=17.5s
step   200/900 tau=0.4602 loss=0.301362 mse_soft=0.300790 ent_in=1.3322 ent_out=0.5754 rowmax_in=0.4498 rowmax_out=0.7671 discrete_mse=603.610596 best_discrete=22.866159 hash=False elapsed=19.8s
step   225/900 tau=0.4174 loss=0.297916 mse_soft=0.297367 ent_in=1.3088 ent_out=0.5213 rowmax_in=0.4525 rowmax_out=0.7883 discrete_mse=603.610596 best_discrete=22.866159 hash=False elapsed=22.0s
step   250/900 tau=0.3786 loss=0.296127 mse_soft=0.295593 ent_in=1.2927 ent_out=0.4868 rowmax_in=0.4564 rowmax_out=0.8044 discrete_mse=603.610596 best_discrete=22.866159 hash=False elapsed=24.3s
step   275/900 tau=0.3434 loss=0.294847 mse_soft=0.294322 ent_in=1.2819 ent_out=0.4678 rowmax_in=0.4593 rowmax_out=0.8145 discrete_mse=1065.179810 best_discrete=22.866159 hash=False elapsed=26.6s
step   300/900 tau=0.3115 loss=0.294270 mse_soft=0.293753 ent_in=1.2666 ent_out=0.4585 rowmax_in=0.4630 rowmax_out=0.8200 discrete_mse=293.787018 best_discrete=22.866159 hash=False elapsed=28.9s
step   325/900 tau=0.2826 loss=0.291813 mse_soft=0.291308 ent_in=1.2492 ent_out=0.4347 rowmax_in=0.4683 rowmax_out=0.8264 discrete_mse=293.787018 best_discrete=22.866159 hash=False elapsed=31.2s
step   350/900 tau=0.2563 loss=0.292947 mse_soft=0.292453 ent_in=1.2390 ent_out=0.4083 rowmax_in=0.4699 rowmax_out=0.8324 discrete_mse=548.108398 best_discrete=22.866159 hash=False elapsed=33.6s
step   375/900 tau=0.2325 loss=0.289295 mse_soft=0.288808 ent_in=1.2345 ent_out=0.3901 rowmax_in=0.4686 rowmax_out=0.8331 discrete_mse=453.652527 best_discrete=22.866159 hash=False elapsed=35.8s
step   400/900 tau=0.2109 loss=0.296436 mse_soft=0.295954 ent_in=1.2280 ent_out=0.3789 rowmax_in=0.4675 rowmax_out=0.8335 discrete_mse=786.566650 best_discrete=22.866159 hash=False elapsed=38.2s
step   425/900 tau=0.1913 loss=0.288320 mse_soft=0.287844 ent_in=1.2254 ent_out=0.3627 rowmax_in=0.4708 rowmax_out=0.8375 discrete_mse=786.566650 best_discrete=22.866159 hash=False elapsed=40.4s
step   450/900 tau=0.1735 loss=0.291590 mse_soft=0.291122 ent_in=1.2224 ent_out=0.3371 rowmax_in=0.4720 rowmax_out=0.8452 discrete_mse=673.440491 best_discrete=22.866159 hash=False elapsed=42.8s
step   475/900 tau=0.1574 loss=0.288773 mse_soft=0.288312 ent_in=1.2195 ent_out=0.3165 rowmax_in=0.4738 rowmax_out=0.8547 discrete_mse=232.448639 best_discrete=22.866159 hash=False elapsed=45.1s
step   500/900 tau=0.1428 loss=0.287143 mse_soft=0.286691 ent_in=1.2138 ent_out=0.2940 rowmax_in=0.4740 rowmax_out=0.8638 discrete_mse=404.271881 best_discrete=22.866159 hash=False elapsed=47.4s
step   525/900 tau=0.1295 loss=0.290498 mse_soft=0.290051 ent_in=1.2085 ent_out=0.2819 rowmax_in=0.4753 rowmax_out=0.8658 discrete_mse=404.271881 best_discrete=22.866159 hash=False elapsed=49.7s
step   550/900 tau=0.1175 loss=0.288856 mse_soft=0.288413 ent_in=1.2021 ent_out=0.2773 rowmax_in=0.4772 rowmax_out=0.8664 discrete_mse=325.050964 best_discrete=22.866159 hash=False elapsed=52.1s
step   575/900 tau=0.1066 loss=0.288289 mse_soft=0.287846 ent_in=1.2020 ent_out=0.2740 rowmax_in=0.4784 rowmax_out=0.8671 discrete_mse=404.271881 best_discrete=22.866159 hash=False elapsed=54.6s
step   600/900 tau=0.0967 loss=0.288676 mse_soft=0.288233 ent_in=1.2000 ent_out=0.2744 rowmax_in=0.4781 rowmax_out=0.8670 discrete_mse=404.271881 best_discrete=22.866159 hash=False elapsed=57.2s
step   625/900 tau=0.0877 loss=0.326323 mse_soft=0.325882 ent_in=1.1831 ent_out=0.2840 rowmax_in=0.4861 rowmax_out=0.8575 discrete_mse=59.627537 best_discrete=22.866159 hash=False elapsed=59.5s
step   650/900 tau=0.0795 loss=0.305493 mse_soft=0.305070 ent_in=1.1392 ent_out=0.2705 rowmax_in=0.5024 rowmax_out=0.8560 discrete_mse=207.592667 best_discrete=22.866159 hash=False elapsed=61.7s
step   675/900 tau=0.0722 loss=0.306919 mse_soft=0.306488 ent_in=1.1621 ent_out=0.2731 rowmax_in=0.4836 rowmax_out=0.8566 discrete_mse=271.990601 best_discrete=22.866159 hash=False elapsed=63.9s
step   700/900 tau=0.0655 loss=0.328032 mse_soft=0.327611 ent_in=1.1231 ent_out=0.2799 rowmax_in=0.5093 rowmax_out=0.8625 discrete_mse=248.004089 best_discrete=22.866159 hash=False elapsed=66.1s
step   725/900 tau=0.0594 loss=0.329099 mse_soft=0.328699 ent_in=1.0431 ent_out=0.2905 rowmax_in=0.5230 rowmax_out=0.8467 discrete_mse=162.851303 best_discrete=22.866159 hash=False elapsed=68.5s
step   750/900 tau=0.0539 loss=0.319102 mse_soft=0.318712 ent_in=1.0090 ent_out=0.2922 rowmax_in=0.5340 rowmax_out=0.8407 discrete_mse=150.192215 best_discrete=22.866159 hash=False elapsed=70.8s
step   775/900 tau=0.0489 loss=0.327857 mse_soft=0.327463 ent_in=1.0091 ent_out=0.3032 rowmax_in=0.5231 rowmax_out=0.8387 discrete_mse=217.635574 best_discrete=22.866159 hash=False elapsed=73.2s
step   800/900 tau=0.0443 loss=0.332786 mse_soft=0.332408 ent_in=0.9655 ent_out=0.2956 rowmax_in=0.5500 rowmax_out=0.8434 discrete_mse=619.689331 best_discrete=22.866159 hash=False elapsed=75.6s
step   825/900 tau=0.0402 loss=0.335215 mse_soft=0.334833 ent_in=0.9700 ent_out=0.3050 rowmax_in=0.5398 rowmax_out=0.8344 discrete_mse=182.308075 best_discrete=22.866159 hash=False elapsed=77.9s
step   850/900 tau=0.0365 loss=0.358396 mse_soft=0.358033 ent_in=0.9204 ent_out=0.2892 rowmax_in=0.5655 rowmax_out=0.8457 discrete_mse=474.475128 best_discrete=22.866159 hash=False elapsed=80.3s
step   875/900 tau=0.0331 loss=0.448281 mse_soft=0.448056 ent_in=0.5116 ent_out=0.2382 rowmax_in=0.7639 rowmax_out=0.8583 discrete_mse=37.516796 best_discrete=22.866159 hash=False elapsed=82.4s
step   900/900 tau=0.0300 loss=0.415478 mse_soft=0.415280 ent_in=0.4447 ent_out=0.2160 rowmax_in=0.7843 rowmax_out=0.8671 discrete_mse=35.159134 best_discrete=22.866159 hash=False elapsed=84.4s

Final metrics:
  soft_mse_full=0.406940
  rowmax_in_mean=0.7799
  rowmax_out_mean=0.8670
  ent_in_mean=0.4504
  ent_out_mean=0.2160
  final_discrete_mse=35.159134
  hash_match=False
  best_discrete_mse_seen=22.866159
Saved results to overnight_b020_j1.json
