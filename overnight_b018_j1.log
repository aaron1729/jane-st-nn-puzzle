Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.080958 mse_soft=1.078635 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=40.641136 best_discrete=40.641136 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.873393 mse_soft=0.871203 ent_in=3.6330 ent_out=3.6657 rowmax_in=0.0454 rowmax_out=0.0452 discrete_mse=1060.151733 best_discrete=40.641136 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.649610 mse_soft=0.647707 ent_in=3.1240 ent_out=3.2178 rowmax_in=0.0934 rowmax_out=0.0883 discrete_mse=6023.353516 best_discrete=40.641136 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.506167 mse_soft=0.504587 ent_in=2.6044 ent_out=2.6635 rowmax_in=0.2049 rowmax_out=0.2036 discrete_mse=457.804352 best_discrete=40.641136 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.391586 mse_soft=0.390449 ent_in=1.9853 ent_out=1.8039 rowmax_in=0.3519 rowmax_out=0.4397 discrete_mse=1739.537964 best_discrete=40.641136 hash=False elapsed=9.6s
step   125/900 tau=0.6165 loss=0.338000 mse_soft=0.337157 ent_in=1.6156 ent_out=1.1953 rowmax_in=0.4334 rowmax_out=0.6199 discrete_mse=411.854248 best_discrete=40.641136 hash=False elapsed=11.8s
step   150/900 tau=0.5592 loss=0.309091 mse_soft=0.308418 ent_in=1.4328 ent_out=0.8124 rowmax_in=0.4731 rowmax_out=0.7359 discrete_mse=64.158783 best_discrete=40.641136 hash=False elapsed=14.1s
step   175/900 tau=0.5073 loss=0.293967 mse_soft=0.293384 ent_in=1.3328 ent_out=0.6105 rowmax_in=0.4862 rowmax_out=0.7898 discrete_mse=19.852880 best_discrete=19.852880 hash=False elapsed=16.3s
step   200/900 tau=0.4602 loss=0.286086 mse_soft=0.285551 ent_in=1.2698 ent_out=0.5152 rowmax_in=0.4964 rowmax_out=0.8111 discrete_mse=14.734544 best_discrete=14.734544 hash=False elapsed=18.4s
step   225/900 tau=0.4174 loss=0.282509 mse_soft=0.282000 ent_in=1.2403 ent_out=0.4555 rowmax_in=0.5007 rowmax_out=0.8266 discrete_mse=6.897936 best_discrete=6.897936 hash=False elapsed=20.6s
step   250/900 tau=0.3786 loss=0.279574 mse_soft=0.279085 ent_in=1.2128 ent_out=0.4175 rowmax_in=0.5018 rowmax_out=0.8318 discrete_mse=118.283234 best_discrete=6.897936 hash=False elapsed=23.0s
step   275/900 tau=0.3434 loss=0.277157 mse_soft=0.276680 ent_in=1.1921 ent_out=0.4005 rowmax_in=0.5024 rowmax_out=0.8312 discrete_mse=86.969551 best_discrete=6.897936 hash=False elapsed=25.1s
step   300/900 tau=0.3115 loss=0.275051 mse_soft=0.274582 ent_in=1.1795 ent_out=0.3854 rowmax_in=0.5031 rowmax_out=0.8324 discrete_mse=195.566895 best_discrete=6.897936 hash=False elapsed=27.3s
step   325/900 tau=0.2826 loss=0.274564 mse_soft=0.274102 ent_in=1.1667 ent_out=0.3728 rowmax_in=0.5055 rowmax_out=0.8339 discrete_mse=195.566895 best_discrete=6.897936 hash=False elapsed=29.5s
step   350/900 tau=0.2563 loss=0.274323 mse_soft=0.273865 ent_in=1.1560 ent_out=0.3701 rowmax_in=0.5069 rowmax_out=0.8325 discrete_mse=195.566895 best_discrete=6.897936 hash=False elapsed=31.7s
step   375/900 tau=0.2325 loss=0.276257 mse_soft=0.275803 ent_in=1.1452 ent_out=0.3678 rowmax_in=0.5085 rowmax_out=0.8307 discrete_mse=195.566895 best_discrete=6.897936 hash=False elapsed=33.9s
step   400/900 tau=0.2109 loss=0.273275 mse_soft=0.272824 ent_in=1.1401 ent_out=0.3632 rowmax_in=0.5095 rowmax_out=0.8300 discrete_mse=195.566895 best_discrete=6.897936 hash=False elapsed=36.1s
step   425/900 tau=0.1913 loss=0.272946 mse_soft=0.272501 ent_in=1.1298 ent_out=0.3540 rowmax_in=0.5099 rowmax_out=0.8304 discrete_mse=178.249100 best_discrete=6.897936 hash=False elapsed=38.5s
step   450/900 tau=0.1735 loss=0.275580 mse_soft=0.275138 ent_in=1.1244 ent_out=0.3467 rowmax_in=0.5080 rowmax_out=0.8297 discrete_mse=281.420380 best_discrete=6.897936 hash=False elapsed=40.8s
step   475/900 tau=0.1574 loss=0.271548 mse_soft=0.271111 ent_in=1.1202 ent_out=0.3371 rowmax_in=0.5094 rowmax_out=0.8349 discrete_mse=744.402710 best_discrete=6.897936 hash=False elapsed=43.0s
step   500/900 tau=0.1428 loss=0.272628 mse_soft=0.272193 ent_in=1.1154 ent_out=0.3328 rowmax_in=0.5107 rowmax_out=0.8341 discrete_mse=393.754364 best_discrete=6.897936 hash=False elapsed=45.2s
step   525/900 tau=0.1295 loss=0.276785 mse_soft=0.276354 ent_in=1.1116 ent_out=0.3256 rowmax_in=0.5106 rowmax_out=0.8358 discrete_mse=1036.263916 best_discrete=6.897936 hash=False elapsed=47.3s
step   550/900 tau=0.1175 loss=0.274993 mse_soft=0.274568 ent_in=1.0975 ent_out=0.3210 rowmax_in=0.5189 rowmax_out=0.8389 discrete_mse=551.995361 best_discrete=6.897936 hash=False elapsed=49.6s
step   575/900 tau=0.1066 loss=0.285398 mse_soft=0.284980 ent_in=1.0838 ent_out=0.3126 rowmax_in=0.5211 rowmax_out=0.8439 discrete_mse=719.966858 best_discrete=6.897936 hash=False elapsed=51.8s
step   600/900 tau=0.0967 loss=0.276477 mse_soft=0.276058 ent_in=1.0836 ent_out=0.3138 rowmax_in=0.5188 rowmax_out=0.8394 discrete_mse=556.042664 best_discrete=6.897936 hash=False elapsed=53.9s
step   625/900 tau=0.0877 loss=0.295934 mse_soft=0.295523 ent_in=1.0640 ent_out=0.3058 rowmax_in=0.5255 rowmax_out=0.8433 discrete_mse=471.756927 best_discrete=6.897936 hash=False elapsed=56.2s
step   650/900 tau=0.0795 loss=0.276446 mse_soft=0.276035 ent_in=1.0642 ent_out=0.3066 rowmax_in=0.5245 rowmax_out=0.8395 discrete_mse=218.916901 best_discrete=6.897936 hash=False elapsed=58.4s
step   675/900 tau=0.0722 loss=0.282570 mse_soft=0.282180 ent_in=1.0117 ent_out=0.2888 rowmax_in=0.5519 rowmax_out=0.8407 discrete_mse=27.955818 best_discrete=6.897936 hash=False elapsed=60.8s
step   700/900 tau=0.0655 loss=0.280961 mse_soft=0.280571 ent_in=1.0177 ent_out=0.2802 rowmax_in=0.5408 rowmax_out=0.8445 discrete_mse=24.847269 best_discrete=6.897936 hash=False elapsed=63.0s
step   725/900 tau=0.0594 loss=0.278249 mse_soft=0.277863 ent_in=1.0129 ent_out=0.2741 rowmax_in=0.5437 rowmax_out=0.8491 discrete_mse=24.847269 best_discrete=6.897936 hash=False elapsed=65.1s
step   750/900 tau=0.0539 loss=0.336844 mse_soft=0.336504 ent_in=0.9077 ent_out=0.2277 rowmax_in=0.5862 rowmax_out=0.8856 discrete_mse=39.657101 best_discrete=6.897936 hash=False elapsed=67.4s
step   775/900 tau=0.0489 loss=0.332834 mse_soft=0.332546 ent_in=0.7290 ent_out=0.2305 rowmax_in=0.6576 rowmax_out=0.8791 discrete_mse=78.420982 best_discrete=6.897936 hash=False elapsed=69.5s
step   800/900 tau=0.0443 loss=0.317116 mse_soft=0.316843 ent_in=0.6806 ent_out=0.2296 rowmax_in=0.6632 rowmax_out=0.8788 discrete_mse=57.664650 best_discrete=6.897936 hash=False elapsed=71.7s
step   825/900 tau=0.0402 loss=0.335182 mse_soft=0.334910 ent_in=0.6597 ent_out=0.2439 rowmax_in=0.6753 rowmax_out=0.8665 discrete_mse=14.629112 best_discrete=6.897936 hash=False elapsed=73.9s
step   850/900 tau=0.0365 loss=0.455907 mse_soft=0.455713 ent_in=0.4434 ent_out=0.2014 rowmax_in=0.7862 rowmax_out=0.8989 discrete_mse=99.246506 best_discrete=6.897936 hash=False elapsed=76.2s
step   875/900 tau=0.0331 loss=0.417499 mse_soft=0.417329 ent_in=0.4017 ent_out=0.1646 rowmax_in=0.7972 rowmax_out=0.9112 discrete_mse=53.845348 best_discrete=6.897936 hash=False elapsed=78.4s
step   900/900 tau=0.0300 loss=0.410799 mse_soft=0.410621 ent_in=0.4034 ent_out=0.1914 rowmax_in=0.7884 rowmax_out=0.8875 discrete_mse=63.017410 best_discrete=6.897936 hash=False elapsed=80.5s

Final metrics:
  soft_mse_full=0.413023
  rowmax_in_mean=0.7896
  rowmax_out_mean=0.8858
  ent_in_mean=0.4032
  ent_out_mean=0.1932
  final_discrete_mse=53.359905
  hash_match=False
  best_discrete_mse_seen=6.897936
Saved results to overnight_b018_j1.json
