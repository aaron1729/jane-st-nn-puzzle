Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.059603 mse_soft=1.057281 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=12.899085 best_discrete=12.899085 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.859337 mse_soft=0.857146 ent_in=3.6350 ent_out=3.6673 rowmax_in=0.0465 rowmax_out=0.0439 discrete_mse=591.363586 best_discrete=12.899085 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.648597 mse_soft=0.646688 ent_in=3.1385 ent_out=3.2237 rowmax_in=0.0983 rowmax_out=0.0893 discrete_mse=4496.447754 best_discrete=12.899085 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.521409 mse_soft=0.519807 ent_in=2.6406 ent_out=2.6997 rowmax_in=0.1918 rowmax_out=0.1863 discrete_mse=3230.411865 best_discrete=12.899085 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.407317 mse_soft=0.406144 ent_in=2.0376 ent_out=1.8726 rowmax_in=0.3335 rowmax_out=0.4185 discrete_mse=535.638550 best_discrete=12.899085 hash=False elapsed=9.6s
step   125/900 tau=0.6165 loss=0.343347 mse_soft=0.342516 ent_in=1.6331 ent_out=1.1383 rowmax_in=0.4314 rowmax_out=0.6306 discrete_mse=138.086502 best_discrete=12.899085 hash=False elapsed=11.8s
step   150/900 tau=0.5592 loss=0.305176 mse_soft=0.304563 ent_in=1.3600 ent_out=0.6803 rowmax_in=0.4859 rowmax_out=0.7797 discrete_mse=88.330734 best_discrete=12.899085 hash=False elapsed=13.9s
step   175/900 tau=0.5073 loss=0.289707 mse_soft=0.289193 ent_in=1.2191 ent_out=0.4953 rowmax_in=0.5190 rowmax_out=0.8279 discrete_mse=93.712936 best_discrete=12.899085 hash=False elapsed=16.1s
step   200/900 tau=0.4602 loss=0.283280 mse_soft=0.282793 ent_in=1.1749 ent_out=0.4499 rowmax_in=0.5252 rowmax_out=0.8343 discrete_mse=223.184891 best_discrete=12.899085 hash=False elapsed=18.4s
step   225/900 tau=0.4174 loss=0.279125 mse_soft=0.278650 ent_in=1.1518 ent_out=0.4330 rowmax_in=0.5344 rowmax_out=0.8295 discrete_mse=498.286591 best_discrete=12.899085 hash=False elapsed=20.7s
step   250/900 tau=0.3786 loss=0.276686 mse_soft=0.276227 ent_in=1.1174 ent_out=0.4121 rowmax_in=0.5460 rowmax_out=0.8263 discrete_mse=1144.419800 best_discrete=12.899085 hash=False elapsed=23.1s
step   275/900 tau=0.3434 loss=0.271923 mse_soft=0.271483 ent_in=1.0867 ent_out=0.3807 rowmax_in=0.5497 rowmax_out=0.8336 discrete_mse=686.182800 best_discrete=12.899085 hash=False elapsed=25.6s
step   300/900 tau=0.3115 loss=0.271641 mse_soft=0.271212 ent_in=1.0684 ent_out=0.3619 rowmax_in=0.5507 rowmax_out=0.8351 discrete_mse=578.002258 best_discrete=12.899085 hash=False elapsed=28.1s
step   325/900 tau=0.2826 loss=0.269625 mse_soft=0.269202 ent_in=1.0585 ent_out=0.3505 rowmax_in=0.5527 rowmax_out=0.8359 discrete_mse=578.002258 best_discrete=12.899085 hash=False elapsed=30.4s
step   350/900 tau=0.2563 loss=0.269965 mse_soft=0.269549 ent_in=1.0436 ent_out=0.3428 rowmax_in=0.5568 rowmax_out=0.8381 discrete_mse=578.002258 best_discrete=12.899085 hash=False elapsed=32.8s
step   375/900 tau=0.2325 loss=0.271780 mse_soft=0.271368 ent_in=1.0356 ent_out=0.3365 rowmax_in=0.5599 rowmax_out=0.8394 discrete_mse=578.002258 best_discrete=12.899085 hash=False elapsed=35.1s
step   400/900 tau=0.2109 loss=0.272217 mse_soft=0.271806 ent_in=1.0346 ent_out=0.3368 rowmax_in=0.5581 rowmax_out=0.8372 discrete_mse=578.002258 best_discrete=12.899085 hash=False elapsed=37.5s
step   425/900 tau=0.1913 loss=0.271728 mse_soft=0.271320 ent_in=1.0243 ent_out=0.3350 rowmax_in=0.5631 rowmax_out=0.8385 discrete_mse=578.002258 best_discrete=12.899085 hash=False elapsed=39.8s
step   450/900 tau=0.1735 loss=0.270040 mse_soft=0.269633 ent_in=1.0250 ent_out=0.3339 rowmax_in=0.5592 rowmax_out=0.8388 discrete_mse=578.002258 best_discrete=12.899085 hash=False elapsed=42.3s
step   475/900 tau=0.1574 loss=0.280264 mse_soft=0.279859 ent_in=1.0159 ent_out=0.3330 rowmax_in=0.5627 rowmax_out=0.8395 discrete_mse=496.048798 best_discrete=12.899085 hash=False elapsed=44.6s
step   500/900 tau=0.1428 loss=0.268763 mse_soft=0.268358 ent_in=1.0137 ent_out=0.3345 rowmax_in=0.5643 rowmax_out=0.8363 discrete_mse=496.048798 best_discrete=12.899085 hash=False elapsed=46.9s
step   525/900 tau=0.1295 loss=0.277790 mse_soft=0.277388 ent_in=1.0035 ent_out=0.3356 rowmax_in=0.5712 rowmax_out=0.8337 discrete_mse=496.048798 best_discrete=12.899085 hash=False elapsed=49.3s
step   550/900 tau=0.1175 loss=0.272180 mse_soft=0.271781 ent_in=0.9970 ent_out=0.3330 rowmax_in=0.5688 rowmax_out=0.8294 discrete_mse=833.622314 best_discrete=12.899085 hash=False elapsed=51.9s
step   575/900 tau=0.1066 loss=0.268009 mse_soft=0.267615 ent_in=0.9886 ent_out=0.3245 rowmax_in=0.5714 rowmax_out=0.8291 discrete_mse=833.622314 best_discrete=12.899085 hash=False elapsed=54.2s
step   600/900 tau=0.0967 loss=0.272444 mse_soft=0.272056 ent_in=0.9724 ent_out=0.3190 rowmax_in=0.5786 rowmax_out=0.8304 discrete_mse=833.622314 best_discrete=12.899085 hash=False elapsed=56.6s
step   625/900 tau=0.0877 loss=0.267730 mse_soft=0.267343 ent_in=0.9730 ent_out=0.3162 rowmax_in=0.5740 rowmax_out=0.8302 discrete_mse=833.622314 best_discrete=12.899085 hash=False elapsed=59.1s
step   650/900 tau=0.0795 loss=0.276972 mse_soft=0.276587 ent_in=0.9710 ent_out=0.3128 rowmax_in=0.5750 rowmax_out=0.8320 discrete_mse=833.622314 best_discrete=12.899085 hash=False elapsed=61.5s
step   675/900 tau=0.0722 loss=0.300696 mse_soft=0.300315 ent_in=0.9560 ent_out=0.3145 rowmax_in=0.5813 rowmax_out=0.8301 discrete_mse=614.042542 best_discrete=12.899085 hash=False elapsed=64.0s
step   700/900 tau=0.0655 loss=0.310008 mse_soft=0.309641 ent_in=0.9102 ent_out=0.3134 rowmax_in=0.5986 rowmax_out=0.8314 discrete_mse=20.772276 best_discrete=12.899085 hash=False elapsed=66.2s
step   725/900 tau=0.0594 loss=0.349206 mse_soft=0.348844 ent_in=0.8844 ent_out=0.3210 rowmax_in=0.5856 rowmax_out=0.8199 discrete_mse=243.090439 best_discrete=12.899085 hash=False elapsed=68.5s
step   750/900 tau=0.0539 loss=0.332092 mse_soft=0.331806 ent_in=0.7017 ent_out=0.2499 rowmax_in=0.6762 rowmax_out=0.8735 discrete_mse=78.464622 best_discrete=12.899085 hash=False elapsed=70.7s
step   775/900 tau=0.0489 loss=0.306537 mse_soft=0.306243 ent_in=0.7331 ent_out=0.2493 rowmax_in=0.6417 rowmax_out=0.8687 discrete_mse=35.711494 best_discrete=12.899085 hash=False elapsed=73.2s
step   800/900 tau=0.0443 loss=0.327679 mse_soft=0.327432 ent_in=0.6024 ent_out=0.2206 rowmax_in=0.7093 rowmax_out=0.8868 discrete_mse=41.592663 best_discrete=12.899085 hash=False elapsed=75.5s
step   825/900 tau=0.0402 loss=0.365485 mse_soft=0.365245 ent_in=0.5663 ent_out=0.2313 rowmax_in=0.7333 rowmax_out=0.8788 discrete_mse=15.861393 best_discrete=12.899085 hash=False elapsed=77.7s
step   850/900 tau=0.0365 loss=0.368190 mse_soft=0.367990 ent_in=0.4400 ent_out=0.2282 rowmax_in=0.7761 rowmax_out=0.8761 discrete_mse=7.458016 best_discrete=7.458016 hash=False elapsed=79.9s
step   875/900 tau=0.0331 loss=0.334610 mse_soft=0.334391 ent_in=0.4970 ent_out=0.2345 rowmax_in=0.7451 rowmax_out=0.8693 discrete_mse=68.517776 best_discrete=7.458016 hash=False elapsed=82.2s
step   900/900 tau=0.0300 loss=0.350629 mse_soft=0.350431 ent_in=0.4145 ent_out=0.2470 rowmax_in=0.7842 rowmax_out=0.8582 discrete_mse=114.459297 best_discrete=7.458016 hash=False elapsed=84.4s

Final metrics:
  soft_mse_full=0.356742
  rowmax_in_mean=0.7785
  rowmax_out_mean=0.8563
  ent_in_mean=0.4201
  ent_out_mean=0.2479
  final_discrete_mse=29.341887
  hash_match=False
  best_discrete_mse_seen=7.458016
Saved results to overnight_b166_j1.json
