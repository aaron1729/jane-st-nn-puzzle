Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.040777 mse_soft=1.038455 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=15.368690 best_discrete=15.368690 hash=False elapsed=0.6s
step    25/900 tau=0.9106 loss=0.841515 mse_soft=0.839326 ent_in=3.6323 ent_out=3.6661 rowmax_in=0.0459 rowmax_out=0.0439 discrete_mse=1028.189331 best_discrete=15.368690 hash=False elapsed=3.0s
step    50/900 tau=0.8260 loss=0.632207 mse_soft=0.630302 ent_in=3.1288 ent_out=3.2217 rowmax_in=0.0923 rowmax_out=0.0865 discrete_mse=3731.723145 best_discrete=15.368690 hash=False elapsed=5.5s
step    75/900 tau=0.7493 loss=0.505709 mse_soft=0.504112 ent_in=2.6222 ent_out=2.7022 rowmax_in=0.1968 rowmax_out=0.1905 discrete_mse=3276.871826 best_discrete=15.368690 hash=False elapsed=7.9s
step   100/900 tau=0.6797 loss=0.411969 mse_soft=0.410769 ent_in=2.1018 ent_out=1.8965 rowmax_in=0.3123 rowmax_out=0.4105 discrete_mse=676.819580 best_discrete=15.368690 hash=False elapsed=10.4s
step   125/900 tau=0.6165 loss=0.335043 mse_soft=0.334231 ent_in=1.6202 ent_out=1.0846 rowmax_in=0.4306 rowmax_out=0.6605 discrete_mse=165.981140 best_discrete=15.368690 hash=False elapsed=12.9s
step   150/900 tau=0.5592 loss=0.305665 mse_soft=0.305033 ent_in=1.3967 ent_out=0.7090 rowmax_in=0.4679 rowmax_out=0.7559 discrete_mse=510.430481 best_discrete=15.368690 hash=False elapsed=15.4s
step   175/900 tau=0.5073 loss=0.289863 mse_soft=0.289309 ent_in=1.3118 ent_out=0.5355 rowmax_in=0.4813 rowmax_out=0.8034 discrete_mse=60.610149 best_discrete=15.368690 hash=False elapsed=17.6s
step   200/900 tau=0.4602 loss=0.275950 mse_soft=0.275461 ent_in=1.2166 ent_out=0.4151 rowmax_in=0.5024 rowmax_out=0.8421 discrete_mse=79.505638 best_discrete=15.368690 hash=False elapsed=20.1s
step   225/900 tau=0.4174 loss=0.268262 mse_soft=0.267804 ent_in=1.1601 ent_out=0.3687 rowmax_in=0.5138 rowmax_out=0.8559 discrete_mse=96.716370 best_discrete=15.368690 hash=False elapsed=22.3s
step   250/900 tau=0.3786 loss=0.266413 mse_soft=0.265964 ent_in=1.1403 ent_out=0.3571 rowmax_in=0.5164 rowmax_out=0.8565 discrete_mse=130.515213 best_discrete=15.368690 hash=False elapsed=24.6s
step   275/900 tau=0.3434 loss=0.263110 mse_soft=0.262667 ent_in=1.1278 ent_out=0.3483 rowmax_in=0.5164 rowmax_out=0.8591 discrete_mse=130.515213 best_discrete=15.368690 hash=False elapsed=26.9s
step   300/900 tau=0.3115 loss=0.263112 mse_soft=0.262674 ent_in=1.1190 ent_out=0.3391 rowmax_in=0.5179 rowmax_out=0.8627 discrete_mse=79.505638 best_discrete=15.368690 hash=False elapsed=29.2s
step   325/900 tau=0.2826 loss=0.261287 mse_soft=0.260855 ent_in=1.1152 ent_out=0.3264 rowmax_in=0.5143 rowmax_out=0.8686 discrete_mse=79.505638 best_discrete=15.368690 hash=False elapsed=31.6s
step   350/900 tau=0.2563 loss=0.260448 mse_soft=0.260019 ent_in=1.1096 ent_out=0.3211 rowmax_in=0.5165 rowmax_out=0.8676 discrete_mse=79.505638 best_discrete=15.368690 hash=False elapsed=33.9s
step   375/900 tau=0.2325 loss=0.258308 mse_soft=0.257881 ent_in=1.0982 ent_out=0.3251 rowmax_in=0.5215 rowmax_out=0.8608 discrete_mse=164.814163 best_discrete=15.368690 hash=False elapsed=36.2s
step   400/900 tau=0.2109 loss=0.261850 mse_soft=0.261426 ent_in=1.0847 ent_out=0.3280 rowmax_in=0.5293 rowmax_out=0.8593 discrete_mse=163.164627 best_discrete=15.368690 hash=False elapsed=38.5s
step   425/900 tau=0.1913 loss=0.257923 mse_soft=0.257503 ent_in=1.0741 ent_out=0.3265 rowmax_in=0.5338 rowmax_out=0.8597 discrete_mse=115.649651 best_discrete=15.368690 hash=False elapsed=40.8s
step   450/900 tau=0.1735 loss=0.260289 mse_soft=0.259873 ent_in=1.0644 ent_out=0.3211 rowmax_in=0.5382 rowmax_out=0.8620 discrete_mse=115.649651 best_discrete=15.368690 hash=False elapsed=43.0s
step   475/900 tau=0.1574 loss=0.259262 mse_soft=0.258849 ent_in=1.0603 ent_out=0.3180 rowmax_in=0.5391 rowmax_out=0.8622 discrete_mse=118.987625 best_discrete=15.368690 hash=False elapsed=45.3s
step   500/900 tau=0.1428 loss=0.295345 mse_soft=0.294935 ent_in=1.0592 ent_out=0.3104 rowmax_in=0.5396 rowmax_out=0.8652 discrete_mse=43.160160 best_discrete=15.368690 hash=False elapsed=47.7s
step   525/900 tau=0.1295 loss=0.258568 mse_soft=0.258159 ent_in=1.0537 ent_out=0.3088 rowmax_in=0.5369 rowmax_out=0.8661 discrete_mse=40.293369 best_discrete=15.368690 hash=False elapsed=50.1s
step   550/900 tau=0.1175 loss=0.258615 mse_soft=0.258206 ent_in=1.0532 ent_out=0.3089 rowmax_in=0.5381 rowmax_out=0.8659 discrete_mse=115.649651 best_discrete=15.368690 hash=False elapsed=52.4s
step   575/900 tau=0.1066 loss=0.258712 mse_soft=0.258305 ent_in=1.0507 ent_out=0.3058 rowmax_in=0.5409 rowmax_out=0.8672 discrete_mse=80.044838 best_discrete=15.368690 hash=False elapsed=54.9s
step   600/900 tau=0.0967 loss=0.261124 mse_soft=0.260718 ent_in=1.0530 ent_out=0.2994 rowmax_in=0.5397 rowmax_out=0.8694 discrete_mse=40.293369 best_discrete=15.368690 hash=False elapsed=57.2s
step   625/900 tau=0.0877 loss=0.345718 mse_soft=0.345346 ent_in=0.9587 ent_out=0.2841 rowmax_in=0.5883 rowmax_out=0.8809 discrete_mse=138.963379 best_discrete=15.368690 hash=False elapsed=59.4s
step   650/900 tau=0.0795 loss=0.273464 mse_soft=0.273111 ent_in=0.9178 ent_out=0.2607 rowmax_in=0.5894 rowmax_out=0.8720 discrete_mse=105.529785 best_discrete=15.368690 hash=False elapsed=61.9s
step   675/900 tau=0.0722 loss=0.271443 mse_soft=0.271096 ent_in=0.9176 ent_out=0.2392 rowmax_in=0.5845 rowmax_out=0.8829 discrete_mse=73.703232 best_discrete=15.368690 hash=False elapsed=64.2s
step   700/900 tau=0.0655 loss=0.265805 mse_soft=0.265460 ent_in=0.9175 ent_out=0.2331 rowmax_in=0.5852 rowmax_out=0.8872 discrete_mse=40.455208 best_discrete=15.368690 hash=False elapsed=66.5s
step   725/900 tau=0.0594 loss=0.269743 mse_soft=0.269403 ent_in=0.9072 ent_out=0.2281 rowmax_in=0.5835 rowmax_out=0.8929 discrete_mse=30.742708 best_discrete=15.368690 hash=False elapsed=68.7s
step   750/900 tau=0.0539 loss=0.271860 mse_soft=0.271528 ent_in=0.8773 ent_out=0.2297 rowmax_in=0.5962 rowmax_out=0.8908 discrete_mse=99.227814 best_discrete=15.368690 hash=False elapsed=70.9s
step   775/900 tau=0.0489 loss=0.290419 mse_soft=0.290094 ent_in=0.8513 ent_out=0.2312 rowmax_in=0.6081 rowmax_out=0.8897 discrete_mse=16.878304 best_discrete=15.368690 hash=False elapsed=73.1s
step   800/900 tau=0.0443 loss=0.426284 mse_soft=0.426084 ent_in=0.5395 ent_out=0.1274 rowmax_in=0.7243 rowmax_out=0.9449 discrete_mse=3.340544 best_discrete=3.340544 hash=False elapsed=75.3s
step   825/900 tau=0.0402 loss=0.363598 mse_soft=0.363428 ent_in=0.4268 ent_out=0.1403 rowmax_in=0.7878 rowmax_out=0.9219 discrete_mse=21.491207 best_discrete=3.340544 hash=False elapsed=77.7s
step   850/900 tau=0.0365 loss=0.340611 mse_soft=0.340449 ent_in=0.4260 ent_out=0.1162 rowmax_in=0.7879 rowmax_out=0.9397 discrete_mse=39.743584 best_discrete=3.340544 hash=False elapsed=80.0s
step   875/900 tau=0.0331 loss=0.341195 mse_soft=0.341034 ent_in=0.4249 ent_out=0.1125 rowmax_in=0.7872 rowmax_out=0.9467 discrete_mse=8.071115 best_discrete=3.340544 hash=False elapsed=82.1s
step   900/900 tau=0.0300 loss=0.331822 mse_soft=0.331646 ent_in=0.4666 ent_out=0.1187 rowmax_in=0.7680 rowmax_out=0.9388 discrete_mse=12.859344 best_discrete=3.340544 hash=False elapsed=84.3s

Final metrics:
  soft_mse_full=0.341466
  rowmax_in_mean=0.7678
  rowmax_out_mean=0.9417
  ent_in_mean=0.4668
  ent_out_mean=0.1166
  final_discrete_mse=22.018950
  hash_match=False
  best_discrete_mse_seen=3.340544
Saved results to overnight_b002_j1.json
