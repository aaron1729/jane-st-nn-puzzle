Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.064441 mse_soft=1.062118 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=23.287207 best_discrete=23.287207 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.862191 mse_soft=0.860000 ent_in=3.6360 ent_out=3.6679 rowmax_in=0.0453 rowmax_out=0.0445 discrete_mse=1086.587280 best_discrete=23.287207 hash=False elapsed=2.7s
step    50/900 tau=0.8229 loss=0.653823 mse_soft=0.651914 ent_in=3.1409 ent_out=3.2222 rowmax_in=0.0927 rowmax_out=0.0887 discrete_mse=1021.570801 best_discrete=23.287207 hash=False elapsed=4.9s
step    75/900 tau=0.7450 loss=0.519817 mse_soft=0.518229 ent_in=2.6204 ent_out=2.6733 rowmax_in=0.1960 rowmax_out=0.1986 discrete_mse=142.409164 best_discrete=23.287207 hash=False elapsed=7.0s
step   100/900 tau=0.6745 loss=0.411004 mse_soft=0.409831 ent_in=2.0234 ent_out=1.8864 rowmax_in=0.3361 rowmax_out=0.3770 discrete_mse=1170.816284 best_discrete=23.287207 hash=False elapsed=9.1s
step   125/900 tau=0.6107 loss=0.352534 mse_soft=0.351654 ent_in=1.6540 ent_out=1.2801 rowmax_in=0.4276 rowmax_out=0.5597 discrete_mse=984.106201 best_discrete=23.287207 hash=False elapsed=11.3s
step   150/900 tau=0.5529 loss=0.327798 mse_soft=0.327085 ent_in=1.4672 ent_out=0.9094 rowmax_in=0.4687 rowmax_out=0.6701 discrete_mse=1000.087280 best_discrete=23.287207 hash=False elapsed=13.6s
step   175/900 tau=0.5006 loss=0.312004 mse_soft=0.311386 ent_in=1.3586 ent_out=0.7027 rowmax_in=0.4931 rowmax_out=0.7324 discrete_mse=249.746796 best_discrete=23.287207 hash=False elapsed=15.7s
step   200/900 tau=0.4532 loss=0.302579 mse_soft=0.302030 ent_in=1.2754 ent_out=0.5545 rowmax_in=0.5026 rowmax_out=0.7828 discrete_mse=259.364441 best_discrete=23.287207 hash=False elapsed=17.9s
step   225/900 tau=0.4103 loss=0.296162 mse_soft=0.295650 ent_in=1.2286 ent_out=0.4769 rowmax_in=0.5022 rowmax_out=0.8080 discrete_mse=275.187988 best_discrete=23.287207 hash=False elapsed=20.0s
step   250/900 tau=0.3715 loss=0.294047 mse_soft=0.293558 ent_in=1.1937 ent_out=0.4356 rowmax_in=0.5016 rowmax_out=0.8243 discrete_mse=458.816437 best_discrete=23.287207 hash=False elapsed=22.1s
step   275/900 tau=0.3363 loss=0.288614 mse_soft=0.288144 ent_in=1.1682 ent_out=0.3979 rowmax_in=0.5025 rowmax_out=0.8418 discrete_mse=328.912079 best_discrete=23.287207 hash=False elapsed=24.2s
step   300/900 tau=0.3045 loss=0.287884 mse_soft=0.287429 ent_in=1.1533 ent_out=0.3620 rowmax_in=0.5033 rowmax_out=0.8566 discrete_mse=328.912079 best_discrete=23.287207 hash=False elapsed=26.3s
step   325/900 tau=0.2756 loss=0.284970 mse_soft=0.284536 ent_in=1.1337 ent_out=0.3115 rowmax_in=0.5087 rowmax_out=0.8758 discrete_mse=1205.508423 best_discrete=23.287207 hash=False elapsed=28.7s
step   350/900 tau=0.2496 loss=0.282722 mse_soft=0.282302 ent_in=1.1297 ent_out=0.2696 rowmax_in=0.5121 rowmax_out=0.8930 discrete_mse=206.364563 best_discrete=23.287207 hash=False elapsed=30.8s
step   375/900 tau=0.2259 loss=0.284699 mse_soft=0.284289 ent_in=1.1272 ent_out=0.2397 rowmax_in=0.5157 rowmax_out=0.9062 discrete_mse=222.405197 best_discrete=23.287207 hash=False elapsed=33.0s
step   400/900 tau=0.2046 loss=0.280374 mse_soft=0.279971 ent_in=1.1242 ent_out=0.2199 rowmax_in=0.5184 rowmax_out=0.9123 discrete_mse=499.575439 best_discrete=23.287207 hash=False elapsed=35.1s
step   425/900 tau=0.1852 loss=0.277721 mse_soft=0.277328 ent_in=1.1072 ent_out=0.2016 rowmax_in=0.5262 rowmax_out=0.9178 discrete_mse=391.181488 best_discrete=23.287207 hash=False elapsed=37.4s
step   450/900 tau=0.1677 loss=0.281147 mse_soft=0.280757 ent_in=1.1031 ent_out=0.1975 rowmax_in=0.5254 rowmax_out=0.9177 discrete_mse=382.855377 best_discrete=23.287207 hash=False elapsed=39.4s
step   475/900 tau=0.1518 loss=0.282283 mse_soft=0.281897 ent_in=1.0948 ent_out=0.1913 rowmax_in=0.5293 rowmax_out=0.9196 discrete_mse=396.917999 best_discrete=23.287207 hash=False elapsed=41.8s
step   500/900 tau=0.1374 loss=0.278509 mse_soft=0.278126 ent_in=1.0943 ent_out=0.1836 rowmax_in=0.5266 rowmax_out=0.9224 discrete_mse=365.015228 best_discrete=23.287207 hash=False elapsed=44.2s
step   525/900 tau=0.1244 loss=0.279964 mse_soft=0.279584 ent_in=1.0869 ent_out=0.1785 rowmax_in=0.5323 rowmax_out=0.9220 discrete_mse=396.917999 best_discrete=23.287207 hash=False elapsed=46.5s
step   550/900 tau=0.1126 loss=0.278761 mse_soft=0.278383 ent_in=1.0891 ent_out=0.1703 rowmax_in=0.5298 rowmax_out=0.9265 discrete_mse=147.723633 best_discrete=23.287207 hash=False elapsed=48.8s
step   575/900 tau=0.1020 loss=0.277955 mse_soft=0.277577 ent_in=1.0888 ent_out=0.1704 rowmax_in=0.5272 rowmax_out=0.9238 discrete_mse=371.293976 best_discrete=23.287207 hash=False elapsed=51.3s
step   600/900 tau=0.0923 loss=0.280220 mse_soft=0.279845 ent_in=1.0836 ent_out=0.1655 rowmax_in=0.5285 rowmax_out=0.9248 discrete_mse=237.194397 best_discrete=23.287207 hash=False elapsed=53.4s
step   625/900 tau=0.0836 loss=0.308518 mse_soft=0.308191 ent_in=0.9450 ent_out=0.1480 rowmax_in=0.5860 rowmax_out=0.9358 discrete_mse=15.399933 best_discrete=15.399933 hash=False elapsed=55.6s
step   650/900 tau=0.0757 loss=0.285544 mse_soft=0.285219 ent_in=0.9203 ent_out=0.1623 rowmax_in=0.5886 rowmax_out=0.9271 discrete_mse=95.857384 best_discrete=15.399933 hash=False elapsed=57.9s
step   675/900 tau=0.0685 loss=0.284251 mse_soft=0.283928 ent_in=0.9217 ent_out=0.1551 rowmax_in=0.5824 rowmax_out=0.9308 discrete_mse=165.300797 best_discrete=15.399933 hash=False elapsed=59.9s
step   700/900 tau=0.0620 loss=0.285073 mse_soft=0.284750 ent_in=0.9195 ent_out=0.1584 rowmax_in=0.5842 rowmax_out=0.9285 discrete_mse=347.244385 best_discrete=15.399933 hash=False elapsed=61.9s
step   725/900 tau=0.0562 loss=0.283714 mse_soft=0.283392 ent_in=0.9102 ent_out=0.1628 rowmax_in=0.5836 rowmax_out=0.9265 discrete_mse=49.949623 best_discrete=15.399933 hash=False elapsed=64.0s
step   750/900 tau=0.0508 loss=0.299302 mse_soft=0.298986 ent_in=0.8854 ent_out=0.1667 rowmax_in=0.6001 rowmax_out=0.9253 discrete_mse=28.316813 best_discrete=15.399933 hash=False elapsed=66.4s
step   775/900 tau=0.0460 loss=0.437213 mse_soft=0.437062 ent_in=0.4674 ent_out=0.0359 rowmax_in=0.7766 rowmax_out=0.9883 discrete_mse=16.325823 best_discrete=15.399933 hash=False elapsed=68.7s
step   800/900 tau=0.0417 loss=0.413440 mse_soft=0.413280 ent_in=0.4700 ent_out=0.0621 rowmax_in=0.7602 rowmax_out=0.9729 discrete_mse=38.069763 best_discrete=15.399933 hash=False elapsed=71.0s
step   825/900 tau=0.0377 loss=0.442794 mse_soft=0.442677 ent_in=0.3758 ent_out=0.0144 rowmax_in=0.8172 rowmax_out=0.9969 discrete_mse=15.112754 best_discrete=15.112754 hash=False elapsed=73.2s
step   850/900 tau=0.0342 loss=0.427550 mse_soft=0.427436 ent_in=0.3624 ent_out=0.0174 rowmax_in=0.8187 rowmax_out=0.9960 discrete_mse=6.339036 best_discrete=6.339036 hash=False elapsed=75.4s
step   875/900 tau=0.0309 loss=0.422793 mse_soft=0.422684 ent_in=0.3464 ent_out=0.0197 rowmax_in=0.8316 rowmax_out=0.9952 discrete_mse=6.339036 best_discrete=6.339036 hash=False elapsed=77.9s
step   900/900 tau=0.0280 loss=0.417922 mse_soft=0.417807 ent_in=0.3459 ent_out=0.0376 rowmax_in=0.8279 rowmax_out=0.9817 discrete_mse=12.020237 best_discrete=6.339036 hash=False elapsed=80.2s

Final metrics:
  soft_mse_full=0.419901
  rowmax_in_mean=0.8297
  rowmax_out_mean=0.9825
  ent_in_mean=0.3440
  ent_out_mean=0.0373
  final_discrete_mse=12.020237
  hash_match=False
  best_discrete_mse_seen=6.339036
Saved results to overnight_b049_j2.json
