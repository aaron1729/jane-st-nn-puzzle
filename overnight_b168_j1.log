Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.061945 mse_soft=1.059622 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=25.385603 best_discrete=25.385603 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.853238 mse_soft=0.851047 ent_in=3.6342 ent_out=3.6686 rowmax_in=0.0461 rowmax_out=0.0442 discrete_mse=3178.181396 best_discrete=25.385603 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.630439 mse_soft=0.628534 ent_in=3.1308 ent_out=3.2178 rowmax_in=0.0915 rowmax_out=0.0887 discrete_mse=4947.071289 best_discrete=25.385603 hash=False elapsed=5.1s
step    75/900 tau=0.7493 loss=0.493136 mse_soft=0.491550 ent_in=2.5963 ent_out=2.6903 rowmax_in=0.2040 rowmax_out=0.1984 discrete_mse=1982.363770 best_discrete=25.385603 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.400533 mse_soft=0.399342 ent_in=2.0177 ent_out=1.9518 rowmax_in=0.3371 rowmax_out=0.3828 discrete_mse=1508.093750 best_discrete=25.385603 hash=False elapsed=9.6s
step   125/900 tau=0.6165 loss=0.344469 mse_soft=0.343604 ent_in=1.6290 ent_out=1.2552 rowmax_in=0.4463 rowmax_out=0.6053 discrete_mse=271.904297 best_discrete=25.385603 hash=False elapsed=12.0s
step   150/900 tau=0.5592 loss=0.321527 mse_soft=0.320812 ent_in=1.4769 ent_out=0.9094 rowmax_in=0.4668 rowmax_out=0.6932 discrete_mse=1155.124634 best_discrete=25.385603 hash=False elapsed=14.3s
step   175/900 tau=0.5073 loss=0.308733 mse_soft=0.308101 ent_in=1.3695 ent_out=0.7375 rowmax_in=0.4777 rowmax_out=0.7356 discrete_mse=689.481506 best_discrete=25.385603 hash=False elapsed=16.9s
step   200/900 tau=0.4602 loss=0.302783 mse_soft=0.302195 ent_in=1.3244 ent_out=0.6352 rowmax_in=0.4830 rowmax_out=0.7648 discrete_mse=776.519592 best_discrete=25.385603 hash=False elapsed=19.4s
step   225/900 tau=0.4174 loss=0.297312 mse_soft=0.296751 ent_in=1.2978 ent_out=0.5700 rowmax_in=0.4827 rowmax_out=0.7816 discrete_mse=694.419067 best_discrete=25.385603 hash=False elapsed=21.6s
step   250/900 tau=0.3786 loss=0.292089 mse_soft=0.291548 ent_in=1.2805 ent_out=0.5239 rowmax_in=0.4792 rowmax_out=0.7878 discrete_mse=698.152588 best_discrete=25.385603 hash=False elapsed=23.8s
step   275/900 tau=0.3434 loss=0.288987 mse_soft=0.288472 ent_in=1.2506 ent_out=0.4648 rowmax_in=0.4839 rowmax_out=0.8057 discrete_mse=593.221619 best_discrete=25.385603 hash=False elapsed=26.1s
step   300/900 tau=0.3115 loss=0.286143 mse_soft=0.285645 ent_in=1.2359 ent_out=0.4243 rowmax_in=0.4855 rowmax_out=0.8196 discrete_mse=495.684998 best_discrete=25.385603 hash=False elapsed=28.4s
step   325/900 tau=0.2826 loss=0.284601 mse_soft=0.284114 ent_in=1.2225 ent_out=0.4005 rowmax_in=0.4878 rowmax_out=0.8260 discrete_mse=533.411987 best_discrete=25.385603 hash=False elapsed=30.6s
step   350/900 tau=0.2563 loss=0.284612 mse_soft=0.284132 ent_in=1.2169 ent_out=0.3808 rowmax_in=0.4873 rowmax_out=0.8346 discrete_mse=495.684998 best_discrete=25.385603 hash=False elapsed=32.8s
step   375/900 tau=0.2325 loss=0.284665 mse_soft=0.284192 ent_in=1.2135 ent_out=0.3635 rowmax_in=0.4847 rowmax_out=0.8421 discrete_mse=564.280884 best_discrete=25.385603 hash=False elapsed=35.0s
step   400/900 tau=0.2109 loss=0.285943 mse_soft=0.285476 ent_in=1.2073 ent_out=0.3495 rowmax_in=0.4844 rowmax_out=0.8477 discrete_mse=564.280884 best_discrete=25.385603 hash=False elapsed=37.3s
step   425/900 tau=0.1913 loss=0.282667 mse_soft=0.282204 ent_in=1.2025 ent_out=0.3433 rowmax_in=0.4856 rowmax_out=0.8488 discrete_mse=56.533005 best_discrete=25.385603 hash=False elapsed=39.7s
step   450/900 tau=0.1735 loss=0.283086 mse_soft=0.282623 ent_in=1.2016 ent_out=0.3397 rowmax_in=0.4848 rowmax_out=0.8487 discrete_mse=72.401260 best_discrete=25.385603 hash=False elapsed=41.7s
step   475/900 tau=0.1574 loss=0.289113 mse_soft=0.288653 ent_in=1.1983 ent_out=0.3351 rowmax_in=0.4860 rowmax_out=0.8497 discrete_mse=58.369843 best_discrete=25.385603 hash=False elapsed=44.0s
step   500/900 tau=0.1428 loss=0.296176 mse_soft=0.295715 ent_in=1.2027 ent_out=0.3355 rowmax_in=0.4809 rowmax_out=0.8482 discrete_mse=72.401260 best_discrete=25.385603 hash=False elapsed=46.2s
step   525/900 tau=0.1295 loss=0.284843 mse_soft=0.284383 ent_in=1.1940 ent_out=0.3368 rowmax_in=0.4837 rowmax_out=0.8482 discrete_mse=43.521336 best_discrete=25.385603 hash=False elapsed=48.5s
step   550/900 tau=0.1175 loss=0.288063 mse_soft=0.287607 ent_in=1.1856 ent_out=0.3359 rowmax_in=0.4881 rowmax_out=0.8494 discrete_mse=18.969122 best_discrete=18.969122 hash=False elapsed=50.8s
step   575/900 tau=0.1066 loss=0.286825 mse_soft=0.286368 ent_in=1.1819 ent_out=0.3413 rowmax_in=0.4894 rowmax_out=0.8474 discrete_mse=432.859680 best_discrete=18.969122 hash=False elapsed=53.3s
step   600/900 tau=0.0967 loss=0.287869 mse_soft=0.287410 ent_in=1.1777 ent_out=0.3527 rowmax_in=0.4900 rowmax_out=0.8403 discrete_mse=26.957787 best_discrete=18.969122 hash=False elapsed=55.6s
step   625/900 tau=0.0877 loss=0.325313 mse_soft=0.324851 ent_in=1.1763 ent_out=0.3618 rowmax_in=0.4890 rowmax_out=0.8337 discrete_mse=205.489594 best_discrete=18.969122 hash=False elapsed=58.3s
step   650/900 tau=0.0795 loss=0.288073 mse_soft=0.287620 ent_in=1.1508 ent_out=0.3592 rowmax_in=0.4996 rowmax_out=0.8333 discrete_mse=162.758377 best_discrete=18.969122 hash=False elapsed=60.6s
step   675/900 tau=0.0722 loss=0.288258 mse_soft=0.287811 ent_in=1.1282 ent_out=0.3599 rowmax_in=0.5108 rowmax_out=0.8282 discrete_mse=546.337585 best_discrete=18.969122 hash=False elapsed=62.7s
step   700/900 tau=0.0655 loss=0.293499 mse_soft=0.293053 ent_in=1.1303 ent_out=0.3541 rowmax_in=0.5119 rowmax_out=0.8296 discrete_mse=231.527588 best_discrete=18.969122 hash=False elapsed=65.1s
step   725/900 tau=0.0594 loss=0.304797 mse_soft=0.304379 ent_in=1.0763 ent_out=0.3177 rowmax_in=0.5328 rowmax_out=0.8529 discrete_mse=95.564812 best_discrete=18.969122 hash=False elapsed=67.3s
step   750/900 tau=0.0539 loss=0.289161 mse_soft=0.288768 ent_in=1.0257 ent_out=0.2856 rowmax_in=0.5442 rowmax_out=0.8649 discrete_mse=175.580444 best_discrete=18.969122 hash=False elapsed=69.5s
step   775/900 tau=0.0489 loss=0.289656 mse_soft=0.289271 ent_in=1.0106 ent_out=0.2719 rowmax_in=0.5436 rowmax_out=0.8651 discrete_mse=163.541107 best_discrete=18.969122 hash=False elapsed=71.9s
step   800/900 tau=0.0443 loss=0.421367 mse_soft=0.421141 ent_in=0.5499 ent_out=0.2035 rowmax_in=0.7447 rowmax_out=0.8762 discrete_mse=50.392185 best_discrete=18.969122 hash=False elapsed=74.0s
step   825/900 tau=0.0402 loss=0.430177 mse_soft=0.430026 ent_in=0.3711 ent_out=0.1318 rowmax_in=0.8277 rowmax_out=0.9133 discrete_mse=7.204502 best_discrete=7.204502 hash=False elapsed=76.2s
step   850/900 tau=0.0365 loss=0.402277 mse_soft=0.402132 ent_in=0.3739 ent_out=0.1100 rowmax_in=0.8033 rowmax_out=0.9198 discrete_mse=43.599834 best_discrete=7.204502 hash=False elapsed=78.4s
step   875/900 tau=0.0331 loss=0.396946 mse_soft=0.396796 ent_in=0.3713 ent_out=0.1269 rowmax_in=0.8056 rowmax_out=0.9111 discrete_mse=52.338718 best_discrete=7.204502 hash=False elapsed=80.7s
step   900/900 tau=0.0300 loss=0.388380 mse_soft=0.388230 ent_in=0.3692 ent_out=0.1309 rowmax_in=0.7979 rowmax_out=0.9085 discrete_mse=12.710889 best_discrete=7.204502 hash=False elapsed=82.8s

Final metrics:
  soft_mse_full=0.402951
  rowmax_in_mean=0.8017
  rowmax_out_mean=0.9085
  ent_in_mean=0.3664
  ent_out_mean=0.1306
  final_discrete_mse=9.833342
  hash_match=False
  best_discrete_mse_seen=7.204502
Saved results to overnight_b168_j1.json
