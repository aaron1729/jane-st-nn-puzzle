Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.051430 mse_soft=1.049108 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=73.093887 best_discrete=73.093887 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.851509 mse_soft=0.849318 ent_in=3.6347 ent_out=3.6682 rowmax_in=0.0471 rowmax_out=0.0443 discrete_mse=414.268402 best_discrete=73.093887 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.641131 mse_soft=0.639224 ent_in=3.1306 ent_out=3.2282 rowmax_in=0.0936 rowmax_out=0.0876 discrete_mse=2218.289551 best_discrete=73.093887 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.501645 mse_soft=0.500066 ent_in=2.5878 ent_out=2.6728 rowmax_in=0.2003 rowmax_out=0.1933 discrete_mse=1107.913818 best_discrete=73.093887 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.394394 mse_soft=0.393244 ent_in=1.9988 ent_out=1.8345 rowmax_in=0.3263 rowmax_out=0.4256 discrete_mse=1106.547974 best_discrete=73.093887 hash=False elapsed=9.5s
step   125/900 tau=0.6165 loss=0.336083 mse_soft=0.335242 ent_in=1.6046 ent_out=1.1998 rowmax_in=0.4118 rowmax_out=0.6094 discrete_mse=1252.452148 best_discrete=73.093887 hash=False elapsed=11.7s
step   150/900 tau=0.5592 loss=0.309365 mse_soft=0.308697 ent_in=1.3995 ent_out=0.8263 rowmax_in=0.4599 rowmax_out=0.7071 discrete_mse=2897.823486 best_discrete=73.093887 hash=False elapsed=14.1s
step   175/900 tau=0.5073 loss=0.296915 mse_soft=0.296334 ent_in=1.3046 ent_out=0.6319 rowmax_in=0.4711 rowmax_out=0.7716 discrete_mse=1349.853149 best_discrete=73.093887 hash=False elapsed=16.5s
step   200/900 tau=0.4602 loss=0.290081 mse_soft=0.289543 ent_in=1.2459 ent_out=0.5468 rowmax_in=0.4755 rowmax_out=0.7886 discrete_mse=1694.877930 best_discrete=73.093887 hash=False elapsed=18.8s
step   225/900 tau=0.4174 loss=0.285454 mse_soft=0.284946 ent_in=1.2069 ent_out=0.4857 rowmax_in=0.4789 rowmax_out=0.7985 discrete_mse=709.051880 best_discrete=73.093887 hash=False elapsed=21.3s
step   250/900 tau=0.3786 loss=0.282521 mse_soft=0.282032 ent_in=1.1798 ent_out=0.4483 rowmax_in=0.4843 rowmax_out=0.8076 discrete_mse=891.944458 best_discrete=73.093887 hash=False elapsed=23.8s
step   275/900 tau=0.3434 loss=0.279475 mse_soft=0.278997 ent_in=1.1785 ent_out=0.4161 rowmax_in=0.4841 rowmax_out=0.8203 discrete_mse=2997.603760 best_discrete=73.093887 hash=False elapsed=26.3s
step   300/900 tau=0.3115 loss=0.275837 mse_soft=0.275366 ent_in=1.1726 ent_out=0.3962 rowmax_in=0.4867 rowmax_out=0.8216 discrete_mse=2893.747070 best_discrete=73.093887 hash=False elapsed=28.6s
step   325/900 tau=0.2826 loss=0.274558 mse_soft=0.274090 ent_in=1.1692 ent_out=0.3889 rowmax_in=0.4864 rowmax_out=0.8242 discrete_mse=1691.609131 best_discrete=73.093887 hash=False elapsed=30.9s
step   350/900 tau=0.2563 loss=0.273049 mse_soft=0.272586 ent_in=1.1666 ent_out=0.3783 rowmax_in=0.4861 rowmax_out=0.8260 discrete_mse=1691.609131 best_discrete=73.093887 hash=False elapsed=33.2s
step   375/900 tau=0.2325 loss=0.272584 mse_soft=0.272127 ent_in=1.1613 ent_out=0.3632 rowmax_in=0.4873 rowmax_out=0.8299 discrete_mse=1758.383301 best_discrete=73.093887 hash=False elapsed=35.4s
step   400/900 tau=0.2109 loss=0.272481 mse_soft=0.272028 ent_in=1.1602 ent_out=0.3504 rowmax_in=0.4850 rowmax_out=0.8335 discrete_mse=1758.383301 best_discrete=73.093887 hash=False elapsed=37.7s
step   425/900 tau=0.1913 loss=0.270894 mse_soft=0.270444 ent_in=1.1555 ent_out=0.3431 rowmax_in=0.4841 rowmax_out=0.8353 discrete_mse=1031.595215 best_discrete=73.093887 hash=False elapsed=39.9s
step   450/900 tau=0.1735 loss=0.276055 mse_soft=0.275608 ent_in=1.1524 ent_out=0.3379 rowmax_in=0.4850 rowmax_out=0.8386 discrete_mse=1758.383301 best_discrete=73.093887 hash=False elapsed=42.5s
step   475/900 tau=0.1574 loss=0.274348 mse_soft=0.273902 ent_in=1.1522 ent_out=0.3350 rowmax_in=0.4857 rowmax_out=0.8407 discrete_mse=1031.595215 best_discrete=73.093887 hash=False elapsed=44.9s
step   500/900 tau=0.1428 loss=0.270981 mse_soft=0.270536 ent_in=1.1500 ent_out=0.3326 rowmax_in=0.4853 rowmax_out=0.8439 discrete_mse=656.115601 best_discrete=73.093887 hash=False elapsed=46.9s
step   525/900 tau=0.1295 loss=0.272591 mse_soft=0.272146 ent_in=1.1506 ent_out=0.3310 rowmax_in=0.4862 rowmax_out=0.8460 discrete_mse=464.340576 best_discrete=73.093887 hash=False elapsed=49.2s
step   550/900 tau=0.1175 loss=0.270232 mse_soft=0.269790 ent_in=1.1475 ent_out=0.3278 rowmax_in=0.4881 rowmax_out=0.8509 discrete_mse=1152.538940 best_discrete=73.093887 hash=False elapsed=51.4s
step   575/900 tau=0.1066 loss=0.274481 mse_soft=0.274043 ent_in=1.1446 ent_out=0.3142 rowmax_in=0.4922 rowmax_out=0.8613 discrete_mse=1106.729614 best_discrete=73.093887 hash=False elapsed=53.9s
step   600/900 tau=0.0967 loss=0.273961 mse_soft=0.273531 ent_in=1.1325 ent_out=0.3007 rowmax_in=0.4903 rowmax_out=0.8638 discrete_mse=924.831360 best_discrete=73.093887 hash=False elapsed=56.2s
step   625/900 tau=0.0877 loss=0.270541 mse_soft=0.270112 ent_in=1.1339 ent_out=0.2941 rowmax_in=0.4830 rowmax_out=0.8653 discrete_mse=1335.704712 best_discrete=73.093887 hash=False elapsed=58.5s
step   650/900 tau=0.0795 loss=0.274254 mse_soft=0.273832 ent_in=1.1137 ent_out=0.2936 rowmax_in=0.4962 rowmax_out=0.8659 discrete_mse=1174.867920 best_discrete=73.093887 hash=False elapsed=60.7s
step   675/900 tau=0.0722 loss=0.274303 mse_soft=0.273888 ent_in=1.1009 ent_out=0.2817 rowmax_in=0.5017 rowmax_out=0.8695 discrete_mse=1425.499390 best_discrete=73.093887 hash=False elapsed=63.0s
step   700/900 tau=0.0655 loss=0.306939 mse_soft=0.306551 ent_in=1.0414 ent_out=0.2523 rowmax_in=0.5188 rowmax_out=0.8778 discrete_mse=194.249863 best_discrete=73.093887 hash=False elapsed=65.4s
step   725/900 tau=0.0594 loss=0.297936 mse_soft=0.297566 ent_in=0.9916 ent_out=0.2420 rowmax_in=0.5237 rowmax_out=0.8780 discrete_mse=208.777191 best_discrete=73.093887 hash=False elapsed=67.7s
step   750/900 tau=0.0539 loss=0.399127 mse_soft=0.398856 ent_in=0.6783 ent_out=0.2261 rowmax_in=0.6592 rowmax_out=0.8845 discrete_mse=349.781769 best_discrete=73.093887 hash=False elapsed=69.9s
step   775/900 tau=0.0489 loss=0.329591 mse_soft=0.329320 ent_in=0.7023 ent_out=0.2024 rowmax_in=0.6281 rowmax_out=0.8959 discrete_mse=516.657654 best_discrete=73.093887 hash=False elapsed=72.2s
step   800/900 tau=0.0443 loss=0.321344 mse_soft=0.321079 ent_in=0.6990 ent_out=0.1861 rowmax_in=0.6321 rowmax_out=0.9051 discrete_mse=284.034546 best_discrete=73.093887 hash=False elapsed=74.3s
step   825/900 tau=0.0402 loss=0.315387 mse_soft=0.315110 ent_in=0.7173 ent_out=0.2048 rowmax_in=0.6241 rowmax_out=0.8965 discrete_mse=492.341797 best_discrete=73.093887 hash=False elapsed=76.5s
step   850/900 tau=0.0365 loss=0.378080 mse_soft=0.377823 ent_in=0.6723 ent_out=0.1851 rowmax_in=0.6544 rowmax_out=0.9050 discrete_mse=1034.023926 best_discrete=73.093887 hash=False elapsed=78.7s
step   875/900 tau=0.0331 loss=0.607521 mse_soft=0.607369 ent_in=0.3569 ent_out=0.1496 rowmax_in=0.8351 rowmax_out=0.9241 discrete_mse=49.615398 best_discrete=49.615398 hash=False elapsed=80.9s
step   900/900 tau=0.0300 loss=0.508362 mse_soft=0.508230 ent_in=0.3017 ent_out=0.1397 rowmax_in=0.8437 rowmax_out=0.9201 discrete_mse=71.487885 best_discrete=49.615398 hash=False elapsed=83.3s

Final metrics:
  soft_mse_full=0.514994
  rowmax_in_mean=0.8431
  rowmax_out_mean=0.9212
  ent_in_mean=0.3037
  ent_out_mean=0.1360
  final_discrete_mse=35.609550
  hash_match=False
  best_discrete_mse_seen=49.615398
Saved results to overnight_b217_j1.json
