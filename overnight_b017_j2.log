Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.041218 mse_soft=1.038895 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=46.194557 best_discrete=46.194557 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.846392 mse_soft=0.844203 ent_in=3.6330 ent_out=3.6655 rowmax_in=0.0450 rowmax_out=0.0451 discrete_mse=2167.774658 best_discrete=46.194557 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.644770 mse_soft=0.642856 ent_in=3.1425 ent_out=3.2356 rowmax_in=0.0889 rowmax_out=0.0886 discrete_mse=261.642578 best_discrete=46.194557 hash=False elapsed=5.0s
step    75/900 tau=0.7450 loss=0.494658 mse_soft=0.493088 ent_in=2.5866 ent_out=2.6486 rowmax_in=0.1968 rowmax_out=0.2074 discrete_mse=2346.092285 best_discrete=46.194557 hash=False elapsed=7.3s
step   100/900 tau=0.6745 loss=0.391144 mse_soft=0.389970 ent_in=2.0129 ent_out=1.9010 rowmax_in=0.3428 rowmax_out=0.4038 discrete_mse=966.293762 best_discrete=46.194557 hash=False elapsed=9.6s
step   125/900 tau=0.6107 loss=0.337353 mse_soft=0.336465 ent_in=1.6206 ent_out=1.3388 rowmax_in=0.4383 rowmax_out=0.5575 discrete_mse=185.524948 best_discrete=46.194557 hash=False elapsed=11.9s
step   150/900 tau=0.5529 loss=0.309381 mse_soft=0.308649 ent_in=1.4307 ent_out=1.0114 rowmax_in=0.4926 rowmax_out=0.6402 discrete_mse=474.345245 best_discrete=46.194557 hash=False elapsed=14.1s
step   175/900 tau=0.5006 loss=0.294271 mse_soft=0.293636 ent_in=1.2985 ent_out=0.8176 rowmax_in=0.5249 rowmax_out=0.6921 discrete_mse=932.790405 best_discrete=46.194557 hash=False elapsed=16.4s
step   200/900 tau=0.4532 loss=0.283930 mse_soft=0.283354 ent_in=1.2234 ent_out=0.6945 rowmax_in=0.5406 rowmax_out=0.7326 discrete_mse=23.976305 best_discrete=23.976305 hash=False elapsed=18.5s
step   225/900 tau=0.4103 loss=0.276767 mse_soft=0.276233 ent_in=1.1606 ent_out=0.6193 rowmax_in=0.5462 rowmax_out=0.7498 discrete_mse=146.724991 best_discrete=23.976305 hash=False elapsed=20.7s
step   250/900 tau=0.3715 loss=0.273304 mse_soft=0.272796 ent_in=1.1227 ent_out=0.5697 rowmax_in=0.5496 rowmax_out=0.7587 discrete_mse=65.630074 best_discrete=23.976305 hash=False elapsed=22.9s
step   275/900 tau=0.3363 loss=0.271966 mse_soft=0.271473 ent_in=1.0972 ent_out=0.5457 rowmax_in=0.5539 rowmax_out=0.7585 discrete_mse=71.052841 best_discrete=23.976305 hash=False elapsed=25.0s
step   300/900 tau=0.3045 loss=0.272116 mse_soft=0.271636 ent_in=1.0784 ent_out=0.5218 rowmax_in=0.5566 rowmax_out=0.7621 discrete_mse=71.052841 best_discrete=23.976305 hash=False elapsed=27.1s
step   325/900 tau=0.2756 loss=0.271745 mse_soft=0.271274 ent_in=1.0621 ent_out=0.5066 rowmax_in=0.5590 rowmax_out=0.7641 discrete_mse=160.338516 best_discrete=23.976305 hash=False elapsed=29.2s
step   350/900 tau=0.2496 loss=0.268996 mse_soft=0.268535 ent_in=1.0504 ent_out=0.4870 rowmax_in=0.5596 rowmax_out=0.7736 discrete_mse=139.525055 best_discrete=23.976305 hash=False elapsed=31.5s
step   375/900 tau=0.2259 loss=0.269587 mse_soft=0.269132 ent_in=1.0392 ent_out=0.4772 rowmax_in=0.5635 rowmax_out=0.7754 discrete_mse=139.525055 best_discrete=23.976305 hash=False elapsed=33.6s
step   400/900 tau=0.2046 loss=0.267740 mse_soft=0.267290 ent_in=1.0302 ent_out=0.4693 rowmax_in=0.5654 rowmax_out=0.7787 discrete_mse=139.525055 best_discrete=23.976305 hash=False elapsed=36.1s
step   425/900 tau=0.1852 loss=0.271549 mse_soft=0.271106 ent_in=1.0185 ent_out=0.4610 rowmax_in=0.5689 rowmax_out=0.7818 discrete_mse=190.886246 best_discrete=23.976305 hash=False elapsed=38.1s
step   450/900 tau=0.1677 loss=0.266431 mse_soft=0.265991 ent_in=1.0105 ent_out=0.4566 rowmax_in=0.5697 rowmax_out=0.7813 discrete_mse=104.561882 best_discrete=23.976305 hash=False elapsed=40.0s
step   475/900 tau=0.1518 loss=0.273172 mse_soft=0.272736 ent_in=1.0007 ent_out=0.4500 rowmax_in=0.5722 rowmax_out=0.7840 discrete_mse=64.122795 best_discrete=23.976305 hash=False elapsed=42.0s
step   500/900 tau=0.1374 loss=0.270569 mse_soft=0.270136 ent_in=0.9959 ent_out=0.4483 rowmax_in=0.5730 rowmax_out=0.7815 discrete_mse=64.122795 best_discrete=23.976305 hash=False elapsed=44.0s
step   525/900 tau=0.1244 loss=0.277704 mse_soft=0.277274 ent_in=0.9905 ent_out=0.4421 rowmax_in=0.5772 rowmax_out=0.7835 discrete_mse=71.399422 best_discrete=23.976305 hash=False elapsed=46.0s
step   550/900 tau=0.1126 loss=0.283433 mse_soft=0.283002 ent_in=0.9894 ent_out=0.4481 rowmax_in=0.5763 rowmax_out=0.7755 discrete_mse=44.750351 best_discrete=23.976305 hash=False elapsed=48.0s
step   575/900 tau=0.1020 loss=0.276013 mse_soft=0.275590 ent_in=0.9745 ent_out=0.4352 rowmax_in=0.5855 rowmax_out=0.7851 discrete_mse=63.403049 best_discrete=23.976305 hash=False elapsed=50.1s
step   600/900 tau=0.0923 loss=0.272080 mse_soft=0.271659 ent_in=0.9673 ent_out=0.4349 rowmax_in=0.5831 rowmax_out=0.7838 discrete_mse=105.152382 best_discrete=23.976305 hash=False elapsed=52.1s
step   625/900 tau=0.0836 loss=0.277963 mse_soft=0.277550 ent_in=0.9515 ent_out=0.4240 rowmax_in=0.5894 rowmax_out=0.7884 discrete_mse=136.435501 best_discrete=23.976305 hash=False elapsed=54.2s
step   650/900 tau=0.0757 loss=0.274228 mse_soft=0.273816 ent_in=0.9486 ent_out=0.4226 rowmax_in=0.5898 rowmax_out=0.7875 discrete_mse=136.435501 best_discrete=23.976305 hash=False elapsed=56.3s
step   675/900 tau=0.0685 loss=0.342869 mse_soft=0.342513 ent_in=0.8207 ent_out=0.3649 rowmax_in=0.6579 rowmax_out=0.8184 discrete_mse=7.155395 best_discrete=7.155395 hash=False elapsed=58.5s
step   700/900 tau=0.0620 loss=0.289861 mse_soft=0.289508 ent_in=0.7940 ent_out=0.3854 rowmax_in=0.6457 rowmax_out=0.8034 discrete_mse=66.874748 best_discrete=7.155395 hash=False elapsed=60.6s
step   725/900 tau=0.0562 loss=0.283720 mse_soft=0.283370 ent_in=0.7768 ent_out=0.3903 rowmax_in=0.6482 rowmax_out=0.8002 discrete_mse=148.042664 best_discrete=7.155395 hash=False elapsed=62.8s
step   750/900 tau=0.0508 loss=0.285344 mse_soft=0.284992 ent_in=0.7787 ent_out=0.3956 rowmax_in=0.6415 rowmax_out=0.8010 discrete_mse=108.623398 best_discrete=7.155395 hash=False elapsed=65.0s
step   775/900 tau=0.0460 loss=0.375044 mse_soft=0.374803 ent_in=0.5361 ent_out=0.2672 rowmax_in=0.7493 rowmax_out=0.8563 discrete_mse=12.473050 best_discrete=7.155395 hash=False elapsed=67.3s
step   800/900 tau=0.0417 loss=0.337840 mse_soft=0.337600 ent_in=0.5374 ent_out=0.2618 rowmax_in=0.7408 rowmax_out=0.8548 discrete_mse=6.735217 best_discrete=6.735217 hash=False elapsed=69.5s
step   825/900 tau=0.0377 loss=0.348627 mse_soft=0.348405 ent_in=0.4835 ent_out=0.2587 rowmax_in=0.7716 rowmax_out=0.8712 discrete_mse=29.362452 best_discrete=6.735217 hash=False elapsed=71.7s
step   850/900 tau=0.0342 loss=0.330391 mse_soft=0.330143 ent_in=0.5395 ent_out=0.2842 rowmax_in=0.7446 rowmax_out=0.8408 discrete_mse=104.429840 best_discrete=6.735217 hash=False elapsed=73.8s
step   875/900 tau=0.0309 loss=0.332104 mse_soft=0.331856 ent_in=0.5509 ent_out=0.2780 rowmax_in=0.7293 rowmax_out=0.8412 discrete_mse=41.651775 best_discrete=6.735217 hash=False elapsed=76.1s
step   900/900 tau=0.0280 loss=0.326469 mse_soft=0.326221 ent_in=0.5489 ent_out=0.2791 rowmax_in=0.7318 rowmax_out=0.8403 discrete_mse=193.606750 best_discrete=6.735217 hash=False elapsed=78.3s

Final metrics:
  soft_mse_full=0.335180
  rowmax_in_mean=0.7260
  rowmax_out_mean=0.8396
  ent_in_mean=0.5546
  ent_out_mean=0.2801
  final_discrete_mse=193.606750
  hash_match=False
  best_discrete_mse_seen=6.735217
Saved results to overnight_b017_j2.json
