Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.035335 mse_soft=1.033012 ent_in=3.8712 ent_out=3.8711 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=76.089050 best_discrete=76.089050 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.839879 mse_soft=0.837688 ent_in=3.6356 ent_out=3.6680 rowmax_in=0.0462 rowmax_out=0.0444 discrete_mse=4274.417969 best_discrete=76.089050 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.638647 mse_soft=0.636735 ent_in=3.1421 ent_out=3.2323 rowmax_in=0.0913 rowmax_out=0.0894 discrete_mse=776.255798 best_discrete=76.089050 hash=False elapsed=5.1s
step    75/900 tau=0.7450 loss=0.496322 mse_soft=0.494751 ent_in=2.5986 ent_out=2.6382 rowmax_in=0.2021 rowmax_out=0.2103 discrete_mse=2486.285889 best_discrete=76.089050 hash=False elapsed=7.3s
step   100/900 tau=0.6745 loss=0.392173 mse_soft=0.391018 ent_in=1.9778 ent_out=1.8701 rowmax_in=0.3566 rowmax_out=0.4017 discrete_mse=1125.293823 best_discrete=76.089050 hash=False elapsed=9.6s
step   125/900 tau=0.6107 loss=0.334935 mse_soft=0.334103 ent_in=1.5943 ent_out=1.1802 rowmax_in=0.4236 rowmax_out=0.5829 discrete_mse=2116.384277 best_discrete=76.089050 hash=False elapsed=12.0s
step   150/900 tau=0.5529 loss=0.313431 mse_soft=0.312726 ent_in=1.4390 ent_out=0.9097 rowmax_in=0.4495 rowmax_out=0.6449 discrete_mse=6916.811035 best_discrete=76.089050 hash=False elapsed=14.5s
step   175/900 tau=0.5006 loss=0.300347 mse_soft=0.299713 ent_in=1.3136 ent_out=0.8002 rowmax_in=0.4786 rowmax_out=0.6698 discrete_mse=458.249786 best_discrete=76.089050 hash=False elapsed=16.8s
step   200/900 tau=0.4532 loss=0.289458 mse_soft=0.288867 ent_in=1.2613 ent_out=0.7087 rowmax_in=0.4787 rowmax_out=0.7033 discrete_mse=217.062027 best_discrete=76.089050 hash=False elapsed=19.2s
step   225/900 tau=0.4103 loss=0.281526 mse_soft=0.280968 ent_in=1.2187 ent_out=0.6396 rowmax_in=0.4842 rowmax_out=0.7295 discrete_mse=341.502747 best_discrete=76.089050 hash=False elapsed=21.6s
step   250/900 tau=0.3715 loss=0.275809 mse_soft=0.275276 ent_in=1.1864 ent_out=0.5930 rowmax_in=0.4906 rowmax_out=0.7371 discrete_mse=211.952744 best_discrete=76.089050 hash=False elapsed=24.0s
step   275/900 tau=0.3363 loss=0.273322 mse_soft=0.272801 ent_in=1.1680 ent_out=0.5705 rowmax_in=0.4924 rowmax_out=0.7418 discrete_mse=30.674788 best_discrete=30.674788 hash=False elapsed=26.4s
step   300/900 tau=0.3045 loss=0.270525 mse_soft=0.270018 ent_in=1.1498 ent_out=0.5383 rowmax_in=0.4942 rowmax_out=0.7504 discrete_mse=67.900864 best_discrete=30.674788 hash=False elapsed=28.7s
step   325/900 tau=0.2756 loss=0.267493 mse_soft=0.267010 ent_in=1.1178 ent_out=0.4917 rowmax_in=0.5079 rowmax_out=0.7690 discrete_mse=456.088379 best_discrete=30.674788 hash=False elapsed=30.9s
step   350/900 tau=0.2496 loss=0.265414 mse_soft=0.264948 ent_in=1.0940 ent_out=0.4588 rowmax_in=0.5152 rowmax_out=0.7799 discrete_mse=101.982407 best_discrete=30.674788 hash=False elapsed=33.0s
step   375/900 tau=0.2259 loss=0.264726 mse_soft=0.264271 ent_in=1.0804 ent_out=0.4368 rowmax_in=0.5189 rowmax_out=0.7857 discrete_mse=101.705444 best_discrete=30.674788 hash=False elapsed=35.3s
step   400/900 tau=0.2046 loss=0.266399 mse_soft=0.265951 ent_in=1.0708 ent_out=0.4208 rowmax_in=0.5243 rowmax_out=0.7916 discrete_mse=660.729370 best_discrete=30.674788 hash=False elapsed=37.6s
step   425/900 tau=0.1852 loss=0.264850 mse_soft=0.264413 ent_in=1.0541 ent_out=0.4029 rowmax_in=0.5295 rowmax_out=0.7995 discrete_mse=483.432434 best_discrete=30.674788 hash=False elapsed=40.3s
step   450/900 tau=0.1677 loss=0.263076 mse_soft=0.262645 ent_in=1.0495 ent_out=0.3874 rowmax_in=0.5292 rowmax_out=0.8076 discrete_mse=520.207520 best_discrete=30.674788 hash=False elapsed=42.5s
step   475/900 tau=0.1518 loss=0.265889 mse_soft=0.265461 ent_in=1.0438 ent_out=0.3807 rowmax_in=0.5319 rowmax_out=0.8076 discrete_mse=1630.411377 best_discrete=30.674788 hash=False elapsed=44.6s
step   500/900 tau=0.1374 loss=0.263974 mse_soft=0.263548 ent_in=1.0448 ent_out=0.3753 rowmax_in=0.5295 rowmax_out=0.8092 discrete_mse=2968.948242 best_discrete=30.674788 hash=False elapsed=46.9s
step   525/900 tau=0.1244 loss=0.262764 mse_soft=0.262342 ent_in=1.0389 ent_out=0.3694 rowmax_in=0.5336 rowmax_out=0.8107 discrete_mse=1630.411377 best_discrete=30.674788 hash=False elapsed=49.3s
step   550/900 tau=0.1126 loss=0.268561 mse_soft=0.268142 ent_in=1.0340 ent_out=0.3631 rowmax_in=0.5358 rowmax_out=0.8123 discrete_mse=708.925171 best_discrete=30.674788 hash=False elapsed=51.5s
step   575/900 tau=0.1020 loss=0.263820 mse_soft=0.263401 ent_in=1.0358 ent_out=0.3586 rowmax_in=0.5333 rowmax_out=0.8145 discrete_mse=545.011475 best_discrete=30.674788 hash=False elapsed=53.5s
step   600/900 tau=0.0923 loss=0.289108 mse_soft=0.288710 ent_in=0.9940 ent_out=0.3329 rowmax_in=0.5490 rowmax_out=0.8288 discrete_mse=364.419403 best_discrete=30.674788 hash=False elapsed=55.5s
step   625/900 tau=0.0836 loss=0.271532 mse_soft=0.271138 ent_in=0.9910 ent_out=0.3204 rowmax_in=0.5426 rowmax_out=0.8341 discrete_mse=336.791138 best_discrete=30.674788 hash=False elapsed=57.7s
step   650/900 tau=0.0757 loss=0.274050 mse_soft=0.273661 ent_in=0.9707 ent_out=0.3242 rowmax_in=0.5480 rowmax_out=0.8348 discrete_mse=336.791138 best_discrete=30.674788 hash=False elapsed=59.9s
step   675/900 tau=0.0685 loss=0.286606 mse_soft=0.286229 ent_in=0.9507 ent_out=0.3054 rowmax_in=0.5529 rowmax_out=0.8518 discrete_mse=126.142723 best_discrete=30.674788 hash=False elapsed=62.2s
step   700/900 tau=0.0620 loss=0.300421 mse_soft=0.300061 ent_in=0.8996 ent_out=0.2992 rowmax_in=0.5719 rowmax_out=0.8396 discrete_mse=430.241547 best_discrete=30.674788 hash=False elapsed=64.5s
step   725/900 tau=0.0562 loss=0.408925 mse_soft=0.408666 ent_in=0.6320 ent_out=0.2302 rowmax_in=0.6903 rowmax_out=0.8882 discrete_mse=81.946945 best_discrete=30.674788 hash=False elapsed=66.8s
step   750/900 tau=0.0508 loss=0.401749 mse_soft=0.401515 ent_in=0.5600 ent_out=0.2214 rowmax_in=0.6827 rowmax_out=0.8916 discrete_mse=0.795924 best_discrete=0.795924 hash=False elapsed=69.1s
step   775/900 tau=0.0460 loss=0.400245 mse_soft=0.400039 ent_in=0.4603 ent_out=0.2262 rowmax_in=0.7749 rowmax_out=0.8836 discrete_mse=58.103397 best_discrete=0.795924 hash=False elapsed=71.3s
step   800/900 tau=0.0417 loss=0.359839 mse_soft=0.359635 ent_in=0.4673 ent_out=0.2122 rowmax_in=0.7516 rowmax_out=0.8879 discrete_mse=7.675954 best_discrete=0.795924 hash=False elapsed=73.5s
step   825/900 tau=0.0377 loss=0.354396 mse_soft=0.354191 ent_in=0.4643 ent_out=0.2162 rowmax_in=0.7476 rowmax_out=0.8864 discrete_mse=11.740812 best_discrete=0.795924 hash=False elapsed=75.7s
step   850/900 tau=0.0342 loss=0.357537 mse_soft=0.357332 ent_in=0.4685 ent_out=0.2165 rowmax_in=0.7445 rowmax_out=0.8850 discrete_mse=5.862980 best_discrete=0.795924 hash=False elapsed=77.7s
step   875/900 tau=0.0309 loss=0.356191 mse_soft=0.355982 ent_in=0.4782 ent_out=0.2185 rowmax_in=0.7368 rowmax_out=0.8843 discrete_mse=11.740812 best_discrete=0.795924 hash=False elapsed=79.7s
step   900/900 tau=0.0280 loss=0.390157 mse_soft=0.389949 ent_in=0.4719 ent_out=0.2206 rowmax_in=0.7471 rowmax_out=0.8823 discrete_mse=11.793868 best_discrete=0.795924 hash=False elapsed=82.1s

Final metrics:
  soft_mse_full=0.378121
  rowmax_in_mean=0.7510
  rowmax_out_mean=0.8819
  ent_in_mean=0.4653
  ent_out_mean=0.2210
  final_discrete_mse=4.024015
  hash_match=False
  best_discrete_mse_seen=0.795924
Saved results to overnight_b033_j2.json
