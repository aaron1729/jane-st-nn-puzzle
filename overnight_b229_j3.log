Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.02
step     1/700 tau=1.0000 loss=1.065763 mse_soft=1.063440 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=50.302216 best_discrete=50.302216 hash=False elapsed=0.5s
step    25/700 tau=0.8866 loss=0.935125 mse_soft=0.932873 ent_in=3.7424 ent_out=3.7623 rowmax_in=0.0369 rowmax_out=0.0364 discrete_mse=514.128357 best_discrete=50.302216 hash=False elapsed=2.6s
step    50/700 tau=0.7821 loss=0.712013 mse_soft=0.709978 ent_in=3.3631 ent_out=3.4227 rowmax_in=0.0694 rowmax_out=0.0660 discrete_mse=7638.258789 best_discrete=50.302216 hash=False elapsed=4.8s
step    75/700 tau=0.6899 loss=0.591776 mse_soft=0.589970 ent_in=2.9577 ent_out=3.0626 rowmax_in=0.1314 rowmax_out=0.1213 discrete_mse=1033.496338 best_discrete=50.302216 hash=False elapsed=7.0s
step   100/700 tau=0.6086 loss=0.472901 mse_soft=0.471446 ent_in=2.4193 ent_out=2.4324 rowmax_in=0.2625 rowmax_out=0.2524 discrete_mse=5776.456543 best_discrete=50.302216 hash=False elapsed=9.3s
step   125/700 tau=0.5368 loss=0.389048 mse_soft=0.387967 ent_in=1.8698 ent_out=1.7326 rowmax_in=0.3949 rowmax_out=0.4435 discrete_mse=3051.996338 best_discrete=50.302216 hash=False elapsed=11.4s
step   150/700 tau=0.4736 loss=0.347480 mse_soft=0.346660 ent_in=1.5574 ent_out=1.1741 rowmax_in=0.4464 rowmax_out=0.6077 discrete_mse=115.574944 best_discrete=50.302216 hash=False elapsed=13.5s
step   175/700 tau=0.4177 loss=0.322082 mse_soft=0.321400 ent_in=1.3988 ent_out=0.8730 rowmax_in=0.4745 rowmax_out=0.6902 discrete_mse=279.181946 best_discrete=50.302216 hash=False elapsed=15.8s
step   200/700 tau=0.3685 loss=0.306017 mse_soft=0.305428 ent_in=1.3035 ent_out=0.6592 rowmax_in=0.4906 rowmax_out=0.7288 discrete_mse=1087.341431 best_discrete=50.302216 hash=False elapsed=18.1s
step   225/700 tau=0.3251 loss=0.299088 mse_soft=0.298543 ent_in=1.2446 ent_out=0.5712 rowmax_in=0.4940 rowmax_out=0.7493 discrete_mse=2385.150635 best_discrete=50.302216 hash=False elapsed=20.7s
step   250/700 tau=0.2868 loss=0.295390 mse_soft=0.294867 ent_in=1.2013 ent_out=0.5426 rowmax_in=0.5002 rowmax_out=0.7504 discrete_mse=1417.453125 best_discrete=50.302216 hash=False elapsed=23.1s
step   275/700 tau=0.2530 loss=0.292226 mse_soft=0.291724 ent_in=1.1723 ent_out=0.4984 rowmax_in=0.5019 rowmax_out=0.7669 discrete_mse=1283.185547 best_discrete=50.302216 hash=False elapsed=25.3s
step   300/700 tau=0.2231 loss=0.290560 mse_soft=0.290067 ent_in=1.1590 ent_out=0.4838 rowmax_in=0.5022 rowmax_out=0.7735 discrete_mse=2177.939453 best_discrete=50.302216 hash=False elapsed=27.7s
step   325/700 tau=0.1968 loss=0.288909 mse_soft=0.288421 ent_in=1.1498 ent_out=0.4767 rowmax_in=0.5041 rowmax_out=0.7746 discrete_mse=2177.939453 best_discrete=50.302216 hash=False elapsed=29.9s
step   350/700 tau=0.1736 loss=0.290569 mse_soft=0.290086 ent_in=1.1452 ent_out=0.4644 rowmax_in=0.5037 rowmax_out=0.7783 discrete_mse=2398.480713 best_discrete=50.302216 hash=False elapsed=32.1s
step   375/700 tau=0.1532 loss=0.289383 mse_soft=0.288906 ent_in=1.1356 ent_out=0.4561 rowmax_in=0.5071 rowmax_out=0.7813 discrete_mse=1309.712646 best_discrete=50.302216 hash=False elapsed=34.7s
step   400/700 tau=0.1351 loss=0.289185 mse_soft=0.288713 ent_in=1.1250 ent_out=0.4496 rowmax_in=0.5105 rowmax_out=0.7869 discrete_mse=1309.712646 best_discrete=50.302216 hash=False elapsed=37.0s
step   425/700 tau=0.1192 loss=0.291467 mse_soft=0.290998 ent_in=1.1170 ent_out=0.4464 rowmax_in=0.5124 rowmax_out=0.7898 discrete_mse=1009.326782 best_discrete=50.302216 hash=False elapsed=39.3s
step   450/700 tau=0.1051 loss=0.290369 mse_soft=0.289903 ent_in=1.1081 ent_out=0.4446 rowmax_in=0.5138 rowmax_out=0.7904 discrete_mse=1009.326782 best_discrete=50.302216 hash=False elapsed=41.5s
step   475/700 tau=0.0928 loss=0.293831 mse_soft=0.293368 ent_in=1.1063 ent_out=0.4373 rowmax_in=0.5105 rowmax_out=0.7888 discrete_mse=618.450806 best_discrete=50.302216 hash=False elapsed=43.6s
step   500/700 tau=0.0818 loss=0.293568 mse_soft=0.293107 ent_in=1.1027 ent_out=0.4339 rowmax_in=0.5103 rowmax_out=0.7903 discrete_mse=1009.326782 best_discrete=50.302216 hash=False elapsed=45.9s
step   525/700 tau=0.0722 loss=0.299006 mse_soft=0.298557 ent_in=1.0788 ent_out=0.4178 rowmax_in=0.5187 rowmax_out=0.8007 discrete_mse=129.915390 best_discrete=50.302216 hash=False elapsed=47.7s
step   550/700 tau=0.0637 loss=0.291387 mse_soft=0.290947 ent_in=1.0494 ent_out=0.4143 rowmax_in=0.5277 rowmax_out=0.7860 discrete_mse=317.225128 best_discrete=50.302216 hash=False elapsed=49.9s
step   575/700 tau=0.0562 loss=0.320154 mse_soft=0.319773 ent_in=0.9286 ent_out=0.3421 rowmax_in=0.5824 rowmax_out=0.8200 discrete_mse=241.184326 best_discrete=50.302216 hash=False elapsed=52.0s
step   600/700 tau=0.0495 loss=0.305777 mse_soft=0.305397 ent_in=0.9220 ent_out=0.3445 rowmax_in=0.5744 rowmax_out=0.8115 discrete_mse=202.535522 best_discrete=50.302216 hash=False elapsed=54.3s
step   625/700 tau=0.0437 loss=0.328742 mse_soft=0.328399 ent_in=0.8494 ent_out=0.2932 rowmax_in=0.5990 rowmax_out=0.8537 discrete_mse=38.584156 best_discrete=38.584156 hash=False elapsed=56.5s
step   650/700 tau=0.0386 loss=0.343182 mse_soft=0.342855 ent_in=0.7986 ent_out=0.2910 rowmax_in=0.6315 rowmax_out=0.8512 discrete_mse=5.215265 best_discrete=5.215265 hash=False elapsed=58.7s
step   675/700 tau=0.0340 loss=0.396696 mse_soft=0.396453 ent_in=0.6245 ent_out=0.1858 rowmax_in=0.7108 rowmax_out=0.9132 discrete_mse=28.366375 best_discrete=5.215265 hash=False elapsed=60.9s
step   700/700 tau=0.0300 loss=0.356510 mse_soft=0.356259 ent_in=0.6353 ent_out=0.2004 rowmax_in=0.6882 rowmax_out=0.8959 discrete_mse=26.610023 best_discrete=5.215265 hash=False elapsed=63.3s

Final metrics:
  soft_mse_full=0.356170
  rowmax_in_mean=0.6832
  rowmax_out_mean=0.8970
  ent_in_mean=0.6373
  ent_out_mean=0.2003
  final_discrete_mse=26.610023
  hash_match=False
  best_discrete_mse_seen=5.215265
Saved results to overnight_b229_j3.json
