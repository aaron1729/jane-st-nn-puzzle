Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.041525 mse_soft=1.039202 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=24.314644 best_discrete=24.314644 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.845741 mse_soft=0.843551 ent_in=3.6334 ent_out=3.6659 rowmax_in=0.0454 rowmax_out=0.0443 discrete_mse=2481.279053 best_discrete=24.314644 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.642706 mse_soft=0.640794 ent_in=3.1389 ent_out=3.2343 rowmax_in=0.0927 rowmax_out=0.0868 discrete_mse=1557.211304 best_discrete=24.314644 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.510160 mse_soft=0.508566 ent_in=2.6287 ent_out=2.6854 rowmax_in=0.1969 rowmax_out=0.1991 discrete_mse=598.000610 best_discrete=24.314644 hash=False elapsed=7.1s
step   100/900 tau=0.6797 loss=0.405907 mse_soft=0.404734 ent_in=2.0497 ent_out=1.8596 rowmax_in=0.3380 rowmax_out=0.4196 discrete_mse=670.577698 best_discrete=24.314644 hash=False elapsed=9.2s
step   125/900 tau=0.6165 loss=0.345254 mse_soft=0.344411 ent_in=1.5993 ent_out=1.2118 rowmax_in=0.4360 rowmax_out=0.5939 discrete_mse=132.542252 best_discrete=24.314644 hash=False elapsed=11.3s
step   150/900 tau=0.5592 loss=0.310515 mse_soft=0.309867 ent_in=1.3399 ent_out=0.8204 rowmax_in=0.4993 rowmax_out=0.7053 discrete_mse=331.611786 best_discrete=24.314644 hash=False elapsed=13.6s
step   175/900 tau=0.5073 loss=0.295092 mse_soft=0.294540 ent_in=1.2142 ent_out=0.6275 rowmax_in=0.5239 rowmax_out=0.7607 discrete_mse=254.323837 best_discrete=24.314644 hash=False elapsed=15.6s
step   200/900 tau=0.4602 loss=0.286031 mse_soft=0.285519 ent_in=1.1800 ent_out=0.5280 rowmax_in=0.5206 rowmax_out=0.7864 discrete_mse=530.654419 best_discrete=24.314644 hash=False elapsed=17.8s
step   225/900 tau=0.4174 loss=0.281373 mse_soft=0.280881 ent_in=1.1674 ent_out=0.4724 rowmax_in=0.5193 rowmax_out=0.7998 discrete_mse=552.708069 best_discrete=24.314644 hash=False elapsed=20.0s
step   250/900 tau=0.3786 loss=0.278577 mse_soft=0.278096 ent_in=1.1604 ent_out=0.4430 rowmax_in=0.5174 rowmax_out=0.8093 discrete_mse=510.540802 best_discrete=24.314644 hash=False elapsed=22.0s
step   275/900 tau=0.3434 loss=0.275949 mse_soft=0.275480 ent_in=1.1470 ent_out=0.4158 rowmax_in=0.5191 rowmax_out=0.8179 discrete_mse=278.748138 best_discrete=24.314644 hash=False elapsed=23.8s
step   300/900 tau=0.3115 loss=0.273294 mse_soft=0.272836 ent_in=1.1316 ent_out=0.3936 rowmax_in=0.5209 rowmax_out=0.8243 discrete_mse=248.697937 best_discrete=24.314644 hash=False elapsed=25.7s
step   325/900 tau=0.2826 loss=0.272280 mse_soft=0.271829 ent_in=1.1227 ent_out=0.3784 rowmax_in=0.5186 rowmax_out=0.8273 discrete_mse=248.697937 best_discrete=24.314644 hash=False elapsed=27.6s
step   350/900 tau=0.2563 loss=0.271830 mse_soft=0.271385 ent_in=1.1152 ent_out=0.3670 rowmax_in=0.5187 rowmax_out=0.8319 discrete_mse=248.697937 best_discrete=24.314644 hash=False elapsed=29.8s
step   375/900 tau=0.2325 loss=0.273008 mse_soft=0.272566 ent_in=1.1112 ent_out=0.3621 rowmax_in=0.5195 rowmax_out=0.8323 discrete_mse=248.697937 best_discrete=24.314644 hash=False elapsed=31.9s
step   400/900 tau=0.2109 loss=0.272778 mse_soft=0.272339 ent_in=1.1084 ent_out=0.3549 rowmax_in=0.5190 rowmax_out=0.8352 discrete_mse=248.697937 best_discrete=24.314644 hash=False elapsed=33.9s
step   425/900 tau=0.1913 loss=0.274383 mse_soft=0.273947 ent_in=1.1029 ent_out=0.3503 rowmax_in=0.5191 rowmax_out=0.8360 discrete_mse=248.697937 best_discrete=24.314644 hash=False elapsed=36.0s
step   450/900 tau=0.1735 loss=0.276931 mse_soft=0.276499 ent_in=1.0980 ent_out=0.3419 rowmax_in=0.5251 rowmax_out=0.8426 discrete_mse=78.873932 best_discrete=24.314644 hash=False elapsed=38.1s
step   475/900 tau=0.1574 loss=0.270348 mse_soft=0.269919 ent_in=1.0909 ent_out=0.3412 rowmax_in=0.5240 rowmax_out=0.8392 discrete_mse=95.254723 best_discrete=24.314644 hash=False elapsed=40.2s
step   500/900 tau=0.1428 loss=0.278650 mse_soft=0.278228 ent_in=1.0725 ent_out=0.3336 rowmax_in=0.5271 rowmax_out=0.8423 discrete_mse=95.254723 best_discrete=24.314644 hash=False elapsed=42.3s
step   525/900 tau=0.1295 loss=0.275397 mse_soft=0.274978 ent_in=1.0668 ent_out=0.3297 rowmax_in=0.5275 rowmax_out=0.8455 discrete_mse=119.225449 best_discrete=24.314644 hash=False elapsed=44.5s
step   550/900 tau=0.1175 loss=0.280265 mse_soft=0.279847 ent_in=1.0627 ent_out=0.3333 rowmax_in=0.5293 rowmax_out=0.8438 discrete_mse=119.225449 best_discrete=24.314644 hash=False elapsed=46.8s
step   575/900 tau=0.1066 loss=0.281714 mse_soft=0.281295 ent_in=1.0610 ent_out=0.3335 rowmax_in=0.5248 rowmax_out=0.8433 discrete_mse=119.225449 best_discrete=24.314644 hash=False elapsed=49.0s
step   600/900 tau=0.0967 loss=0.276732 mse_soft=0.276316 ent_in=1.0545 ent_out=0.3334 rowmax_in=0.5292 rowmax_out=0.8437 discrete_mse=370.755341 best_discrete=24.314644 hash=False elapsed=51.1s
step   625/900 tau=0.0877 loss=0.277662 mse_soft=0.277248 ent_in=1.0518 ent_out=0.3300 rowmax_in=0.5305 rowmax_out=0.8477 discrete_mse=158.464859 best_discrete=24.314644 hash=False elapsed=53.2s
step   650/900 tau=0.0795 loss=0.326168 mse_soft=0.325792 ent_in=0.9678 ent_out=0.2857 rowmax_in=0.5637 rowmax_out=0.8600 discrete_mse=73.098045 best_discrete=24.314644 hash=False elapsed=55.5s
step   675/900 tau=0.0722 loss=0.284087 mse_soft=0.283710 ent_in=0.9597 ent_out=0.2945 rowmax_in=0.5616 rowmax_out=0.8582 discrete_mse=107.059273 best_discrete=24.314644 hash=False elapsed=57.8s
step   700/900 tau=0.0655 loss=0.298499 mse_soft=0.298118 ent_in=0.9547 ent_out=0.3150 rowmax_in=0.5606 rowmax_out=0.8478 discrete_mse=54.194466 best_discrete=24.314644 hash=False elapsed=60.1s
step   725/900 tau=0.0594 loss=0.280452 mse_soft=0.280074 ent_in=0.9520 ent_out=0.3079 rowmax_in=0.5619 rowmax_out=0.8528 discrete_mse=73.828812 best_discrete=24.314644 hash=False elapsed=62.4s
step   750/900 tau=0.0539 loss=0.280010 mse_soft=0.279629 ent_in=0.9586 ent_out=0.3108 rowmax_in=0.5552 rowmax_out=0.8489 discrete_mse=96.194946 best_discrete=24.314644 hash=False elapsed=64.3s
step   775/900 tau=0.0489 loss=0.349032 mse_soft=0.348747 ent_in=0.7030 ent_out=0.2463 rowmax_in=0.6622 rowmax_out=0.8780 discrete_mse=38.528297 best_discrete=24.314644 hash=False elapsed=66.1s
step   800/900 tau=0.0443 loss=0.425213 mse_soft=0.425018 ent_in=0.4603 ent_out=0.1914 rowmax_in=0.7864 rowmax_out=0.8947 discrete_mse=1.070914 best_discrete=1.070914 hash=False elapsed=68.2s
step   825/900 tau=0.0402 loss=0.505279 mse_soft=0.505114 ent_in=0.4254 ent_out=0.1227 rowmax_in=0.7831 rowmax_out=0.9409 discrete_mse=21.472340 best_discrete=1.070914 hash=False elapsed=70.4s
step   850/900 tau=0.0365 loss=0.431328 mse_soft=0.431148 ent_in=0.4446 ent_out=0.1538 rowmax_in=0.7539 rowmax_out=0.9115 discrete_mse=81.717796 best_discrete=1.070914 hash=False elapsed=72.5s
step   875/900 tau=0.0331 loss=0.405778 mse_soft=0.405601 ent_in=0.4238 ent_out=0.1663 rowmax_in=0.7713 rowmax_out=0.9057 discrete_mse=1.985595 best_discrete=1.070914 hash=False elapsed=74.2s
step   900/900 tau=0.0300 loss=0.397889 mse_soft=0.397702 ent_in=0.4531 ent_out=0.1692 rowmax_in=0.7516 rowmax_out=0.9016 discrete_mse=4.570259 best_discrete=1.070914 hash=False elapsed=76.2s

Final metrics:
  soft_mse_full=0.406842
  rowmax_in_mean=0.7511
  rowmax_out_mean=0.9020
  ent_in_mean=0.4537
  ent_out_mean=0.1691
  final_discrete_mse=4.570259
  hash_match=False
  best_discrete_mse_seen=1.070914
Saved results to overnight_b016_j1.json
