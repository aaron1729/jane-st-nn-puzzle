Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.067156 mse_soft=1.064834 ent_in=3.8712 ent_out=3.8711 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=384.332642 best_discrete=384.332642 hash=False elapsed=0.6s
step    25/900 tau=0.9106 loss=0.864242 mse_soft=0.862052 ent_in=3.6333 ent_out=3.6687 rowmax_in=0.0456 rowmax_out=0.0442 discrete_mse=1255.853271 best_discrete=384.332642 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.648935 mse_soft=0.647032 ent_in=3.1291 ent_out=3.2165 rowmax_in=0.0906 rowmax_out=0.0886 discrete_mse=6440.252930 best_discrete=384.332642 hash=False elapsed=5.3s
step    75/900 tau=0.7493 loss=0.512741 mse_soft=0.511155 ent_in=2.6067 ent_out=2.6787 rowmax_in=0.1993 rowmax_out=0.1986 discrete_mse=991.553345 best_discrete=384.332642 hash=False elapsed=7.7s
step   100/900 tau=0.6797 loss=0.407185 mse_soft=0.406008 ent_in=2.0389 ent_out=1.8828 rowmax_in=0.3317 rowmax_out=0.4194 discrete_mse=403.489502 best_discrete=384.332642 hash=False elapsed=10.1s
step   125/900 tau=0.6165 loss=0.346022 mse_soft=0.345163 ent_in=1.6867 ent_out=1.1768 rowmax_in=0.4007 rowmax_out=0.6160 discrete_mse=744.417908 best_discrete=384.332642 hash=False elapsed=12.4s
step   150/900 tau=0.5592 loss=0.316481 mse_soft=0.315788 ent_in=1.5065 ent_out=0.8042 rowmax_in=0.4379 rowmax_out=0.7480 discrete_mse=212.473892 best_discrete=212.473892 hash=False elapsed=14.8s
step   175/900 tau=0.5073 loss=0.301416 mse_soft=0.300794 ent_in=1.4118 ent_out=0.6618 rowmax_in=0.4524 rowmax_out=0.7746 discrete_mse=222.768326 best_discrete=212.473892 hash=False elapsed=17.3s
step   200/900 tau=0.4602 loss=0.292659 mse_soft=0.292073 ent_in=1.3534 ent_out=0.6008 rowmax_in=0.4619 rowmax_out=0.7796 discrete_mse=297.574097 best_discrete=212.473892 hash=False elapsed=19.7s
step   225/900 tau=0.4174 loss=0.286133 mse_soft=0.285581 ent_in=1.3060 ent_out=0.5348 rowmax_in=0.4669 rowmax_out=0.7955 discrete_mse=207.468338 best_discrete=207.468338 hash=False elapsed=22.2s
step   250/900 tau=0.3786 loss=0.283207 mse_soft=0.282681 ent_in=1.2812 ent_out=0.4711 rowmax_in=0.4689 rowmax_out=0.8158 discrete_mse=262.734528 best_discrete=207.468338 hash=False elapsed=24.5s
step   275/900 tau=0.3434 loss=0.281270 mse_soft=0.280764 ent_in=1.2626 ent_out=0.4241 rowmax_in=0.4732 rowmax_out=0.8317 discrete_mse=767.711182 best_discrete=207.468338 hash=False elapsed=27.0s
step   300/900 tau=0.3115 loss=0.278550 mse_soft=0.278058 ent_in=1.2503 ent_out=0.3898 rowmax_in=0.4750 rowmax_out=0.8455 discrete_mse=942.745605 best_discrete=207.468338 hash=False elapsed=29.4s
step   325/900 tau=0.2826 loss=0.274732 mse_soft=0.274249 ent_in=1.2394 ent_out=0.3707 rowmax_in=0.4778 rowmax_out=0.8517 discrete_mse=709.288635 best_discrete=207.468338 hash=False elapsed=31.7s
step   350/900 tau=0.2563 loss=0.276158 mse_soft=0.275683 ent_in=1.2297 ent_out=0.3563 rowmax_in=0.4805 rowmax_out=0.8577 discrete_mse=709.288635 best_discrete=207.468338 hash=False elapsed=34.2s
step   375/900 tau=0.2325 loss=0.272247 mse_soft=0.271775 ent_in=1.2159 ent_out=0.3563 rowmax_in=0.4849 rowmax_out=0.8560 discrete_mse=1089.886475 best_discrete=207.468338 hash=False elapsed=36.6s
step   400/900 tau=0.2109 loss=0.275330 mse_soft=0.274862 ent_in=1.2034 ent_out=0.3554 rowmax_in=0.4888 rowmax_out=0.8569 discrete_mse=1089.886475 best_discrete=207.468338 hash=False elapsed=38.8s
step   425/900 tau=0.1913 loss=0.271509 mse_soft=0.271043 ent_in=1.1965 ent_out=0.3564 rowmax_in=0.4898 rowmax_out=0.8555 discrete_mse=1089.886475 best_discrete=207.468338 hash=False elapsed=41.1s
step   450/900 tau=0.1735 loss=0.271083 mse_soft=0.270618 ent_in=1.1917 ent_out=0.3560 rowmax_in=0.4915 rowmax_out=0.8547 discrete_mse=942.745605 best_discrete=207.468338 hash=False elapsed=43.4s
step   475/900 tau=0.1574 loss=0.272534 mse_soft=0.272072 ent_in=1.1872 ent_out=0.3519 rowmax_in=0.4918 rowmax_out=0.8551 discrete_mse=1089.886475 best_discrete=207.468338 hash=False elapsed=45.7s
step   500/900 tau=0.1428 loss=0.280177 mse_soft=0.279724 ent_in=1.1615 ent_out=0.3479 rowmax_in=0.5079 rowmax_out=0.8547 discrete_mse=1028.565186 best_discrete=207.468338 hash=False elapsed=47.9s
step   525/900 tau=0.1295 loss=0.294198 mse_soft=0.293746 ent_in=1.1553 ent_out=0.3524 rowmax_in=0.5064 rowmax_out=0.8514 discrete_mse=896.422791 best_discrete=207.468338 hash=False elapsed=50.4s
step   550/900 tau=0.1175 loss=0.276737 mse_soft=0.276292 ent_in=1.1352 ent_out=0.3474 rowmax_in=0.5158 rowmax_out=0.8520 discrete_mse=317.832916 best_discrete=207.468338 hash=False elapsed=52.9s
step   575/900 tau=0.1066 loss=0.290068 mse_soft=0.289626 ent_in=1.1313 ent_out=0.3416 rowmax_in=0.5151 rowmax_out=0.8539 discrete_mse=355.560791 best_discrete=207.468338 hash=False elapsed=55.1s
step   600/900 tau=0.0967 loss=0.273296 mse_soft=0.272859 ent_in=1.1178 ent_out=0.3380 rowmax_in=0.5174 rowmax_out=0.8544 discrete_mse=355.560791 best_discrete=207.468338 hash=False elapsed=57.4s
step   625/900 tau=0.0877 loss=0.289410 mse_soft=0.288981 ent_in=1.0890 ent_out=0.3408 rowmax_in=0.5314 rowmax_out=0.8485 discrete_mse=192.706497 best_discrete=192.706497 hash=False elapsed=59.9s
step   650/900 tau=0.0795 loss=0.381815 mse_soft=0.381399 ent_in=1.0538 ent_out=0.3344 rowmax_in=0.5311 rowmax_out=0.8501 discrete_mse=72.817162 best_discrete=72.817162 hash=False elapsed=62.2s
step   675/900 tau=0.0722 loss=0.308979 mse_soft=0.308593 ent_in=0.9381 ent_out=0.3467 rowmax_in=0.5626 rowmax_out=0.8379 discrete_mse=49.192688 best_discrete=49.192688 hash=False elapsed=64.4s
step   700/900 tau=0.0655 loss=0.317500 mse_soft=0.317121 ent_in=0.9364 ent_out=0.3261 rowmax_in=0.5575 rowmax_out=0.8464 discrete_mse=47.262093 best_discrete=47.262093 hash=False elapsed=66.4s
step   725/900 tau=0.0594 loss=0.352686 mse_soft=0.352377 ent_in=0.7117 ent_out=0.3181 rowmax_in=0.6641 rowmax_out=0.8296 discrete_mse=11.471433 best_discrete=11.471433 hash=False elapsed=68.6s
step   750/900 tau=0.0539 loss=0.332311 mse_soft=0.332003 ent_in=0.7223 ent_out=0.3046 rowmax_in=0.6519 rowmax_out=0.8399 discrete_mse=48.809372 best_discrete=11.471433 hash=False elapsed=70.8s
step   775/900 tau=0.0489 loss=0.329371 mse_soft=0.329067 ent_in=0.7161 ent_out=0.2996 rowmax_in=0.6596 rowmax_out=0.8416 discrete_mse=1.271008 best_discrete=1.271008 hash=False elapsed=73.0s
step   800/900 tau=0.0443 loss=0.344370 mse_soft=0.344074 ent_in=0.7027 ent_out=0.2834 rowmax_in=0.6605 rowmax_out=0.8532 discrete_mse=51.204617 best_discrete=1.271008 hash=False elapsed=75.2s
step   825/900 tau=0.0402 loss=0.328439 mse_soft=0.328148 ent_in=0.6851 ent_out=0.2842 rowmax_in=0.6691 rowmax_out=0.8465 discrete_mse=58.825199 best_discrete=1.271008 hash=False elapsed=77.4s
step   850/900 tau=0.0365 loss=0.323462 mse_soft=0.323167 ent_in=0.7051 ent_out=0.2765 rowmax_in=0.6577 rowmax_out=0.8425 discrete_mse=102.603394 best_discrete=1.271008 hash=False elapsed=79.5s
step   875/900 tau=0.0331 loss=0.372876 mse_soft=0.372635 ent_in=0.5350 ent_out=0.2680 rowmax_in=0.7394 rowmax_out=0.8600 discrete_mse=11.291680 best_discrete=1.271008 hash=False elapsed=81.8s
step   900/900 tau=0.0300 loss=0.477819 mse_soft=0.477652 ent_in=0.3728 ent_out=0.1841 rowmax_in=0.8075 rowmax_out=0.8961 discrete_mse=3.284152 best_discrete=1.271008 hash=False elapsed=84.1s

Final metrics:
  soft_mse_full=0.573376
  rowmax_in_mean=0.7973
  rowmax_out_mean=0.9033
  ent_in_mean=0.3894
  ent_out_mean=0.1701
  final_discrete_mse=5.725713
  hash_match=False
  best_discrete_mse_seen=1.271008
Saved results to overnight_b114_j1.json
