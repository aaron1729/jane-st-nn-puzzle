Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.058700 mse_soft=1.056377 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=37.418507 best_discrete=37.418507 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.855842 mse_soft=0.853653 ent_in=3.6327 ent_out=3.6651 rowmax_in=0.0460 rowmax_out=0.0446 discrete_mse=4799.109863 best_discrete=37.418507 hash=False elapsed=2.7s
step    50/900 tau=0.8229 loss=0.642152 mse_soft=0.640246 ent_in=3.1305 ent_out=3.2246 rowmax_in=0.0919 rowmax_out=0.0873 discrete_mse=2385.423828 best_discrete=37.418507 hash=False elapsed=4.8s
step    75/900 tau=0.7450 loss=0.503058 mse_soft=0.501482 ent_in=2.5944 ent_out=2.6597 rowmax_in=0.2052 rowmax_out=0.2009 discrete_mse=3690.105225 best_discrete=37.418507 hash=False elapsed=6.9s
step   100/900 tau=0.6745 loss=0.392046 mse_soft=0.390924 ent_in=1.9189 ent_out=1.8209 rowmax_in=0.3824 rowmax_out=0.4321 discrete_mse=969.305176 best_discrete=37.418507 hash=False elapsed=9.3s
step   125/900 tau=0.6107 loss=0.332246 mse_soft=0.331409 ent_in=1.5597 ent_out=1.2324 rowmax_in=0.4737 rowmax_out=0.5867 discrete_mse=295.381165 best_discrete=37.418507 hash=False elapsed=11.7s
step   150/900 tau=0.5529 loss=0.306035 mse_soft=0.305339 ent_in=1.3861 ent_out=0.9332 rowmax_in=0.5086 rowmax_out=0.6667 discrete_mse=456.768890 best_discrete=37.418507 hash=False elapsed=14.2s
step   175/900 tau=0.5006 loss=0.294850 mse_soft=0.294234 ent_in=1.2872 ent_out=0.7690 rowmax_in=0.5181 rowmax_out=0.7038 discrete_mse=549.285400 best_discrete=37.418507 hash=False elapsed=16.4s
step   200/900 tau=0.4532 loss=0.284916 mse_soft=0.284361 ent_in=1.1896 ent_out=0.6597 rowmax_in=0.5495 rowmax_out=0.7364 discrete_mse=594.707397 best_discrete=37.418507 hash=False elapsed=18.9s
step   225/900 tau=0.4103 loss=0.277410 mse_soft=0.276897 ent_in=1.1402 ent_out=0.5692 rowmax_in=0.5585 rowmax_out=0.7661 discrete_mse=301.165497 best_discrete=37.418507 hash=False elapsed=21.3s
step   250/900 tau=0.3715 loss=0.273342 mse_soft=0.272850 ent_in=1.1125 ent_out=0.5267 rowmax_in=0.5641 rowmax_out=0.7780 discrete_mse=423.486145 best_discrete=37.418507 hash=False elapsed=23.5s
step   275/900 tau=0.3363 loss=0.269172 mse_soft=0.268693 ent_in=1.0832 ent_out=0.5110 rowmax_in=0.5723 rowmax_out=0.7819 discrete_mse=445.434998 best_discrete=37.418507 hash=False elapsed=25.9s
step   300/900 tau=0.3045 loss=0.265759 mse_soft=0.265291 ent_in=1.0657 ent_out=0.4940 rowmax_in=0.5747 rowmax_out=0.7891 discrete_mse=445.434998 best_discrete=37.418507 hash=False elapsed=28.4s
step   325/900 tau=0.2756 loss=0.265963 mse_soft=0.265510 ent_in=1.0419 ent_out=0.4683 rowmax_in=0.5796 rowmax_out=0.7950 discrete_mse=496.836395 best_discrete=37.418507 hash=False elapsed=30.9s
step   350/900 tau=0.2496 loss=0.262870 mse_soft=0.262426 ent_in=1.0308 ent_out=0.4504 rowmax_in=0.5827 rowmax_out=0.7992 discrete_mse=279.589844 best_discrete=37.418507 hash=False elapsed=33.3s
step   375/900 tau=0.2259 loss=0.265914 mse_soft=0.265475 ent_in=1.0231 ent_out=0.4380 rowmax_in=0.5845 rowmax_out=0.8033 discrete_mse=496.836395 best_discrete=37.418507 hash=False elapsed=35.6s
step   400/900 tau=0.2046 loss=0.262583 mse_soft=0.262150 ent_in=1.0185 ent_out=0.4252 rowmax_in=0.5858 rowmax_out=0.8086 discrete_mse=227.689987 best_discrete=37.418507 hash=False elapsed=37.9s
step   425/900 tau=0.1852 loss=0.266977 mse_soft=0.266547 ent_in=1.0140 ent_out=0.4185 rowmax_in=0.5845 rowmax_out=0.8113 discrete_mse=227.689987 best_discrete=37.418507 hash=False elapsed=40.2s
step   450/900 tau=0.1677 loss=0.265938 mse_soft=0.265510 ent_in=1.0118 ent_out=0.4134 rowmax_in=0.5848 rowmax_out=0.8125 discrete_mse=224.778351 best_discrete=37.418507 hash=False elapsed=42.6s
step   475/900 tau=0.1518 loss=0.263994 mse_soft=0.263569 ent_in=1.0126 ent_out=0.4043 rowmax_in=0.5802 rowmax_out=0.8176 discrete_mse=278.514343 best_discrete=37.418507 hash=False elapsed=45.1s
step   500/900 tau=0.1374 loss=0.264723 mse_soft=0.264303 ent_in=1.0008 ent_out=0.4007 rowmax_in=0.5834 rowmax_out=0.8149 discrete_mse=278.514343 best_discrete=37.418507 hash=False elapsed=47.4s
step   525/900 tau=0.1244 loss=0.376960 mse_soft=0.376543 ent_in=0.9947 ent_out=0.3939 rowmax_in=0.5805 rowmax_out=0.8226 discrete_mse=162.474182 best_discrete=37.418507 hash=False elapsed=49.6s
step   550/900 tau=0.1126 loss=0.268917 mse_soft=0.268518 ent_in=0.9465 ent_out=0.3848 rowmax_in=0.5962 rowmax_out=0.8176 discrete_mse=303.508942 best_discrete=37.418507 hash=False elapsed=52.0s
step   575/900 tau=0.1020 loss=0.262777 mse_soft=0.262383 ent_in=0.9420 ent_out=0.3722 rowmax_in=0.5901 rowmax_out=0.8197 discrete_mse=395.105743 best_discrete=37.418507 hash=False elapsed=54.4s
step   600/900 tau=0.0923 loss=0.261322 mse_soft=0.260931 ent_in=0.9387 ent_out=0.3645 rowmax_in=0.5903 rowmax_out=0.8256 discrete_mse=395.105743 best_discrete=37.418507 hash=False elapsed=56.6s
step   625/900 tau=0.0836 loss=0.288408 mse_soft=0.288025 ent_in=0.9222 ent_out=0.3537 rowmax_in=0.6020 rowmax_out=0.8402 discrete_mse=379.456116 best_discrete=37.418507 hash=False elapsed=59.1s
step   650/900 tau=0.0757 loss=0.368614 mse_soft=0.368326 ent_in=0.7253 ent_out=0.2361 rowmax_in=0.6387 rowmax_out=0.8949 discrete_mse=52.024345 best_discrete=37.418507 hash=False elapsed=61.3s
step   675/900 tau=0.0685 loss=0.335282 mse_soft=0.334973 ent_in=0.7313 ent_out=0.2999 rowmax_in=0.6346 rowmax_out=0.8343 discrete_mse=6.586731 best_discrete=6.586731 hash=False elapsed=63.7s
step   700/900 tau=0.0620 loss=0.313641 mse_soft=0.313327 ent_in=0.7151 ent_out=0.3318 rowmax_in=0.6464 rowmax_out=0.8101 discrete_mse=65.683502 best_discrete=6.586731 hash=False elapsed=65.9s
step   725/900 tau=0.0562 loss=0.331325 mse_soft=0.331034 ent_in=0.6664 ent_out=0.3031 rowmax_in=0.6785 rowmax_out=0.8415 discrete_mse=15.940445 best_discrete=6.586731 hash=False elapsed=68.1s
step   750/900 tau=0.0508 loss=0.310442 mse_soft=0.310160 ent_in=0.6398 ent_out=0.2999 rowmax_in=0.6810 rowmax_out=0.8378 discrete_mse=20.379356 best_discrete=6.586731 hash=False elapsed=70.4s
step   775/900 tau=0.0460 loss=0.342007 mse_soft=0.341715 ent_in=0.6570 ent_out=0.3191 rowmax_in=0.6781 rowmax_out=0.8266 discrete_mse=33.619202 best_discrete=6.586731 hash=False elapsed=72.8s
step   800/900 tau=0.0417 loss=0.364405 mse_soft=0.364139 ent_in=0.6105 ent_out=0.2776 rowmax_in=0.6949 rowmax_out=0.8471 discrete_mse=104.173004 best_discrete=6.586731 hash=False elapsed=75.0s
step   825/900 tau=0.0377 loss=0.344454 mse_soft=0.344200 ent_in=0.5819 ent_out=0.2651 rowmax_in=0.7101 rowmax_out=0.8643 discrete_mse=16.138475 best_discrete=6.586731 hash=False elapsed=77.3s
step   850/900 tau=0.0342 loss=0.409838 mse_soft=0.409678 ent_in=0.3683 ent_out=0.1628 rowmax_in=0.8305 rowmax_out=0.9225 discrete_mse=1.188497 best_discrete=1.188497 hash=False elapsed=79.6s
step   875/900 tau=0.0309 loss=0.387823 mse_soft=0.387643 ent_in=0.4325 ent_out=0.1680 rowmax_in=0.7886 rowmax_out=0.9220 discrete_mse=1.188497 best_discrete=1.188497 hash=False elapsed=81.9s
step   900/900 tau=0.0280 loss=0.406467 mse_soft=0.406281 ent_in=0.4240 ent_out=0.1950 rowmax_in=0.7987 rowmax_out=0.9037 discrete_mse=0.856802 best_discrete=0.856802 hash=False elapsed=84.1s

Final metrics:
  soft_mse_full=0.406819
  rowmax_in_mean=0.7896
  rowmax_out_mean=0.9039
  ent_in_mean=0.4338
  ent_out_mean=0.1952
  final_discrete_mse=0.856802
  hash_match=False
  best_discrete_mse_seen=0.856802
Saved results to overnight_b006_j2.json
