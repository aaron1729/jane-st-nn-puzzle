Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.066099 mse_soft=1.063776 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=138.710022 best_discrete=138.710022 hash=False elapsed=0.6s
step    25/900 tau=0.9106 loss=0.860704 mse_soft=0.858513 ent_in=3.6328 ent_out=3.6688 rowmax_in=0.0456 rowmax_out=0.0432 discrete_mse=329.768188 best_discrete=138.710022 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.646941 mse_soft=0.645033 ent_in=3.1272 ent_out=3.2327 rowmax_in=0.0945 rowmax_out=0.0860 discrete_mse=4657.119141 best_discrete=138.710022 hash=False elapsed=5.1s
step    75/900 tau=0.7493 loss=0.508917 mse_soft=0.507318 ent_in=2.6084 ent_out=2.7209 rowmax_in=0.2024 rowmax_out=0.1881 discrete_mse=311.249786 best_discrete=138.710022 hash=False elapsed=7.2s
step   100/900 tau=0.6797 loss=0.405274 mse_soft=0.404076 ent_in=2.0200 ent_out=1.9731 rowmax_in=0.3445 rowmax_out=0.3855 discrete_mse=974.847168 best_discrete=138.710022 hash=False elapsed=9.3s
step   125/900 tau=0.6165 loss=0.342019 mse_soft=0.341158 ent_in=1.6029 ent_out=1.2678 rowmax_in=0.4495 rowmax_out=0.5996 discrete_mse=360.493683 best_discrete=138.710022 hash=False elapsed=11.5s
step   150/900 tau=0.5592 loss=0.311761 mse_soft=0.311120 ent_in=1.3702 ent_out=0.7666 rowmax_in=0.4979 rowmax_out=0.7567 discrete_mse=200.799118 best_discrete=138.710022 hash=False elapsed=13.8s
step   175/900 tau=0.5073 loss=0.291801 mse_soft=0.291284 ent_in=1.2448 ent_out=0.4769 rowmax_in=0.5178 rowmax_out=0.8380 discrete_mse=472.502594 best_discrete=138.710022 hash=False elapsed=15.9s
step   200/900 tau=0.4602 loss=0.283505 mse_soft=0.283041 ent_in=1.1823 ent_out=0.3639 rowmax_in=0.5296 rowmax_out=0.8604 discrete_mse=656.555603 best_discrete=138.710022 hash=False elapsed=17.9s
step   225/900 tau=0.4174 loss=0.280849 mse_soft=0.280398 ent_in=1.1605 ent_out=0.3428 rowmax_in=0.5269 rowmax_out=0.8581 discrete_mse=656.555603 best_discrete=138.710022 hash=False elapsed=20.1s
step   250/900 tau=0.3786 loss=0.278620 mse_soft=0.278180 ent_in=1.1436 ent_out=0.3208 rowmax_in=0.5258 rowmax_out=0.8640 discrete_mse=512.236816 best_discrete=138.710022 hash=False elapsed=22.2s
step   275/900 tau=0.3434 loss=0.277817 mse_soft=0.277386 ent_in=1.1319 ent_out=0.3064 rowmax_in=0.5245 rowmax_out=0.8664 discrete_mse=1099.887207 best_discrete=138.710022 hash=False elapsed=24.4s
step   300/900 tau=0.3115 loss=0.275803 mse_soft=0.275378 ent_in=1.1202 ent_out=0.2973 rowmax_in=0.5288 rowmax_out=0.8697 discrete_mse=490.241547 best_discrete=138.710022 hash=False elapsed=26.6s
step   325/900 tau=0.2826 loss=0.275136 mse_soft=0.274718 ent_in=1.1039 ent_out=0.2914 rowmax_in=0.5315 rowmax_out=0.8757 discrete_mse=490.241547 best_discrete=138.710022 hash=False elapsed=28.8s
step   350/900 tau=0.2563 loss=0.274215 mse_soft=0.273805 ent_in=1.0939 ent_out=0.2740 rowmax_in=0.5316 rowmax_out=0.8856 discrete_mse=431.574280 best_discrete=138.710022 hash=False elapsed=31.0s
step   375/900 tau=0.2325 loss=0.273101 mse_soft=0.272700 ent_in=1.0852 ent_out=0.2488 rowmax_in=0.5309 rowmax_out=0.8946 discrete_mse=522.177063 best_discrete=138.710022 hash=False elapsed=33.3s
step   400/900 tau=0.2109 loss=0.272409 mse_soft=0.272011 ent_in=1.0807 ent_out=0.2453 rowmax_in=0.5326 rowmax_out=0.8948 discrete_mse=522.177063 best_discrete=138.710022 hash=False elapsed=35.5s
step   425/900 tau=0.1913 loss=0.277092 mse_soft=0.276693 ent_in=1.0869 ent_out=0.2429 rowmax_in=0.5256 rowmax_out=0.8956 discrete_mse=522.177063 best_discrete=138.710022 hash=False elapsed=37.6s
step   450/900 tau=0.1735 loss=0.271262 mse_soft=0.270864 ent_in=1.0822 ent_out=0.2441 rowmax_in=0.5274 rowmax_out=0.8958 discrete_mse=753.676575 best_discrete=138.710022 hash=False elapsed=39.8s
step   475/900 tau=0.1574 loss=0.275143 mse_soft=0.274743 ent_in=1.0846 ent_out=0.2475 rowmax_in=0.5241 rowmax_out=0.8943 discrete_mse=665.674866 best_discrete=138.710022 hash=False elapsed=41.8s
step   500/900 tau=0.1428 loss=0.273532 mse_soft=0.273133 ent_in=1.0810 ent_out=0.2490 rowmax_in=0.5275 rowmax_out=0.8935 discrete_mse=1781.190552 best_discrete=138.710022 hash=False elapsed=43.9s
step   525/900 tau=0.1295 loss=0.274754 mse_soft=0.274352 ent_in=1.0856 ent_out=0.2532 rowmax_in=0.5226 rowmax_out=0.8911 discrete_mse=665.674866 best_discrete=138.710022 hash=False elapsed=45.9s
step   550/900 tau=0.1175 loss=0.271972 mse_soft=0.271569 ent_in=1.0825 ent_out=0.2610 rowmax_in=0.5226 rowmax_out=0.8847 discrete_mse=665.674866 best_discrete=138.710022 hash=False elapsed=48.0s
step   575/900 tau=0.1066 loss=0.278057 mse_soft=0.277657 ent_in=1.0719 ent_out=0.2625 rowmax_in=0.5257 rowmax_out=0.8828 discrete_mse=788.637085 best_discrete=138.710022 hash=False elapsed=50.5s
step   600/900 tau=0.0967 loss=0.270926 mse_soft=0.270526 ent_in=1.0629 ent_out=0.2699 rowmax_in=0.5268 rowmax_out=0.8757 discrete_mse=635.385254 best_discrete=138.710022 hash=False elapsed=52.6s
step   625/900 tau=0.0877 loss=0.272198 mse_soft=0.271800 ent_in=1.0568 ent_out=0.2711 rowmax_in=0.5273 rowmax_out=0.8741 discrete_mse=788.637085 best_discrete=138.710022 hash=False elapsed=54.8s
step   650/900 tau=0.0795 loss=0.275360 mse_soft=0.274964 ent_in=1.0484 ent_out=0.2713 rowmax_in=0.5298 rowmax_out=0.8719 discrete_mse=299.346039 best_discrete=138.710022 hash=False elapsed=56.9s
step   675/900 tau=0.0722 loss=0.272186 mse_soft=0.271794 ent_in=1.0348 ent_out=0.2716 rowmax_in=0.5373 rowmax_out=0.8728 discrete_mse=179.421494 best_discrete=138.710022 hash=False elapsed=59.1s
step   700/900 tau=0.0655 loss=0.358795 mse_soft=0.358485 ent_in=0.7819 ent_out=0.2508 rowmax_in=0.6267 rowmax_out=0.8618 discrete_mse=32.932274 best_discrete=32.932274 hash=False elapsed=61.1s
step   725/900 tau=0.0594 loss=0.316022 mse_soft=0.315753 ent_in=0.7003 ent_out=0.1965 rowmax_in=0.6604 rowmax_out=0.8994 discrete_mse=13.640651 best_discrete=13.640651 hash=False elapsed=63.1s
step   750/900 tau=0.0539 loss=0.362545 mse_soft=0.362277 ent_in=0.7063 ent_out=0.1896 rowmax_in=0.6496 rowmax_out=0.9021 discrete_mse=10.732071 best_discrete=10.732071 hash=False elapsed=65.3s
step   775/900 tau=0.0489 loss=0.314064 mse_soft=0.313790 ent_in=0.7104 ent_out=0.2054 rowmax_in=0.6588 rowmax_out=0.8925 discrete_mse=36.843105 best_discrete=10.732071 hash=False elapsed=67.3s
step   800/900 tau=0.0443 loss=0.299621 mse_soft=0.299365 ent_in=0.6671 ent_out=0.1889 rowmax_in=0.6810 rowmax_out=0.8993 discrete_mse=39.732204 best_discrete=10.732071 hash=False elapsed=69.1s
step   825/900 tau=0.0402 loss=0.300228 mse_soft=0.299972 ent_in=0.6626 ent_out=0.1927 rowmax_in=0.6790 rowmax_out=0.8980 discrete_mse=27.689505 best_discrete=10.732071 hash=False elapsed=70.8s
step   850/900 tau=0.0365 loss=0.309063 mse_soft=0.308810 ent_in=0.6512 ent_out=0.1926 rowmax_in=0.6790 rowmax_out=0.8979 discrete_mse=58.997887 best_discrete=10.732071 hash=False elapsed=72.7s
step   875/900 tau=0.0331 loss=0.354887 mse_soft=0.354685 ent_in=0.4838 ent_out=0.1880 rowmax_in=0.7440 rowmax_out=0.9030 discrete_mse=52.793186 best_discrete=10.732071 hash=False elapsed=74.4s
step   900/900 tau=0.0300 loss=0.335276 mse_soft=0.335078 ent_in=0.4802 ent_out=0.1792 rowmax_in=0.7436 rowmax_out=0.9093 discrete_mse=61.738373 best_discrete=10.732071 hash=False elapsed=76.3s

Final metrics:
  soft_mse_full=0.342552
  rowmax_in_mean=0.7412
  rowmax_out_mean=0.9074
  ent_in_mean=0.4841
  ent_out_mean=0.1795
  final_discrete_mse=44.446507
  hash_match=False
  best_discrete_mse_seen=10.732071
Saved results to overnight_b040_j1.json
