Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.061957 mse_soft=1.059635 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=18.258329 best_discrete=18.258329 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.858850 mse_soft=0.856659 ent_in=3.6350 ent_out=3.6676 rowmax_in=0.0455 rowmax_out=0.0443 discrete_mse=883.520752 best_discrete=18.258329 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.649107 mse_soft=0.647190 ent_in=3.1473 ent_out=3.2447 rowmax_in=0.0913 rowmax_out=0.0854 discrete_mse=6550.487793 best_discrete=18.258329 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.512487 mse_soft=0.510884 ent_in=2.6339 ent_out=2.7079 rowmax_in=0.2020 rowmax_out=0.1931 discrete_mse=706.933838 best_discrete=18.258329 hash=False elapsed=7.4s
step   100/900 tau=0.6797 loss=0.411102 mse_soft=0.409895 ent_in=2.0960 ent_out=1.9258 rowmax_in=0.3250 rowmax_out=0.3860 discrete_mse=273.441498 best_discrete=18.258329 hash=False elapsed=9.8s
step   125/900 tau=0.6165 loss=0.344772 mse_soft=0.343915 ent_in=1.6457 ent_out=1.2097 rowmax_in=0.4462 rowmax_out=0.6046 discrete_mse=360.559296 best_discrete=18.258329 hash=False elapsed=12.0s
step   150/900 tau=0.5592 loss=0.315429 mse_soft=0.314771 ent_in=1.4323 ent_out=0.7591 rowmax_in=0.4778 rowmax_out=0.7525 discrete_mse=379.247345 best_discrete=18.258329 hash=False elapsed=14.3s
step   175/900 tau=0.5073 loss=0.300227 mse_soft=0.299668 ent_in=1.3174 ent_out=0.5463 rowmax_in=0.4997 rowmax_out=0.7978 discrete_mse=256.647156 best_discrete=18.258329 hash=False elapsed=16.4s
step   200/900 tau=0.4602 loss=0.290569 mse_soft=0.290066 ent_in=1.2297 ent_out=0.4483 rowmax_in=0.5163 rowmax_out=0.8133 discrete_mse=543.441162 best_discrete=18.258329 hash=False elapsed=18.7s
step   225/900 tau=0.4174 loss=0.285167 mse_soft=0.284690 ent_in=1.1854 ent_out=0.4029 rowmax_in=0.5207 rowmax_out=0.8265 discrete_mse=367.825684 best_discrete=18.258329 hash=False elapsed=21.0s
step   250/900 tau=0.3786 loss=0.282021 mse_soft=0.281559 ent_in=1.1693 ent_out=0.3712 rowmax_in=0.5217 rowmax_out=0.8329 discrete_mse=367.825684 best_discrete=18.258329 hash=False elapsed=23.4s
step   275/900 tau=0.3434 loss=0.280797 mse_soft=0.280349 ent_in=1.1453 ent_out=0.3479 rowmax_in=0.5249 rowmax_out=0.8354 discrete_mse=673.574463 best_discrete=18.258329 hash=False elapsed=25.6s
step   300/900 tau=0.3115 loss=0.277379 mse_soft=0.276942 ent_in=1.1270 ent_out=0.3314 rowmax_in=0.5316 rowmax_out=0.8342 discrete_mse=673.574463 best_discrete=18.258329 hash=False elapsed=27.9s
step   325/900 tau=0.2826 loss=0.276390 mse_soft=0.275959 ent_in=1.1165 ent_out=0.3220 rowmax_in=0.5326 rowmax_out=0.8393 discrete_mse=207.577682 best_discrete=18.258329 hash=False elapsed=30.1s
step   350/900 tau=0.2563 loss=0.276565 mse_soft=0.276135 ent_in=1.1144 ent_out=0.3182 rowmax_in=0.5328 rowmax_out=0.8419 discrete_mse=289.952393 best_discrete=18.258329 hash=False elapsed=32.4s
step   375/900 tau=0.2325 loss=0.276608 mse_soft=0.276181 ent_in=1.1112 ent_out=0.3123 rowmax_in=0.5336 rowmax_out=0.8446 discrete_mse=289.952393 best_discrete=18.258329 hash=False elapsed=34.7s
step   400/900 tau=0.2109 loss=0.276564 mse_soft=0.276139 ent_in=1.1087 ent_out=0.3103 rowmax_in=0.5328 rowmax_out=0.8453 discrete_mse=260.847260 best_discrete=18.258329 hash=False elapsed=37.1s
step   425/900 tau=0.1913 loss=0.276113 mse_soft=0.275691 ent_in=1.1020 ent_out=0.3061 rowmax_in=0.5282 rowmax_out=0.8495 discrete_mse=124.507462 best_discrete=18.258329 hash=False elapsed=39.4s
step   450/900 tau=0.1735 loss=0.278235 mse_soft=0.277819 ent_in=1.0901 ent_out=0.2962 rowmax_in=0.5309 rowmax_out=0.8591 discrete_mse=46.678669 best_discrete=18.258329 hash=False elapsed=41.5s
step   475/900 tau=0.1574 loss=0.275586 mse_soft=0.275177 ent_in=1.0766 ent_out=0.2863 rowmax_in=0.5342 rowmax_out=0.8656 discrete_mse=28.851442 best_discrete=18.258329 hash=False elapsed=43.8s
step   500/900 tau=0.1428 loss=0.274937 mse_soft=0.274535 ent_in=1.0649 ent_out=0.2746 rowmax_in=0.5358 rowmax_out=0.8723 discrete_mse=114.452385 best_discrete=18.258329 hash=False elapsed=46.3s
step   525/900 tau=0.1295 loss=0.272631 mse_soft=0.272241 ent_in=1.0507 ent_out=0.2490 rowmax_in=0.5398 rowmax_out=0.8808 discrete_mse=199.328476 best_discrete=18.258329 hash=False elapsed=48.3s
step   550/900 tau=0.1175 loss=0.279035 mse_soft=0.278653 ent_in=1.0377 ent_out=0.2350 rowmax_in=0.5401 rowmax_out=0.8840 discrete_mse=114.452385 best_discrete=18.258329 hash=False elapsed=50.6s
step   575/900 tau=0.1066 loss=0.281730 mse_soft=0.281352 ent_in=1.0307 ent_out=0.2301 rowmax_in=0.5409 rowmax_out=0.8881 discrete_mse=199.328476 best_discrete=18.258329 hash=False elapsed=53.0s
step   600/900 tau=0.0967 loss=0.274489 mse_soft=0.274111 ent_in=1.0277 ent_out=0.2297 rowmax_in=0.5407 rowmax_out=0.8878 discrete_mse=114.452385 best_discrete=18.258329 hash=False elapsed=55.5s
step   625/900 tau=0.0877 loss=0.299971 mse_soft=0.299600 ent_in=1.0136 ent_out=0.2231 rowmax_in=0.5461 rowmax_out=0.8935 discrete_mse=105.896194 best_discrete=18.258329 hash=False elapsed=57.9s
step   650/900 tau=0.0795 loss=0.282809 mse_soft=0.282441 ent_in=1.0056 ent_out=0.2228 rowmax_in=0.5451 rowmax_out=0.8882 discrete_mse=114.452385 best_discrete=18.258329 hash=False elapsed=60.2s
step   675/900 tau=0.0722 loss=0.273955 mse_soft=0.273590 ent_in=0.9961 ent_out=0.2230 rowmax_in=0.5482 rowmax_out=0.8913 discrete_mse=114.452385 best_discrete=18.258329 hash=False elapsed=62.5s
step   700/900 tau=0.0655 loss=0.286103 mse_soft=0.285745 ent_in=0.9802 ent_out=0.2123 rowmax_in=0.5602 rowmax_out=0.9010 discrete_mse=41.821430 best_discrete=18.258329 hash=False elapsed=64.8s
step   725/900 tau=0.0594 loss=0.318120 mse_soft=0.317830 ent_in=0.7696 ent_out=0.1973 rowmax_in=0.6249 rowmax_out=0.8998 discrete_mse=84.543076 best_discrete=18.258329 hash=False elapsed=67.0s
step   750/900 tau=0.0539 loss=0.291935 mse_soft=0.291636 ent_in=0.8113 ent_out=0.1851 rowmax_in=0.5865 rowmax_out=0.9125 discrete_mse=82.331154 best_discrete=18.258329 hash=False elapsed=69.4s
step   775/900 tau=0.0489 loss=0.289447 mse_soft=0.289146 ent_in=0.8173 ent_out=0.1858 rowmax_in=0.5822 rowmax_out=0.9123 discrete_mse=60.525860 best_discrete=18.258329 hash=False elapsed=71.4s
step   800/900 tau=0.0443 loss=0.294228 mse_soft=0.293936 ent_in=0.7936 ent_out=0.1787 rowmax_in=0.6024 rowmax_out=0.9171 discrete_mse=83.221413 best_discrete=18.258329 hash=False elapsed=73.7s
step   825/900 tau=0.0402 loss=0.536899 mse_soft=0.536771 ent_in=0.3585 ent_out=0.0680 rowmax_in=0.8321 rowmax_out=0.9655 discrete_mse=10.915818 best_discrete=10.915818 hash=False elapsed=75.9s
step   850/900 tau=0.0365 loss=0.455115 mse_soft=0.454982 ent_in=0.3780 ent_out=0.0665 rowmax_in=0.8046 rowmax_out=0.9657 discrete_mse=34.002361 best_discrete=10.915818 hash=False elapsed=78.3s
step   875/900 tau=0.0331 loss=0.629972 mse_soft=0.629873 ent_in=0.2597 ent_out=0.0687 rowmax_in=0.8846 rowmax_out=0.9649 discrete_mse=0.780291 best_discrete=0.780291 hash=False elapsed=80.4s
step   900/900 tau=0.0300 loss=0.592644 mse_soft=0.592552 ent_in=0.2417 ent_out=0.0675 rowmax_in=0.8875 rowmax_out=0.9653 discrete_mse=0.714917 best_discrete=0.714917 hash=False elapsed=82.4s

Final metrics:
  soft_mse_full=0.565605
  rowmax_in_mean=0.8872
  rowmax_out_mean=0.9653
  ent_in_mean=0.2420
  ent_out_mean=0.0676
  final_discrete_mse=0.714917
  hash_match=False
  best_discrete_mse_seen=0.714917
Saved results to overnight_b059_j1.json
