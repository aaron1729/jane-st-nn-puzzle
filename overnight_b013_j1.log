Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.079085 mse_soft=1.076762 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=18.967890 best_discrete=18.967890 hash=False elapsed=0.6s
step    25/900 tau=0.9106 loss=0.871509 mse_soft=0.869317 ent_in=3.6372 ent_out=3.6689 rowmax_in=0.0449 rowmax_out=0.0439 discrete_mse=1057.224121 best_discrete=18.967890 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.652017 mse_soft=0.650099 ent_in=3.1489 ent_out=3.2456 rowmax_in=0.0903 rowmax_out=0.0866 discrete_mse=1519.880005 best_discrete=18.967890 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.507501 mse_soft=0.505902 ent_in=2.6262 ent_out=2.7025 rowmax_in=0.2038 rowmax_out=0.1987 discrete_mse=740.454590 best_discrete=18.967890 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.410826 mse_soft=0.409605 ent_in=2.0845 ent_out=1.9857 rowmax_in=0.3401 rowmax_out=0.3595 discrete_mse=1199.361206 best_discrete=18.967890 hash=False elapsed=9.6s
step   125/900 tau=0.6165 loss=0.346995 mse_soft=0.346089 ent_in=1.6684 ent_out=1.3535 rowmax_in=0.4374 rowmax_out=0.5549 discrete_mse=327.115814 best_discrete=18.967890 hash=False elapsed=11.8s
step   150/900 tau=0.5592 loss=0.318000 mse_soft=0.317275 ent_in=1.4432 ent_out=0.9736 rowmax_in=0.4771 rowmax_out=0.6766 discrete_mse=491.643646 best_discrete=18.967890 hash=False elapsed=14.1s
step   175/900 tau=0.5073 loss=0.305377 mse_soft=0.304745 ent_in=1.3459 ent_out=0.7598 rowmax_in=0.4916 rowmax_out=0.7344 discrete_mse=706.255859 best_discrete=18.967890 hash=False elapsed=16.4s
step   200/900 tau=0.4602 loss=0.295497 mse_soft=0.294939 ent_in=1.2907 ent_out=0.5705 rowmax_in=0.4963 rowmax_out=0.7952 discrete_mse=555.116760 best_discrete=18.967890 hash=False elapsed=18.7s
step   225/900 tau=0.4174 loss=0.289970 mse_soft=0.289453 ent_in=1.2525 ent_out=0.4737 rowmax_in=0.5026 rowmax_out=0.8230 discrete_mse=439.112976 best_discrete=18.967890 hash=False elapsed=21.0s
step   250/900 tau=0.3786 loss=0.286932 mse_soft=0.286439 ent_in=1.2253 ent_out=0.4160 rowmax_in=0.5099 rowmax_out=0.8370 discrete_mse=856.137451 best_discrete=18.967890 hash=False elapsed=23.2s
step   275/900 tau=0.3434 loss=0.286601 mse_soft=0.286123 ent_in=1.2044 ent_out=0.3893 rowmax_in=0.5138 rowmax_out=0.8437 discrete_mse=439.112976 best_discrete=18.967890 hash=False elapsed=25.5s
step   300/900 tau=0.3115 loss=0.285255 mse_soft=0.284784 ent_in=1.1978 ent_out=0.3712 rowmax_in=0.5141 rowmax_out=0.8491 discrete_mse=529.637451 best_discrete=18.967890 hash=False elapsed=27.7s
step   325/900 tau=0.2826 loss=0.284463 mse_soft=0.283998 ent_in=1.1930 ent_out=0.3580 rowmax_in=0.5150 rowmax_out=0.8531 discrete_mse=856.137451 best_discrete=18.967890 hash=False elapsed=29.9s
step   350/900 tau=0.2563 loss=0.284114 mse_soft=0.283655 ent_in=1.1891 ent_out=0.3403 rowmax_in=0.5159 rowmax_out=0.8586 discrete_mse=856.137451 best_discrete=18.967890 hash=False elapsed=32.0s
step   375/900 tau=0.2325 loss=0.283324 mse_soft=0.282872 ent_in=1.1841 ent_out=0.3224 rowmax_in=0.5168 rowmax_out=0.8643 discrete_mse=523.591187 best_discrete=18.967890 hash=False elapsed=33.9s
step   400/900 tau=0.2109 loss=0.283338 mse_soft=0.282892 ent_in=1.1779 ent_out=0.3080 rowmax_in=0.5186 rowmax_out=0.8661 discrete_mse=523.591187 best_discrete=18.967890 hash=False elapsed=35.9s
step   425/900 tau=0.1913 loss=0.284997 mse_soft=0.284557 ent_in=1.1732 ent_out=0.2944 rowmax_in=0.5197 rowmax_out=0.8689 discrete_mse=523.591187 best_discrete=18.967890 hash=False elapsed=37.8s
step   450/900 tau=0.1735 loss=0.282081 mse_soft=0.281643 ent_in=1.1745 ent_out=0.2843 rowmax_in=0.5187 rowmax_out=0.8716 discrete_mse=523.591187 best_discrete=18.967890 hash=False elapsed=39.7s
step   475/900 tau=0.1574 loss=0.282260 mse_soft=0.281824 ent_in=1.1765 ent_out=0.2776 rowmax_in=0.5168 rowmax_out=0.8741 discrete_mse=318.345032 best_discrete=18.967890 hash=False elapsed=41.7s
step   500/900 tau=0.1428 loss=0.286239 mse_soft=0.285803 ent_in=1.1786 ent_out=0.2724 rowmax_in=0.5146 rowmax_out=0.8766 discrete_mse=310.221375 best_discrete=18.967890 hash=False elapsed=43.6s
step   525/900 tau=0.1295 loss=0.287628 mse_soft=0.287195 ent_in=1.1719 ent_out=0.2717 rowmax_in=0.5153 rowmax_out=0.8753 discrete_mse=532.986206 best_discrete=18.967890 hash=False elapsed=45.5s
step   550/900 tau=0.1175 loss=0.294365 mse_soft=0.293936 ent_in=1.1709 ent_out=0.2581 rowmax_in=0.5155 rowmax_out=0.8807 discrete_mse=379.879700 best_discrete=18.967890 hash=False elapsed=47.4s
step   575/900 tau=0.1066 loss=0.283415 mse_soft=0.282991 ent_in=1.1634 ent_out=0.2500 rowmax_in=0.5151 rowmax_out=0.8789 discrete_mse=245.985291 best_discrete=18.967890 hash=False elapsed=49.4s
step   600/900 tau=0.0967 loss=0.291210 mse_soft=0.290791 ent_in=1.1537 ent_out=0.2424 rowmax_in=0.5216 rowmax_out=0.8807 discrete_mse=245.985291 best_discrete=18.967890 hash=False elapsed=51.3s
step   625/900 tau=0.0877 loss=0.309079 mse_soft=0.308663 ent_in=1.1451 ent_out=0.2418 rowmax_in=0.5215 rowmax_out=0.8799 discrete_mse=555.744019 best_discrete=18.967890 hash=False elapsed=53.2s
step   650/900 tau=0.0795 loss=0.301639 mse_soft=0.301229 ent_in=1.1283 ent_out=0.2358 rowmax_in=0.5212 rowmax_out=0.8803 discrete_mse=499.814301 best_discrete=18.967890 hash=False elapsed=55.2s
step   675/900 tau=0.0722 loss=0.295843 mse_soft=0.295436 ent_in=1.1321 ent_out=0.2228 rowmax_in=0.5255 rowmax_out=0.8886 discrete_mse=245.985291 best_discrete=18.967890 hash=False elapsed=57.2s
step   700/900 tau=0.0655 loss=0.328540 mse_soft=0.328160 ent_in=1.0409 ent_out=0.2270 rowmax_in=0.5608 rowmax_out=0.8780 discrete_mse=303.116852 best_discrete=18.967890 hash=False elapsed=59.1s
step   725/900 tau=0.0594 loss=0.309857 mse_soft=0.309498 ent_in=0.9719 ent_out=0.2248 rowmax_in=0.5768 rowmax_out=0.8774 discrete_mse=150.631516 best_discrete=18.967890 hash=False elapsed=61.0s
step   750/900 tau=0.0539 loss=0.308442 mse_soft=0.308088 ent_in=0.9633 ent_out=0.2177 rowmax_in=0.5845 rowmax_out=0.8858 discrete_mse=236.854950 best_discrete=18.967890 hash=False elapsed=62.9s
step   775/900 tau=0.0489 loss=0.309647 mse_soft=0.309289 ent_in=0.9772 ent_out=0.2150 rowmax_in=0.5753 rowmax_out=0.8864 discrete_mse=71.998520 best_discrete=18.967890 hash=False elapsed=64.9s
step   800/900 tau=0.0443 loss=0.319180 mse_soft=0.318862 ent_in=0.8774 ent_out=0.1823 rowmax_in=0.6064 rowmax_out=0.9018 discrete_mse=316.578247 best_discrete=18.967890 hash=False elapsed=66.8s
step   825/900 tau=0.0402 loss=0.305694 mse_soft=0.305400 ent_in=0.8002 ent_out=0.1784 rowmax_in=0.6377 rowmax_out=0.9068 discrete_mse=323.194885 best_discrete=18.967890 hash=False elapsed=68.9s
step   850/900 tau=0.0365 loss=0.396291 mse_soft=0.396007 ent_in=0.7616 ent_out=0.1818 rowmax_in=0.6555 rowmax_out=0.9099 discrete_mse=70.478569 best_discrete=18.967890 hash=False elapsed=71.0s
step   875/900 tau=0.0331 loss=0.513897 mse_soft=0.513779 ent_in=0.3213 ent_out=0.0747 rowmax_in=0.8198 rowmax_out=0.9583 discrete_mse=197.964890 best_discrete=18.967890 hash=False elapsed=73.0s
step   900/900 tau=0.0300 loss=0.496707 mse_soft=0.496589 ent_in=0.3181 ent_out=0.0728 rowmax_in=0.8146 rowmax_out=0.9586 discrete_mse=162.966888 best_discrete=18.967890 hash=False elapsed=75.3s

Final metrics:
  soft_mse_full=0.487234
  rowmax_in_mean=0.8131
  rowmax_out_mean=0.9585
  ent_in_mean=0.3208
  ent_out_mean=0.0730
  final_discrete_mse=162.966888
  hash_match=False
  best_discrete_mse_seen=18.967890
Saved results to overnight_b013_j1.json
