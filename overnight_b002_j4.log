Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.015
step     1/700 tau=1.0000 loss=1.064205 mse_soft=1.063431 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=8.969029 best_discrete=8.969029 hash=False elapsed=0.6s
step    25/700 tau=0.8810 loss=0.972077 mse_soft=0.971317 ent_in=3.7930 ent_out=3.8054 rowmax_in=0.0331 rowmax_out=0.0323 discrete_mse=1903.897095 best_discrete=8.969029 hash=False elapsed=2.8s
step    50/700 tau=0.7721 loss=0.787201 mse_soft=0.786492 ent_in=3.5155 ent_out=3.5657 rowmax_in=0.0563 rowmax_out=0.0545 discrete_mse=14402.782227 best_discrete=8.969029 hash=False elapsed=5.1s
step    75/700 tau=0.6767 loss=0.645305 mse_soft=0.644667 ent_in=3.1373 ent_out=3.2362 rowmax_in=0.0977 rowmax_out=0.0898 discrete_mse=3869.044678 best_discrete=8.969029 hash=False elapsed=7.3s
step   100/700 tau=0.5931 loss=0.532583 mse_soft=0.532028 ent_in=2.7207 ent_out=2.8357 rowmax_in=0.1840 rowmax_out=0.1628 discrete_mse=6991.379883 best_discrete=8.969029 hash=False elapsed=9.6s
step   125/700 tau=0.5198 loss=0.434517 mse_soft=0.434080 ent_in=2.1720 ent_out=2.1983 rowmax_in=0.3194 rowmax_out=0.3040 discrete_mse=2676.961182 best_discrete=8.969029 hash=False elapsed=11.9s
step   150/700 tau=0.4555 loss=0.361777 mse_soft=0.361446 ent_in=1.7578 ent_out=1.5576 rowmax_in=0.4166 rowmax_out=0.4983 discrete_mse=2534.511963 best_discrete=8.969029 hash=False elapsed=14.3s
step   175/700 tau=0.3992 loss=0.323327 mse_soft=0.323080 ent_in=1.4653 ent_out=1.0061 rowmax_in=0.4760 rowmax_out=0.6651 discrete_mse=3348.223633 best_discrete=8.969029 hash=False elapsed=16.5s
step   200/700 tau=0.3499 loss=0.307040 mse_soft=0.306834 ent_in=1.3298 ent_out=0.7248 rowmax_in=0.4931 rowmax_out=0.7353 discrete_mse=1035.506348 best_discrete=8.969029 hash=False elapsed=18.6s
step   225/700 tau=0.3066 loss=0.298416 mse_soft=0.298230 ent_in=1.2581 ent_out=0.6017 rowmax_in=0.5047 rowmax_out=0.7602 discrete_mse=559.820312 best_discrete=8.969029 hash=False elapsed=20.9s
step   250/700 tau=0.2687 loss=0.292800 mse_soft=0.292627 ent_in=1.2043 ent_out=0.5189 rowmax_in=0.5137 rowmax_out=0.7886 discrete_mse=808.685303 best_discrete=8.969029 hash=False elapsed=23.0s
step   275/700 tau=0.2355 loss=0.292164 mse_soft=0.291999 ent_in=1.1789 ent_out=0.4702 rowmax_in=0.5164 rowmax_out=0.7968 discrete_mse=808.685303 best_discrete=8.969029 hash=False elapsed=25.1s
step   300/700 tau=0.2064 loss=0.288964 mse_soft=0.288805 ent_in=1.1620 ent_out=0.4317 rowmax_in=0.5187 rowmax_out=0.8050 discrete_mse=1214.598511 best_discrete=8.969029 hash=False elapsed=27.2s
step   325/700 tau=0.1809 loss=0.290340 mse_soft=0.290183 ent_in=1.1548 ent_out=0.4093 rowmax_in=0.5180 rowmax_out=0.8105 discrete_mse=123.714645 best_discrete=8.969029 hash=False elapsed=29.4s
step   350/700 tau=0.1585 loss=0.286344 mse_soft=0.286189 ent_in=1.1500 ent_out=0.4023 rowmax_in=0.5184 rowmax_out=0.8115 discrete_mse=117.928856 best_discrete=8.969029 hash=False elapsed=31.6s
step   375/700 tau=0.1389 loss=0.288849 mse_soft=0.288695 ent_in=1.1409 ent_out=0.4008 rowmax_in=0.5215 rowmax_out=0.8140 discrete_mse=135.286240 best_discrete=8.969029 hash=False elapsed=33.7s
step   400/700 tau=0.1218 loss=0.285152 mse_soft=0.284999 ent_in=1.1318 ent_out=0.3963 rowmax_in=0.5222 rowmax_out=0.8189 discrete_mse=135.286240 best_discrete=8.969029 hash=False elapsed=35.8s
step   425/700 tau=0.1067 loss=0.286622 mse_soft=0.286471 ent_in=1.1248 ent_out=0.3910 rowmax_in=0.5229 rowmax_out=0.8199 discrete_mse=135.286240 best_discrete=8.969029 hash=False elapsed=38.1s
step   450/700 tau=0.0935 loss=0.287640 mse_soft=0.287489 ent_in=1.1200 ent_out=0.3900 rowmax_in=0.5225 rowmax_out=0.8195 discrete_mse=135.286240 best_discrete=8.969029 hash=False elapsed=40.2s
step   475/700 tau=0.0820 loss=0.295149 mse_soft=0.294999 ent_in=1.1126 ent_out=0.3838 rowmax_in=0.5223 rowmax_out=0.8249 discrete_mse=1156.721558 best_discrete=8.969029 hash=False elapsed=42.5s
step   500/700 tau=0.0718 loss=0.293383 mse_soft=0.293233 ent_in=1.1084 ent_out=0.3879 rowmax_in=0.5223 rowmax_out=0.8212 discrete_mse=413.307953 best_discrete=8.969029 hash=False elapsed=44.6s
step   525/700 tau=0.0630 loss=0.342844 mse_soft=0.342695 ent_in=1.1049 ent_out=0.3856 rowmax_in=0.5231 rowmax_out=0.8231 discrete_mse=1094.371582 best_discrete=8.969029 hash=False elapsed=46.9s
step   550/700 tau=0.0552 loss=0.300865 mse_soft=0.300724 ent_in=1.0240 ent_out=0.3805 rowmax_in=0.5571 rowmax_out=0.8179 discrete_mse=116.459869 best_discrete=8.969029 hash=False elapsed=49.0s
step   575/700 tau=0.0484 loss=0.294186 mse_soft=0.294046 ent_in=1.0139 ent_out=0.3859 rowmax_in=0.5501 rowmax_out=0.8151 discrete_mse=889.452271 best_discrete=8.969029 hash=False elapsed=51.2s
step   600/700 tau=0.0424 loss=0.294567 mse_soft=0.294429 ent_in=1.0008 ent_out=0.3830 rowmax_in=0.5628 rowmax_out=0.8169 discrete_mse=100.109970 best_discrete=8.969029 hash=False elapsed=53.5s
step   625/700 tau=0.0371 loss=0.304904 mse_soft=0.304771 ent_in=0.9464 ent_out=0.3814 rowmax_in=0.5766 rowmax_out=0.8135 discrete_mse=37.727871 best_discrete=8.969029 hash=False elapsed=55.8s
step   650/700 tau=0.0325 loss=0.306208 mse_soft=0.306080 ent_in=0.9231 ent_out=0.3527 rowmax_in=0.5847 rowmax_out=0.8281 discrete_mse=272.514557 best_discrete=8.969029 hash=False elapsed=58.0s
step   675/700 tau=0.0285 loss=0.300385 mse_soft=0.300259 ent_in=0.9163 ent_out=0.3489 rowmax_in=0.5845 rowmax_out=0.8264 discrete_mse=343.478577 best_discrete=8.969029 hash=False elapsed=60.1s
step   700/700 tau=0.0250 loss=0.342821 mse_soft=0.342714 ent_in=0.7605 ent_out=0.3164 rowmax_in=0.6228 rowmax_out=0.8336 discrete_mse=52.553555 best_discrete=8.969029 hash=False elapsed=62.5s

Final metrics:
  soft_mse_full=0.329463
  rowmax_in_mean=0.6305
  rowmax_out_mean=0.8313
  ent_in_mean=0.7557
  ent_out_mean=0.3208
  final_discrete_mse=24.973585
  hash_match=False
  best_discrete_mse_seen=8.969029
Saved results to overnight_b002_j4.json
