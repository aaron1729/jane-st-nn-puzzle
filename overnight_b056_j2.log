Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.061637 mse_soft=1.059315 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=393.585999 best_discrete=393.585999 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.863174 mse_soft=0.860983 ent_in=3.6325 ent_out=3.6693 rowmax_in=0.0461 rowmax_out=0.0447 discrete_mse=916.271057 best_discrete=393.585999 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.652414 mse_soft=0.650511 ent_in=3.1200 ent_out=3.2237 rowmax_in=0.0947 rowmax_out=0.0878 discrete_mse=1526.519043 best_discrete=393.585999 hash=False elapsed=5.1s
step    75/900 tau=0.7450 loss=0.508925 mse_soft=0.507357 ent_in=2.5733 ent_out=2.6544 rowmax_in=0.2075 rowmax_out=0.2004 discrete_mse=990.880981 best_discrete=393.585999 hash=False elapsed=7.1s
step   100/900 tau=0.6745 loss=0.391024 mse_soft=0.389869 ent_in=1.9794 ent_out=1.8708 rowmax_in=0.3602 rowmax_out=0.3961 discrete_mse=530.999084 best_discrete=393.585999 hash=False elapsed=9.3s
step   125/900 tau=0.6107 loss=0.334576 mse_soft=0.333742 ent_in=1.5450 ent_out=1.2344 rowmax_in=0.4654 rowmax_out=0.5791 discrete_mse=1474.860962 best_discrete=393.585999 hash=False elapsed=11.3s
step   150/900 tau=0.5529 loss=0.310101 mse_soft=0.309434 ent_in=1.3723 ent_out=0.8537 rowmax_in=0.4946 rowmax_out=0.6867 discrete_mse=520.408508 best_discrete=393.585999 hash=False elapsed=13.3s
step   175/900 tau=0.5006 loss=0.297756 mse_soft=0.297158 ent_in=1.2918 ent_out=0.7007 rowmax_in=0.5044 rowmax_out=0.7307 discrete_mse=524.917664 best_discrete=393.585999 hash=False elapsed=15.4s
step   200/900 tau=0.4532 loss=0.290212 mse_soft=0.289655 ent_in=1.2396 ent_out=0.6184 rowmax_in=0.5092 rowmax_out=0.7520 discrete_mse=644.222961 best_discrete=393.585999 hash=False elapsed=17.3s
step   225/900 tau=0.4103 loss=0.286122 mse_soft=0.285595 ent_in=1.1936 ent_out=0.5638 rowmax_in=0.5174 rowmax_out=0.7624 discrete_mse=498.392395 best_discrete=393.585999 hash=False elapsed=19.2s
step   250/900 tau=0.3715 loss=0.283234 mse_soft=0.282726 ent_in=1.1625 ent_out=0.5308 rowmax_in=0.5197 rowmax_out=0.7716 discrete_mse=508.551300 best_discrete=393.585999 hash=False elapsed=21.2s
step   275/900 tau=0.3363 loss=0.280461 mse_soft=0.279966 ent_in=1.1382 ent_out=0.5135 rowmax_in=0.5210 rowmax_out=0.7765 discrete_mse=909.414185 best_discrete=393.585999 hash=False elapsed=23.3s
step   300/900 tau=0.3045 loss=0.280264 mse_soft=0.279776 ent_in=1.1236 ent_out=0.5025 rowmax_in=0.5231 rowmax_out=0.7773 discrete_mse=909.414185 best_discrete=393.585999 hash=False elapsed=25.4s
step   325/900 tau=0.2756 loss=0.280249 mse_soft=0.279767 ent_in=1.1150 ent_out=0.4925 rowmax_in=0.5238 rowmax_out=0.7773 discrete_mse=909.414185 best_discrete=393.585999 hash=False elapsed=27.7s
step   350/900 tau=0.2496 loss=0.281404 mse_soft=0.280924 ent_in=1.1124 ent_out=0.4866 rowmax_in=0.5229 rowmax_out=0.7778 discrete_mse=909.414185 best_discrete=393.585999 hash=False elapsed=30.1s
step   375/900 tau=0.2259 loss=0.277920 mse_soft=0.277442 ent_in=1.1109 ent_out=0.4824 rowmax_in=0.5224 rowmax_out=0.7775 discrete_mse=1128.764160 best_discrete=393.585999 hash=False elapsed=32.4s
step   400/900 tau=0.2046 loss=0.282153 mse_soft=0.281677 ent_in=1.1103 ent_out=0.4759 rowmax_in=0.5215 rowmax_out=0.7795 discrete_mse=1128.764160 best_discrete=393.585999 hash=False elapsed=34.6s
step   425/900 tau=0.1852 loss=0.282951 mse_soft=0.282477 ent_in=1.1099 ent_out=0.4720 rowmax_in=0.5207 rowmax_out=0.7792 discrete_mse=712.889343 best_discrete=393.585999 hash=False elapsed=36.9s
step   450/900 tau=0.1677 loss=0.277909 mse_soft=0.277436 ent_in=1.1074 ent_out=0.4705 rowmax_in=0.5201 rowmax_out=0.7789 discrete_mse=867.668396 best_discrete=393.585999 hash=False elapsed=39.3s
step   475/900 tau=0.1518 loss=0.278740 mse_soft=0.278268 ent_in=1.1042 ent_out=0.4686 rowmax_in=0.5195 rowmax_out=0.7802 discrete_mse=900.619995 best_discrete=393.585999 hash=False elapsed=41.4s
step   500/900 tau=0.1374 loss=0.277460 mse_soft=0.276991 ent_in=1.0966 ent_out=0.4659 rowmax_in=0.5214 rowmax_out=0.7824 discrete_mse=2540.242676 best_discrete=393.585999 hash=False elapsed=43.3s
step   525/900 tau=0.1244 loss=0.280304 mse_soft=0.279839 ent_in=1.0929 ent_out=0.4589 rowmax_in=0.5218 rowmax_out=0.7877 discrete_mse=1247.882812 best_discrete=393.585999 hash=False elapsed=45.4s
step   550/900 tau=0.1126 loss=0.284589 mse_soft=0.284128 ent_in=1.0836 ent_out=0.4531 rowmax_in=0.5259 rowmax_out=0.7883 discrete_mse=1379.361328 best_discrete=393.585999 hash=False elapsed=47.5s
step   575/900 tau=0.1020 loss=0.294657 mse_soft=0.294201 ent_in=1.0807 ent_out=0.4401 rowmax_in=0.5242 rowmax_out=0.7940 discrete_mse=729.607666 best_discrete=393.585999 hash=False elapsed=49.6s
step   600/900 tau=0.0923 loss=0.294381 mse_soft=0.293927 ent_in=1.0783 ent_out=0.4344 rowmax_in=0.5212 rowmax_out=0.8012 discrete_mse=811.699463 best_discrete=393.585999 hash=False elapsed=51.6s
step   625/900 tau=0.0836 loss=0.338412 mse_soft=0.337979 ent_in=1.0451 ent_out=0.3995 rowmax_in=0.5455 rowmax_out=0.8209 discrete_mse=840.653076 best_discrete=393.585999 hash=False elapsed=53.5s
step   650/900 tau=0.0757 loss=0.310754 mse_soft=0.310353 ent_in=0.9460 ent_out=0.3912 rowmax_in=0.5582 rowmax_out=0.8127 discrete_mse=323.007721 best_discrete=323.007721 hash=False elapsed=55.6s
step   675/900 tau=0.0685 loss=0.296236 mse_soft=0.295833 ent_in=0.9454 ent_out=0.3981 rowmax_in=0.5555 rowmax_out=0.8059 discrete_mse=75.738907 best_discrete=75.738907 hash=False elapsed=57.8s
step   700/900 tau=0.0620 loss=0.302315 mse_soft=0.301927 ent_in=0.9074 ent_out=0.3853 rowmax_in=0.5662 rowmax_out=0.8081 discrete_mse=331.857788 best_discrete=75.738907 hash=False elapsed=59.8s
step   725/900 tau=0.0562 loss=0.301921 mse_soft=0.301523 ent_in=0.9186 ent_out=0.4082 rowmax_in=0.5558 rowmax_out=0.7899 discrete_mse=229.029770 best_discrete=75.738907 hash=False elapsed=61.7s
step   750/900 tau=0.0508 loss=0.294262 mse_soft=0.293866 ent_in=0.9065 ent_out=0.4154 rowmax_in=0.5560 rowmax_out=0.7912 discrete_mse=240.755997 best_discrete=75.738907 hash=False elapsed=63.8s
step   775/900 tau=0.0460 loss=0.459187 mse_soft=0.458911 ent_in=0.5928 ent_out=0.3283 rowmax_in=0.7235 rowmax_out=0.8503 discrete_mse=1.511292 best_discrete=1.511292 hash=False elapsed=65.7s
step   800/900 tau=0.0417 loss=0.415116 mse_soft=0.414925 ent_in=0.4423 ent_out=0.1961 rowmax_in=0.7727 rowmax_out=0.9078 discrete_mse=4.835398 best_discrete=1.511292 hash=False elapsed=67.6s
step   825/900 tau=0.0377 loss=0.370366 mse_soft=0.370168 ent_in=0.4370 ent_out=0.2231 rowmax_in=0.7601 rowmax_out=0.8874 discrete_mse=14.720273 best_discrete=1.511292 hash=False elapsed=69.8s
step   850/900 tau=0.0342 loss=0.366866 mse_soft=0.366663 ent_in=0.4454 ent_out=0.2300 rowmax_in=0.7717 rowmax_out=0.8832 discrete_mse=13.676981 best_discrete=1.511292 hash=False elapsed=71.9s
step   875/900 tau=0.0309 loss=0.390351 mse_soft=0.390184 ent_in=0.3531 ent_out=0.2043 rowmax_in=0.8130 rowmax_out=0.8960 discrete_mse=28.325853 best_discrete=1.511292 hash=False elapsed=74.0s
step   900/900 tau=0.0280 loss=0.377720 mse_soft=0.377540 ent_in=0.3762 ent_out=0.2262 rowmax_in=0.7981 rowmax_out=0.8838 discrete_mse=5.548586 best_discrete=1.511292 hash=False elapsed=76.1s

Final metrics:
  soft_mse_full=0.387688
  rowmax_in_mean=0.7975
  rowmax_out_mean=0.8865
  ent_in_mean=0.3787
  ent_out_mean=0.2216
  final_discrete_mse=13.775746
  hash_match=False
  best_discrete_mse_seen=1.511292
Saved results to overnight_b056_j2.json
