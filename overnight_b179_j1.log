Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.053198 mse_soft=1.050875 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=17.843512 best_discrete=17.843512 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.853471 mse_soft=0.851282 ent_in=3.6314 ent_out=3.6663 rowmax_in=0.0454 rowmax_out=0.0452 discrete_mse=9907.423828 best_discrete=17.843512 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.644880 mse_soft=0.642971 ent_in=3.1349 ent_out=3.2284 rowmax_in=0.0901 rowmax_out=0.0887 discrete_mse=2342.588867 best_discrete=17.843512 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.506337 mse_soft=0.504754 ent_in=2.6137 ent_out=2.6650 rowmax_in=0.2037 rowmax_out=0.2042 discrete_mse=1228.417969 best_discrete=17.843512 hash=False elapsed=7.2s
step   100/900 tau=0.6797 loss=0.396279 mse_soft=0.395128 ent_in=2.0063 ent_out=1.8327 rowmax_in=0.3464 rowmax_out=0.4246 discrete_mse=319.355042 best_discrete=17.843512 hash=False elapsed=9.4s
step   125/900 tau=0.6165 loss=0.340480 mse_soft=0.339607 ent_in=1.6866 ent_out=1.2209 rowmax_in=0.4175 rowmax_out=0.6026 discrete_mse=1448.099976 best_discrete=17.843512 hash=False elapsed=11.5s
step   150/900 tau=0.5592 loss=0.321885 mse_soft=0.321136 ent_in=1.5550 ent_out=0.9425 rowmax_in=0.4348 rowmax_out=0.6774 discrete_mse=2540.393555 best_discrete=17.843512 hash=False elapsed=13.7s
step   175/900 tau=0.5073 loss=0.310439 mse_soft=0.309771 ent_in=1.4860 ent_out=0.7392 rowmax_in=0.4381 rowmax_out=0.7317 discrete_mse=1416.301880 best_discrete=17.843512 hash=False elapsed=15.9s
step   200/900 tau=0.4602 loss=0.302502 mse_soft=0.301895 ent_in=1.4421 ent_out=0.5794 rowmax_in=0.4441 rowmax_out=0.7853 discrete_mse=1179.038330 best_discrete=17.843512 hash=False elapsed=18.0s
step   225/900 tau=0.4174 loss=0.295560 mse_soft=0.294997 ent_in=1.4104 ent_out=0.4673 rowmax_in=0.4473 rowmax_out=0.8168 discrete_mse=899.174805 best_discrete=17.843512 hash=False elapsed=20.1s
step   250/900 tau=0.3786 loss=0.292574 mse_soft=0.292028 ent_in=1.3978 ent_out=0.4201 rowmax_in=0.4420 rowmax_out=0.8274 discrete_mse=850.039856 best_discrete=17.843512 hash=False elapsed=22.2s
step   275/900 tau=0.3434 loss=0.286820 mse_soft=0.286291 ent_in=1.3786 ent_out=0.3856 rowmax_in=0.4444 rowmax_out=0.8343 discrete_mse=905.172852 best_discrete=17.843512 hash=False elapsed=24.4s
step   300/900 tau=0.3115 loss=0.286533 mse_soft=0.286016 ent_in=1.3591 ent_out=0.3657 rowmax_in=0.4461 rowmax_out=0.8381 discrete_mse=356.193604 best_discrete=17.843512 hash=False elapsed=26.5s
step   325/900 tau=0.2826 loss=0.285275 mse_soft=0.284766 ent_in=1.3404 ent_out=0.3556 rowmax_in=0.4471 rowmax_out=0.8381 discrete_mse=388.952942 best_discrete=17.843512 hash=False elapsed=28.7s
step   350/900 tau=0.2563 loss=0.279740 mse_soft=0.279239 ent_in=1.3230 ent_out=0.3461 rowmax_in=0.4485 rowmax_out=0.8396 discrete_mse=712.016052 best_discrete=17.843512 hash=False elapsed=30.9s
step   375/900 tau=0.2325 loss=0.281906 mse_soft=0.281413 ent_in=1.3053 ent_out=0.3409 rowmax_in=0.4522 rowmax_out=0.8390 discrete_mse=546.964417 best_discrete=17.843512 hash=False elapsed=33.2s
step   400/900 tau=0.2109 loss=0.280223 mse_soft=0.279735 ent_in=1.2889 ent_out=0.3395 rowmax_in=0.4577 rowmax_out=0.8377 discrete_mse=1891.403564 best_discrete=17.843512 hash=False elapsed=35.4s
step   425/900 tau=0.1913 loss=0.276383 mse_soft=0.275902 ent_in=1.2705 ent_out=0.3316 rowmax_in=0.4600 rowmax_out=0.8405 discrete_mse=1281.669189 best_discrete=17.843512 hash=False elapsed=37.6s
step   450/900 tau=0.1735 loss=0.279276 mse_soft=0.278802 ent_in=1.2576 ent_out=0.3232 rowmax_in=0.4619 rowmax_out=0.8440 discrete_mse=1170.730225 best_discrete=17.843512 hash=False elapsed=39.9s
step   475/900 tau=0.1574 loss=0.286665 mse_soft=0.286194 ent_in=1.2502 ent_out=0.3186 rowmax_in=0.4630 rowmax_out=0.8436 discrete_mse=1521.537354 best_discrete=17.843512 hash=False elapsed=42.5s
step   500/900 tau=0.1428 loss=0.283313 mse_soft=0.282845 ent_in=1.2442 ent_out=0.3164 rowmax_in=0.4638 rowmax_out=0.8445 discrete_mse=360.933044 best_discrete=17.843512 hash=False elapsed=44.6s
step   525/900 tau=0.1295 loss=0.302468 mse_soft=0.302004 ent_in=1.2333 ent_out=0.3128 rowmax_in=0.4671 rowmax_out=0.8435 discrete_mse=1572.623413 best_discrete=17.843512 hash=False elapsed=46.6s
step   550/900 tau=0.1175 loss=0.274599 mse_soft=0.274137 ent_in=1.2282 ent_out=0.3120 rowmax_in=0.4651 rowmax_out=0.8453 discrete_mse=2582.586426 best_discrete=17.843512 hash=False elapsed=48.7s
step   575/900 tau=0.1066 loss=0.281156 mse_soft=0.280698 ent_in=1.2183 ent_out=0.3080 rowmax_in=0.4692 rowmax_out=0.8477 discrete_mse=696.581787 best_discrete=17.843512 hash=False elapsed=50.9s
step   600/900 tau=0.0967 loss=0.328610 mse_soft=0.328167 ent_in=1.1804 ent_out=0.2958 rowmax_in=0.4911 rowmax_out=0.8571 discrete_mse=870.958374 best_discrete=17.843512 hash=False elapsed=53.0s
step   625/900 tau=0.0877 loss=0.282957 mse_soft=0.282523 ent_in=1.1633 ent_out=0.2835 rowmax_in=0.4871 rowmax_out=0.8650 discrete_mse=513.446472 best_discrete=17.843512 hash=False elapsed=55.2s
step   650/900 tau=0.0795 loss=0.285344 mse_soft=0.284910 ent_in=1.1561 ent_out=0.2901 rowmax_in=0.4898 rowmax_out=0.8548 discrete_mse=870.958374 best_discrete=17.843512 hash=False elapsed=57.6s
step   675/900 tau=0.0722 loss=0.339953 mse_soft=0.339534 ent_in=1.1337 ent_out=0.2617 rowmax_in=0.4970 rowmax_out=0.8723 discrete_mse=493.192078 best_discrete=17.843512 hash=False elapsed=59.8s
step   700/900 tau=0.0655 loss=0.306407 mse_soft=0.306003 ent_in=1.0944 ent_out=0.2536 rowmax_in=0.5067 rowmax_out=0.8769 discrete_mse=921.448364 best_discrete=17.843512 hash=False elapsed=62.1s
step   725/900 tau=0.0594 loss=0.294066 mse_soft=0.293672 ent_in=1.0632 ent_out=0.2496 rowmax_in=0.5192 rowmax_out=0.8708 discrete_mse=964.752075 best_discrete=17.843512 hash=False elapsed=64.2s
step   750/900 tau=0.0539 loss=0.484029 mse_soft=0.483707 ent_in=0.8603 ent_out=0.2110 rowmax_in=0.6153 rowmax_out=0.8975 discrete_mse=163.769089 best_discrete=17.843512 hash=False elapsed=66.4s
step   775/900 tau=0.0489 loss=0.436428 mse_soft=0.436235 ent_in=0.4562 ent_out=0.1872 rowmax_in=0.7821 rowmax_out=0.8972 discrete_mse=45.972080 best_discrete=17.843512 hash=False elapsed=68.6s
step   800/900 tau=0.0443 loss=0.392619 mse_soft=0.392419 ent_in=0.4629 ent_out=0.2019 rowmax_in=0.7618 rowmax_out=0.8816 discrete_mse=5.949162 best_discrete=5.949162 hash=False elapsed=70.7s
step   825/900 tau=0.0402 loss=0.363654 mse_soft=0.363448 ent_in=0.4904 ent_out=0.1985 rowmax_in=0.7406 rowmax_out=0.8884 discrete_mse=4.891529 best_discrete=4.891529 hash=False elapsed=72.7s
step   850/900 tau=0.0365 loss=0.352935 mse_soft=0.352733 ent_in=0.4714 ent_out=0.2016 rowmax_in=0.7511 rowmax_out=0.8845 discrete_mse=9.682600 best_discrete=4.891529 hash=False elapsed=74.7s
step   875/900 tau=0.0331 loss=0.346515 mse_soft=0.346319 ent_in=0.4586 ent_out=0.1947 rowmax_in=0.7498 rowmax_out=0.8973 discrete_mse=168.367264 best_discrete=4.891529 hash=False elapsed=76.8s
step   900/900 tau=0.0300 loss=0.344240 mse_soft=0.344047 ent_in=0.4565 ent_out=0.1872 rowmax_in=0.7528 rowmax_out=0.8947 discrete_mse=582.632812 best_discrete=4.891529 hash=False elapsed=78.8s

Final metrics:
  soft_mse_full=0.354426
  rowmax_in_mean=0.7516
  rowmax_out_mean=0.8943
  ent_in_mean=0.4574
  ent_out_mean=0.1865
  final_discrete_mse=582.632812
  hash_match=False
  best_discrete_mse_seen=4.891529
Saved results to overnight_b179_j1.json
