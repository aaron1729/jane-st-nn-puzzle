Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.058884 mse_soft=1.056561 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=32.416973 best_discrete=32.416973 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.855237 mse_soft=0.853047 ent_in=3.6323 ent_out=3.6681 rowmax_in=0.0463 rowmax_out=0.0440 discrete_mse=3548.062256 best_discrete=32.416973 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.641642 mse_soft=0.639734 ent_in=3.1281 ent_out=3.2299 rowmax_in=0.0932 rowmax_out=0.0878 discrete_mse=3901.719971 best_discrete=32.416973 hash=False elapsed=4.6s
step    75/900 tau=0.7450 loss=0.510871 mse_soft=0.509283 ent_in=2.6093 ent_out=2.6862 rowmax_in=0.1962 rowmax_out=0.1934 discrete_mse=624.520813 best_discrete=32.416973 hash=False elapsed=6.7s
step   100/900 tau=0.6745 loss=0.400121 mse_soft=0.398952 ent_in=2.0223 ent_out=1.8741 rowmax_in=0.3360 rowmax_out=0.4038 discrete_mse=948.614746 best_discrete=32.416973 hash=False elapsed=8.7s
step   125/900 tau=0.6107 loss=0.346929 mse_soft=0.346066 ent_in=1.6673 ent_out=1.2086 rowmax_in=0.4080 rowmax_out=0.6115 discrete_mse=1568.117920 best_discrete=32.416973 hash=False elapsed=10.6s
step   150/900 tau=0.5529 loss=0.320529 mse_soft=0.319832 ent_in=1.4709 ent_out=0.8495 rowmax_in=0.4619 rowmax_out=0.7122 discrete_mse=389.040771 best_discrete=32.416973 hash=False elapsed=12.7s
step   175/900 tau=0.5006 loss=0.308355 mse_soft=0.307743 ent_in=1.3799 ent_out=0.6592 rowmax_in=0.4744 rowmax_out=0.7610 discrete_mse=107.582375 best_discrete=32.416973 hash=False elapsed=14.9s
step   200/900 tau=0.4532 loss=0.300083 mse_soft=0.299523 ent_in=1.3295 ent_out=0.5380 rowmax_in=0.4788 rowmax_out=0.7874 discrete_mse=157.579742 best_discrete=32.416973 hash=False elapsed=17.0s
step   225/900 tau=0.4103 loss=0.295412 mse_soft=0.294883 ent_in=1.2934 ent_out=0.4682 rowmax_in=0.4819 rowmax_out=0.7958 discrete_mse=1181.694580 best_discrete=32.416973 hash=False elapsed=19.1s
step   250/900 tau=0.3715 loss=0.291368 mse_soft=0.290863 ent_in=1.2705 ent_out=0.4120 rowmax_in=0.4838 rowmax_out=0.8198 discrete_mse=593.857056 best_discrete=32.416973 hash=False elapsed=21.1s
step   275/900 tau=0.3363 loss=0.288564 mse_soft=0.288074 ent_in=1.2594 ent_out=0.3751 rowmax_in=0.4834 rowmax_out=0.8355 discrete_mse=593.857056 best_discrete=32.416973 hash=False elapsed=23.2s
step   300/900 tau=0.3045 loss=0.287596 mse_soft=0.287119 ent_in=1.2410 ent_out=0.3506 rowmax_in=0.4880 rowmax_out=0.8447 discrete_mse=397.355042 best_discrete=32.416973 hash=False elapsed=25.2s
step   325/900 tau=0.2756 loss=0.283426 mse_soft=0.282957 ent_in=1.2278 ent_out=0.3351 rowmax_in=0.4883 rowmax_out=0.8522 discrete_mse=374.166077 best_discrete=32.416973 hash=False elapsed=27.1s
step   350/900 tau=0.2496 loss=0.284196 mse_soft=0.283733 ent_in=1.2132 ent_out=0.3295 rowmax_in=0.4909 rowmax_out=0.8568 discrete_mse=1324.099609 best_discrete=32.416973 hash=False elapsed=29.0s
step   375/900 tau=0.2259 loss=0.283143 mse_soft=0.282686 ent_in=1.2006 ent_out=0.3237 rowmax_in=0.4934 rowmax_out=0.8593 discrete_mse=931.785767 best_discrete=32.416973 hash=False elapsed=31.1s
step   400/900 tau=0.2046 loss=0.281355 mse_soft=0.280904 ent_in=1.1903 ent_out=0.3135 rowmax_in=0.4949 rowmax_out=0.8617 discrete_mse=3559.742432 best_discrete=32.416973 hash=False elapsed=33.3s
step   425/900 tau=0.1852 loss=0.279421 mse_soft=0.278977 ent_in=1.1817 ent_out=0.2990 rowmax_in=0.4968 rowmax_out=0.8668 discrete_mse=3559.742432 best_discrete=32.416973 hash=False elapsed=35.4s
step   450/900 tau=0.1677 loss=0.279286 mse_soft=0.278851 ent_in=1.1654 ent_out=0.2873 rowmax_in=0.5048 rowmax_out=0.8702 discrete_mse=866.756165 best_discrete=32.416973 hash=False elapsed=37.4s
step   475/900 tau=0.1518 loss=0.284473 mse_soft=0.284043 ent_in=1.1555 ent_out=0.2767 rowmax_in=0.5092 rowmax_out=0.8744 discrete_mse=2656.749023 best_discrete=32.416973 hash=False elapsed=39.4s
step   500/900 tau=0.1374 loss=0.282975 mse_soft=0.282549 ent_in=1.1485 ent_out=0.2710 rowmax_in=0.5100 rowmax_out=0.8754 discrete_mse=1008.657593 best_discrete=32.416973 hash=False elapsed=41.5s
step   525/900 tau=0.1244 loss=0.278038 mse_soft=0.277614 ent_in=1.1395 ent_out=0.2733 rowmax_in=0.5122 rowmax_out=0.8742 discrete_mse=2656.749023 best_discrete=32.416973 hash=False elapsed=43.7s
step   550/900 tau=0.1126 loss=0.287174 mse_soft=0.286752 ent_in=1.1355 ent_out=0.2725 rowmax_in=0.5134 rowmax_out=0.8735 discrete_mse=1008.657593 best_discrete=32.416973 hash=False elapsed=45.7s
step   575/900 tau=0.1020 loss=0.312624 mse_soft=0.312209 ent_in=1.1137 ent_out=0.2726 rowmax_in=0.5250 rowmax_out=0.8764 discrete_mse=2032.571167 best_discrete=32.416973 hash=False elapsed=48.0s
step   600/900 tau=0.0923 loss=0.294728 mse_soft=0.294306 ent_in=1.1203 ent_out=0.2875 rowmax_in=0.5204 rowmax_out=0.8668 discrete_mse=1311.620728 best_discrete=32.416973 hash=False elapsed=50.3s
step   625/900 tau=0.0836 loss=0.314792 mse_soft=0.314380 ent_in=1.0883 ent_out=0.2879 rowmax_in=0.5301 rowmax_out=0.8593 discrete_mse=939.818176 best_discrete=32.416973 hash=False elapsed=52.6s
step   650/900 tau=0.0757 loss=0.306896 mse_soft=0.306481 ent_in=1.0927 ent_out=0.2884 rowmax_in=0.5282 rowmax_out=0.8643 discrete_mse=1188.740723 best_discrete=32.416973 hash=False elapsed=54.7s
step   675/900 tau=0.0685 loss=0.443210 mse_soft=0.442841 ent_in=0.9775 ent_out=0.2507 rowmax_in=0.5695 rowmax_out=0.8780 discrete_mse=344.379517 best_discrete=32.416973 hash=False elapsed=56.9s
step   700/900 tau=0.0620 loss=0.354889 mse_soft=0.354630 ent_in=0.7105 ent_out=0.1539 rowmax_in=0.6787 rowmax_out=0.9214 discrete_mse=328.075928 best_discrete=32.416973 hash=False elapsed=59.2s
step   725/900 tau=0.0562 loss=0.340167 mse_soft=0.339907 ent_in=0.7198 ent_out=0.1462 rowmax_in=0.6588 rowmax_out=0.9208 discrete_mse=299.067688 best_discrete=32.416973 hash=False elapsed=61.5s
step   750/900 tau=0.0508 loss=0.350264 mse_soft=0.350004 ent_in=0.7216 ent_out=0.1441 rowmax_in=0.6470 rowmax_out=0.9235 discrete_mse=192.747726 best_discrete=32.416973 hash=False elapsed=63.7s
step   775/900 tau=0.0460 loss=0.345648 mse_soft=0.345389 ent_in=0.7288 ent_out=0.1359 rowmax_in=0.6355 rowmax_out=0.9287 discrete_mse=145.675186 best_discrete=32.416973 hash=False elapsed=66.0s
step   800/900 tau=0.0417 loss=0.489207 mse_soft=0.489021 ent_in=0.4834 ent_out=0.1351 rowmax_in=0.7763 rowmax_out=0.9303 discrete_mse=82.819054 best_discrete=32.416973 hash=False elapsed=68.1s
step   825/900 tau=0.0377 loss=0.494703 mse_soft=0.494571 ent_in=0.3546 ent_out=0.0860 rowmax_in=0.8414 rowmax_out=0.9422 discrete_mse=53.708485 best_discrete=32.416973 hash=False elapsed=70.3s
step   850/900 tau=0.0342 loss=0.469069 mse_soft=0.468936 ent_in=0.3753 ent_out=0.0706 rowmax_in=0.8288 rowmax_out=0.9479 discrete_mse=53.708485 best_discrete=32.416973 hash=False elapsed=72.2s
step   875/900 tau=0.0309 loss=0.511845 mse_soft=0.511744 ent_in=0.2554 ent_out=0.0796 rowmax_in=0.8889 rowmax_out=0.9435 discrete_mse=64.852402 best_discrete=32.416973 hash=False elapsed=74.2s
step   900/900 tau=0.0280 loss=0.482531 mse_soft=0.482424 ent_in=0.2693 ent_out=0.0889 rowmax_in=0.8764 rowmax_out=0.9327 discrete_mse=67.421440 best_discrete=32.416973 hash=False elapsed=76.2s

Final metrics:
  soft_mse_full=0.490404
  rowmax_in_mean=0.8749
  rowmax_out_mean=0.9307
  ent_in_mean=0.2723
  ent_out_mean=0.0888
  final_discrete_mse=67.421440
  hash_match=False
  best_discrete_mse_seen=32.416973
Saved results to overnight_b090_j2.json
