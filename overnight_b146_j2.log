Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.077353 mse_soft=1.075030 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=17.630907 best_discrete=17.630907 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.873399 mse_soft=0.871209 ent_in=3.6327 ent_out=3.6701 rowmax_in=0.0451 rowmax_out=0.0437 discrete_mse=690.645203 best_discrete=17.630907 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.661653 mse_soft=0.659742 ent_in=3.1321 ent_out=3.2370 rowmax_in=0.0910 rowmax_out=0.0862 discrete_mse=1047.264404 best_discrete=17.630907 hash=False elapsed=4.9s
step    75/900 tau=0.7450 loss=0.510647 mse_soft=0.509075 ent_in=2.5754 ent_out=2.6663 rowmax_in=0.2148 rowmax_out=0.2051 discrete_mse=1696.577515 best_discrete=17.630907 hash=False elapsed=7.1s
step   100/900 tau=0.6745 loss=0.396894 mse_soft=0.395745 ent_in=1.9686 ent_out=1.8640 rowmax_in=0.3549 rowmax_out=0.3968 discrete_mse=2106.053955 best_discrete=17.630907 hash=False elapsed=9.1s
step   125/900 tau=0.6107 loss=0.342322 mse_soft=0.341449 ent_in=1.5807 ent_out=1.3269 rowmax_in=0.4482 rowmax_out=0.5575 discrete_mse=4544.616211 best_discrete=17.630907 hash=False elapsed=11.3s
step   150/900 tau=0.5529 loss=0.315548 mse_soft=0.314838 ent_in=1.3949 ent_out=0.9711 rowmax_in=0.4869 rowmax_out=0.6596 discrete_mse=2793.326416 best_discrete=17.630907 hash=False elapsed=13.6s
step   175/900 tau=0.5006 loss=0.301532 mse_soft=0.300923 ent_in=1.2885 ent_out=0.7424 rowmax_in=0.5100 rowmax_out=0.7291 discrete_mse=1427.298828 best_discrete=17.630907 hash=False elapsed=15.7s
step   200/900 tau=0.4532 loss=0.293447 mse_soft=0.292891 ent_in=1.2269 ent_out=0.6251 rowmax_in=0.5213 rowmax_out=0.7554 discrete_mse=1346.088867 best_discrete=17.630907 hash=False elapsed=18.0s
step   225/900 tau=0.4103 loss=0.289774 mse_soft=0.289244 ent_in=1.1931 ent_out=0.5719 rowmax_in=0.5263 rowmax_out=0.7670 discrete_mse=963.163696 best_discrete=17.630907 hash=False elapsed=20.2s
step   250/900 tau=0.3715 loss=0.289593 mse_soft=0.289078 ent_in=1.1724 ent_out=0.5445 rowmax_in=0.5272 rowmax_out=0.7739 discrete_mse=168.645233 best_discrete=17.630907 hash=False elapsed=22.4s
step   275/900 tau=0.3363 loss=0.287141 mse_soft=0.286637 ent_in=1.1553 ent_out=0.5271 rowmax_in=0.5302 rowmax_out=0.7775 discrete_mse=29.117105 best_discrete=17.630907 hash=False elapsed=24.7s
step   300/900 tau=0.3045 loss=0.287202 mse_soft=0.286705 ent_in=1.1454 ent_out=0.5141 rowmax_in=0.5319 rowmax_out=0.7815 discrete_mse=29.117105 best_discrete=17.630907 hash=False elapsed=26.7s
step   325/900 tau=0.2756 loss=0.285335 mse_soft=0.284844 ent_in=1.1393 ent_out=0.5002 rowmax_in=0.5308 rowmax_out=0.7860 discrete_mse=72.466423 best_discrete=17.630907 hash=False elapsed=28.9s
step   350/900 tau=0.2496 loss=0.282494 mse_soft=0.282011 ent_in=1.1291 ent_out=0.4794 rowmax_in=0.5316 rowmax_out=0.7925 discrete_mse=510.516083 best_discrete=17.630907 hash=False elapsed=30.9s
step   375/900 tau=0.2259 loss=0.284456 mse_soft=0.283979 ent_in=1.1281 ent_out=0.4623 rowmax_in=0.5307 rowmax_out=0.7968 discrete_mse=510.516083 best_discrete=17.630907 hash=False elapsed=33.0s
step   400/900 tau=0.2046 loss=0.282596 mse_soft=0.282125 ent_in=1.1199 ent_out=0.4496 rowmax_in=0.5323 rowmax_out=0.8009 discrete_mse=413.138336 best_discrete=17.630907 hash=False elapsed=35.0s
step   425/900 tau=0.1852 loss=0.283559 mse_soft=0.283093 ent_in=1.1136 ent_out=0.4402 rowmax_in=0.5339 rowmax_out=0.8024 discrete_mse=413.138336 best_discrete=17.630907 hash=False elapsed=37.0s
step   450/900 tau=0.1677 loss=0.286912 mse_soft=0.286450 ent_in=1.1074 ent_out=0.4330 rowmax_in=0.5343 rowmax_out=0.8035 discrete_mse=413.138336 best_discrete=17.630907 hash=False elapsed=39.0s
step   475/900 tau=0.1518 loss=0.285391 mse_soft=0.284934 ent_in=1.1037 ent_out=0.4198 rowmax_in=0.5346 rowmax_out=0.8079 discrete_mse=211.579025 best_discrete=17.630907 hash=False elapsed=40.8s
step   500/900 tau=0.1374 loss=0.290691 mse_soft=0.290237 ent_in=1.1028 ent_out=0.4096 rowmax_in=0.5322 rowmax_out=0.8116 discrete_mse=478.968597 best_discrete=17.630907 hash=False elapsed=42.9s
step   525/900 tau=0.1244 loss=0.294646 mse_soft=0.294199 ent_in=1.0953 ent_out=0.3951 rowmax_in=0.5333 rowmax_out=0.8168 discrete_mse=205.902405 best_discrete=17.630907 hash=False elapsed=45.0s
step   550/900 tau=0.1126 loss=0.314814 mse_soft=0.314375 ent_in=1.0895 ent_out=0.3757 rowmax_in=0.5340 rowmax_out=0.8283 discrete_mse=184.921463 best_discrete=17.630907 hash=False elapsed=47.2s
step   575/900 tau=0.1020 loss=0.296344 mse_soft=0.295944 ent_in=0.9763 ent_out=0.3571 rowmax_in=0.5862 rowmax_out=0.8276 discrete_mse=7.784320 best_discrete=7.784320 hash=False elapsed=49.5s
step   600/900 tau=0.0923 loss=0.287945 mse_soft=0.287560 ent_in=0.9277 ent_out=0.3574 rowmax_in=0.5959 rowmax_out=0.8293 discrete_mse=30.306572 best_discrete=7.784320 hash=False elapsed=51.6s
step   625/900 tau=0.0836 loss=0.289616 mse_soft=0.289239 ent_in=0.9144 ent_out=0.3404 rowmax_in=0.5969 rowmax_out=0.8410 discrete_mse=16.200394 best_discrete=7.784320 hash=False elapsed=53.8s
step   650/900 tau=0.0757 loss=0.291876 mse_soft=0.291504 ent_in=0.9084 ent_out=0.3330 rowmax_in=0.5914 rowmax_out=0.8420 discrete_mse=60.450581 best_discrete=7.784320 hash=False elapsed=55.9s
step   675/900 tau=0.0685 loss=0.286850 mse_soft=0.286485 ent_in=0.8856 ent_out=0.3310 rowmax_in=0.5998 rowmax_out=0.8433 discrete_mse=43.699223 best_discrete=7.784320 hash=False elapsed=58.2s
step   700/900 tau=0.0620 loss=0.360990 mse_soft=0.360671 ent_in=0.7963 ent_out=0.2700 rowmax_in=0.6427 rowmax_out=0.8820 discrete_mse=41.291107 best_discrete=7.784320 hash=False elapsed=60.5s
step   725/900 tau=0.0562 loss=0.330779 mse_soft=0.330507 ent_in=0.6603 ent_out=0.2487 rowmax_in=0.6970 rowmax_out=0.8837 discrete_mse=135.687378 best_discrete=7.784320 hash=False elapsed=62.6s
step   750/900 tau=0.0508 loss=0.312581 mse_soft=0.312296 ent_in=0.6815 ent_out=0.2655 rowmax_in=0.6745 rowmax_out=0.8712 discrete_mse=89.355408 best_discrete=7.784320 hash=False elapsed=64.7s
step   775/900 tau=0.0460 loss=0.301795 mse_soft=0.301508 ent_in=0.7006 ent_out=0.2573 rowmax_in=0.6673 rowmax_out=0.8752 discrete_mse=53.652660 best_discrete=7.784320 hash=False elapsed=66.5s
step   800/900 tau=0.0417 loss=0.397550 mse_soft=0.397311 ent_in=0.5621 ent_out=0.2344 rowmax_in=0.7384 rowmax_out=0.8881 discrete_mse=86.118889 best_discrete=7.784320 hash=False elapsed=68.6s
step   825/900 tau=0.0377 loss=0.381349 mse_soft=0.381169 ent_in=0.4189 ent_out=0.1809 rowmax_in=0.7834 rowmax_out=0.9080 discrete_mse=63.470337 best_discrete=7.784320 hash=False elapsed=70.6s
step   850/900 tau=0.0342 loss=0.358083 mse_soft=0.357893 ent_in=0.4475 ent_out=0.1865 rowmax_in=0.7716 rowmax_out=0.9037 discrete_mse=46.569542 best_discrete=7.784320 hash=False elapsed=72.6s
step   875/900 tau=0.0309 loss=0.354063 mse_soft=0.353868 ent_in=0.4629 ent_out=0.1853 rowmax_in=0.7632 rowmax_out=0.9063 discrete_mse=75.950684 best_discrete=7.784320 hash=False elapsed=74.6s
step   900/900 tau=0.0280 loss=0.440873 mse_soft=0.440724 ent_in=0.3466 ent_out=0.1521 rowmax_in=0.8311 rowmax_out=0.9194 discrete_mse=67.745903 best_discrete=7.784320 hash=False elapsed=76.7s

Final metrics:
  soft_mse_full=0.447592
  rowmax_in_mean=0.8184
  rowmax_out_mean=0.9202
  ent_in_mean=0.3606
  ent_out_mean=0.1510
  final_discrete_mse=51.904228
  hash_match=False
  best_discrete_mse_seen=7.784320
Saved results to overnight_b146_j2.json
