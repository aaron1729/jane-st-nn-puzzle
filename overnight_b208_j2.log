Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.076494 mse_soft=1.074171 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=84.381432 best_discrete=84.381432 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.870449 mse_soft=0.868260 ent_in=3.6303 ent_out=3.6671 rowmax_in=0.0452 rowmax_out=0.0439 discrete_mse=1098.540283 best_discrete=84.381432 hash=False elapsed=2.9s
step    50/900 tau=0.8229 loss=0.658062 mse_soft=0.656159 ent_in=3.1237 ent_out=3.2199 rowmax_in=0.0938 rowmax_out=0.0881 discrete_mse=1040.620605 best_discrete=84.381432 hash=False elapsed=5.1s
step    75/900 tau=0.7450 loss=0.514812 mse_soft=0.513231 ent_in=2.5830 ent_out=2.6859 rowmax_in=0.2099 rowmax_out=0.2017 discrete_mse=889.384155 best_discrete=84.381432 hash=False elapsed=7.2s
step   100/900 tau=0.6745 loss=0.398921 mse_soft=0.397771 ent_in=1.9876 ent_out=1.8454 rowmax_in=0.3389 rowmax_out=0.4119 discrete_mse=831.527588 best_discrete=84.381432 hash=False elapsed=9.3s
step   125/900 tau=0.6107 loss=0.337225 mse_soft=0.336400 ent_in=1.6295 ent_out=1.1196 rowmax_in=0.4134 rowmax_out=0.6324 discrete_mse=376.399780 best_discrete=84.381432 hash=False elapsed=11.5s
step   150/900 tau=0.5529 loss=0.304344 mse_soft=0.303717 ent_in=1.4075 ent_out=0.6834 rowmax_in=0.4567 rowmax_out=0.7444 discrete_mse=132.627975 best_discrete=84.381432 hash=False elapsed=13.6s
step   175/900 tau=0.5006 loss=0.290279 mse_soft=0.289742 ent_in=1.3109 ent_out=0.4802 rowmax_in=0.4689 rowmax_out=0.8124 discrete_mse=280.036743 best_discrete=84.381432 hash=False elapsed=15.8s
step   200/900 tau=0.4532 loss=0.280188 mse_soft=0.279696 ent_in=1.2318 ent_out=0.4091 rowmax_in=0.4924 rowmax_out=0.8285 discrete_mse=147.591644 best_discrete=84.381432 hash=False elapsed=18.1s
step   225/900 tau=0.4103 loss=0.272904 mse_soft=0.272461 ent_in=1.1525 ent_out=0.3239 rowmax_in=0.5130 rowmax_out=0.8615 discrete_mse=53.862450 best_discrete=53.862450 hash=False elapsed=20.3s
step   250/900 tau=0.3715 loss=0.268879 mse_soft=0.268450 ent_in=1.1405 ent_out=0.2875 rowmax_in=0.5158 rowmax_out=0.8780 discrete_mse=46.751270 best_discrete=46.751270 hash=False elapsed=22.5s
step   275/900 tau=0.3363 loss=0.265715 mse_soft=0.265300 ent_in=1.1195 ent_out=0.2664 rowmax_in=0.5196 rowmax_out=0.8912 discrete_mse=55.145573 best_discrete=46.751270 hash=False elapsed=24.8s
step   300/900 tau=0.3045 loss=0.263683 mse_soft=0.263278 ent_in=1.1017 ent_out=0.2506 rowmax_in=0.5209 rowmax_out=0.8982 discrete_mse=36.469055 best_discrete=36.469055 hash=False elapsed=26.9s
step   325/900 tau=0.2756 loss=0.263242 mse_soft=0.262843 ent_in=1.0926 ent_out=0.2374 rowmax_in=0.5200 rowmax_out=0.9048 discrete_mse=36.469055 best_discrete=36.469055 hash=False elapsed=29.4s
step   350/900 tau=0.2496 loss=0.262384 mse_soft=0.261994 ent_in=1.0840 ent_out=0.2144 rowmax_in=0.5236 rowmax_out=0.9142 discrete_mse=23.467457 best_discrete=23.467457 hash=False elapsed=31.6s
step   375/900 tau=0.2259 loss=0.261135 mse_soft=0.260755 ent_in=1.0691 ent_out=0.1977 rowmax_in=0.5305 rowmax_out=0.9209 discrete_mse=23.467457 best_discrete=23.467457 hash=False elapsed=33.8s
step   400/900 tau=0.2046 loss=0.260872 mse_soft=0.260499 ent_in=1.0587 ent_out=0.1850 rowmax_in=0.5351 rowmax_out=0.9262 discrete_mse=23.467457 best_discrete=23.467457 hash=False elapsed=35.8s
step   425/900 tau=0.1852 loss=0.260971 mse_soft=0.260601 ent_in=1.0482 ent_out=0.1872 rowmax_in=0.5410 rowmax_out=0.9224 discrete_mse=6.200507 best_discrete=6.200507 hash=False elapsed=38.0s
step   450/900 tau=0.1677 loss=0.262564 mse_soft=0.262196 ent_in=1.0473 ent_out=0.1799 rowmax_in=0.5418 rowmax_out=0.9255 discrete_mse=6.200507 best_discrete=6.200507 hash=False elapsed=40.0s
step   475/900 tau=0.1518 loss=0.259813 mse_soft=0.259446 ent_in=1.0396 ent_out=0.1844 rowmax_in=0.5422 rowmax_out=0.9230 discrete_mse=33.814606 best_discrete=6.200507 hash=False elapsed=42.1s
step   500/900 tau=0.1374 loss=0.258841 mse_soft=0.258475 ent_in=1.0400 ent_out=0.1810 rowmax_in=0.5427 rowmax_out=0.9247 discrete_mse=6.200507 best_discrete=6.200507 hash=False elapsed=44.2s
step   525/900 tau=0.1244 loss=0.262015 mse_soft=0.261650 ent_in=1.0379 ent_out=0.1795 rowmax_in=0.5415 rowmax_out=0.9235 discrete_mse=6.200507 best_discrete=6.200507 hash=False elapsed=46.2s
step   550/900 tau=0.1126 loss=0.258437 mse_soft=0.258074 ent_in=1.0316 ent_out=0.1794 rowmax_in=0.5442 rowmax_out=0.9232 discrete_mse=19.568413 best_discrete=6.200507 hash=False elapsed=48.4s
step   575/900 tau=0.1020 loss=0.260250 mse_soft=0.259889 ent_in=1.0299 ent_out=0.1751 rowmax_in=0.5442 rowmax_out=0.9253 discrete_mse=11.474472 best_discrete=6.200507 hash=False elapsed=50.5s
step   600/900 tau=0.0923 loss=0.263993 mse_soft=0.263633 ent_in=1.0225 ent_out=0.1754 rowmax_in=0.5450 rowmax_out=0.9265 discrete_mse=66.772850 best_discrete=6.200507 hash=False elapsed=52.6s
step   625/900 tau=0.0836 loss=0.267775 mse_soft=0.267422 ent_in=1.0099 ent_out=0.1683 rowmax_in=0.5568 rowmax_out=0.9287 discrete_mse=99.678581 best_discrete=6.200507 hash=False elapsed=54.8s
step   650/900 tau=0.0757 loss=0.263793 mse_soft=0.263435 ent_in=1.0222 ent_out=0.1696 rowmax_in=0.5417 rowmax_out=0.9292 discrete_mse=38.110901 best_discrete=6.200507 hash=False elapsed=57.1s
step   675/900 tau=0.0685 loss=0.274170 mse_soft=0.273821 ent_in=1.0007 ent_out=0.1641 rowmax_in=0.5555 rowmax_out=0.9311 discrete_mse=53.076984 best_discrete=6.200507 hash=False elapsed=59.3s
step   700/900 tau=0.0620 loss=0.265563 mse_soft=0.265224 ent_in=0.9677 ent_out=0.1644 rowmax_in=0.5635 rowmax_out=0.9244 discrete_mse=41.941341 best_discrete=6.200507 hash=False elapsed=61.4s
step   725/900 tau=0.0562 loss=0.336236 mse_soft=0.335956 ent_in=0.8201 ent_out=0.1117 rowmax_in=0.6453 rowmax_out=0.9474 discrete_mse=34.301128 best_discrete=6.200507 hash=False elapsed=63.5s
step   750/900 tau=0.0508 loss=0.291753 mse_soft=0.291494 ent_in=0.7790 ent_out=0.0845 rowmax_in=0.6243 rowmax_out=0.9604 discrete_mse=28.508856 best_discrete=6.200507 hash=False elapsed=65.6s
step   775/900 tau=0.0460 loss=0.290375 mse_soft=0.290118 ent_in=0.7743 ent_out=0.0807 rowmax_in=0.6285 rowmax_out=0.9616 discrete_mse=1.453976 best_discrete=1.453976 hash=False elapsed=67.7s
step   800/900 tau=0.0417 loss=0.320756 mse_soft=0.320528 ent_in=0.6807 ent_out=0.0798 rowmax_in=0.6686 rowmax_out=0.9626 discrete_mse=2.096087 best_discrete=1.453976 hash=False elapsed=69.7s
step   825/900 tau=0.0377 loss=0.292125 mse_soft=0.291893 ent_in=0.7059 ent_out=0.0682 rowmax_in=0.6436 rowmax_out=0.9664 discrete_mse=6.297938 best_discrete=1.453976 hash=False elapsed=71.7s
step   850/900 tau=0.0342 loss=0.311341 mse_soft=0.311126 ent_in=0.6366 ent_out=0.0797 rowmax_in=0.6887 rowmax_out=0.9629 discrete_mse=1.658941 best_discrete=1.453976 hash=False elapsed=73.7s
step   875/900 tau=0.0309 loss=0.319481 mse_soft=0.319271 ent_in=0.6259 ent_out=0.0735 rowmax_in=0.6881 rowmax_out=0.9656 discrete_mse=8.467928 best_discrete=1.453976 hash=False elapsed=75.7s
step   900/900 tau=0.0280 loss=0.386829 mse_soft=0.386670 ent_in=0.4440 ent_out=0.0837 rowmax_in=0.7676 rowmax_out=0.9598 discrete_mse=17.669165 best_discrete=1.453976 hash=False elapsed=77.8s

Final metrics:
  soft_mse_full=0.388903
  rowmax_in_mean=0.7770
  rowmax_out_mean=0.9597
  ent_in_mean=0.4404
  ent_out_mean=0.0837
  final_discrete_mse=13.487462
  hash_match=False
  best_discrete_mse_seen=1.453976
Saved results to overnight_b208_j2.json
