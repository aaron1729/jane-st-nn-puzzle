Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.065274 mse_soft=1.062951 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=205.422546 best_discrete=205.422546 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.863472 mse_soft=0.861282 ent_in=3.6311 ent_out=3.6694 rowmax_in=0.0458 rowmax_out=0.0444 discrete_mse=860.351990 best_discrete=205.422546 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.653933 mse_soft=0.652026 ent_in=3.1290 ent_out=3.2275 rowmax_in=0.0916 rowmax_out=0.0867 discrete_mse=5276.706055 best_discrete=205.422546 hash=False elapsed=5.1s
step    75/900 tau=0.7493 loss=0.506043 mse_soft=0.504467 ent_in=2.5936 ent_out=2.6597 rowmax_in=0.2040 rowmax_out=0.2019 discrete_mse=840.631470 best_discrete=205.422546 hash=False elapsed=7.4s
step   100/900 tau=0.6797 loss=0.391588 mse_soft=0.390442 ent_in=1.9786 ent_out=1.8397 rowmax_in=0.3484 rowmax_out=0.4075 discrete_mse=448.596588 best_discrete=205.422546 hash=False elapsed=9.7s
step   125/900 tau=0.6165 loss=0.337191 mse_soft=0.336336 ent_in=1.6178 ent_out=1.2325 rowmax_in=0.4349 rowmax_out=0.5991 discrete_mse=1060.340576 best_discrete=205.422546 hash=False elapsed=11.9s
step   150/900 tau=0.5592 loss=0.307844 mse_soft=0.307159 ent_in=1.4415 ent_out=0.8444 rowmax_in=0.4643 rowmax_out=0.7098 discrete_mse=894.594971 best_discrete=205.422546 hash=False elapsed=14.2s
step   175/900 tau=0.5073 loss=0.293977 mse_soft=0.293389 ent_in=1.3434 ent_out=0.6191 rowmax_in=0.4802 rowmax_out=0.7712 discrete_mse=973.218567 best_discrete=205.422546 hash=False elapsed=16.3s
step   200/900 tau=0.4602 loss=0.286757 mse_soft=0.286217 ent_in=1.2746 ent_out=0.5243 rowmax_in=0.4950 rowmax_out=0.7900 discrete_mse=2116.531494 best_discrete=205.422546 hash=False elapsed=18.6s
step   225/900 tau=0.4174 loss=0.281779 mse_soft=0.281267 ent_in=1.2380 ent_out=0.4686 rowmax_in=0.5036 rowmax_out=0.7991 discrete_mse=2283.761230 best_discrete=205.422546 hash=False elapsed=20.8s
step   250/900 tau=0.3786 loss=0.277304 mse_soft=0.276812 ent_in=1.2026 ent_out=0.4348 rowmax_in=0.5122 rowmax_out=0.8078 discrete_mse=565.227539 best_discrete=205.422546 hash=False elapsed=23.0s
step   275/900 tau=0.3434 loss=0.275768 mse_soft=0.275296 ent_in=1.1725 ent_out=0.4027 rowmax_in=0.5150 rowmax_out=0.8181 discrete_mse=565.227539 best_discrete=205.422546 hash=False elapsed=25.2s
step   300/900 tau=0.3115 loss=0.274950 mse_soft=0.274490 ent_in=1.1559 ent_out=0.3773 rowmax_in=0.5151 rowmax_out=0.8246 discrete_mse=691.961426 best_discrete=205.422546 hash=False elapsed=27.4s
step   325/900 tau=0.2826 loss=0.272488 mse_soft=0.272035 ent_in=1.1483 ent_out=0.3598 rowmax_in=0.5141 rowmax_out=0.8311 discrete_mse=691.961426 best_discrete=205.422546 hash=False elapsed=29.7s
step   350/900 tau=0.2563 loss=0.274540 mse_soft=0.274091 ent_in=1.1446 ent_out=0.3510 rowmax_in=0.5131 rowmax_out=0.8339 discrete_mse=691.961426 best_discrete=205.422546 hash=False elapsed=32.0s
step   375/900 tau=0.2325 loss=0.272268 mse_soft=0.271822 ent_in=1.1388 ent_out=0.3462 rowmax_in=0.5132 rowmax_out=0.8333 discrete_mse=674.527710 best_discrete=205.422546 hash=False elapsed=34.4s
step   400/900 tau=0.2109 loss=0.274827 mse_soft=0.274383 ent_in=1.1417 ent_out=0.3394 rowmax_in=0.5103 rowmax_out=0.8320 discrete_mse=423.653503 best_discrete=205.422546 hash=False elapsed=36.6s
step   425/900 tau=0.1913 loss=0.271124 mse_soft=0.270681 ent_in=1.1373 ent_out=0.3390 rowmax_in=0.5104 rowmax_out=0.8312 discrete_mse=674.527710 best_discrete=205.422546 hash=False elapsed=39.1s
step   450/900 tau=0.1735 loss=0.272939 mse_soft=0.272499 ent_in=1.1332 ent_out=0.3328 rowmax_in=0.5102 rowmax_out=0.8321 discrete_mse=423.653503 best_discrete=205.422546 hash=False elapsed=41.3s
step   475/900 tau=0.1574 loss=0.278266 mse_soft=0.277829 ent_in=1.1322 ent_out=0.3258 rowmax_in=0.5088 rowmax_out=0.8346 discrete_mse=423.653503 best_discrete=205.422546 hash=False elapsed=43.6s
step   500/900 tau=0.1428 loss=0.274663 mse_soft=0.274227 ent_in=1.1311 ent_out=0.3230 rowmax_in=0.5068 rowmax_out=0.8352 discrete_mse=186.652847 best_discrete=186.652847 hash=False elapsed=45.9s
step   525/900 tau=0.1295 loss=0.271076 mse_soft=0.270640 ent_in=1.1327 ent_out=0.3227 rowmax_in=0.5047 rowmax_out=0.8358 discrete_mse=481.345978 best_discrete=186.652847 hash=False elapsed=48.3s
step   550/900 tau=0.1175 loss=0.274421 mse_soft=0.273992 ent_in=1.1194 ent_out=0.3110 rowmax_in=0.5096 rowmax_out=0.8374 discrete_mse=186.652847 best_discrete=186.652847 hash=False elapsed=50.6s
step   575/900 tau=0.1066 loss=0.273587 mse_soft=0.273159 ent_in=1.1107 ent_out=0.3152 rowmax_in=0.5084 rowmax_out=0.8381 discrete_mse=190.436401 best_discrete=186.652847 hash=False elapsed=52.9s
step   600/900 tau=0.0967 loss=0.290434 mse_soft=0.290013 ent_in=1.1014 ent_out=0.3015 rowmax_in=0.5138 rowmax_out=0.8447 discrete_mse=372.630371 best_discrete=186.652847 hash=False elapsed=55.2s
step   625/900 tau=0.0877 loss=0.274366 mse_soft=0.273947 ent_in=1.0952 ent_out=0.3032 rowmax_in=0.5154 rowmax_out=0.8405 discrete_mse=163.832489 best_discrete=163.832489 hash=False elapsed=57.6s
step   650/900 tau=0.0795 loss=0.302890 mse_soft=0.302480 ent_in=1.0707 ent_out=0.2974 rowmax_in=0.5225 rowmax_out=0.8426 discrete_mse=1149.785767 best_discrete=163.832489 hash=False elapsed=59.7s
step   675/900 tau=0.0722 loss=0.354817 mse_soft=0.354422 ent_in=1.0316 ent_out=0.2866 rowmax_in=0.5350 rowmax_out=0.8520 discrete_mse=461.903046 best_discrete=163.832489 hash=False elapsed=62.0s
step   700/900 tau=0.0655 loss=0.287513 mse_soft=0.287134 ent_in=0.9667 ent_out=0.2968 rowmax_in=0.5499 rowmax_out=0.8510 discrete_mse=649.782837 best_discrete=163.832489 hash=False elapsed=64.1s
step   725/900 tau=0.0594 loss=0.287387 mse_soft=0.287008 ent_in=0.9787 ent_out=0.2831 rowmax_in=0.5378 rowmax_out=0.8561 discrete_mse=337.173920 best_discrete=163.832489 hash=False elapsed=66.1s
step   750/900 tau=0.0539 loss=0.293035 mse_soft=0.292654 ent_in=0.9845 ent_out=0.2844 rowmax_in=0.5409 rowmax_out=0.8560 discrete_mse=973.267578 best_discrete=163.832489 hash=False elapsed=68.3s
step   775/900 tau=0.0489 loss=0.333272 mse_soft=0.332926 ent_in=0.8797 ent_out=0.2763 rowmax_in=0.5903 rowmax_out=0.8585 discrete_mse=137.077927 best_discrete=137.077927 hash=False elapsed=70.4s
step   800/900 tau=0.0443 loss=0.296741 mse_soft=0.296384 ent_in=0.8977 ent_out=0.2923 rowmax_in=0.5702 rowmax_out=0.8408 discrete_mse=237.591965 best_discrete=137.077927 hash=False elapsed=72.7s
step   825/900 tau=0.0402 loss=1.695049 mse_soft=1.694851 ent_in=0.4463 ent_out=0.2115 rowmax_in=0.7856 rowmax_out=0.8841 discrete_mse=33.278412 best_discrete=33.278412 hash=False elapsed=74.9s
step   850/900 tau=0.0365 loss=0.566106 mse_soft=0.565996 ent_in=0.2828 ent_out=0.0826 rowmax_in=0.8504 rowmax_out=0.9525 discrete_mse=26.669214 best_discrete=26.669214 hash=False elapsed=76.9s
step   875/900 tau=0.0331 loss=0.529570 mse_soft=0.529458 ent_in=0.2840 ent_out=0.0907 rowmax_in=0.8490 rowmax_out=0.9357 discrete_mse=48.510677 best_discrete=26.669214 hash=False elapsed=79.1s
step   900/900 tau=0.0300 loss=0.525195 mse_soft=0.525081 ent_in=0.2961 ent_out=0.0863 rowmax_in=0.8412 rowmax_out=0.9362 discrete_mse=32.114216 best_discrete=26.669214 hash=False elapsed=81.2s

Final metrics:
  soft_mse_full=0.524541
  rowmax_in_mean=0.8416
  rowmax_out_mean=0.9363
  ent_in_mean=0.2959
  ent_out_mean=0.0863
  final_discrete_mse=32.114216
  hash_match=False
  best_discrete_mse_seen=26.669214
Saved results to overnight_b116_j1.json
