Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.059497 mse_soft=1.057174 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=12.816870 best_discrete=12.816870 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.860511 mse_soft=0.858321 ent_in=3.6333 ent_out=3.6672 rowmax_in=0.0455 rowmax_out=0.0443 discrete_mse=2042.342529 best_discrete=12.816870 hash=False elapsed=2.4s
step    50/900 tau=0.8229 loss=0.653036 mse_soft=0.651127 ent_in=3.1354 ent_out=3.2254 rowmax_in=0.0918 rowmax_out=0.0882 discrete_mse=2380.791260 best_discrete=12.816870 hash=False elapsed=4.5s
step    75/900 tau=0.7450 loss=0.511279 mse_soft=0.509703 ent_in=2.5992 ent_out=2.6531 rowmax_in=0.2093 rowmax_out=0.2070 discrete_mse=1859.592773 best_discrete=12.816870 hash=False elapsed=6.5s
step   100/900 tau=0.6745 loss=0.406797 mse_soft=0.405631 ent_in=2.0330 ent_out=1.8565 rowmax_in=0.3458 rowmax_out=0.4095 discrete_mse=1476.308228 best_discrete=12.816870 hash=False elapsed=8.6s
step   125/900 tau=0.6107 loss=0.350326 mse_soft=0.349474 ent_in=1.6125 ent_out=1.2276 rowmax_in=0.4403 rowmax_out=0.5975 discrete_mse=628.088806 best_discrete=12.816870 hash=False elapsed=10.8s
step   150/900 tau=0.5529 loss=0.323118 mse_soft=0.322454 ent_in=1.3983 ent_out=0.8126 rowmax_in=0.4821 rowmax_out=0.7116 discrete_mse=1479.326904 best_discrete=12.816870 hash=False elapsed=12.8s
step   175/900 tau=0.5006 loss=0.310662 mse_soft=0.310093 ent_in=1.2831 ent_out=0.6159 rowmax_in=0.5016 rowmax_out=0.7667 discrete_mse=200.136353 best_discrete=12.816870 hash=False elapsed=14.8s
step   200/900 tau=0.4532 loss=0.303866 mse_soft=0.303328 ent_in=1.2381 ent_out=0.5574 rowmax_in=0.5080 rowmax_out=0.7824 discrete_mse=128.696350 best_discrete=12.816870 hash=False elapsed=16.9s
step   225/900 tau=0.4103 loss=0.296537 mse_soft=0.296030 ent_in=1.2055 ent_out=0.4862 rowmax_in=0.5127 rowmax_out=0.8082 discrete_mse=143.875244 best_discrete=12.816870 hash=False elapsed=18.9s
step   250/900 tau=0.3715 loss=0.291375 mse_soft=0.290897 ent_in=1.1677 ent_out=0.4249 rowmax_in=0.5186 rowmax_out=0.8208 discrete_mse=203.168427 best_discrete=12.816870 hash=False elapsed=21.0s
step   275/900 tau=0.3363 loss=0.287876 mse_soft=0.287415 ent_in=1.1464 ent_out=0.3902 rowmax_in=0.5249 rowmax_out=0.8319 discrete_mse=203.168427 best_discrete=12.816870 hash=False elapsed=23.0s
step   300/900 tau=0.3045 loss=0.286319 mse_soft=0.285868 ent_in=1.1333 ent_out=0.3703 rowmax_in=0.5258 rowmax_out=0.8395 discrete_mse=203.168427 best_discrete=12.816870 hash=False elapsed=25.3s
step   325/900 tau=0.2756 loss=0.282962 mse_soft=0.282520 ent_in=1.1173 ent_out=0.3564 rowmax_in=0.5287 rowmax_out=0.8426 discrete_mse=58.204624 best_discrete=12.816870 hash=False elapsed=27.5s
step   350/900 tau=0.2496 loss=0.282870 mse_soft=0.282436 ent_in=1.1023 ent_out=0.3439 rowmax_in=0.5291 rowmax_out=0.8459 discrete_mse=409.384338 best_discrete=12.816870 hash=False elapsed=29.6s
step   375/900 tau=0.2259 loss=0.285589 mse_soft=0.285160 ent_in=1.0983 ent_out=0.3319 rowmax_in=0.5278 rowmax_out=0.8496 discrete_mse=409.384338 best_discrete=12.816870 hash=False elapsed=31.7s
step   400/900 tau=0.2046 loss=0.280708 mse_soft=0.280282 ent_in=1.0908 ent_out=0.3260 rowmax_in=0.5302 rowmax_out=0.8512 discrete_mse=409.384338 best_discrete=12.816870 hash=False elapsed=33.7s
step   425/900 tau=0.1852 loss=0.281858 mse_soft=0.281437 ent_in=1.0812 ent_out=0.3211 rowmax_in=0.5321 rowmax_out=0.8521 discrete_mse=604.124084 best_discrete=12.816870 hash=False elapsed=35.7s
step   450/900 tau=0.1677 loss=0.282451 mse_soft=0.282034 ent_in=1.0770 ent_out=0.3138 rowmax_in=0.5317 rowmax_out=0.8562 discrete_mse=604.124084 best_discrete=12.816870 hash=False elapsed=38.0s
step   475/900 tau=0.1518 loss=0.281493 mse_soft=0.281078 ent_in=1.0744 ent_out=0.3091 rowmax_in=0.5307 rowmax_out=0.8561 discrete_mse=604.124084 best_discrete=12.816870 hash=False elapsed=40.2s
step   500/900 tau=0.1374 loss=0.285256 mse_soft=0.284846 ent_in=1.0693 ent_out=0.3003 rowmax_in=0.5337 rowmax_out=0.8602 discrete_mse=453.630341 best_discrete=12.816870 hash=False elapsed=42.4s
step   525/900 tau=0.1244 loss=0.285848 mse_soft=0.285439 ent_in=1.0660 ent_out=0.2981 rowmax_in=0.5343 rowmax_out=0.8585 discrete_mse=293.107697 best_discrete=12.816870 hash=False elapsed=44.4s
step   550/900 tau=0.1126 loss=0.290973 mse_soft=0.290568 ent_in=1.0541 ent_out=0.2963 rowmax_in=0.5429 rowmax_out=0.8600 discrete_mse=604.124084 best_discrete=12.816870 hash=False elapsed=46.6s
step   575/900 tau=0.1020 loss=0.294330 mse_soft=0.293927 ent_in=1.0525 ent_out=0.2894 rowmax_in=0.5425 rowmax_out=0.8631 discrete_mse=149.991348 best_discrete=12.816870 hash=False elapsed=48.7s
step   600/900 tau=0.0923 loss=0.287884 mse_soft=0.287486 ent_in=1.0326 ent_out=0.2954 rowmax_in=0.5522 rowmax_out=0.8558 discrete_mse=293.107697 best_discrete=12.816870 hash=False elapsed=50.8s
step   625/900 tau=0.0836 loss=0.299791 mse_soft=0.299404 ent_in=1.0167 ent_out=0.2710 rowmax_in=0.5580 rowmax_out=0.8740 discrete_mse=149.969193 best_discrete=12.816870 hash=False elapsed=53.1s
step   650/900 tau=0.0757 loss=0.307968 mse_soft=0.307579 ent_in=1.0191 ent_out=0.2761 rowmax_in=0.5455 rowmax_out=0.8718 discrete_mse=293.107697 best_discrete=12.816870 hash=False elapsed=55.1s
step   675/900 tau=0.0685 loss=0.311189 mse_soft=0.310830 ent_in=0.9527 ent_out=0.2460 rowmax_in=0.5730 rowmax_out=0.8907 discrete_mse=64.785896 best_discrete=12.816870 hash=False elapsed=57.2s
step   700/900 tau=0.0620 loss=0.314315 mse_soft=0.313966 ent_in=0.9129 ent_out=0.2523 rowmax_in=0.5916 rowmax_out=0.8785 discrete_mse=75.844719 best_discrete=12.816870 hash=False elapsed=59.4s
step   725/900 tau=0.0562 loss=0.365962 mse_soft=0.365625 ent_in=0.8985 ent_out=0.2265 rowmax_in=0.5822 rowmax_out=0.8913 discrete_mse=353.419434 best_discrete=12.816870 hash=False elapsed=61.5s
step   750/900 tau=0.0508 loss=0.317005 mse_soft=0.316677 ent_in=0.8585 ent_out=0.2319 rowmax_in=0.5984 rowmax_out=0.8902 discrete_mse=162.832596 best_discrete=12.816870 hash=False elapsed=63.6s
step   775/900 tau=0.0460 loss=0.301727 mse_soft=0.301395 ent_in=0.8587 ent_out=0.2474 rowmax_in=0.5834 rowmax_out=0.8787 discrete_mse=340.454529 best_discrete=12.816870 hash=False elapsed=65.7s
step   800/900 tau=0.0417 loss=0.343423 mse_soft=0.343114 ent_in=0.7811 ent_out=0.2464 rowmax_in=0.6541 rowmax_out=0.8741 discrete_mse=40.900169 best_discrete=12.816870 hash=False elapsed=68.0s
step   825/900 tau=0.0377 loss=0.417121 mse_soft=0.416923 ent_in=0.4963 ent_out=0.1638 rowmax_in=0.7429 rowmax_out=0.9105 discrete_mse=1.642128 best_discrete=1.642128 hash=False elapsed=70.2s
step   850/900 tau=0.0342 loss=0.460939 mse_soft=0.460790 ent_in=0.3577 ent_out=0.1378 rowmax_in=0.8356 rowmax_out=0.9194 discrete_mse=2.418813 best_discrete=1.642128 hash=False elapsed=72.4s
step   875/900 tau=0.0309 loss=0.495102 mse_soft=0.494967 ent_in=0.3389 ent_out=0.1127 rowmax_in=0.8403 rowmax_out=0.9320 discrete_mse=5.031097 best_discrete=1.642128 hash=False elapsed=74.7s
step   900/900 tau=0.0280 loss=0.511756 mse_soft=0.511645 ent_in=0.2632 ent_out=0.1060 rowmax_in=0.8805 rowmax_out=0.9299 discrete_mse=9.331263 best_discrete=1.642128 hash=False elapsed=77.0s

Final metrics:
  soft_mse_full=0.508365
  rowmax_in_mean=0.8849
  rowmax_out_mean=0.9327
  ent_in_mean=0.2553
  ent_out_mean=0.1044
  final_discrete_mse=9.331263
  hash_match=False
  best_discrete_mse_seen=1.642128
Saved results to overnight_b012_j2.json
