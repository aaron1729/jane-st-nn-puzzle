Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.069416 mse_soft=1.067093 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=76.330872 best_discrete=76.330872 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.861737 mse_soft=0.859548 ent_in=3.6309 ent_out=3.6670 rowmax_in=0.0448 rowmax_out=0.0447 discrete_mse=8644.974609 best_discrete=76.330872 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.651410 mse_soft=0.649494 ent_in=3.1362 ent_out=3.2477 rowmax_in=0.0912 rowmax_out=0.0836 discrete_mse=2699.789551 best_discrete=76.330872 hash=False elapsed=5.0s
step    75/900 tau=0.7450 loss=0.518170 mse_soft=0.516569 ent_in=2.6074 ent_out=2.7271 rowmax_in=0.2047 rowmax_out=0.1930 discrete_mse=1262.242188 best_discrete=76.330872 hash=False elapsed=7.3s
step   100/900 tau=0.6745 loss=0.408050 mse_soft=0.406868 ent_in=1.9866 ent_out=1.9527 rowmax_in=0.3592 rowmax_out=0.3837 discrete_mse=2606.211670 best_discrete=76.330872 hash=False elapsed=9.7s
step   125/900 tau=0.6107 loss=0.343240 mse_soft=0.342388 ent_in=1.6103 ent_out=1.2300 rowmax_in=0.4420 rowmax_out=0.5934 discrete_mse=2054.036133 best_discrete=76.330872 hash=False elapsed=12.0s
step   150/900 tau=0.5529 loss=0.314036 mse_soft=0.313361 ent_in=1.4179 ent_out=0.8325 rowmax_in=0.4873 rowmax_out=0.7104 discrete_mse=1165.722168 best_discrete=76.330872 hash=False elapsed=14.4s
step   175/900 tau=0.5006 loss=0.299950 mse_soft=0.299370 ent_in=1.3167 ent_out=0.6157 rowmax_in=0.5121 rowmax_out=0.7852 discrete_mse=1171.796387 best_discrete=76.330872 hash=False elapsed=16.8s
step   200/900 tau=0.4532 loss=0.293509 mse_soft=0.292983 ent_in=1.2452 ent_out=0.5090 rowmax_in=0.5243 rowmax_out=0.8144 discrete_mse=1355.027466 best_discrete=76.330872 hash=False elapsed=19.1s
step   225/900 tau=0.4103 loss=0.289516 mse_soft=0.289014 ent_in=1.2172 ent_out=0.4553 rowmax_in=0.5237 rowmax_out=0.8292 discrete_mse=1837.024170 best_discrete=76.330872 hash=False elapsed=21.5s
step   250/900 tau=0.3715 loss=0.286367 mse_soft=0.285883 ent_in=1.2097 ent_out=0.4014 rowmax_in=0.5214 rowmax_out=0.8424 discrete_mse=1837.024170 best_discrete=76.330872 hash=False elapsed=23.8s
step   275/900 tau=0.3363 loss=0.286535 mse_soft=0.286059 ent_in=1.2138 ent_out=0.3717 rowmax_in=0.5172 rowmax_out=0.8503 discrete_mse=1837.024170 best_discrete=76.330872 hash=False elapsed=26.1s
step   300/900 tau=0.3045 loss=0.284022 mse_soft=0.283551 ent_in=1.2158 ent_out=0.3561 rowmax_in=0.5145 rowmax_out=0.8526 discrete_mse=1273.682617 best_discrete=76.330872 hash=False elapsed=28.5s
step   325/900 tau=0.2756 loss=0.282138 mse_soft=0.281668 ent_in=1.2132 ent_out=0.3529 rowmax_in=0.5127 rowmax_out=0.8505 discrete_mse=1273.682617 best_discrete=76.330872 hash=False elapsed=30.9s
step   350/900 tau=0.2496 loss=0.283043 mse_soft=0.282575 ent_in=1.2097 ent_out=0.3516 rowmax_in=0.5112 rowmax_out=0.8481 discrete_mse=1273.682617 best_discrete=76.330872 hash=False elapsed=33.3s
step   375/900 tau=0.2259 loss=0.280688 mse_soft=0.280223 ent_in=1.2025 ent_out=0.3459 rowmax_in=0.5121 rowmax_out=0.8497 discrete_mse=1273.682617 best_discrete=76.330872 hash=False elapsed=35.8s
step   400/900 tau=0.2046 loss=0.282548 mse_soft=0.282086 ent_in=1.1985 ent_out=0.3414 rowmax_in=0.5114 rowmax_out=0.8499 discrete_mse=1273.682617 best_discrete=76.330872 hash=False elapsed=38.1s
step   425/900 tau=0.1852 loss=0.278341 mse_soft=0.277880 ent_in=1.1991 ent_out=0.3383 rowmax_in=0.5082 rowmax_out=0.8505 discrete_mse=1504.170654 best_discrete=76.330872 hash=False elapsed=40.4s
step   450/900 tau=0.1677 loss=0.286429 mse_soft=0.285968 ent_in=1.1975 ent_out=0.3364 rowmax_in=0.5082 rowmax_out=0.8504 discrete_mse=816.137573 best_discrete=76.330872 hash=False elapsed=42.8s
step   475/900 tau=0.1518 loss=0.282859 mse_soft=0.282399 ent_in=1.1977 ent_out=0.3349 rowmax_in=0.5070 rowmax_out=0.8497 discrete_mse=1636.886719 best_discrete=76.330872 hash=False elapsed=45.3s
step   500/900 tau=0.1374 loss=0.283427 mse_soft=0.282968 ent_in=1.1957 ent_out=0.3340 rowmax_in=0.5046 rowmax_out=0.8489 discrete_mse=816.137573 best_discrete=76.330872 hash=False elapsed=47.5s
step   525/900 tau=0.1244 loss=0.282372 mse_soft=0.281915 ent_in=1.1928 ent_out=0.3314 rowmax_in=0.5034 rowmax_out=0.8516 discrete_mse=1504.170654 best_discrete=76.330872 hash=False elapsed=49.9s
step   550/900 tau=0.1126 loss=0.288287 mse_soft=0.287834 ent_in=1.1844 ent_out=0.3262 rowmax_in=0.5095 rowmax_out=0.8559 discrete_mse=800.403198 best_discrete=76.330872 hash=False elapsed=52.2s
step   575/900 tau=0.1020 loss=0.288193 mse_soft=0.287746 ent_in=1.1619 ent_out=0.3301 rowmax_in=0.5175 rowmax_out=0.8534 discrete_mse=720.779907 best_discrete=76.330872 hash=False elapsed=54.5s
step   600/900 tau=0.0923 loss=0.287921 mse_soft=0.287473 ent_in=1.1654 ent_out=0.3288 rowmax_in=0.5130 rowmax_out=0.8505 discrete_mse=1352.262329 best_discrete=76.330872 hash=False elapsed=56.8s
step   625/900 tau=0.0836 loss=0.309332 mse_soft=0.308912 ent_in=1.1217 ent_out=0.2778 rowmax_in=0.5215 rowmax_out=0.8766 discrete_mse=663.054382 best_discrete=76.330872 hash=False elapsed=59.2s
step   650/900 tau=0.0757 loss=0.293562 mse_soft=0.293129 ent_in=1.1200 ent_out=0.3233 rowmax_in=0.5208 rowmax_out=0.8479 discrete_mse=1739.498779 best_discrete=76.330872 hash=False elapsed=61.5s
step   675/900 tau=0.0685 loss=0.305866 mse_soft=0.305435 ent_in=1.1151 ent_out=0.3225 rowmax_in=0.5212 rowmax_out=0.8518 discrete_mse=892.794678 best_discrete=76.330872 hash=False elapsed=63.8s
step   700/900 tau=0.0620 loss=0.299838 mse_soft=0.299430 ent_in=1.0417 ent_out=0.3203 rowmax_in=0.5474 rowmax_out=0.8521 discrete_mse=1157.387329 best_discrete=76.330872 hash=False elapsed=66.1s
step   725/900 tau=0.0562 loss=0.346012 mse_soft=0.345631 ent_in=0.9749 ent_out=0.2940 rowmax_in=0.5525 rowmax_out=0.8545 discrete_mse=253.503693 best_discrete=76.330872 hash=False elapsed=68.1s
step   750/900 tau=0.0508 loss=0.376127 mse_soft=0.375780 ent_in=0.8645 ent_out=0.2925 rowmax_in=0.6015 rowmax_out=0.8582 discrete_mse=409.031403 best_discrete=76.330872 hash=False elapsed=70.1s
step   775/900 tau=0.0460 loss=0.313807 mse_soft=0.313479 ent_in=0.8207 ent_out=0.2723 rowmax_in=0.6072 rowmax_out=0.8720 discrete_mse=144.936127 best_discrete=76.330872 hash=False elapsed=72.2s
step   800/900 tau=0.0417 loss=0.310921 mse_soft=0.310596 ent_in=0.8004 ent_out=0.2835 rowmax_in=0.6109 rowmax_out=0.8578 discrete_mse=361.722809 best_discrete=76.330872 hash=False elapsed=74.2s
step   825/900 tau=0.0377 loss=0.320665 mse_soft=0.320360 ent_in=0.7540 ent_out=0.2624 rowmax_in=0.6306 rowmax_out=0.8656 discrete_mse=82.133911 best_discrete=76.330872 hash=False elapsed=76.2s
step   850/900 tau=0.0342 loss=0.496220 mse_soft=0.496025 ent_in=0.4950 ent_out=0.1533 rowmax_in=0.7792 rowmax_out=0.9326 discrete_mse=77.739426 best_discrete=76.330872 hash=False elapsed=78.1s
step   875/900 tau=0.0309 loss=0.426624 mse_soft=0.426489 ent_in=0.3739 ent_out=0.0770 rowmax_in=0.8165 rowmax_out=0.9627 discrete_mse=45.004559 best_discrete=45.004559 hash=False elapsed=80.3s
step   900/900 tau=0.0280 loss=0.476759 mse_soft=0.476624 ent_in=0.3725 ent_out=0.0756 rowmax_in=0.8174 rowmax_out=0.9635 discrete_mse=96.126633 best_discrete=45.004559 hash=False elapsed=82.5s

Final metrics:
  soft_mse_full=0.479641
  rowmax_in_mean=0.8136
  rowmax_out_mean=0.9646
  ent_in_mean=0.3755
  ent_out_mean=0.0739
  final_discrete_mse=117.420547
  hash_match=False
  best_discrete_mse_seen=45.004559
Saved results to overnight_b155_j2.json
