Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.02
step     1/700 tau=1.0000 loss=1.065751 mse_soft=1.063428 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=3.251855 best_discrete=3.251855 hash=False elapsed=0.5s
step    25/700 tau=0.8866 loss=0.935282 mse_soft=0.933031 ent_in=3.7428 ent_out=3.7623 rowmax_in=0.0370 rowmax_out=0.0362 discrete_mse=1462.019531 best_discrete=3.251855 hash=False elapsed=2.4s
step    50/700 tau=0.7821 loss=0.707829 mse_soft=0.705794 ent_in=3.3630 ent_out=3.4218 rowmax_in=0.0687 rowmax_out=0.0674 discrete_mse=7801.472656 best_discrete=3.251855 hash=False elapsed=4.6s
step    75/700 tau=0.6899 loss=0.585993 mse_soft=0.584193 ent_in=2.9476 ent_out=3.0532 rowmax_in=0.1317 rowmax_out=0.1227 discrete_mse=410.294525 best_discrete=3.251855 hash=False elapsed=6.9s
step   100/700 tau=0.6086 loss=0.467722 mse_soft=0.466278 ent_in=2.3927 ent_out=2.4201 rowmax_in=0.2506 rowmax_out=0.2683 discrete_mse=4052.148193 best_discrete=3.251855 hash=False elapsed=9.4s
step   125/700 tau=0.5368 loss=0.384374 mse_soft=0.383320 ent_in=1.8470 ent_out=1.6675 rowmax_in=0.3823 rowmax_out=0.4756 discrete_mse=971.586548 best_discrete=3.251855 hash=False elapsed=11.5s
step   150/700 tau=0.4736 loss=0.345131 mse_soft=0.344305 ent_in=1.5636 ent_out=1.1897 rowmax_in=0.4432 rowmax_out=0.6035 discrete_mse=748.286865 best_discrete=3.251855 hash=False elapsed=13.7s
step   175/700 tau=0.4177 loss=0.320169 mse_soft=0.319474 ent_in=1.4104 ent_out=0.9045 rowmax_in=0.4695 rowmax_out=0.6705 discrete_mse=14834.543945 best_discrete=3.251855 hash=False elapsed=16.0s
step   200/700 tau=0.3685 loss=0.304357 mse_soft=0.303778 ent_in=1.3042 ent_out=0.6262 rowmax_in=0.4899 rowmax_out=0.7630 discrete_mse=6493.165527 best_discrete=3.251855 hash=False elapsed=18.3s
step   225/700 tau=0.3251 loss=0.296821 mse_soft=0.296290 ent_in=1.2642 ent_out=0.5031 rowmax_in=0.4936 rowmax_out=0.7975 discrete_mse=8338.235352 best_discrete=3.251855 hash=False elapsed=20.6s
step   250/700 tau=0.2868 loss=0.293446 mse_soft=0.292944 ent_in=1.2340 ent_out=0.4378 rowmax_in=0.4946 rowmax_out=0.8190 discrete_mse=6061.339355 best_discrete=3.251855 hash=False elapsed=23.0s
step   275/700 tau=0.2530 loss=0.290066 mse_soft=0.289585 ent_in=1.2108 ent_out=0.3949 rowmax_in=0.4938 rowmax_out=0.8410 discrete_mse=6061.339355 best_discrete=3.251855 hash=False elapsed=25.3s
step   300/700 tau=0.2231 loss=0.288438 mse_soft=0.287977 ent_in=1.1806 ent_out=0.3571 rowmax_in=0.4969 rowmax_out=0.8546 discrete_mse=7548.345215 best_discrete=3.251855 hash=False elapsed=27.6s
step   325/700 tau=0.1968 loss=0.289897 mse_soft=0.289444 ent_in=1.1677 ent_out=0.3429 rowmax_in=0.4987 rowmax_out=0.8603 discrete_mse=7548.345215 best_discrete=3.251855 hash=False elapsed=29.9s
step   350/700 tau=0.1736 loss=0.288503 mse_soft=0.288053 ent_in=1.1624 ent_out=0.3378 rowmax_in=0.4995 rowmax_out=0.8608 discrete_mse=2959.761963 best_discrete=3.251855 hash=False elapsed=32.1s
step   375/700 tau=0.1532 loss=0.288405 mse_soft=0.287957 ent_in=1.1631 ent_out=0.3308 rowmax_in=0.4998 rowmax_out=0.8623 discrete_mse=2959.761963 best_discrete=3.251855 hash=False elapsed=34.2s
step   400/700 tau=0.1351 loss=0.286308 mse_soft=0.285863 ent_in=1.1562 ent_out=0.3269 rowmax_in=0.5020 rowmax_out=0.8608 discrete_mse=3583.643555 best_discrete=3.251855 hash=False elapsed=36.3s
step   425/700 tau=0.1192 loss=0.290345 mse_soft=0.289905 ent_in=1.1476 ent_out=0.3191 rowmax_in=0.5042 rowmax_out=0.8610 discrete_mse=3609.834717 best_discrete=3.251855 hash=False elapsed=38.5s
step   450/700 tau=0.1051 loss=0.290931 mse_soft=0.290495 ent_in=1.1435 ent_out=0.3109 rowmax_in=0.5075 rowmax_out=0.8646 discrete_mse=4295.569336 best_discrete=3.251855 hash=False elapsed=40.9s
step   475/700 tau=0.0928 loss=0.294898 mse_soft=0.294463 ent_in=1.1399 ent_out=0.3081 rowmax_in=0.5052 rowmax_out=0.8630 discrete_mse=7539.946289 best_discrete=3.251855 hash=False elapsed=43.2s
step   500/700 tau=0.0818 loss=0.287708 mse_soft=0.287276 ent_in=1.1350 ent_out=0.3054 rowmax_in=0.5069 rowmax_out=0.8587 discrete_mse=7539.946289 best_discrete=3.251855 hash=False elapsed=45.5s
step   525/700 tau=0.0722 loss=0.296411 mse_soft=0.295980 ent_in=1.1318 ent_out=0.3047 rowmax_in=0.5118 rowmax_out=0.8616 discrete_mse=9222.641602 best_discrete=3.251855 hash=False elapsed=47.8s
step   550/700 tau=0.0637 loss=0.335884 mse_soft=0.335460 ent_in=1.1173 ent_out=0.2981 rowmax_in=0.5098 rowmax_out=0.8569 discrete_mse=368.924927 best_discrete=3.251855 hash=False elapsed=50.1s
step   575/700 tau=0.0562 loss=0.300253 mse_soft=0.299876 ent_in=0.9906 ent_out=0.2662 rowmax_in=0.5528 rowmax_out=0.8701 discrete_mse=885.412048 best_discrete=3.251855 hash=False elapsed=52.4s
step   600/700 tau=0.0495 loss=0.300713 mse_soft=0.300332 ent_in=1.0014 ent_out=0.2681 rowmax_in=0.5492 rowmax_out=0.8669 discrete_mse=788.620972 best_discrete=3.251855 hash=False elapsed=54.8s
step   625/700 tau=0.0437 loss=0.405656 mse_soft=0.405323 ent_in=0.8922 ent_out=0.2171 rowmax_in=0.6077 rowmax_out=0.9000 discrete_mse=98.222397 best_discrete=3.251855 hash=False elapsed=57.1s
step   650/700 tau=0.0386 loss=0.365345 mse_soft=0.365111 ent_in=0.6129 ent_out=0.1672 rowmax_in=0.7118 rowmax_out=0.9131 discrete_mse=11.151895 best_discrete=3.251855 hash=False elapsed=59.4s
step   675/700 tau=0.0340 loss=0.345805 mse_soft=0.345572 ent_in=0.6215 ent_out=0.1568 rowmax_in=0.6965 rowmax_out=0.9182 discrete_mse=91.806351 best_discrete=3.251855 hash=False elapsed=61.7s
step   700/700 tau=0.0300 loss=0.339540 mse_soft=0.339302 ent_in=0.6294 ent_out=0.1653 rowmax_in=0.6854 rowmax_out=0.9135 discrete_mse=70.450493 best_discrete=3.251855 hash=False elapsed=64.0s

Final metrics:
  soft_mse_full=0.339190
  rowmax_in_mean=0.6844
  rowmax_out_mean=0.9139
  ent_in_mean=0.6298
  ent_out_mean=0.1643
  final_discrete_mse=56.639893
  hash_match=False
  best_discrete_mse_seen=3.251855
Saved results to overnight_b190_j3.json
