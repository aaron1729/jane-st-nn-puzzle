Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.052801 mse_soft=1.050479 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=71.823547 best_discrete=71.823547 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.850347 mse_soft=0.848158 ent_in=3.6314 ent_out=3.6654 rowmax_in=0.0459 rowmax_out=0.0443 discrete_mse=921.063965 best_discrete=71.823547 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.641783 mse_soft=0.639876 ent_in=3.1333 ent_out=3.2238 rowmax_in=0.0939 rowmax_out=0.0884 discrete_mse=1870.802734 best_discrete=71.823547 hash=False elapsed=4.8s
step    75/900 tau=0.7493 loss=0.501022 mse_soft=0.499445 ent_in=2.5859 ent_out=2.6689 rowmax_in=0.1994 rowmax_out=0.1921 discrete_mse=8579.280273 best_discrete=71.823547 hash=False elapsed=7.0s
step   100/900 tau=0.6797 loss=0.394527 mse_soft=0.393365 ent_in=2.0116 ent_out=1.8617 rowmax_in=0.3360 rowmax_out=0.3948 discrete_mse=1843.934570 best_discrete=71.823547 hash=False elapsed=9.4s
step   125/900 tau=0.6165 loss=0.335789 mse_soft=0.334916 ent_in=1.6172 ent_out=1.2918 rowmax_in=0.4397 rowmax_out=0.5585 discrete_mse=271.290253 best_discrete=71.823547 hash=False elapsed=11.6s
step   150/900 tau=0.5592 loss=0.303623 mse_soft=0.302924 ent_in=1.3808 ent_out=0.9495 rowmax_in=0.4895 rowmax_out=0.6540 discrete_mse=363.127106 best_discrete=71.823547 hash=False elapsed=14.2s
step   175/900 tau=0.5073 loss=0.291111 mse_soft=0.290496 ent_in=1.2904 ent_out=0.7596 rowmax_in=0.5026 rowmax_out=0.7119 discrete_mse=577.542664 best_discrete=71.823547 hash=False elapsed=16.7s
step   200/900 tau=0.4602 loss=0.281040 mse_soft=0.280480 ent_in=1.2210 ent_out=0.6474 rowmax_in=0.5156 rowmax_out=0.7440 discrete_mse=240.755539 best_discrete=71.823547 hash=False elapsed=19.2s
step   225/900 tau=0.4174 loss=0.276538 mse_soft=0.276019 ent_in=1.1696 ent_out=0.5591 rowmax_in=0.5208 rowmax_out=0.7760 discrete_mse=240.755539 best_discrete=71.823547 hash=False elapsed=21.3s
step   250/900 tau=0.3786 loss=0.273465 mse_soft=0.272969 ent_in=1.1532 ent_out=0.5011 rowmax_in=0.5213 rowmax_out=0.7955 discrete_mse=174.200775 best_discrete=71.823547 hash=False elapsed=23.6s
step   275/900 tau=0.3434 loss=0.269359 mse_soft=0.268879 ent_in=1.1276 ent_out=0.4722 rowmax_in=0.5265 rowmax_out=0.8040 discrete_mse=174.200775 best_discrete=71.823547 hash=False elapsed=25.9s
step   300/900 tau=0.3115 loss=0.266210 mse_soft=0.265743 ent_in=1.1099 ent_out=0.4479 rowmax_in=0.5268 rowmax_out=0.8107 discrete_mse=170.717133 best_discrete=71.823547 hash=False elapsed=28.3s
step   325/900 tau=0.2826 loss=0.266106 mse_soft=0.265650 ent_in=1.0961 ent_out=0.4233 rowmax_in=0.5322 rowmax_out=0.8206 discrete_mse=170.717133 best_discrete=71.823547 hash=False elapsed=30.9s
step   350/900 tau=0.2563 loss=0.263313 mse_soft=0.262867 ent_in=1.0789 ent_out=0.4069 rowmax_in=0.5387 rowmax_out=0.8250 discrete_mse=506.014801 best_discrete=71.823547 hash=False elapsed=33.4s
step   375/900 tau=0.2325 loss=0.262939 mse_soft=0.262495 ent_in=1.0714 ent_out=0.4055 rowmax_in=0.5385 rowmax_out=0.8234 discrete_mse=374.077393 best_discrete=71.823547 hash=False elapsed=35.7s
step   400/900 tau=0.2109 loss=0.260003 mse_soft=0.259564 ent_in=1.0639 ent_out=0.3984 rowmax_in=0.5386 rowmax_out=0.8264 discrete_mse=374.077393 best_discrete=71.823547 hash=False elapsed=38.3s
step   425/900 tau=0.1913 loss=0.261676 mse_soft=0.261243 ent_in=1.0540 ent_out=0.3889 rowmax_in=0.5392 rowmax_out=0.8291 discrete_mse=768.488953 best_discrete=71.823547 hash=False elapsed=40.8s
step   450/900 tau=0.1735 loss=0.259384 mse_soft=0.258956 ent_in=1.0474 ent_out=0.3773 rowmax_in=0.5418 rowmax_out=0.8327 discrete_mse=405.073120 best_discrete=71.823547 hash=False elapsed=42.9s
step   475/900 tau=0.1574 loss=0.257961 mse_soft=0.257539 ent_in=1.0405 ent_out=0.3648 rowmax_in=0.5430 rowmax_out=0.8344 discrete_mse=964.588745 best_discrete=71.823547 hash=False elapsed=45.0s
step   500/900 tau=0.1428 loss=0.259549 mse_soft=0.259132 ent_in=1.0302 ent_out=0.3584 rowmax_in=0.5461 rowmax_out=0.8335 discrete_mse=1214.563599 best_discrete=71.823547 hash=False elapsed=47.5s
step   525/900 tau=0.1295 loss=0.261282 mse_soft=0.260869 ent_in=1.0229 ent_out=0.3528 rowmax_in=0.5487 rowmax_out=0.8317 discrete_mse=2122.238525 best_discrete=71.823547 hash=False elapsed=49.8s
step   550/900 tau=0.1175 loss=0.258632 mse_soft=0.258221 ent_in=1.0200 ent_out=0.3489 rowmax_in=0.5471 rowmax_out=0.8316 discrete_mse=502.727478 best_discrete=71.823547 hash=False elapsed=52.3s
step   575/900 tau=0.1066 loss=0.277188 mse_soft=0.276779 ent_in=1.0143 ent_out=0.3467 rowmax_in=0.5478 rowmax_out=0.8329 discrete_mse=1241.310791 best_discrete=71.823547 hash=False elapsed=54.5s
step   600/900 tau=0.0967 loss=0.270248 mse_soft=0.269843 ent_in=1.0076 ent_out=0.3451 rowmax_in=0.5445 rowmax_out=0.8282 discrete_mse=136.830780 best_discrete=71.823547 hash=False elapsed=57.1s
step   625/900 tau=0.0877 loss=0.266358 mse_soft=0.265964 ent_in=0.9790 ent_out=0.3348 rowmax_in=0.5544 rowmax_out=0.8357 discrete_mse=832.072754 best_discrete=71.823547 hash=False elapsed=59.6s
step   650/900 tau=0.0795 loss=0.265133 mse_soft=0.264736 ent_in=0.9778 ent_out=0.3450 rowmax_in=0.5538 rowmax_out=0.8275 discrete_mse=156.428772 best_discrete=71.823547 hash=False elapsed=61.8s
step   675/900 tau=0.0722 loss=0.284870 mse_soft=0.284485 ent_in=0.9532 ent_out=0.3298 rowmax_in=0.5645 rowmax_out=0.8368 discrete_mse=85.651901 best_discrete=71.823547 hash=False elapsed=64.1s
step   700/900 tau=0.0655 loss=0.275805 mse_soft=0.275427 ent_in=0.9402 ent_out=0.3191 rowmax_in=0.5775 rowmax_out=0.8393 discrete_mse=189.242142 best_discrete=71.823547 hash=False elapsed=66.5s
step   725/900 tau=0.0594 loss=0.275601 mse_soft=0.275250 ent_in=0.8758 ent_out=0.2972 rowmax_in=0.5959 rowmax_out=0.8489 discrete_mse=51.308632 best_discrete=51.308632 hash=False elapsed=68.9s
step   750/900 tau=0.0539 loss=0.271495 mse_soft=0.271135 ent_in=0.8774 ent_out=0.3256 rowmax_in=0.5859 rowmax_out=0.8318 discrete_mse=67.387680 best_discrete=51.308632 hash=False elapsed=71.3s
step   775/900 tau=0.0489 loss=0.527323 mse_soft=0.527139 ent_in=0.4842 ent_out=0.1293 rowmax_in=0.7846 rowmax_out=0.9338 discrete_mse=2.193796 best_discrete=2.193796 hash=False elapsed=73.6s
step   800/900 tau=0.0443 loss=0.424328 mse_soft=0.424175 ent_in=0.3923 ent_out=0.1188 rowmax_in=0.8162 rowmax_out=0.9394 discrete_mse=0.885134 best_discrete=0.885134 hash=False elapsed=75.9s
step   825/900 tau=0.0402 loss=0.414994 mse_soft=0.414861 ent_in=0.3371 ent_out=0.1077 rowmax_in=0.8448 rowmax_out=0.9397 discrete_mse=0.885134 best_discrete=0.885134 hash=False elapsed=78.3s
step   850/900 tau=0.0365 loss=0.370301 mse_soft=0.370159 ent_in=0.3578 ent_out=0.1171 rowmax_in=0.8273 rowmax_out=0.9311 discrete_mse=2.859116 best_discrete=0.885134 hash=False elapsed=80.6s
step   875/900 tau=0.0331 loss=0.371155 mse_soft=0.371010 ent_in=0.3691 ent_out=0.1131 rowmax_in=0.8113 rowmax_out=0.9336 discrete_mse=2.859116 best_discrete=0.885134 hash=False elapsed=82.8s
step   900/900 tau=0.0300 loss=0.356135 mse_soft=0.355992 ent_in=0.3654 ent_out=0.1104 rowmax_in=0.8030 rowmax_out=0.9336 discrete_mse=3.601211 best_discrete=0.885134 hash=False elapsed=85.1s

Final metrics:
  soft_mse_full=0.375737
  rowmax_in_mean=0.8033
  rowmax_out_mean=0.9337
  ent_in_mean=0.3646
  ent_out_mean=0.1102
  final_discrete_mse=3.601211
  hash_match=False
  best_discrete_mse_seen=0.885134
Saved results to overnight_b010_j1.json
