Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.081312 mse_soft=1.078989 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=17.583830 best_discrete=17.583830 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.881369 mse_soft=0.879180 ent_in=3.6313 ent_out=3.6656 rowmax_in=0.0471 rowmax_out=0.0444 discrete_mse=106.107025 best_discrete=17.583830 hash=False elapsed=2.5s
step    50/900 tau=0.8229 loss=0.666979 mse_soft=0.665075 ent_in=3.1219 ent_out=3.2231 rowmax_in=0.0924 rowmax_out=0.0868 discrete_mse=525.349731 best_discrete=17.583830 hash=False elapsed=4.5s
step    75/900 tau=0.7450 loss=0.524178 mse_soft=0.522594 ent_in=2.6059 ent_out=2.6744 rowmax_in=0.2014 rowmax_out=0.1957 discrete_mse=1450.757935 best_discrete=17.583830 hash=False elapsed=6.6s
step   100/900 tau=0.6745 loss=0.408747 mse_soft=0.407564 ent_in=2.0472 ent_out=1.8939 rowmax_in=0.3304 rowmax_out=0.4042 discrete_mse=5219.106934 best_discrete=17.583830 hash=False elapsed=8.9s
step   125/900 tau=0.6107 loss=0.347979 mse_soft=0.347124 ent_in=1.6287 ent_out=1.2210 rowmax_in=0.4308 rowmax_out=0.5820 discrete_mse=1514.988403 best_discrete=17.583830 hash=False elapsed=11.0s
step   150/900 tau=0.5529 loss=0.321890 mse_soft=0.321183 ent_in=1.4548 ent_out=0.9028 rowmax_in=0.4713 rowmax_out=0.6588 discrete_mse=337.251984 best_discrete=17.583830 hash=False elapsed=13.1s
step   175/900 tau=0.5006 loss=0.307326 mse_soft=0.306702 ent_in=1.3411 ent_out=0.7357 rowmax_in=0.4987 rowmax_out=0.7077 discrete_mse=604.793884 best_discrete=17.583830 hash=False elapsed=15.3s
step   200/900 tau=0.4532 loss=0.298038 mse_soft=0.297479 ent_in=1.2673 ent_out=0.5950 rowmax_in=0.5109 rowmax_out=0.7571 discrete_mse=420.574341 best_discrete=17.583830 hash=False elapsed=17.4s
step   225/900 tau=0.4103 loss=0.291214 mse_soft=0.290695 ent_in=1.2051 ent_out=0.5240 rowmax_in=0.5234 rowmax_out=0.7800 discrete_mse=734.139465 best_discrete=17.583830 hash=False elapsed=19.5s
step   250/900 tau=0.3715 loss=0.289345 mse_soft=0.288842 ent_in=1.1748 ent_out=0.5019 rowmax_in=0.5254 rowmax_out=0.7845 discrete_mse=386.092346 best_discrete=17.583830 hash=False elapsed=22.0s
step   275/900 tau=0.3363 loss=0.287181 mse_soft=0.286690 ent_in=1.1557 ent_out=0.4816 rowmax_in=0.5274 rowmax_out=0.7903 discrete_mse=824.838379 best_discrete=17.583830 hash=False elapsed=24.3s
step   300/900 tau=0.3045 loss=0.285975 mse_soft=0.285494 ent_in=1.1398 ent_out=0.4643 rowmax_in=0.5274 rowmax_out=0.7958 discrete_mse=563.037964 best_discrete=17.583830 hash=False elapsed=26.5s
step   325/900 tau=0.2756 loss=0.285110 mse_soft=0.284636 ent_in=1.1298 ent_out=0.4488 rowmax_in=0.5281 rowmax_out=0.8001 discrete_mse=326.454681 best_discrete=17.583830 hash=False elapsed=28.7s
step   350/900 tau=0.2496 loss=0.285835 mse_soft=0.285366 ent_in=1.1281 ent_out=0.4365 rowmax_in=0.5266 rowmax_out=0.8045 discrete_mse=670.264954 best_discrete=17.583830 hash=False elapsed=30.8s
step   375/900 tau=0.2259 loss=0.284638 mse_soft=0.284173 ent_in=1.1241 ent_out=0.4264 rowmax_in=0.5258 rowmax_out=0.8083 discrete_mse=648.284790 best_discrete=17.583830 hash=False elapsed=33.2s
step   400/900 tau=0.2046 loss=0.285649 mse_soft=0.285187 ent_in=1.1234 ent_out=0.4145 rowmax_in=0.5266 rowmax_out=0.8143 discrete_mse=670.264954 best_discrete=17.583830 hash=False elapsed=35.5s
step   425/900 tau=0.1852 loss=0.285565 mse_soft=0.285108 ent_in=1.1169 ent_out=0.4053 rowmax_in=0.5259 rowmax_out=0.8171 discrete_mse=670.264954 best_discrete=17.583830 hash=False elapsed=37.7s
step   450/900 tau=0.1677 loss=0.283418 mse_soft=0.282964 ent_in=1.1141 ent_out=0.3981 rowmax_in=0.5260 rowmax_out=0.8204 discrete_mse=670.264954 best_discrete=17.583830 hash=False elapsed=39.9s
step   475/900 tau=0.1518 loss=0.284902 mse_soft=0.284451 ent_in=1.1110 ent_out=0.3951 rowmax_in=0.5257 rowmax_out=0.8212 discrete_mse=326.454681 best_discrete=17.583830 hash=False elapsed=42.3s
step   500/900 tau=0.1374 loss=0.284017 mse_soft=0.283569 ent_in=1.1023 ent_out=0.3913 rowmax_in=0.5286 rowmax_out=0.8230 discrete_mse=306.142548 best_discrete=17.583830 hash=False elapsed=44.5s
step   525/900 tau=0.1244 loss=0.301046 mse_soft=0.300601 ent_in=1.0938 ent_out=0.3894 rowmax_in=0.5303 rowmax_out=0.8217 discrete_mse=1013.497192 best_discrete=17.583830 hash=False elapsed=46.8s
step   550/900 tau=0.1126 loss=0.286117 mse_soft=0.285674 ent_in=1.0904 ent_out=0.3878 rowmax_in=0.5284 rowmax_out=0.8203 discrete_mse=239.207550 best_discrete=17.583830 hash=False elapsed=49.2s
step   575/900 tau=0.1020 loss=0.294068 mse_soft=0.293627 ent_in=1.0829 ent_out=0.3868 rowmax_in=0.5324 rowmax_out=0.8201 discrete_mse=454.523651 best_discrete=17.583830 hash=False elapsed=51.6s
step   600/900 tau=0.0923 loss=0.296618 mse_soft=0.296178 ent_in=1.0822 ent_out=0.3839 rowmax_in=0.5269 rowmax_out=0.8202 discrete_mse=13.285735 best_discrete=13.285735 hash=False elapsed=54.1s
step   625/900 tau=0.0836 loss=0.318048 mse_soft=0.317609 ent_in=1.0803 ent_out=0.3840 rowmax_in=0.5359 rowmax_out=0.8198 discrete_mse=1248.507568 best_discrete=13.285735 hash=False elapsed=56.4s
step   650/900 tau=0.0757 loss=0.340669 mse_soft=0.340266 ent_in=1.0021 ent_out=0.3440 rowmax_in=0.5708 rowmax_out=0.8406 discrete_mse=39.496494 best_discrete=13.285735 hash=False elapsed=58.8s
step   675/900 tau=0.0685 loss=0.314514 mse_soft=0.314107 ent_in=0.9883 ent_out=0.3691 rowmax_in=0.5505 rowmax_out=0.8153 discrete_mse=165.442307 best_discrete=13.285735 hash=False elapsed=61.4s
step   700/900 tau=0.0620 loss=0.293826 mse_soft=0.293417 ent_in=0.9961 ent_out=0.3659 rowmax_in=0.5432 rowmax_out=0.8169 discrete_mse=345.161591 best_discrete=13.285735 hash=False elapsed=63.8s
step   725/900 tau=0.0562 loss=0.314748 mse_soft=0.314345 ent_in=0.9846 ent_out=0.3609 rowmax_in=0.5503 rowmax_out=0.8204 discrete_mse=151.569717 best_discrete=13.285735 hash=False elapsed=66.1s
step   750/900 tau=0.0508 loss=0.309943 mse_soft=0.309547 ent_in=0.9572 ent_out=0.3634 rowmax_in=0.5624 rowmax_out=0.8155 discrete_mse=63.917912 best_discrete=13.285735 hash=False elapsed=68.5s
step   775/900 tau=0.0460 loss=0.401487 mse_soft=0.401145 ent_in=0.8250 ent_out=0.3169 rowmax_in=0.6183 rowmax_out=0.8499 discrete_mse=13.404941 best_discrete=13.285735 hash=False elapsed=71.1s
step   800/900 tau=0.0417 loss=0.403481 mse_soft=0.403278 ent_in=0.4831 ent_out=0.1924 rowmax_in=0.7545 rowmax_out=0.8955 discrete_mse=34.415775 best_discrete=13.285735 hash=False elapsed=73.5s
step   825/900 tau=0.0377 loss=0.379592 mse_soft=0.379402 ent_in=0.4714 ent_out=0.1617 rowmax_in=0.7514 rowmax_out=0.9092 discrete_mse=87.637001 best_discrete=13.285735 hash=False elapsed=75.8s
step   850/900 tau=0.0342 loss=0.370896 mse_soft=0.370715 ent_in=0.4496 ent_out=0.1545 rowmax_in=0.7606 rowmax_out=0.9145 discrete_mse=2.541740 best_discrete=2.541740 hash=False elapsed=78.2s
step   875/900 tau=0.0309 loss=0.369746 mse_soft=0.369563 ent_in=0.4496 ent_out=0.1609 rowmax_in=0.7606 rowmax_out=0.9094 discrete_mse=2.541740 best_discrete=2.541740 hash=False elapsed=80.4s
step   900/900 tau=0.0280 loss=0.368530 mse_soft=0.368342 ent_in=0.4373 ent_out=0.1884 rowmax_in=0.7696 rowmax_out=0.8944 discrete_mse=120.053497 best_discrete=2.541740 hash=False elapsed=82.8s

Final metrics:
  soft_mse_full=0.374488
  rowmax_in_mean=0.7703
  rowmax_out_mean=0.8892
  ent_in_mean=0.4378
  ent_out_mean=0.1957
  final_discrete_mse=69.861977
  hash_match=False
  best_discrete_mse_seen=2.541740
Saved results to overnight_b021_j2.json
