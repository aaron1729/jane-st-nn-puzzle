Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.062964 mse_soft=1.060641 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=142.440155 best_discrete=142.440155 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.858862 mse_soft=0.856672 ent_in=3.6331 ent_out=3.6681 rowmax_in=0.0451 rowmax_out=0.0442 discrete_mse=3896.803955 best_discrete=142.440155 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.640909 mse_soft=0.639003 ent_in=3.1292 ent_out=3.2259 rowmax_in=0.0925 rowmax_out=0.0895 discrete_mse=1675.334106 best_discrete=142.440155 hash=False elapsed=5.3s
step    75/900 tau=0.7493 loss=0.497594 mse_soft=0.496026 ent_in=2.5786 ent_out=2.6500 rowmax_in=0.2056 rowmax_out=0.2109 discrete_mse=1369.288696 best_discrete=142.440155 hash=False elapsed=7.7s
step   100/900 tau=0.6797 loss=0.393461 mse_soft=0.392310 ent_in=1.9536 ent_out=1.8837 rowmax_in=0.3571 rowmax_out=0.3984 discrete_mse=276.307037 best_discrete=142.440155 hash=False elapsed=9.9s
step   125/900 tau=0.6165 loss=0.333725 mse_soft=0.332895 ent_in=1.5458 ent_out=1.2190 rowmax_in=0.4533 rowmax_out=0.5991 discrete_mse=2035.193359 best_discrete=142.440155 hash=False elapsed=11.9s
step   150/900 tau=0.5592 loss=0.312364 mse_soft=0.311697 ent_in=1.3930 ent_out=0.8308 rowmax_in=0.4829 rowmax_out=0.7152 discrete_mse=867.594299 best_discrete=142.440155 hash=False elapsed=14.2s
step   175/900 tau=0.5073 loss=0.297809 mse_soft=0.297218 ent_in=1.3246 ent_out=0.6455 rowmax_in=0.4830 rowmax_out=0.7597 discrete_mse=521.284729 best_discrete=142.440155 hash=False elapsed=16.4s
step   200/900 tau=0.4602 loss=0.289010 mse_soft=0.288479 ent_in=1.2704 ent_out=0.5005 rowmax_in=0.4790 rowmax_out=0.8122 discrete_mse=314.472748 best_discrete=142.440155 hash=False elapsed=18.6s
step   225/900 tau=0.4174 loss=0.284050 mse_soft=0.283550 ent_in=1.2291 ent_out=0.4366 rowmax_in=0.4847 rowmax_out=0.8337 discrete_mse=440.323486 best_discrete=142.440155 hash=False elapsed=20.9s
step   250/900 tau=0.3786 loss=0.280457 mse_soft=0.279976 ent_in=1.2055 ent_out=0.3965 rowmax_in=0.4869 rowmax_out=0.8410 discrete_mse=461.797089 best_discrete=142.440155 hash=False elapsed=22.9s
step   275/900 tau=0.3434 loss=0.280268 mse_soft=0.279802 ent_in=1.1851 ent_out=0.3700 rowmax_in=0.4909 rowmax_out=0.8476 discrete_mse=324.984375 best_discrete=142.440155 hash=False elapsed=25.1s
step   300/900 tau=0.3115 loss=0.276609 mse_soft=0.276148 ent_in=1.1793 ent_out=0.3587 rowmax_in=0.4932 rowmax_out=0.8475 discrete_mse=324.984375 best_discrete=142.440155 hash=False elapsed=27.2s
step   325/900 tau=0.2826 loss=0.275523 mse_soft=0.275067 ent_in=1.1743 ent_out=0.3456 rowmax_in=0.4931 rowmax_out=0.8533 discrete_mse=144.466019 best_discrete=142.440155 hash=False elapsed=29.5s
step   350/900 tau=0.2563 loss=0.273393 mse_soft=0.272940 ent_in=1.1669 ent_out=0.3441 rowmax_in=0.4932 rowmax_out=0.8494 discrete_mse=139.638672 best_discrete=139.638672 hash=False elapsed=31.7s
step   375/900 tau=0.2325 loss=0.275743 mse_soft=0.275293 ent_in=1.1636 ent_out=0.3355 rowmax_in=0.4940 rowmax_out=0.8529 discrete_mse=144.466019 best_discrete=139.638672 hash=False elapsed=34.0s
step   400/900 tau=0.2109 loss=0.273217 mse_soft=0.272772 ent_in=1.1557 ent_out=0.3288 rowmax_in=0.4965 rowmax_out=0.8546 discrete_mse=397.338654 best_discrete=139.638672 hash=False elapsed=36.3s
step   425/900 tau=0.1913 loss=0.272662 mse_soft=0.272219 ent_in=1.1550 ent_out=0.3204 rowmax_in=0.4972 rowmax_out=0.8548 discrete_mse=397.338654 best_discrete=139.638672 hash=False elapsed=38.1s
step   450/900 tau=0.1735 loss=0.275713 mse_soft=0.275272 ent_in=1.1553 ent_out=0.3127 rowmax_in=0.4956 rowmax_out=0.8559 discrete_mse=652.779419 best_discrete=139.638672 hash=False elapsed=40.2s
step   475/900 tau=0.1574 loss=0.272398 mse_soft=0.271960 ent_in=1.1523 ent_out=0.3052 rowmax_in=0.4989 rowmax_out=0.8607 discrete_mse=697.437561 best_discrete=139.638672 hash=False elapsed=42.5s
step   500/900 tau=0.1428 loss=0.275159 mse_soft=0.274727 ent_in=1.1506 ent_out=0.2905 rowmax_in=0.4992 rowmax_out=0.8670 discrete_mse=67.996994 best_discrete=67.996994 hash=False elapsed=44.7s
step   525/900 tau=0.1295 loss=0.275873 mse_soft=0.275444 ent_in=1.1457 ent_out=0.2868 rowmax_in=0.4987 rowmax_out=0.8682 discrete_mse=831.945984 best_discrete=67.996994 hash=False elapsed=46.6s
step   550/900 tau=0.1175 loss=0.272480 mse_soft=0.272051 ent_in=1.1440 ent_out=0.2855 rowmax_in=0.5013 rowmax_out=0.8683 discrete_mse=125.847771 best_discrete=67.996994 hash=False elapsed=48.6s
step   575/900 tau=0.1066 loss=0.274504 mse_soft=0.274080 ent_in=1.1401 ent_out=0.2743 rowmax_in=0.5013 rowmax_out=0.8750 discrete_mse=95.190544 best_discrete=67.996994 hash=False elapsed=50.6s
step   600/900 tau=0.0967 loss=0.272149 mse_soft=0.271726 ent_in=1.1389 ent_out=0.2734 rowmax_in=0.4968 rowmax_out=0.8738 discrete_mse=842.863770 best_discrete=67.996994 hash=False elapsed=52.8s
step   625/900 tau=0.0877 loss=0.302945 mse_soft=0.302561 ent_in=1.0609 ent_out=0.2170 rowmax_in=0.5157 rowmax_out=0.8895 discrete_mse=140.384293 best_discrete=67.996994 hash=False elapsed=55.2s
step   650/900 tau=0.0795 loss=0.287440 mse_soft=0.287061 ent_in=1.0372 ent_out=0.2260 rowmax_in=0.5206 rowmax_out=0.8961 discrete_mse=210.354538 best_discrete=67.996994 hash=False elapsed=57.4s
step   675/900 tau=0.0722 loss=0.298247 mse_soft=0.297879 ent_in=1.0141 ent_out=0.2138 rowmax_in=0.5335 rowmax_out=0.8954 discrete_mse=374.287811 best_discrete=67.996994 hash=False elapsed=59.6s
step   700/900 tau=0.0655 loss=0.298789 mse_soft=0.298420 ent_in=0.9988 ent_out=0.2318 rowmax_in=0.5338 rowmax_out=0.8900 discrete_mse=545.800476 best_discrete=67.996994 hash=False elapsed=62.0s
step   725/900 tau=0.0594 loss=0.309139 mse_soft=0.308791 ent_in=0.9414 ent_out=0.2165 rowmax_in=0.5564 rowmax_out=0.8917 discrete_mse=218.174042 best_discrete=67.996994 hash=False elapsed=64.3s
step   750/900 tau=0.0539 loss=0.294972 mse_soft=0.294632 ent_in=0.9267 ent_out=0.2058 rowmax_in=0.5604 rowmax_out=0.9025 discrete_mse=323.807953 best_discrete=67.996994 hash=False elapsed=66.8s
step   775/900 tau=0.0489 loss=0.292003 mse_soft=0.291655 ent_in=0.9310 ent_out=0.2296 rowmax_in=0.5578 rowmax_out=0.8803 discrete_mse=344.701355 best_discrete=67.996994 hash=False elapsed=68.9s
step   800/900 tau=0.0443 loss=0.375875 mse_soft=0.375604 ent_in=0.7222 ent_out=0.1804 rowmax_in=0.6680 rowmax_out=0.9065 discrete_mse=97.736618 best_discrete=67.996994 hash=False elapsed=71.0s
step   825/900 tau=0.0402 loss=0.351508 mse_soft=0.351250 ent_in=0.7148 ent_out=0.1431 rowmax_in=0.6286 rowmax_out=0.9375 discrete_mse=49.019367 best_discrete=49.019367 hash=False elapsed=73.2s
step   850/900 tau=0.0365 loss=0.380839 mse_soft=0.380648 ent_in=0.5149 ent_out=0.1203 rowmax_in=0.7491 rowmax_out=0.9425 discrete_mse=39.451843 best_discrete=39.451843 hash=False elapsed=75.5s
step   875/900 tau=0.0331 loss=0.353942 mse_soft=0.353750 ent_in=0.5367 ent_out=0.1046 rowmax_in=0.7233 rowmax_out=0.9501 discrete_mse=39.451843 best_discrete=39.451843 hash=False elapsed=77.7s
step   900/900 tau=0.0300 loss=0.353814 mse_soft=0.353630 ent_in=0.5147 ent_out=0.1018 rowmax_in=0.7375 rowmax_out=0.9526 discrete_mse=6.710750 best_discrete=6.710750 hash=False elapsed=80.1s

Final metrics:
  soft_mse_full=0.362526
  rowmax_in_mean=0.7427
  rowmax_out_mean=0.9516
  ent_in_mean=0.5111
  ent_out_mean=0.1033
  final_discrete_mse=28.132349
  hash_match=False
  best_discrete_mse_seen=6.710750
Saved results to overnight_b221_j1.json
