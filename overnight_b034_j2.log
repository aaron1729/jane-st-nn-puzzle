Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.060547 mse_soft=1.058224 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=23.726105 best_discrete=23.726105 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.856432 mse_soft=0.854243 ent_in=3.6302 ent_out=3.6657 rowmax_in=0.0457 rowmax_out=0.0445 discrete_mse=2521.953369 best_discrete=23.726105 hash=False elapsed=2.5s
step    50/900 tau=0.8229 loss=0.637538 mse_soft=0.635637 ent_in=3.1186 ent_out=3.2192 rowmax_in=0.0913 rowmax_out=0.0902 discrete_mse=5421.940918 best_discrete=23.726105 hash=False elapsed=4.7s
step    75/900 tau=0.7450 loss=0.494982 mse_soft=0.493415 ent_in=2.5673 ent_out=2.6558 rowmax_in=0.1986 rowmax_out=0.2054 discrete_mse=224.952301 best_discrete=23.726105 hash=False elapsed=6.9s
step   100/900 tau=0.6745 loss=0.400433 mse_soft=0.399254 ent_in=2.0301 ent_out=1.9002 rowmax_in=0.3298 rowmax_out=0.3857 discrete_mse=515.071716 best_discrete=23.726105 hash=False elapsed=9.2s
step   125/900 tau=0.6107 loss=0.338237 mse_soft=0.337397 ent_in=1.5970 ent_out=1.2013 rowmax_in=0.4365 rowmax_out=0.6120 discrete_mse=280.445282 best_discrete=23.726105 hash=False elapsed=11.6s
step   150/900 tau=0.5529 loss=0.317962 mse_soft=0.317295 ent_in=1.4159 ent_out=0.8085 rowmax_in=0.4737 rowmax_out=0.7191 discrete_mse=98.889435 best_discrete=23.726105 hash=False elapsed=13.6s
step   175/900 tau=0.5006 loss=0.304004 mse_soft=0.303434 ent_in=1.3214 ent_out=0.5801 rowmax_in=0.4926 rowmax_out=0.7882 discrete_mse=151.172852 best_discrete=23.726105 hash=False elapsed=15.8s
step   200/900 tau=0.4532 loss=0.295801 mse_soft=0.295294 ent_in=1.2503 ent_out=0.4415 rowmax_in=0.5045 rowmax_out=0.8321 discrete_mse=203.214050 best_discrete=23.726105 hash=False elapsed=18.1s
step   225/900 tau=0.4103 loss=0.288155 mse_soft=0.287674 ent_in=1.2182 ent_out=0.3855 rowmax_in=0.5084 rowmax_out=0.8480 discrete_mse=86.998543 best_discrete=23.726105 hash=False elapsed=20.4s
step   250/900 tau=0.3715 loss=0.282297 mse_soft=0.281848 ent_in=1.1666 ent_out=0.3300 rowmax_in=0.5157 rowmax_out=0.8736 discrete_mse=143.065552 best_discrete=23.726105 hash=False elapsed=22.7s
step   275/900 tau=0.3363 loss=0.280008 mse_soft=0.279573 ent_in=1.1549 ent_out=0.2933 rowmax_in=0.5161 rowmax_out=0.8818 discrete_mse=145.305191 best_discrete=23.726105 hash=False elapsed=25.1s
step   300/900 tau=0.3045 loss=0.279015 mse_soft=0.278587 ent_in=1.1469 ent_out=0.2811 rowmax_in=0.5163 rowmax_out=0.8822 discrete_mse=92.536171 best_discrete=23.726105 hash=False elapsed=27.6s
step   325/900 tau=0.2756 loss=0.276863 mse_soft=0.276442 ent_in=1.1274 ent_out=0.2783 rowmax_in=0.5192 rowmax_out=0.8800 discrete_mse=232.855392 best_discrete=23.726105 hash=False elapsed=30.1s
step   350/900 tau=0.2496 loss=0.276099 mse_soft=0.275685 ent_in=1.1097 ent_out=0.2698 rowmax_in=0.5231 rowmax_out=0.8823 discrete_mse=109.814995 best_discrete=23.726105 hash=False elapsed=32.2s
step   375/900 tau=0.2259 loss=0.275287 mse_soft=0.274882 ent_in=1.0981 ent_out=0.2520 rowmax_in=0.5263 rowmax_out=0.8922 discrete_mse=109.814995 best_discrete=23.726105 hash=False elapsed=34.7s
step   400/900 tau=0.2046 loss=0.273461 mse_soft=0.273064 ent_in=1.0817 ent_out=0.2427 rowmax_in=0.5307 rowmax_out=0.8967 discrete_mse=112.650696 best_discrete=23.726105 hash=False elapsed=36.9s
step   425/900 tau=0.1852 loss=0.274616 mse_soft=0.274223 ent_in=1.0725 ent_out=0.2390 rowmax_in=0.5330 rowmax_out=0.8957 discrete_mse=132.810547 best_discrete=23.726105 hash=False elapsed=39.0s
step   450/900 tau=0.1677 loss=0.295048 mse_soft=0.294656 ent_in=1.0667 ent_out=0.2410 rowmax_in=0.5352 rowmax_out=0.8898 discrete_mse=109.814995 best_discrete=23.726105 hash=False elapsed=41.1s
step   475/900 tau=0.1518 loss=0.273547 mse_soft=0.273159 ent_in=1.0570 ent_out=0.2373 rowmax_in=0.5364 rowmax_out=0.8914 discrete_mse=109.814995 best_discrete=23.726105 hash=False elapsed=43.1s
step   500/900 tau=0.1374 loss=0.272009 mse_soft=0.271623 ent_in=1.0572 ent_out=0.2288 rowmax_in=0.5379 rowmax_out=0.8936 discrete_mse=109.814995 best_discrete=23.726105 hash=False elapsed=45.3s
step   525/900 tau=0.1244 loss=0.276536 mse_soft=0.276153 ent_in=1.0509 ent_out=0.2256 rowmax_in=0.5400 rowmax_out=0.8947 discrete_mse=109.814995 best_discrete=23.726105 hash=False elapsed=47.8s
step   550/900 tau=0.1126 loss=0.276128 mse_soft=0.275744 ent_in=1.0512 ent_out=0.2285 rowmax_in=0.5369 rowmax_out=0.8925 discrete_mse=109.814995 best_discrete=23.726105 hash=False elapsed=50.1s
step   575/900 tau=0.1020 loss=0.281351 mse_soft=0.280969 ent_in=1.0421 ent_out=0.2309 rowmax_in=0.5442 rowmax_out=0.8909 discrete_mse=66.806770 best_discrete=23.726105 hash=False elapsed=52.3s
step   600/900 tau=0.0923 loss=0.278402 mse_soft=0.278022 ent_in=1.0372 ent_out=0.2308 rowmax_in=0.5498 rowmax_out=0.8921 discrete_mse=230.146973 best_discrete=23.726105 hash=False elapsed=54.6s
step   625/900 tau=0.0836 loss=0.290856 mse_soft=0.290490 ent_in=0.9904 ent_out=0.2271 rowmax_in=0.5630 rowmax_out=0.8929 discrete_mse=147.762222 best_discrete=23.726105 hash=False elapsed=56.9s
step   650/900 tau=0.0757 loss=0.282359 mse_soft=0.282002 ent_in=0.9675 ent_out=0.2248 rowmax_in=0.5662 rowmax_out=0.8964 discrete_mse=154.555252 best_discrete=23.726105 hash=False elapsed=59.1s
step   675/900 tau=0.0685 loss=0.284598 mse_soft=0.284240 ent_in=0.9746 ent_out=0.2188 rowmax_in=0.5603 rowmax_out=0.9009 discrete_mse=53.483597 best_discrete=23.726105 hash=False elapsed=61.4s
step   700/900 tau=0.0620 loss=0.291507 mse_soft=0.291153 ent_in=0.9706 ent_out=0.2089 rowmax_in=0.5700 rowmax_out=0.9044 discrete_mse=83.567085 best_discrete=23.726105 hash=False elapsed=63.5s
step   725/900 tau=0.0562 loss=0.289075 mse_soft=0.288731 ent_in=0.9473 ent_out=0.1971 rowmax_in=0.5760 rowmax_out=0.9073 discrete_mse=136.899078 best_discrete=23.726105 hash=False elapsed=65.7s
step   750/900 tau=0.0508 loss=0.438414 mse_soft=0.438235 ent_in=0.3923 ent_out=0.2068 rowmax_in=0.8056 rowmax_out=0.8931 discrete_mse=124.249794 best_discrete=23.726105 hash=False elapsed=67.9s
step   775/900 tau=0.0460 loss=0.375419 mse_soft=0.375259 ent_in=0.3444 ent_out=0.1891 rowmax_in=0.8242 rowmax_out=0.9072 discrete_mse=59.955925 best_discrete=23.726105 hash=False elapsed=69.9s
step   800/900 tau=0.0417 loss=0.369618 mse_soft=0.369463 ent_in=0.3488 ent_out=0.1674 rowmax_in=0.8197 rowmax_out=0.9181 discrete_mse=59.955925 best_discrete=23.726105 hash=False elapsed=71.8s
step   825/900 tau=0.0377 loss=0.375920 mse_soft=0.375771 ent_in=0.3281 ent_out=0.1702 rowmax_in=0.8394 rowmax_out=0.9150 discrete_mse=51.550049 best_discrete=23.726105 hash=False elapsed=74.0s
step   850/900 tau=0.0342 loss=0.371783 mse_soft=0.371639 ent_in=0.3157 ent_out=0.1657 rowmax_in=0.8392 rowmax_out=0.9166 discrete_mse=51.550049 best_discrete=23.726105 hash=False elapsed=76.1s
step   875/900 tau=0.0309 loss=0.491672 mse_soft=0.491558 ent_in=0.2245 ent_out=0.1558 rowmax_in=0.8971 rowmax_out=0.9209 discrete_mse=161.699020 best_discrete=23.726105 hash=False elapsed=78.3s
step   900/900 tau=0.0280 loss=0.454562 mse_soft=0.454475 ent_in=0.1499 ent_out=0.1404 rowmax_in=0.9246 rowmax_out=0.9199 discrete_mse=15.587623 best_discrete=15.587623 hash=False elapsed=80.3s

Final metrics:
  soft_mse_full=0.467318
  rowmax_in_mean=0.9248
  rowmax_out_mean=0.9197
  ent_in_mean=0.1493
  ent_out_mean=0.1411
  final_discrete_mse=15.587623
  hash_match=False
  best_discrete_mse_seen=15.587623
Saved results to overnight_b034_j2.json
