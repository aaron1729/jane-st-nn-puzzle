Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.063791 mse_soft=1.061468 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=46.242241 best_discrete=46.242241 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.862401 mse_soft=0.860212 ent_in=3.6308 ent_out=3.6659 rowmax_in=0.0455 rowmax_out=0.0451 discrete_mse=2957.851807 best_discrete=46.242241 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.657481 mse_soft=0.655574 ent_in=3.1316 ent_out=3.2255 rowmax_in=0.0923 rowmax_out=0.0866 discrete_mse=9850.350586 best_discrete=46.242241 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.521668 mse_soft=0.520083 ent_in=2.5940 ent_out=2.6902 rowmax_in=0.2011 rowmax_out=0.1972 discrete_mse=1356.844727 best_discrete=46.242241 hash=False elapsed=7.0s
step   100/900 tau=0.6797 loss=0.409677 mse_soft=0.408531 ent_in=1.9969 ent_out=1.8229 rowmax_in=0.3328 rowmax_out=0.4101 discrete_mse=910.406006 best_discrete=46.242241 hash=False elapsed=9.1s
step   125/900 tau=0.6165 loss=0.351445 mse_soft=0.350625 ent_in=1.6040 ent_out=1.1286 rowmax_in=0.4518 rowmax_out=0.6121 discrete_mse=70.253334 best_discrete=46.242241 hash=False elapsed=11.5s
step   150/900 tau=0.5592 loss=0.319917 mse_soft=0.319255 ent_in=1.4248 ent_out=0.7838 rowmax_in=0.4891 rowmax_out=0.7212 discrete_mse=26.871296 best_discrete=26.871296 hash=False elapsed=14.0s
step   175/900 tau=0.5073 loss=0.304717 mse_soft=0.304155 ent_in=1.2984 ent_out=0.5761 rowmax_in=0.5137 rowmax_out=0.7790 discrete_mse=236.371094 best_discrete=26.871296 hash=False elapsed=16.3s
step   200/900 tau=0.4602 loss=0.298646 mse_soft=0.298133 ent_in=1.2398 ent_out=0.4722 rowmax_in=0.5197 rowmax_out=0.8100 discrete_mse=477.646149 best_discrete=26.871296 hash=False elapsed=18.3s
step   225/900 tau=0.4174 loss=0.292890 mse_soft=0.292401 ent_in=1.2055 ent_out=0.4223 rowmax_in=0.5291 rowmax_out=0.8238 discrete_mse=155.304138 best_discrete=26.871296 hash=False elapsed=20.5s
step   250/900 tau=0.3786 loss=0.290238 mse_soft=0.289763 ent_in=1.1798 ent_out=0.4028 rowmax_in=0.5333 rowmax_out=0.8294 discrete_mse=155.304138 best_discrete=26.871296 hash=False elapsed=22.8s
step   275/900 tau=0.3434 loss=0.286417 mse_soft=0.285952 ent_in=1.1584 ent_out=0.3938 rowmax_in=0.5365 rowmax_out=0.8315 discrete_mse=155.304138 best_discrete=26.871296 hash=False elapsed=25.1s
step   300/900 tau=0.3115 loss=0.285352 mse_soft=0.284891 ent_in=1.1451 ent_out=0.3921 rowmax_in=0.5385 rowmax_out=0.8289 discrete_mse=92.707932 best_discrete=26.871296 hash=False elapsed=27.6s
step   325/900 tau=0.2826 loss=0.283213 mse_soft=0.282756 ent_in=1.1372 ent_out=0.3874 rowmax_in=0.5396 rowmax_out=0.8282 discrete_mse=41.107967 best_discrete=26.871296 hash=False elapsed=30.0s
step   350/900 tau=0.2563 loss=0.283995 mse_soft=0.283541 ent_in=1.1282 ent_out=0.3859 rowmax_in=0.5414 rowmax_out=0.8286 discrete_mse=41.107967 best_discrete=26.871296 hash=False elapsed=32.4s
step   375/900 tau=0.2325 loss=0.281811 mse_soft=0.281359 ent_in=1.1260 ent_out=0.3806 rowmax_in=0.5423 rowmax_out=0.8300 discrete_mse=41.107967 best_discrete=26.871296 hash=False elapsed=34.7s
step   400/900 tau=0.2109 loss=0.282314 mse_soft=0.281867 ent_in=1.1234 ent_out=0.3691 rowmax_in=0.5430 rowmax_out=0.8345 discrete_mse=41.107967 best_discrete=26.871296 hash=False elapsed=37.1s
step   425/900 tau=0.1913 loss=0.285037 mse_soft=0.284593 ent_in=1.1178 ent_out=0.3605 rowmax_in=0.5443 rowmax_out=0.8367 discrete_mse=41.107967 best_discrete=26.871296 hash=False elapsed=39.4s
step   450/900 tau=0.1735 loss=0.285000 mse_soft=0.284562 ent_in=1.1105 ent_out=0.3485 rowmax_in=0.5462 rowmax_out=0.8406 discrete_mse=82.802177 best_discrete=26.871296 hash=False elapsed=41.6s
step   475/900 tau=0.1574 loss=0.284388 mse_soft=0.283956 ent_in=1.1032 ent_out=0.3397 rowmax_in=0.5462 rowmax_out=0.8410 discrete_mse=62.912281 best_discrete=26.871296 hash=False elapsed=43.9s
step   500/900 tau=0.1428 loss=0.277808 mse_soft=0.277381 ent_in=1.0928 ent_out=0.3324 rowmax_in=0.5517 rowmax_out=0.8427 discrete_mse=62.912281 best_discrete=26.871296 hash=False elapsed=46.2s
step   525/900 tau=0.1295 loss=0.283807 mse_soft=0.283383 ent_in=1.0881 ent_out=0.3269 rowmax_in=0.5533 rowmax_out=0.8430 discrete_mse=62.912281 best_discrete=26.871296 hash=False elapsed=48.7s
step   550/900 tau=0.1175 loss=0.282310 mse_soft=0.281890 ent_in=1.0825 ent_out=0.3177 rowmax_in=0.5551 rowmax_out=0.8453 discrete_mse=62.912281 best_discrete=26.871296 hash=False elapsed=51.1s
step   575/900 tau=0.1066 loss=0.290676 mse_soft=0.290261 ent_in=1.0726 ent_out=0.3121 rowmax_in=0.5575 rowmax_out=0.8452 discrete_mse=81.722176 best_discrete=26.871296 hash=False elapsed=53.0s
step   600/900 tau=0.0967 loss=0.281325 mse_soft=0.280910 ent_in=1.0719 ent_out=0.3120 rowmax_in=0.5573 rowmax_out=0.8446 discrete_mse=584.180603 best_discrete=26.871296 hash=False elapsed=55.3s
step   625/900 tau=0.0877 loss=0.287722 mse_soft=0.287315 ent_in=1.0481 ent_out=0.3061 rowmax_in=0.5626 rowmax_out=0.8423 discrete_mse=151.449295 best_discrete=26.871296 hash=False elapsed=57.6s
step   650/900 tau=0.0795 loss=0.288358 mse_soft=0.287955 ent_in=1.0357 ent_out=0.3084 rowmax_in=0.5687 rowmax_out=0.8435 discrete_mse=150.781448 best_discrete=26.871296 hash=False elapsed=59.8s
step   675/900 tau=0.0722 loss=0.300436 mse_soft=0.300037 ent_in=1.0220 ent_out=0.3074 rowmax_in=0.5693 rowmax_out=0.8408 discrete_mse=123.584625 best_discrete=26.871296 hash=False elapsed=62.1s
step   700/900 tau=0.0655 loss=0.288222 mse_soft=0.287825 ent_in=1.0132 ent_out=0.3087 rowmax_in=0.5735 rowmax_out=0.8394 discrete_mse=113.561974 best_discrete=26.871296 hash=False elapsed=64.6s
step   725/900 tau=0.0594 loss=0.303260 mse_soft=0.302887 ent_in=0.9567 ent_out=0.2876 rowmax_in=0.5896 rowmax_out=0.8580 discrete_mse=21.005262 best_discrete=21.005262 hash=False elapsed=66.9s
step   750/900 tau=0.0539 loss=0.299668 mse_soft=0.299320 ent_in=0.9001 ent_out=0.2612 rowmax_in=0.6013 rowmax_out=0.8661 discrete_mse=219.259262 best_discrete=21.005262 hash=False elapsed=69.0s
step   775/900 tau=0.0489 loss=0.360162 mse_soft=0.359856 ent_in=0.7948 ent_out=0.2252 rowmax_in=0.6409 rowmax_out=0.8986 discrete_mse=0.929392 best_discrete=0.929392 hash=False elapsed=71.3s
step   800/900 tau=0.0443 loss=0.316592 mse_soft=0.316336 ent_in=0.7001 ent_out=0.1542 rowmax_in=0.6743 rowmax_out=0.9293 discrete_mse=7.128746 best_discrete=0.929392 hash=False elapsed=73.5s
step   825/900 tau=0.0402 loss=0.313705 mse_soft=0.313452 ent_in=0.6845 ent_out=0.1582 rowmax_in=0.6726 rowmax_out=0.9147 discrete_mse=6.215533 best_discrete=0.929392 hash=False elapsed=75.8s
step   850/900 tau=0.0365 loss=0.299467 mse_soft=0.299215 ent_in=0.6716 ent_out=0.1703 rowmax_in=0.6719 rowmax_out=0.9055 discrete_mse=3.873158 best_discrete=0.929392 hash=False elapsed=77.9s
step   875/900 tau=0.0331 loss=0.302984 mse_soft=0.302732 ent_in=0.6670 ent_out=0.1723 rowmax_in=0.6776 rowmax_out=0.9070 discrete_mse=34.326973 best_discrete=0.929392 hash=False elapsed=80.2s
step   900/900 tau=0.0300 loss=0.316410 mse_soft=0.316172 ent_in=0.6372 ent_out=0.1573 rowmax_in=0.6890 rowmax_out=0.9155 discrete_mse=17.100424 best_discrete=0.929392 hash=False elapsed=82.6s

Final metrics:
  soft_mse_full=0.322940
  rowmax_in_mean=0.6983
  rowmax_out_mean=0.9160
  ent_in_mean=0.6270
  ent_out_mean=0.1571
  final_discrete_mse=17.100424
  hash_match=False
  best_discrete_mse_seen=0.929392
Saved results to overnight_b028_j1.json
