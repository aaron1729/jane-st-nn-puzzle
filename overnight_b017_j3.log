Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.02
step     1/700 tau=1.0000 loss=1.065745 mse_soft=1.063422 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=73.964119 best_discrete=73.964119 hash=False elapsed=0.5s
step    25/700 tau=0.8866 loss=0.934655 mse_soft=0.932404 ent_in=3.7412 ent_out=3.7627 rowmax_in=0.0374 rowmax_out=0.0362 discrete_mse=4334.084473 best_discrete=73.964119 hash=False elapsed=2.6s
step    50/700 tau=0.7821 loss=0.710090 mse_soft=0.708056 ent_in=3.3566 ent_out=3.4232 rowmax_in=0.0707 rowmax_out=0.0664 discrete_mse=8412.081055 best_discrete=73.964119 hash=False elapsed=4.7s
step    75/700 tau=0.6899 loss=0.590380 mse_soft=0.588579 ent_in=2.9393 ent_out=3.0628 rowmax_in=0.1300 rowmax_out=0.1208 discrete_mse=1727.690186 best_discrete=73.964119 hash=False elapsed=6.9s
step   100/700 tau=0.6086 loss=0.479960 mse_soft=0.478504 ent_in=2.4228 ent_out=2.4334 rowmax_in=0.2463 rowmax_out=0.2540 discrete_mse=237.321320 best_discrete=73.964119 hash=False elapsed=9.2s
step   125/700 tau=0.5368 loss=0.396287 mse_soft=0.395211 ent_in=1.8792 ent_out=1.7090 rowmax_in=0.3661 rowmax_out=0.4478 discrete_mse=273.294128 best_discrete=73.964119 hash=False elapsed=11.2s
step   150/700 tau=0.4736 loss=0.344729 mse_soft=0.343922 ent_in=1.5408 ent_out=1.1481 rowmax_in=0.4380 rowmax_out=0.5948 discrete_mse=569.293091 best_discrete=73.964119 hash=False elapsed=13.3s
step   175/700 tau=0.4177 loss=0.317800 mse_soft=0.317136 ent_in=1.3827 ent_out=0.8329 rowmax_in=0.4739 rowmax_out=0.6686 discrete_mse=604.892395 best_discrete=73.964119 hash=False elapsed=15.4s
step   200/700 tau=0.3685 loss=0.304900 mse_soft=0.304316 ent_in=1.2825 ent_out=0.6627 rowmax_in=0.4890 rowmax_out=0.7273 discrete_mse=903.763977 best_discrete=73.964119 hash=False elapsed=17.4s
step   225/700 tau=0.3251 loss=0.296593 mse_soft=0.296065 ent_in=1.2143 ent_out=0.5472 rowmax_in=0.5040 rowmax_out=0.7719 discrete_mse=270.701630 best_discrete=73.964119 hash=False elapsed=19.5s
step   250/700 tau=0.2868 loss=0.292301 mse_soft=0.291803 ent_in=1.1691 ent_out=0.4889 rowmax_in=0.5172 rowmax_out=0.7931 discrete_mse=349.104004 best_discrete=73.964119 hash=False elapsed=21.5s
step   275/700 tau=0.2530 loss=0.290296 mse_soft=0.289815 ent_in=1.1532 ent_out=0.4513 rowmax_in=0.5188 rowmax_out=0.8017 discrete_mse=201.043396 best_discrete=73.964119 hash=False elapsed=23.6s
step   300/700 tau=0.2231 loss=0.288641 mse_soft=0.288169 ent_in=1.1392 ent_out=0.4355 rowmax_in=0.5221 rowmax_out=0.8048 discrete_mse=201.043396 best_discrete=73.964119 hash=False elapsed=25.7s
step   325/700 tau=0.1968 loss=0.289336 mse_soft=0.288868 ent_in=1.1340 ent_out=0.4244 rowmax_in=0.5205 rowmax_out=0.8078 discrete_mse=201.043396 best_discrete=73.964119 hash=False elapsed=27.9s
step   350/700 tau=0.1736 loss=0.288281 mse_soft=0.287818 ent_in=1.1320 ent_out=0.4132 rowmax_in=0.5206 rowmax_out=0.8109 discrete_mse=285.477386 best_discrete=73.964119 hash=False elapsed=30.1s
step   375/700 tau=0.1532 loss=0.286622 mse_soft=0.286163 ent_in=1.1239 ent_out=0.4031 rowmax_in=0.5185 rowmax_out=0.8118 discrete_mse=245.953598 best_discrete=73.964119 hash=False elapsed=32.3s
step   400/700 tau=0.1351 loss=0.285377 mse_soft=0.284925 ent_in=1.1212 ent_out=0.3863 rowmax_in=0.5170 rowmax_out=0.8163 discrete_mse=285.477386 best_discrete=73.964119 hash=False elapsed=34.7s
step   425/700 tau=0.1192 loss=0.288415 mse_soft=0.287967 ent_in=1.1179 ent_out=0.3742 rowmax_in=0.5147 rowmax_out=0.8195 discrete_mse=78.082062 best_discrete=73.964119 hash=False elapsed=36.9s
step   450/700 tau=0.1051 loss=0.290133 mse_soft=0.289693 ent_in=1.1051 ent_out=0.3608 rowmax_in=0.5190 rowmax_out=0.8229 discrete_mse=245.953598 best_discrete=73.964119 hash=False elapsed=39.0s
step   475/700 tau=0.0928 loss=0.286337 mse_soft=0.285905 ent_in=1.0958 ent_out=0.3455 rowmax_in=0.5176 rowmax_out=0.8300 discrete_mse=45.292347 best_discrete=45.292347 hash=False elapsed=41.0s
step   500/700 tau=0.0818 loss=0.288011 mse_soft=0.287584 ent_in=1.0872 ent_out=0.3355 rowmax_in=0.5195 rowmax_out=0.8335 discrete_mse=160.336517 best_discrete=45.292347 hash=False elapsed=43.1s
step   525/700 tau=0.0722 loss=0.290692 mse_soft=0.290268 ent_in=1.0854 ent_out=0.3274 rowmax_in=0.5116 rowmax_out=0.8345 discrete_mse=204.676819 best_discrete=45.292347 hash=False elapsed=45.2s
step   550/700 tau=0.0637 loss=0.290258 mse_soft=0.289854 ent_in=1.0384 ent_out=0.3105 rowmax_in=0.5344 rowmax_out=0.8443 discrete_mse=119.428375 best_discrete=45.292347 hash=False elapsed=47.3s
step   575/700 tau=0.0562 loss=0.286265 mse_soft=0.285864 ent_in=1.0317 ent_out=0.3067 rowmax_in=0.5332 rowmax_out=0.8429 discrete_mse=283.803955 best_discrete=45.292347 hash=False elapsed=49.5s
step   600/700 tau=0.0495 loss=0.297135 mse_soft=0.296751 ent_in=0.9746 ent_out=0.3054 rowmax_in=0.5622 rowmax_out=0.8392 discrete_mse=228.421448 best_discrete=45.292347 hash=False elapsed=51.6s
step   625/700 tau=0.0437 loss=0.380301 mse_soft=0.380012 ent_in=0.6837 ent_out=0.2810 rowmax_in=0.6836 rowmax_out=0.8525 discrete_mse=11.817577 best_discrete=11.817577 hash=False elapsed=53.7s
step   650/700 tau=0.0386 loss=0.349115 mse_soft=0.348854 ent_in=0.6498 ent_out=0.2201 rowmax_in=0.6919 rowmax_out=0.8904 discrete_mse=149.210693 best_discrete=11.817577 hash=False elapsed=55.7s
step   675/700 tau=0.0340 loss=0.336746 mse_soft=0.336471 ent_in=0.6568 ent_out=0.2577 rowmax_in=0.6811 rowmax_out=0.8679 discrete_mse=19.305061 best_discrete=11.817577 hash=False elapsed=57.9s
step   700/700 tau=0.0300 loss=0.346474 mse_soft=0.346209 ent_in=0.6327 ent_out=0.2517 rowmax_in=0.6830 rowmax_out=0.8707 discrete_mse=6.831883 best_discrete=6.831883 hash=False elapsed=60.1s

Final metrics:
  soft_mse_full=0.345944
  rowmax_in_mean=0.6816
  rowmax_out_mean=0.8753
  ent_in_mean=0.6347
  ent_out_mean=0.2511
  final_discrete_mse=4.826708
  hash_match=False
  best_discrete_mse_seen=6.831883
Saved results to overnight_b017_j3.json
