Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.054609 mse_soft=1.052287 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=4.942202 best_discrete=4.942202 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.847109 mse_soft=0.844918 ent_in=3.6333 ent_out=3.6694 rowmax_in=0.0448 rowmax_out=0.0441 discrete_mse=4272.417480 best_discrete=4.942202 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.638837 mse_soft=0.636921 ent_in=3.1435 ent_out=3.2429 rowmax_in=0.0923 rowmax_out=0.0867 discrete_mse=2129.107666 best_discrete=4.942202 hash=False elapsed=5.0s
step    75/900 tau=0.7450 loss=0.506773 mse_soft=0.505171 ent_in=2.6262 ent_out=2.7151 rowmax_in=0.2034 rowmax_out=0.2009 discrete_mse=742.990906 best_discrete=4.942202 hash=False elapsed=7.2s
step   100/900 tau=0.6745 loss=0.403441 mse_soft=0.402245 ent_in=2.0412 ent_out=1.9450 rowmax_in=0.3626 rowmax_out=0.3880 discrete_mse=736.717773 best_discrete=4.942202 hash=False elapsed=9.4s
step   125/900 tau=0.6107 loss=0.338994 mse_soft=0.338139 ent_in=1.5952 ent_out=1.2568 rowmax_in=0.4564 rowmax_out=0.5910 discrete_mse=936.466675 best_discrete=4.942202 hash=False elapsed=11.5s
step   150/900 tau=0.5529 loss=0.309710 mse_soft=0.309024 ent_in=1.4257 ent_out=0.8617 rowmax_in=0.4786 rowmax_out=0.6830 discrete_mse=428.649139 best_discrete=4.942202 hash=False elapsed=13.8s
step   175/900 tau=0.5006 loss=0.292752 mse_soft=0.292149 ent_in=1.3469 ent_out=0.6656 rowmax_in=0.4840 rowmax_out=0.7305 discrete_mse=523.432861 best_discrete=4.942202 hash=False elapsed=16.1s
step   200/900 tau=0.4532 loss=0.282046 mse_soft=0.281486 ent_in=1.2889 ent_out=0.5754 rowmax_in=0.4860 rowmax_out=0.7557 discrete_mse=449.631683 best_discrete=4.942202 hash=False elapsed=18.5s
step   225/900 tau=0.4103 loss=0.277847 mse_soft=0.277316 ent_in=1.2461 ent_out=0.5224 rowmax_in=0.5012 rowmax_out=0.7623 discrete_mse=1055.694946 best_discrete=4.942202 hash=False elapsed=20.6s
step   250/900 tau=0.3715 loss=0.271863 mse_soft=0.271348 ent_in=1.2265 ent_out=0.4915 rowmax_in=0.5073 rowmax_out=0.7700 discrete_mse=748.672729 best_discrete=4.942202 hash=False elapsed=22.9s
step   275/900 tau=0.3363 loss=0.271669 mse_soft=0.271162 ent_in=1.2073 ent_out=0.4807 rowmax_in=0.5123 rowmax_out=0.7701 discrete_mse=654.697144 best_discrete=4.942202 hash=False elapsed=25.2s
step   300/900 tau=0.3045 loss=0.269323 mse_soft=0.268824 ent_in=1.1976 ent_out=0.4684 rowmax_in=0.5135 rowmax_out=0.7725 discrete_mse=656.116394 best_discrete=4.942202 hash=False elapsed=27.3s
step   325/900 tau=0.2756 loss=0.269692 mse_soft=0.269196 ent_in=1.1872 ent_out=0.4637 rowmax_in=0.5145 rowmax_out=0.7714 discrete_mse=656.116394 best_discrete=4.942202 hash=False elapsed=29.6s
step   350/900 tau=0.2496 loss=0.275162 mse_soft=0.274670 ent_in=1.1848 ent_out=0.4550 rowmax_in=0.5106 rowmax_out=0.7728 discrete_mse=656.116394 best_discrete=4.942202 hash=False elapsed=31.8s
step   375/900 tau=0.2259 loss=0.268799 mse_soft=0.268314 ent_in=1.1688 ent_out=0.4504 rowmax_in=0.5166 rowmax_out=0.7733 discrete_mse=1054.754150 best_discrete=4.942202 hash=False elapsed=34.0s
step   400/900 tau=0.2046 loss=0.268756 mse_soft=0.268272 ent_in=1.1675 ent_out=0.4455 rowmax_in=0.5146 rowmax_out=0.7738 discrete_mse=446.286041 best_discrete=4.942202 hash=False elapsed=36.2s
step   425/900 tau=0.1852 loss=0.281195 mse_soft=0.280716 ent_in=1.1599 ent_out=0.4386 rowmax_in=0.5157 rowmax_out=0.7763 discrete_mse=1068.841431 best_discrete=4.942202 hash=False elapsed=38.2s
step   450/900 tau=0.1677 loss=0.280635 mse_soft=0.280161 ent_in=1.1492 ent_out=0.4297 rowmax_in=0.5157 rowmax_out=0.7823 discrete_mse=1142.644287 best_discrete=4.942202 hash=False elapsed=40.6s
step   475/900 tau=0.1518 loss=0.270817 mse_soft=0.270346 ent_in=1.1465 ent_out=0.4252 rowmax_in=0.5134 rowmax_out=0.7874 discrete_mse=1801.839111 best_discrete=4.942202 hash=False elapsed=43.0s
step   500/900 tau=0.1374 loss=0.265967 mse_soft=0.265501 ent_in=1.1412 ent_out=0.4132 rowmax_in=0.5089 rowmax_out=0.7955 discrete_mse=1532.131348 best_discrete=4.942202 hash=False elapsed=45.1s
step   525/900 tau=0.1244 loss=0.275096 mse_soft=0.274634 ent_in=1.1279 ent_out=0.4125 rowmax_in=0.5120 rowmax_out=0.7938 discrete_mse=1075.667969 best_discrete=4.942202 hash=False elapsed=47.3s
step   550/900 tau=0.1126 loss=0.270956 mse_soft=0.270499 ent_in=1.1211 ent_out=0.4004 rowmax_in=0.5123 rowmax_out=0.8021 discrete_mse=2077.626709 best_discrete=4.942202 hash=False elapsed=49.5s
step   575/900 tau=0.1020 loss=0.285430 mse_soft=0.284989 ent_in=1.0632 ent_out=0.4051 rowmax_in=0.5380 rowmax_out=0.7956 discrete_mse=303.879852 best_discrete=4.942202 hash=False elapsed=51.9s
step   600/900 tau=0.0923 loss=0.280886 mse_soft=0.280448 ent_in=1.0720 ent_out=0.3878 rowmax_in=0.5219 rowmax_out=0.8103 discrete_mse=1324.960327 best_discrete=4.942202 hash=False elapsed=54.0s
step   625/900 tau=0.0836 loss=0.274118 mse_soft=0.273683 ent_in=1.0719 ent_out=0.3775 rowmax_in=0.5234 rowmax_out=0.8145 discrete_mse=1092.218628 best_discrete=4.942202 hash=False elapsed=56.2s
step   650/900 tau=0.0757 loss=0.310465 mse_soft=0.310083 ent_in=0.9042 ent_out=0.3700 rowmax_in=0.5929 rowmax_out=0.8069 discrete_mse=500.262878 best_discrete=4.942202 hash=False elapsed=58.3s
step   675/900 tau=0.0685 loss=0.297108 mse_soft=0.296726 ent_in=0.9058 ent_out=0.3667 rowmax_in=0.5850 rowmax_out=0.8017 discrete_mse=391.906830 best_discrete=4.942202 hash=False elapsed=60.4s
step   700/900 tau=0.0620 loss=0.292385 mse_soft=0.292016 ent_in=0.8736 ent_out=0.3538 rowmax_in=0.5906 rowmax_out=0.8144 discrete_mse=107.520157 best_discrete=4.942202 hash=False elapsed=62.5s
step   725/900 tau=0.0562 loss=0.281565 mse_soft=0.281198 ent_in=0.8734 ent_out=0.3517 rowmax_in=0.5889 rowmax_out=0.8118 discrete_mse=88.381714 best_discrete=4.942202 hash=False elapsed=64.7s
step   750/900 tau=0.0508 loss=0.350012 mse_soft=0.349701 ent_in=0.6980 ent_out=0.3380 rowmax_in=0.6738 rowmax_out=0.8138 discrete_mse=39.647293 best_discrete=4.942202 hash=False elapsed=66.8s
step   775/900 tau=0.0460 loss=0.310208 mse_soft=0.309903 ent_in=0.6705 ent_out=0.3446 rowmax_in=0.6643 rowmax_out=0.8121 discrete_mse=75.937675 best_discrete=4.942202 hash=False elapsed=68.9s
step   800/900 tau=0.0417 loss=0.299709 mse_soft=0.299410 ent_in=0.6642 ent_out=0.3341 rowmax_in=0.6628 rowmax_out=0.8214 discrete_mse=245.779221 best_discrete=4.942202 hash=False elapsed=71.0s
step   825/900 tau=0.0377 loss=0.298224 mse_soft=0.297920 ent_in=0.6737 ent_out=0.3399 rowmax_in=0.6580 rowmax_out=0.8179 discrete_mse=64.202461 best_discrete=4.942202 hash=False elapsed=73.0s
step   850/900 tau=0.0342 loss=0.306688 mse_soft=0.306388 ent_in=0.6658 ent_out=0.3371 rowmax_in=0.6597 rowmax_out=0.8162 discrete_mse=43.747643 best_discrete=4.942202 hash=False elapsed=75.2s
step   875/900 tau=0.0309 loss=0.300554 mse_soft=0.300255 ent_in=0.6656 ent_out=0.3300 rowmax_in=0.6544 rowmax_out=0.8222 discrete_mse=65.108398 best_discrete=4.942202 hash=False elapsed=77.4s
step   900/900 tau=0.0280 loss=0.602050 mse_soft=0.601918 ent_in=0.3112 ent_out=0.1284 rowmax_in=0.8458 rowmax_out=0.9307 discrete_mse=247.531067 best_discrete=4.942202 hash=False elapsed=79.6s

Final metrics:
  soft_mse_full=0.609086
  rowmax_in_mean=0.8462
  rowmax_out_mean=0.9310
  ent_in_mean=0.3089
  ent_out_mean=0.1277
  final_discrete_mse=187.254089
  hash_match=False
  best_discrete_mse_seen=4.942202
Saved results to overnight_b239_j2.json
