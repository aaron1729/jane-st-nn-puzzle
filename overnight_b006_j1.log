Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.059485 mse_soft=1.057162 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=7.965583 best_discrete=7.965583 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.859240 mse_soft=0.857050 ent_in=3.6325 ent_out=3.6664 rowmax_in=0.0455 rowmax_out=0.0446 discrete_mse=396.454437 best_discrete=7.965583 hash=False elapsed=3.0s
step    50/900 tau=0.8260 loss=0.651088 mse_soft=0.649179 ent_in=3.1384 ent_out=3.2264 rowmax_in=0.0899 rowmax_out=0.0863 discrete_mse=4739.045410 best_discrete=7.965583 hash=False elapsed=5.3s
step    75/900 tau=0.7493 loss=0.512299 mse_soft=0.510710 ent_in=2.6237 ent_out=2.6723 rowmax_in=0.1941 rowmax_out=0.2078 discrete_mse=1197.885620 best_discrete=7.965583 hash=False elapsed=7.6s
step   100/900 tau=0.6797 loss=0.403466 mse_soft=0.402293 ent_in=2.0769 ent_out=1.8350 rowmax_in=0.3173 rowmax_out=0.4086 discrete_mse=1664.982788 best_discrete=7.965583 hash=False elapsed=10.0s
step   125/900 tau=0.6165 loss=0.341101 mse_soft=0.340237 ent_in=1.6686 ent_out=1.2118 rowmax_in=0.4037 rowmax_out=0.6017 discrete_mse=124.156075 best_discrete=7.965583 hash=False elapsed=12.3s
step   150/900 tau=0.5592 loss=0.316012 mse_soft=0.315299 ent_in=1.4813 ent_out=0.8958 rowmax_in=0.4321 rowmax_out=0.6892 discrete_mse=341.357452 best_discrete=7.965583 hash=False elapsed=14.7s
step   175/900 tau=0.5073 loss=0.306455 mse_soft=0.305827 ent_in=1.3787 ent_out=0.7141 rowmax_in=0.4503 rowmax_out=0.7341 discrete_mse=253.695450 best_discrete=7.965583 hash=False elapsed=17.3s
step   200/900 tau=0.4602 loss=0.301301 mse_soft=0.300729 ent_in=1.3114 ent_out=0.5954 rowmax_in=0.4597 rowmax_out=0.7697 discrete_mse=965.502380 best_discrete=7.965583 hash=False elapsed=19.7s
step   225/900 tau=0.4174 loss=0.296431 mse_soft=0.295880 ent_in=1.2748 ent_out=0.5615 rowmax_in=0.4639 rowmax_out=0.7688 discrete_mse=2407.040771 best_discrete=7.965583 hash=False elapsed=22.0s
step   250/900 tau=0.3786 loss=0.293493 mse_soft=0.292960 ent_in=1.2420 ent_out=0.5367 rowmax_in=0.4666 rowmax_out=0.7703 discrete_mse=2017.154541 best_discrete=7.965583 hash=False elapsed=24.5s
step   275/900 tau=0.3434 loss=0.291498 mse_soft=0.290978 ent_in=1.2187 ent_out=0.5135 rowmax_in=0.4695 rowmax_out=0.7732 discrete_mse=1292.710815 best_discrete=7.965583 hash=False elapsed=27.0s
step   300/900 tau=0.3115 loss=0.290514 mse_soft=0.290008 ent_in=1.2015 ent_out=0.4853 rowmax_in=0.4707 rowmax_out=0.7752 discrete_mse=1616.980469 best_discrete=7.965583 hash=False elapsed=29.4s
step   325/900 tau=0.2826 loss=0.286949 mse_soft=0.286458 ent_in=1.1841 ent_out=0.4541 rowmax_in=0.4762 rowmax_out=0.7835 discrete_mse=512.068970 best_discrete=7.965583 hash=False elapsed=31.7s
step   350/900 tau=0.2563 loss=0.284564 mse_soft=0.284087 ent_in=1.1698 ent_out=0.4208 rowmax_in=0.4805 rowmax_out=0.8002 discrete_mse=455.546082 best_discrete=7.965583 hash=False elapsed=34.3s
step   375/900 tau=0.2325 loss=0.285019 mse_soft=0.284552 ent_in=1.1601 ent_out=0.3986 rowmax_in=0.4854 rowmax_out=0.8074 discrete_mse=426.756226 best_discrete=7.965583 hash=False elapsed=36.5s
step   400/900 tau=0.2109 loss=0.282224 mse_soft=0.281761 ent_in=1.1511 ent_out=0.3940 rowmax_in=0.4864 rowmax_out=0.8073 discrete_mse=413.774841 best_discrete=7.965583 hash=False elapsed=39.1s
step   425/900 tau=0.1913 loss=0.281696 mse_soft=0.281237 ent_in=1.1445 ent_out=0.3856 rowmax_in=0.4879 rowmax_out=0.8078 discrete_mse=514.943481 best_discrete=7.965583 hash=False elapsed=41.4s
step   450/900 tau=0.1735 loss=0.283627 mse_soft=0.283172 ent_in=1.1391 ent_out=0.3774 rowmax_in=0.4894 rowmax_out=0.8145 discrete_mse=919.189392 best_discrete=7.965583 hash=False elapsed=43.8s
step   475/900 tau=0.1574 loss=0.284231 mse_soft=0.283779 ent_in=1.1350 ent_out=0.3711 rowmax_in=0.4886 rowmax_out=0.8186 discrete_mse=481.710938 best_discrete=7.965583 hash=False elapsed=46.3s
step   500/900 tau=0.1428 loss=0.284985 mse_soft=0.284536 ent_in=1.1235 ent_out=0.3740 rowmax_in=0.4901 rowmax_out=0.8184 discrete_mse=360.192535 best_discrete=7.965583 hash=False elapsed=48.5s
step   525/900 tau=0.1295 loss=0.280936 mse_soft=0.280491 ent_in=1.1173 ent_out=0.3639 rowmax_in=0.4886 rowmax_out=0.8187 discrete_mse=360.192535 best_discrete=7.965583 hash=False elapsed=50.8s
step   550/900 tau=0.1175 loss=0.285647 mse_soft=0.285205 ent_in=1.1139 ent_out=0.3608 rowmax_in=0.4900 rowmax_out=0.8176 discrete_mse=330.368378 best_discrete=7.965583 hash=False elapsed=53.2s
step   575/900 tau=0.1066 loss=0.296329 mse_soft=0.295889 ent_in=1.1074 ent_out=0.3581 rowmax_in=0.4938 rowmax_out=0.8145 discrete_mse=875.087952 best_discrete=7.965583 hash=False elapsed=55.6s
step   600/900 tau=0.0967 loss=0.295315 mse_soft=0.294883 ent_in=1.0969 ent_out=0.3428 rowmax_in=0.4933 rowmax_out=0.8253 discrete_mse=326.958862 best_discrete=7.965583 hash=False elapsed=57.9s
step   625/900 tau=0.0877 loss=0.301948 mse_soft=0.301531 ent_in=1.0466 ent_out=0.3424 rowmax_in=0.5217 rowmax_out=0.8185 discrete_mse=269.041504 best_discrete=7.965583 hash=False elapsed=60.2s
step   650/900 tau=0.0795 loss=0.302336 mse_soft=0.301926 ent_in=1.0399 ent_out=0.3278 rowmax_in=0.5141 rowmax_out=0.8323 discrete_mse=500.960999 best_discrete=7.965583 hash=False elapsed=62.5s
step   675/900 tau=0.0722 loss=0.287648 mse_soft=0.287235 ent_in=1.0532 ent_out=0.3258 rowmax_in=0.5072 rowmax_out=0.8305 discrete_mse=1026.817383 best_discrete=7.965583 hash=False elapsed=65.1s
step   700/900 tau=0.0655 loss=0.288639 mse_soft=0.288228 ent_in=1.0481 ent_out=0.3228 rowmax_in=0.5104 rowmax_out=0.8372 discrete_mse=245.148224 best_discrete=7.965583 hash=False elapsed=67.4s
step   725/900 tau=0.0594 loss=0.352683 mse_soft=0.352345 ent_in=0.8029 ent_out=0.3217 rowmax_in=0.6189 rowmax_out=0.8325 discrete_mse=366.156525 best_discrete=7.965583 hash=False elapsed=69.8s
step   750/900 tau=0.0539 loss=0.361005 mse_soft=0.360727 ent_in=0.6554 ent_out=0.2711 rowmax_in=0.6900 rowmax_out=0.8577 discrete_mse=161.824127 best_discrete=7.965583 hash=False elapsed=72.3s
step   775/900 tau=0.0489 loss=0.345397 mse_soft=0.345110 ent_in=0.6852 ent_out=0.2709 rowmax_in=0.6490 rowmax_out=0.8427 discrete_mse=28.931892 best_discrete=7.965583 hash=False elapsed=74.6s
step   800/900 tau=0.0443 loss=0.334593 mse_soft=0.334311 ent_in=0.6752 ent_out=0.2619 rowmax_in=0.6438 rowmax_out=0.8550 discrete_mse=65.704094 best_discrete=7.965583 hash=False elapsed=76.8s
step   825/900 tau=0.0402 loss=0.387972 mse_soft=0.387740 ent_in=0.5314 ent_out=0.2414 rowmax_in=0.7088 rowmax_out=0.8614 discrete_mse=487.788544 best_discrete=7.965583 hash=False elapsed=79.1s
step   850/900 tau=0.0365 loss=0.368459 mse_soft=0.368228 ent_in=0.5394 ent_out=0.2294 rowmax_in=0.7105 rowmax_out=0.8667 discrete_mse=289.112091 best_discrete=7.965583 hash=False elapsed=81.4s
step   875/900 tau=0.0331 loss=0.356312 mse_soft=0.356079 ent_in=0.5497 ent_out=0.2273 rowmax_in=0.6979 rowmax_out=0.8627 discrete_mse=52.076145 best_discrete=7.965583 hash=False elapsed=83.7s
step   900/900 tau=0.0300 loss=0.440691 mse_soft=0.440509 ent_in=0.4089 ent_out=0.1971 rowmax_in=0.7777 rowmax_out=0.8823 discrete_mse=44.622360 best_discrete=7.965583 hash=False elapsed=86.0s

Final metrics:
  soft_mse_full=0.470258
  rowmax_in_mean=0.7802
  rowmax_out_mean=0.8777
  ent_in_mean=0.4048
  ent_out_mean=0.1978
  final_discrete_mse=31.120787
  hash_match=False
  best_discrete_mse_seen=7.965583
Saved results to overnight_b006_j1.json
