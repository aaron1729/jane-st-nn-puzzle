Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.091290 mse_soft=1.088967 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=8.162469 best_discrete=8.162469 hash=False elapsed=0.6s
step    25/900 tau=0.9106 loss=0.877839 mse_soft=0.875647 ent_in=3.6356 ent_out=3.6687 rowmax_in=0.0448 rowmax_out=0.0441 discrete_mse=203.458069 best_discrete=8.162469 hash=False elapsed=3.0s
step    50/900 tau=0.8260 loss=0.650601 mse_soft=0.648685 ent_in=3.1474 ent_out=3.2363 rowmax_in=0.0912 rowmax_out=0.0883 discrete_mse=6357.840820 best_discrete=8.162469 hash=False elapsed=5.6s
step    75/900 tau=0.7493 loss=0.499920 mse_soft=0.498330 ent_in=2.5984 ent_out=2.6992 rowmax_in=0.2109 rowmax_out=0.1998 discrete_mse=305.025452 best_discrete=8.162469 hash=False elapsed=8.0s
step   100/900 tau=0.6797 loss=0.406616 mse_soft=0.405398 ent_in=2.0155 ent_out=2.0449 rowmax_in=0.3426 rowmax_out=0.3458 discrete_mse=522.347961 best_discrete=8.162469 hash=False elapsed=10.7s
step   125/900 tau=0.6165 loss=0.353391 mse_soft=0.352480 ent_in=1.6308 ent_out=1.4045 rowmax_in=0.4342 rowmax_out=0.5192 discrete_mse=395.587006 best_discrete=8.162469 hash=False elapsed=13.0s
step   150/900 tau=0.5592 loss=0.326054 mse_soft=0.325335 ent_in=1.4492 ent_out=0.9472 rowmax_in=0.4751 rowmax_out=0.6596 discrete_mse=888.086792 best_discrete=8.162469 hash=False elapsed=15.6s
step   175/900 tau=0.5073 loss=0.313858 mse_soft=0.313231 ent_in=1.3709 ent_out=0.7196 rowmax_in=0.4804 rowmax_out=0.7271 discrete_mse=528.848511 best_discrete=8.162469 hash=False elapsed=18.0s
step   200/900 tau=0.4602 loss=0.303657 mse_soft=0.303089 ent_in=1.3077 ent_out=0.5860 rowmax_in=0.4830 rowmax_out=0.7718 discrete_mse=713.270325 best_discrete=8.162469 hash=False elapsed=20.6s
step   225/900 tau=0.4174 loss=0.297987 mse_soft=0.297453 ent_in=1.2481 ent_out=0.5311 rowmax_in=0.4894 rowmax_out=0.7822 discrete_mse=1816.732544 best_discrete=8.162469 hash=False elapsed=23.1s
step   250/900 tau=0.3786 loss=0.293534 mse_soft=0.293024 ent_in=1.2044 ent_out=0.4961 rowmax_in=0.5018 rowmax_out=0.7959 discrete_mse=1942.688721 best_discrete=8.162469 hash=False elapsed=25.7s
step   275/900 tau=0.3434 loss=0.291169 mse_soft=0.290677 ent_in=1.1696 ent_out=0.4717 rowmax_in=0.5093 rowmax_out=0.8007 discrete_mse=339.248444 best_discrete=8.162469 hash=False elapsed=28.2s
step   300/900 tau=0.3115 loss=0.290145 mse_soft=0.289660 ent_in=1.1530 ent_out=0.4631 rowmax_in=0.5108 rowmax_out=0.8022 discrete_mse=1678.803345 best_discrete=8.162469 hash=False elapsed=30.3s
step   325/900 tau=0.2826 loss=0.293175 mse_soft=0.292694 ent_in=1.1447 ent_out=0.4586 rowmax_in=0.5112 rowmax_out=0.7983 discrete_mse=972.360352 best_discrete=8.162469 hash=False elapsed=32.7s
step   350/900 tau=0.2563 loss=0.288209 mse_soft=0.287735 ent_in=1.1328 ent_out=0.4472 rowmax_in=0.5161 rowmax_out=0.8044 discrete_mse=552.566101 best_discrete=8.162469 hash=False elapsed=35.0s
step   375/900 tau=0.2325 loss=0.287692 mse_soft=0.287222 ent_in=1.1234 ent_out=0.4426 rowmax_in=0.5159 rowmax_out=0.8037 discrete_mse=2684.039551 best_discrete=8.162469 hash=False elapsed=37.2s
step   400/900 tau=0.2109 loss=0.286068 mse_soft=0.285603 ent_in=1.1176 ent_out=0.4342 rowmax_in=0.5168 rowmax_out=0.8060 discrete_mse=997.483398 best_discrete=8.162469 hash=False elapsed=39.5s
step   425/900 tau=0.1913 loss=0.287507 mse_soft=0.287043 ent_in=1.1194 ent_out=0.4286 rowmax_in=0.5176 rowmax_out=0.8058 discrete_mse=1236.761719 best_discrete=8.162469 hash=False elapsed=41.7s
step   450/900 tau=0.1735 loss=0.283704 mse_soft=0.283241 ent_in=1.1177 ent_out=0.4236 rowmax_in=0.5163 rowmax_out=0.8030 discrete_mse=1154.597412 best_discrete=8.162469 hash=False elapsed=44.1s
step   475/900 tau=0.1574 loss=0.288708 mse_soft=0.288250 ent_in=1.1056 ent_out=0.4193 rowmax_in=0.5199 rowmax_out=0.8035 discrete_mse=1154.597412 best_discrete=8.162469 hash=False elapsed=46.4s
step   500/900 tau=0.1428 loss=0.288270 mse_soft=0.287815 ent_in=1.0993 ent_out=0.4169 rowmax_in=0.5217 rowmax_out=0.8051 discrete_mse=571.075195 best_discrete=8.162469 hash=False elapsed=48.8s
step   525/900 tau=0.1295 loss=0.284099 mse_soft=0.283648 ent_in=1.0897 ent_out=0.4113 rowmax_in=0.5254 rowmax_out=0.8087 discrete_mse=1808.313110 best_discrete=8.162469 hash=False elapsed=51.2s
step   550/900 tau=0.1175 loss=0.289821 mse_soft=0.289376 ent_in=1.0777 ent_out=0.4047 rowmax_in=0.5275 rowmax_out=0.8114 discrete_mse=1808.313110 best_discrete=8.162469 hash=False elapsed=53.6s
step   575/900 tau=0.1066 loss=0.289593 mse_soft=0.289152 ent_in=1.0729 ent_out=0.3967 rowmax_in=0.5289 rowmax_out=0.8128 discrete_mse=1482.910522 best_discrete=8.162469 hash=False elapsed=55.9s
step   600/900 tau=0.0967 loss=0.290799 mse_soft=0.290361 ent_in=1.0698 ent_out=0.3899 rowmax_in=0.5259 rowmax_out=0.8154 discrete_mse=1257.160522 best_discrete=8.162469 hash=False elapsed=58.2s
step   625/900 tau=0.0877 loss=0.286250 mse_soft=0.285816 ent_in=1.0618 ent_out=0.3829 rowmax_in=0.5309 rowmax_out=0.8189 discrete_mse=607.765015 best_discrete=8.162469 hash=False elapsed=60.7s
step   650/900 tau=0.0795 loss=0.345152 mse_soft=0.344794 ent_in=0.8151 ent_out=0.3781 rowmax_in=0.6536 rowmax_out=0.8051 discrete_mse=122.138824 best_discrete=8.162469 hash=False elapsed=63.0s
step   675/900 tau=0.0722 loss=0.305254 mse_soft=0.304903 ent_in=0.7930 ent_out=0.3761 rowmax_in=0.6252 rowmax_out=0.8064 discrete_mse=176.694061 best_discrete=8.162469 hash=False elapsed=65.4s
step   700/900 tau=0.0655 loss=0.296779 mse_soft=0.296432 ent_in=0.7870 ent_out=0.3705 rowmax_in=0.6314 rowmax_out=0.8070 discrete_mse=56.158073 best_discrete=8.162469 hash=False elapsed=67.7s
step   725/900 tau=0.0594 loss=0.297219 mse_soft=0.296893 ent_in=0.7460 ent_out=0.3386 rowmax_in=0.6469 rowmax_out=0.8195 discrete_mse=210.406143 best_discrete=8.162469 hash=False elapsed=69.9s
step   750/900 tau=0.0539 loss=0.300646 mse_soft=0.300321 ent_in=0.7591 ent_out=0.3244 rowmax_in=0.6328 rowmax_out=0.8219 discrete_mse=313.760132 best_discrete=8.162469 hash=False elapsed=72.2s
step   775/900 tau=0.0489 loss=0.804464 mse_soft=0.804174 ent_in=0.6662 ent_out=0.2997 rowmax_in=0.6870 rowmax_out=0.8454 discrete_mse=269.487793 best_discrete=8.162469 hash=False elapsed=74.2s
step   800/900 tau=0.0443 loss=0.416189 mse_soft=0.416000 ent_in=0.4654 ent_out=0.1632 rowmax_in=0.7354 rowmax_out=0.9141 discrete_mse=2.377501 best_discrete=2.377501 hash=False elapsed=76.6s
step   825/900 tau=0.0402 loss=0.383040 mse_soft=0.382848 ent_in=0.4715 ent_out=0.1682 rowmax_in=0.7315 rowmax_out=0.9040 discrete_mse=31.622974 best_discrete=2.377501 hash=False elapsed=78.6s
step   850/900 tau=0.0365 loss=0.371605 mse_soft=0.371406 ent_in=0.4758 ent_out=0.1871 rowmax_in=0.7252 rowmax_out=0.8921 discrete_mse=44.099621 best_discrete=2.377501 hash=False elapsed=80.6s
step   875/900 tau=0.0331 loss=0.364520 mse_soft=0.364324 ent_in=0.4772 ent_out=0.1781 rowmax_in=0.7178 rowmax_out=0.8776 discrete_mse=65.252846 best_discrete=2.377501 hash=False elapsed=82.7s
step   900/900 tau=0.0300 loss=0.360547 mse_soft=0.360348 ent_in=0.4865 ent_out=0.1786 rowmax_in=0.7171 rowmax_out=0.8765 discrete_mse=128.175217 best_discrete=2.377501 hash=False elapsed=84.7s

Final metrics:
  soft_mse_full=0.375919
  rowmax_in_mean=0.7153
  rowmax_out_mean=0.8764
  ent_in_mean=0.4881
  ent_out_mean=0.1786
  final_discrete_mse=71.746613
  hash_match=False
  best_discrete_mse_seen=2.377501
Saved results to overnight_b148_j1.json
