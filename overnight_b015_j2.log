Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.040076 mse_soft=1.037753 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=29.120981 best_discrete=29.120981 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.837455 mse_soft=0.835265 ent_in=3.6345 ent_out=3.6677 rowmax_in=0.0449 rowmax_out=0.0442 discrete_mse=2275.333496 best_discrete=29.120981 hash=False elapsed=2.2s
step    50/900 tau=0.8229 loss=0.628574 mse_soft=0.626664 ent_in=3.1395 ent_out=3.2257 rowmax_in=0.0915 rowmax_out=0.0882 discrete_mse=5682.675293 best_discrete=29.120981 hash=False elapsed=4.2s
step    75/900 tau=0.7450 loss=0.492356 mse_soft=0.490775 ent_in=2.6034 ent_out=2.6672 rowmax_in=0.1963 rowmax_out=0.1924 discrete_mse=433.575684 best_discrete=29.120981 hash=False elapsed=6.1s
step   100/900 tau=0.6745 loss=0.394307 mse_soft=0.393127 ent_in=2.0128 ent_out=1.9198 rowmax_in=0.3425 rowmax_out=0.3638 discrete_mse=477.128998 best_discrete=29.120981 hash=False elapsed=8.0s
step   125/900 tau=0.6107 loss=0.328016 mse_soft=0.327173 ent_in=1.6424 ent_out=1.1653 rowmax_in=0.4306 rowmax_out=0.6067 discrete_mse=331.528931 best_discrete=29.120981 hash=False elapsed=10.1s
step   150/900 tau=0.5529 loss=0.298582 mse_soft=0.297924 ent_in=1.4563 ent_out=0.7389 rowmax_in=0.4772 rowmax_out=0.7392 discrete_mse=48.700356 best_discrete=29.120981 hash=False elapsed=12.1s
step   175/900 tau=0.5006 loss=0.284831 mse_soft=0.284274 ent_in=1.3444 ent_out=0.5113 rowmax_in=0.4985 rowmax_out=0.8008 discrete_mse=27.750423 best_discrete=27.750423 hash=False elapsed=14.2s
step   200/900 tau=0.4532 loss=0.277695 mse_soft=0.277195 ent_in=1.2703 ent_out=0.3974 rowmax_in=0.5114 rowmax_out=0.8386 discrete_mse=71.436745 best_discrete=27.750423 hash=False elapsed=16.3s
step   225/900 tau=0.4103 loss=0.273146 mse_soft=0.272677 ent_in=1.2059 ent_out=0.3544 rowmax_in=0.5226 rowmax_out=0.8519 discrete_mse=193.729324 best_discrete=27.750423 hash=False elapsed=18.3s
step   250/900 tau=0.3715 loss=0.269171 mse_soft=0.268721 ent_in=1.1750 ent_out=0.3237 rowmax_in=0.5229 rowmax_out=0.8635 discrete_mse=135.478607 best_discrete=27.750423 hash=False elapsed=20.3s
step   275/900 tau=0.3363 loss=0.266586 mse_soft=0.266153 ent_in=1.1451 ent_out=0.2983 rowmax_in=0.5264 rowmax_out=0.8675 discrete_mse=135.478607 best_discrete=27.750423 hash=False elapsed=22.2s
step   300/900 tau=0.3045 loss=0.265033 mse_soft=0.264610 ent_in=1.1305 ent_out=0.2795 rowmax_in=0.5254 rowmax_out=0.8755 discrete_mse=165.945175 best_discrete=27.750423 hash=False elapsed=24.2s
step   325/900 tau=0.2756 loss=0.262203 mse_soft=0.261792 ent_in=1.1271 ent_out=0.2443 rowmax_in=0.5244 rowmax_out=0.8905 discrete_mse=178.291977 best_discrete=27.750423 hash=False elapsed=26.3s
step   350/900 tau=0.2496 loss=0.262903 mse_soft=0.262500 ent_in=1.1205 ent_out=0.2253 rowmax_in=0.5252 rowmax_out=0.8967 discrete_mse=178.291977 best_discrete=27.750423 hash=False elapsed=28.2s
step   375/900 tau=0.2259 loss=0.261308 mse_soft=0.260908 ent_in=1.1172 ent_out=0.2163 rowmax_in=0.5278 rowmax_out=0.9009 discrete_mse=178.291977 best_discrete=27.750423 hash=False elapsed=30.2s
step   400/900 tau=0.2046 loss=0.259214 mse_soft=0.258819 ent_in=1.1104 ent_out=0.2048 rowmax_in=0.5310 rowmax_out=0.9060 discrete_mse=204.221298 best_discrete=27.750423 hash=False elapsed=32.3s
step   425/900 tau=0.1852 loss=0.258074 mse_soft=0.257681 ent_in=1.1124 ent_out=0.1985 rowmax_in=0.5290 rowmax_out=0.9063 discrete_mse=204.221298 best_discrete=27.750423 hash=False elapsed=34.4s
step   450/900 tau=0.1677 loss=0.259973 mse_soft=0.259583 ent_in=1.1071 ent_out=0.1933 rowmax_in=0.5298 rowmax_out=0.9095 discrete_mse=243.343887 best_discrete=27.750423 hash=False elapsed=36.4s
step   475/900 tau=0.1518 loss=0.261399 mse_soft=0.261010 ent_in=1.1036 ent_out=0.1942 rowmax_in=0.5311 rowmax_out=0.9077 discrete_mse=339.309479 best_discrete=27.750423 hash=False elapsed=38.4s
step   500/900 tau=0.1374 loss=0.266902 mse_soft=0.266512 ent_in=1.1074 ent_out=0.1941 rowmax_in=0.5267 rowmax_out=0.9070 discrete_mse=294.002502 best_discrete=27.750423 hash=False elapsed=40.6s
step   525/900 tau=0.1244 loss=0.262512 mse_soft=0.262124 ent_in=1.0984 ent_out=0.1951 rowmax_in=0.5331 rowmax_out=0.9037 discrete_mse=74.871529 best_discrete=27.750423 hash=False elapsed=42.5s
step   550/900 tau=0.1126 loss=0.268060 mse_soft=0.267673 ent_in=1.0978 ent_out=0.1950 rowmax_in=0.5365 rowmax_out=0.9002 discrete_mse=262.790833 best_discrete=27.750423 hash=False elapsed=44.3s
step   575/900 tau=0.1020 loss=0.260132 mse_soft=0.259746 ent_in=1.0980 ent_out=0.1912 rowmax_in=0.5330 rowmax_out=0.8999 discrete_mse=260.471832 best_discrete=27.750423 hash=False elapsed=46.1s
step   600/900 tau=0.0923 loss=0.275019 mse_soft=0.274629 ent_in=1.1088 ent_out=0.1890 rowmax_in=0.5216 rowmax_out=0.8993 discrete_mse=111.338501 best_discrete=27.750423 hash=False elapsed=48.1s
step   625/900 tau=0.0836 loss=0.269346 mse_soft=0.268965 ent_in=1.0756 ent_out=0.1928 rowmax_in=0.5401 rowmax_out=0.8969 discrete_mse=124.988594 best_discrete=27.750423 hash=False elapsed=50.0s
step   650/900 tau=0.0757 loss=0.283715 mse_soft=0.283333 ent_in=1.0900 ent_out=0.1833 rowmax_in=0.5382 rowmax_out=0.9080 discrete_mse=13.968659 best_discrete=13.968659 hash=False elapsed=52.2s
step   675/900 tau=0.0685 loss=0.269178 mse_soft=0.268796 ent_in=1.0937 ent_out=0.1790 rowmax_in=0.5298 rowmax_out=0.9079 discrete_mse=65.170723 best_discrete=13.968659 hash=False elapsed=54.3s
step   700/900 tau=0.0620 loss=0.284174 mse_soft=0.283817 ent_in=1.0040 ent_out=0.1864 rowmax_in=0.5511 rowmax_out=0.9018 discrete_mse=190.112823 best_discrete=13.968659 hash=False elapsed=56.3s
step   725/900 tau=0.0562 loss=0.343543 mse_soft=0.343230 ent_in=0.9188 ent_out=0.1233 rowmax_in=0.5911 rowmax_out=0.9414 discrete_mse=46.442757 best_discrete=13.968659 hash=False elapsed=58.4s
step   750/900 tau=0.0508 loss=0.284635 mse_soft=0.284325 ent_in=0.9129 ent_out=0.1207 rowmax_in=0.5863 rowmax_out=0.9433 discrete_mse=157.734741 best_discrete=13.968659 hash=False elapsed=60.3s
step   775/900 tau=0.0460 loss=0.343341 mse_soft=0.343091 ent_in=0.7222 ent_out=0.1091 rowmax_in=0.6671 rowmax_out=0.9496 discrete_mse=16.711163 best_discrete=13.968659 hash=False elapsed=62.3s
step   800/900 tau=0.0417 loss=0.391972 mse_soft=0.391741 ent_in=0.6745 ent_out=0.0951 rowmax_in=0.6643 rowmax_out=0.9559 discrete_mse=21.581099 best_discrete=13.968659 hash=False elapsed=64.3s
step   825/900 tau=0.0377 loss=0.344830 mse_soft=0.344612 ent_in=0.5840 ent_out=0.1450 rowmax_in=0.7188 rowmax_out=0.9169 discrete_mse=14.152462 best_discrete=13.968659 hash=False elapsed=66.4s
step   850/900 tau=0.0342 loss=0.333592 mse_soft=0.333372 ent_in=0.5743 ent_out=0.1593 rowmax_in=0.7281 rowmax_out=0.9095 discrete_mse=13.603849 best_discrete=13.603849 hash=False elapsed=68.7s
step   875/900 tau=0.0309 loss=0.342623 mse_soft=0.342415 ent_in=0.5483 ent_out=0.1422 rowmax_in=0.7343 rowmax_out=0.9219 discrete_mse=13.329127 best_discrete=13.329127 hash=False elapsed=70.6s
step   900/900 tau=0.0280 loss=0.334616 mse_soft=0.334405 ent_in=0.5652 ent_out=0.1384 rowmax_in=0.7249 rowmax_out=0.9139 discrete_mse=24.689196 best_discrete=13.329127 hash=False elapsed=72.5s

Final metrics:
  soft_mse_full=0.359540
  rowmax_in_mean=0.7320
  rowmax_out_mean=0.9241
  ent_in_mean=0.5589
  ent_out_mean=0.1334
  final_discrete_mse=22.137430
  hash_match=False
  best_discrete_mse_seen=13.329127
Saved results to overnight_b015_j2.json
