Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.058901 mse_soft=1.056578 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=38.887894 best_discrete=38.887894 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.855058 mse_soft=0.852868 ent_in=3.6308 ent_out=3.6680 rowmax_in=0.0459 rowmax_out=0.0441 discrete_mse=1232.519409 best_discrete=38.887894 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.639968 mse_soft=0.638063 ent_in=3.1255 ent_out=3.2255 rowmax_in=0.0953 rowmax_out=0.0888 discrete_mse=5637.383301 best_discrete=38.887894 hash=False elapsed=4.8s
step    75/900 tau=0.7450 loss=0.498262 mse_soft=0.496690 ent_in=2.5684 ent_out=2.6721 rowmax_in=0.2045 rowmax_out=0.2019 discrete_mse=4037.325195 best_discrete=38.887894 hash=False elapsed=6.9s
step   100/900 tau=0.6745 loss=0.391010 mse_soft=0.389865 ent_in=1.9409 ent_out=1.8760 rowmax_in=0.3564 rowmax_out=0.4003 discrete_mse=3434.422363 best_discrete=38.887894 hash=False elapsed=9.1s
step   125/900 tau=0.6107 loss=0.339963 mse_soft=0.339113 ent_in=1.6197 ent_out=1.2134 rowmax_in=0.4262 rowmax_out=0.5804 discrete_mse=262.202606 best_discrete=38.887894 hash=False elapsed=11.4s
step   150/900 tau=0.5529 loss=0.314112 mse_soft=0.313447 ent_in=1.4307 ent_out=0.7844 rowmax_in=0.4644 rowmax_out=0.7178 discrete_mse=593.229065 best_discrete=38.887894 hash=False elapsed=13.6s
step   175/900 tau=0.5006 loss=0.297778 mse_soft=0.297211 ent_in=1.3134 ent_out=0.5787 rowmax_in=0.4956 rowmax_out=0.7855 discrete_mse=104.880150 best_discrete=38.887894 hash=False elapsed=15.8s
step   200/900 tau=0.4532 loss=0.287725 mse_soft=0.287209 ent_in=1.2570 ent_out=0.4615 rowmax_in=0.5050 rowmax_out=0.8290 discrete_mse=104.880150 best_discrete=38.887894 hash=False elapsed=18.0s
step   225/900 tau=0.4103 loss=0.281454 mse_soft=0.280964 ent_in=1.2221 ent_out=0.4139 rowmax_in=0.5048 rowmax_out=0.8488 discrete_mse=100.246460 best_discrete=38.887894 hash=False elapsed=20.3s
step   250/900 tau=0.3715 loss=0.278792 mse_soft=0.278322 ent_in=1.1967 ent_out=0.3713 rowmax_in=0.5081 rowmax_out=0.8624 discrete_mse=42.373505 best_discrete=38.887894 hash=False elapsed=22.6s
step   275/900 tau=0.3363 loss=0.277011 mse_soft=0.276558 ent_in=1.1677 ent_out=0.3420 rowmax_in=0.5163 rowmax_out=0.8717 discrete_mse=85.459724 best_discrete=38.887894 hash=False elapsed=24.9s
step   300/900 tau=0.3045 loss=0.275371 mse_soft=0.274929 ent_in=1.1501 ent_out=0.3225 rowmax_in=0.5196 rowmax_out=0.8785 discrete_mse=239.130371 best_discrete=38.887894 hash=False elapsed=27.2s
step   325/900 tau=0.2756 loss=0.273960 mse_soft=0.273526 ent_in=1.1369 ent_out=0.3100 rowmax_in=0.5218 rowmax_out=0.8824 discrete_mse=179.016754 best_discrete=38.887894 hash=False elapsed=29.6s
step   350/900 tau=0.2496 loss=0.272911 mse_soft=0.272482 ent_in=1.1261 ent_out=0.3054 rowmax_in=0.5243 rowmax_out=0.8834 discrete_mse=179.016754 best_discrete=38.887894 hash=False elapsed=31.9s
step   375/900 tau=0.2259 loss=0.275398 mse_soft=0.274975 ent_in=1.1221 ent_out=0.2904 rowmax_in=0.5230 rowmax_out=0.8888 discrete_mse=140.989441 best_discrete=38.887894 hash=False elapsed=34.3s
step   400/900 tau=0.2046 loss=0.273027 mse_soft=0.272610 ent_in=1.1150 ent_out=0.2763 rowmax_in=0.5243 rowmax_out=0.8931 discrete_mse=140.989441 best_discrete=38.887894 hash=False elapsed=36.3s
step   425/900 tau=0.1852 loss=0.277821 mse_soft=0.277405 ent_in=1.1151 ent_out=0.2725 rowmax_in=0.5242 rowmax_out=0.8940 discrete_mse=55.880085 best_discrete=38.887894 hash=False elapsed=38.4s
step   450/900 tau=0.1677 loss=0.271436 mse_soft=0.271022 ent_in=1.1113 ent_out=0.2678 rowmax_in=0.5258 rowmax_out=0.8948 discrete_mse=140.989441 best_discrete=38.887894 hash=False elapsed=40.4s
step   475/900 tau=0.1518 loss=0.276456 mse_soft=0.276045 ent_in=1.1115 ent_out=0.2576 rowmax_in=0.5245 rowmax_out=0.8976 discrete_mse=55.880085 best_discrete=38.887894 hash=False elapsed=42.7s
step   500/900 tau=0.1374 loss=0.276406 mse_soft=0.275998 ent_in=1.1067 ent_out=0.2507 rowmax_in=0.5264 rowmax_out=0.9007 discrete_mse=55.880085 best_discrete=38.887894 hash=False elapsed=45.1s
step   525/900 tau=0.1244 loss=0.277958 mse_soft=0.277552 ent_in=1.1058 ent_out=0.2487 rowmax_in=0.5263 rowmax_out=0.9010 discrete_mse=140.989441 best_discrete=38.887894 hash=False elapsed=47.3s
step   550/900 tau=0.1126 loss=0.277891 mse_soft=0.277486 ent_in=1.1056 ent_out=0.2448 rowmax_in=0.5251 rowmax_out=0.9025 discrete_mse=140.989441 best_discrete=38.887894 hash=False elapsed=49.4s
step   575/900 tau=0.1020 loss=0.275905 mse_soft=0.275503 ent_in=1.1072 ent_out=0.2341 rowmax_in=0.5221 rowmax_out=0.9081 discrete_mse=192.971390 best_discrete=38.887894 hash=False elapsed=51.7s
step   600/900 tau=0.0923 loss=0.278805 mse_soft=0.278410 ent_in=1.0915 ent_out=0.2251 rowmax_in=0.5310 rowmax_out=0.9125 discrete_mse=134.200653 best_discrete=38.887894 hash=False elapsed=54.2s
step   625/900 tau=0.0836 loss=0.281043 mse_soft=0.280655 ent_in=1.0808 ent_out=0.2104 rowmax_in=0.5308 rowmax_out=0.9167 discrete_mse=147.943298 best_discrete=38.887894 hash=False elapsed=56.6s
step   650/900 tau=0.0757 loss=0.280075 mse_soft=0.279694 ent_in=1.0807 ent_out=0.1889 rowmax_in=0.5275 rowmax_out=0.9251 discrete_mse=147.943298 best_discrete=38.887894 hash=False elapsed=59.0s
step   675/900 tau=0.0685 loss=0.297863 mse_soft=0.297496 ent_in=1.0484 ent_out=0.1749 rowmax_in=0.5364 rowmax_out=0.9320 discrete_mse=66.663597 best_discrete=38.887894 hash=False elapsed=61.3s
step   700/900 tau=0.0620 loss=0.390038 mse_soft=0.389769 ent_in=0.7535 ent_out=0.1420 rowmax_in=0.6873 rowmax_out=0.9420 discrete_mse=15.153593 best_discrete=15.153593 hash=False elapsed=63.6s
step   725/900 tau=0.0562 loss=0.354647 mse_soft=0.354403 ent_in=0.6449 ent_out=0.1690 rowmax_in=0.7046 rowmax_out=0.9198 discrete_mse=60.131035 best_discrete=15.153593 hash=False elapsed=65.8s
step   750/900 tau=0.0508 loss=0.338908 mse_soft=0.338640 ent_in=0.6769 ent_out=0.2161 rowmax_in=0.6723 rowmax_out=0.8913 discrete_mse=90.530937 best_discrete=15.153593 hash=False elapsed=68.1s
step   775/900 tau=0.0460 loss=0.431852 mse_soft=0.431665 ent_in=0.4784 ent_out=0.1460 rowmax_in=0.7664 rowmax_out=0.9320 discrete_mse=15.235034 best_discrete=15.153593 hash=False elapsed=70.5s
step   800/900 tau=0.0417 loss=0.406423 mse_soft=0.406254 ent_in=0.4737 ent_out=0.0897 rowmax_in=0.7662 rowmax_out=0.9596 discrete_mse=61.106785 best_discrete=15.153593 hash=False elapsed=72.8s
step   825/900 tau=0.0377 loss=0.419552 mse_soft=0.419415 ent_in=0.3747 ent_out=0.0804 rowmax_in=0.8019 rowmax_out=0.9622 discrete_mse=15.472237 best_discrete=15.153593 hash=False elapsed=74.9s
step   850/900 tau=0.0342 loss=0.433708 mse_soft=0.433589 ent_in=0.3407 ent_out=0.0556 rowmax_in=0.8162 rowmax_out=0.9725 discrete_mse=7.994093 best_discrete=7.994093 hash=False elapsed=77.3s
step   875/900 tau=0.0309 loss=0.429660 mse_soft=0.429553 ent_in=0.3084 ent_out=0.0509 rowmax_in=0.8273 rowmax_out=0.9741 discrete_mse=9.592182 best_discrete=7.994093 hash=False elapsed=79.6s
step   900/900 tau=0.0280 loss=0.414303 mse_soft=0.414193 ent_in=0.3100 ent_out=0.0550 rowmax_in=0.8341 rowmax_out=0.9728 discrete_mse=8.718828 best_discrete=7.994093 hash=False elapsed=81.7s

Final metrics:
  soft_mse_full=0.423578
  rowmax_in_mean=0.8379
  rowmax_out_mean=0.9728
  ent_in_mean=0.3067
  ent_out_mean=0.0552
  final_discrete_mse=6.748626
  hash_match=False
  best_discrete_mse_seen=7.994093
Saved results to overnight_b228_j2.json
