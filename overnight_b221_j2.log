Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.060689 mse_soft=1.058366 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=37.516186 best_discrete=37.516186 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.860524 mse_soft=0.858334 ent_in=3.6336 ent_out=3.6674 rowmax_in=0.0461 rowmax_out=0.0444 discrete_mse=470.149048 best_discrete=37.516186 hash=False elapsed=2.9s
step    50/900 tau=0.8229 loss=0.647396 mse_soft=0.645495 ent_in=3.1200 ent_out=3.2144 rowmax_in=0.0931 rowmax_out=0.0903 discrete_mse=5523.242188 best_discrete=37.516186 hash=False elapsed=5.2s
step    75/900 tau=0.7450 loss=0.504812 mse_soft=0.503247 ent_in=2.5621 ent_out=2.6561 rowmax_in=0.2154 rowmax_out=0.2011 discrete_mse=364.639069 best_discrete=37.516186 hash=False elapsed=7.7s
step   100/900 tau=0.6745 loss=0.406767 mse_soft=0.405602 ent_in=1.9756 ent_out=1.9072 rowmax_in=0.3610 rowmax_out=0.3796 discrete_mse=1452.096558 best_discrete=37.516186 hash=False elapsed=10.1s
step   125/900 tau=0.6107 loss=0.345506 mse_soft=0.344653 ent_in=1.5943 ent_out=1.2497 rowmax_in=0.4493 rowmax_out=0.5635 discrete_mse=5908.707031 best_discrete=37.516186 hash=False elapsed=12.5s
step   150/900 tau=0.5529 loss=0.317487 mse_soft=0.316795 ent_in=1.4215 ent_out=0.8838 rowmax_in=0.4855 rowmax_out=0.6607 discrete_mse=1392.166016 best_discrete=37.516186 hash=False elapsed=14.9s
step   175/900 tau=0.5006 loss=0.305034 mse_soft=0.304408 ent_in=1.3347 ent_out=0.7529 rowmax_in=0.5017 rowmax_out=0.6847 discrete_mse=1182.120972 best_discrete=37.516186 hash=False elapsed=17.2s
step   200/900 tau=0.4532 loss=0.295594 mse_soft=0.295021 ent_in=1.2733 ent_out=0.6364 rowmax_in=0.5122 rowmax_out=0.7175 discrete_mse=484.839783 best_discrete=37.516186 hash=False elapsed=19.7s
step   225/900 tau=0.4103 loss=0.289688 mse_soft=0.289146 ent_in=1.2307 ent_out=0.5755 rowmax_in=0.5195 rowmax_out=0.7383 discrete_mse=1832.804321 best_discrete=37.516186 hash=False elapsed=22.0s
step   250/900 tau=0.3715 loss=0.285074 mse_soft=0.284549 ent_in=1.2147 ent_out=0.5349 rowmax_in=0.5155 rowmax_out=0.7524 discrete_mse=1350.922974 best_discrete=37.516186 hash=False elapsed=24.4s
step   275/900 tau=0.3363 loss=0.283157 mse_soft=0.282647 ent_in=1.2001 ent_out=0.5002 rowmax_in=0.5169 rowmax_out=0.7631 discrete_mse=630.462219 best_discrete=37.516186 hash=False elapsed=26.6s
step   300/900 tau=0.3045 loss=0.281514 mse_soft=0.281015 ent_in=1.1888 ent_out=0.4728 rowmax_in=0.5163 rowmax_out=0.7714 discrete_mse=369.693481 best_discrete=37.516186 hash=False elapsed=29.0s
step   325/900 tau=0.2756 loss=0.282350 mse_soft=0.281859 ent_in=1.1800 ent_out=0.4550 rowmax_in=0.5190 rowmax_out=0.7792 discrete_mse=321.734039 best_discrete=37.516186 hash=False elapsed=31.4s
step   350/900 tau=0.2496 loss=0.281390 mse_soft=0.280908 ent_in=1.1698 ent_out=0.4391 rowmax_in=0.5226 rowmax_out=0.7848 discrete_mse=369.693481 best_discrete=37.516186 hash=False elapsed=33.9s
step   375/900 tau=0.2259 loss=0.277948 mse_soft=0.277477 ent_in=1.1458 ent_out=0.4258 rowmax_in=0.5288 rowmax_out=0.7910 discrete_mse=783.649170 best_discrete=37.516186 hash=False elapsed=36.2s
step   400/900 tau=0.2046 loss=0.281133 mse_soft=0.280669 ent_in=1.1298 ent_out=0.4172 rowmax_in=0.5339 rowmax_out=0.7901 discrete_mse=783.649170 best_discrete=37.516186 hash=False elapsed=38.4s
step   425/900 tau=0.1852 loss=0.275271 mse_soft=0.274811 ent_in=1.1207 ent_out=0.4133 rowmax_in=0.5368 rowmax_out=0.7898 discrete_mse=419.092255 best_discrete=37.516186 hash=False elapsed=40.9s
step   450/900 tau=0.1677 loss=0.278513 mse_soft=0.278057 ent_in=1.1133 ent_out=0.4080 rowmax_in=0.5387 rowmax_out=0.7946 discrete_mse=478.823578 best_discrete=37.516186 hash=False elapsed=43.3s
step   475/900 tau=0.1518 loss=0.274501 mse_soft=0.274046 ent_in=1.1047 ent_out=0.4097 rowmax_in=0.5377 rowmax_out=0.7924 discrete_mse=570.486633 best_discrete=37.516186 hash=False elapsed=45.5s
step   500/900 tau=0.1374 loss=0.291190 mse_soft=0.290738 ent_in=1.1010 ent_out=0.4046 rowmax_in=0.5376 rowmax_out=0.7954 discrete_mse=1258.072021 best_discrete=37.516186 hash=False elapsed=47.6s
step   525/900 tau=0.1244 loss=0.276924 mse_soft=0.276490 ent_in=1.0666 ent_out=0.3789 rowmax_in=0.5498 rowmax_out=0.8145 discrete_mse=95.643898 best_discrete=37.516186 hash=False elapsed=49.8s
step   550/900 tau=0.1126 loss=0.271798 mse_soft=0.271367 ent_in=1.0628 ent_out=0.3766 rowmax_in=0.5479 rowmax_out=0.8086 discrete_mse=198.490219 best_discrete=37.516186 hash=False elapsed=52.1s
step   575/900 tau=0.1020 loss=0.298863 mse_soft=0.298475 ent_in=1.0025 ent_out=0.2928 rowmax_in=0.5571 rowmax_out=0.8571 discrete_mse=426.660431 best_discrete=37.516186 hash=False elapsed=54.5s
step   600/900 tau=0.0923 loss=0.284192 mse_soft=0.283806 ent_in=0.9943 ent_out=0.2935 rowmax_in=0.5531 rowmax_out=0.8540 discrete_mse=84.505180 best_discrete=37.516186 hash=False elapsed=56.8s
step   625/900 tau=0.0836 loss=0.280786 mse_soft=0.280401 ent_in=0.9926 ent_out=0.2922 rowmax_in=0.5469 rowmax_out=0.8596 discrete_mse=272.079529 best_discrete=37.516186 hash=False elapsed=59.1s
step   650/900 tau=0.0757 loss=0.285306 mse_soft=0.284925 ent_in=0.9892 ent_out=0.2837 rowmax_in=0.5442 rowmax_out=0.8676 discrete_mse=234.702499 best_discrete=37.516186 hash=False elapsed=61.6s
step   675/900 tau=0.0685 loss=0.296590 mse_soft=0.296217 ent_in=0.9716 ent_out=0.2734 rowmax_in=0.5537 rowmax_out=0.8811 discrete_mse=163.555527 best_discrete=37.516186 hash=False elapsed=64.2s
step   700/900 tau=0.0620 loss=0.366944 mse_soft=0.366575 ent_in=0.9521 ent_out=0.2784 rowmax_in=0.5617 rowmax_out=0.8677 discrete_mse=116.352463 best_discrete=37.516186 hash=False elapsed=66.7s
step   725/900 tau=0.0562 loss=0.520559 mse_soft=0.520353 ent_in=0.5640 ent_out=0.1229 rowmax_in=0.7293 rowmax_out=0.9456 discrete_mse=62.834988 best_discrete=37.516186 hash=False elapsed=69.1s
step   750/900 tau=0.0508 loss=0.420329 mse_soft=0.420141 ent_in=0.5500 ent_out=0.0785 rowmax_in=0.7041 rowmax_out=0.9629 discrete_mse=50.792648 best_discrete=37.516186 hash=False elapsed=71.6s
step   775/900 tau=0.0460 loss=0.408351 mse_soft=0.408158 ent_in=0.5664 ent_out=0.0761 rowmax_in=0.6961 rowmax_out=0.9633 discrete_mse=50.792648 best_discrete=37.516186 hash=False elapsed=73.9s
step   800/900 tau=0.0417 loss=0.413555 mse_soft=0.413370 ent_in=0.5459 ent_out=0.0738 rowmax_in=0.7064 rowmax_out=0.9638 discrete_mse=65.475563 best_discrete=37.516186 hash=False elapsed=76.3s
step   825/900 tau=0.0377 loss=0.492167 mse_soft=0.491998 ent_in=0.4912 ent_out=0.0737 rowmax_in=0.7393 rowmax_out=0.9639 discrete_mse=65.475563 best_discrete=37.516186 hash=False elapsed=78.7s
step   850/900 tau=0.0342 loss=0.468837 mse_soft=0.468683 ent_in=0.4486 ent_out=0.0656 rowmax_in=0.7612 rowmax_out=0.9666 discrete_mse=5.733464 best_discrete=5.733464 hash=False elapsed=81.0s
step   875/900 tau=0.0309 loss=0.432329 mse_soft=0.432167 ent_in=0.4552 ent_out=0.0854 rowmax_in=0.7443 rowmax_out=0.9577 discrete_mse=88.548531 best_discrete=5.733464 hash=False elapsed=83.5s
step   900/900 tau=0.0280 loss=0.425898 mse_soft=0.425732 ent_in=0.4595 ent_out=0.0940 rowmax_in=0.7532 rowmax_out=0.9519 discrete_mse=19.723301 best_discrete=5.733464 hash=False elapsed=85.9s

Final metrics:
  soft_mse_full=0.431067
  rowmax_in_mean=0.7545
  rowmax_out_mean=0.9517
  ent_in_mean=0.4594
  ent_out_mean=0.0943
  final_discrete_mse=19.723301
  hash_match=False
  best_discrete_mse_seen=5.733464
Saved results to overnight_b221_j2.json
