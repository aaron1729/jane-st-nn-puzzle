Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.015
step     1/700 tau=1.0000 loss=1.064251 mse_soft=1.063477 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=7.627925 best_discrete=7.627925 hash=False elapsed=0.5s
step    25/700 tau=0.8810 loss=0.972171 mse_soft=0.971412 ent_in=3.7933 ent_out=3.8051 rowmax_in=0.0330 rowmax_out=0.0323 discrete_mse=2743.501221 best_discrete=7.627925 hash=False elapsed=2.5s
step    50/700 tau=0.7721 loss=0.784576 mse_soft=0.783868 ent_in=3.5155 ent_out=3.5653 rowmax_in=0.0566 rowmax_out=0.0539 discrete_mse=23328.818359 best_discrete=7.627925 hash=False elapsed=4.7s
step    75/700 tau=0.6767 loss=0.642204 mse_soft=0.641567 ent_in=3.1348 ent_out=3.2354 rowmax_in=0.0952 rowmax_out=0.0902 discrete_mse=1496.638428 best_discrete=7.627925 hash=False elapsed=7.1s
step   100/700 tau=0.5931 loss=0.532596 mse_soft=0.532040 ent_in=2.7242 ent_out=2.8315 rowmax_in=0.1820 rowmax_out=0.1692 discrete_mse=785.306763 best_discrete=7.627925 hash=False elapsed=9.3s
step   125/700 tau=0.5198 loss=0.436965 mse_soft=0.436528 ent_in=2.2122 ent_out=2.1613 rowmax_in=0.3002 rowmax_out=0.3218 discrete_mse=2156.613037 best_discrete=7.627925 hash=False elapsed=11.4s
step   150/700 tau=0.4555 loss=0.373241 mse_soft=0.372910 ent_in=1.7647 ent_out=1.5401 rowmax_in=0.4049 rowmax_out=0.5028 discrete_mse=2359.676758 best_discrete=7.627925 hash=False elapsed=13.5s
step   175/700 tau=0.3992 loss=0.335320 mse_soft=0.335072 ent_in=1.4898 ent_out=0.9847 rowmax_in=0.4617 rowmax_out=0.6852 discrete_mse=887.594788 best_discrete=7.627925 hash=False elapsed=15.5s
step   200/700 tau=0.3499 loss=0.313218 mse_soft=0.313017 ent_in=1.3154 ent_out=0.6951 rowmax_in=0.4963 rowmax_out=0.7609 discrete_mse=684.213867 best_discrete=7.627925 hash=False elapsed=17.7s
step   225/700 tau=0.3066 loss=0.302634 mse_soft=0.302453 ent_in=1.2103 ent_out=0.5954 rowmax_in=0.5140 rowmax_out=0.7724 discrete_mse=726.058777 best_discrete=7.627925 hash=False elapsed=19.8s
step   250/700 tau=0.2687 loss=0.295472 mse_soft=0.295302 ent_in=1.1490 ent_out=0.5503 rowmax_in=0.5281 rowmax_out=0.7676 discrete_mse=102.289658 best_discrete=7.627925 hash=False elapsed=21.8s
step   275/700 tau=0.2355 loss=0.290836 mse_soft=0.290674 ent_in=1.1155 ent_out=0.5043 rowmax_in=0.5329 rowmax_out=0.7846 discrete_mse=272.422150 best_discrete=7.627925 hash=False elapsed=24.0s
step   300/700 tau=0.2064 loss=0.286739 mse_soft=0.286583 ent_in=1.1007 ent_out=0.4556 rowmax_in=0.5327 rowmax_out=0.7996 discrete_mse=1310.381348 best_discrete=7.627925 hash=False elapsed=26.1s
step   325/700 tau=0.1809 loss=0.284795 mse_soft=0.284644 ent_in=1.0815 ent_out=0.4269 rowmax_in=0.5384 rowmax_out=0.8088 discrete_mse=1152.125610 best_discrete=7.627925 hash=False elapsed=28.3s
step   350/700 tau=0.1585 loss=0.284996 mse_soft=0.284848 ent_in=1.0705 ent_out=0.4115 rowmax_in=0.5417 rowmax_out=0.8125 discrete_mse=313.877441 best_discrete=7.627925 hash=False elapsed=30.4s
step   375/700 tau=0.1389 loss=0.282067 mse_soft=0.281922 ent_in=1.0644 ent_out=0.3919 rowmax_in=0.5405 rowmax_out=0.8209 discrete_mse=502.927094 best_discrete=7.627925 hash=False elapsed=32.4s
step   400/700 tau=0.1218 loss=0.285846 mse_soft=0.285703 ent_in=1.0531 ent_out=0.3759 rowmax_in=0.5430 rowmax_out=0.8250 discrete_mse=375.332123 best_discrete=7.627925 hash=False elapsed=34.7s
step   425/700 tau=0.1067 loss=0.284010 mse_soft=0.283869 ent_in=1.0443 ent_out=0.3693 rowmax_in=0.5476 rowmax_out=0.8274 discrete_mse=462.637939 best_discrete=7.627925 hash=False elapsed=36.7s
step   450/700 tau=0.0935 loss=0.282922 mse_soft=0.282782 ent_in=1.0413 ent_out=0.3625 rowmax_in=0.5470 rowmax_out=0.8292 discrete_mse=692.553894 best_discrete=7.627925 hash=False elapsed=38.5s
step   475/700 tau=0.0820 loss=0.286554 mse_soft=0.286414 ent_in=1.0391 ent_out=0.3569 rowmax_in=0.5477 rowmax_out=0.8322 discrete_mse=104.370125 best_discrete=7.627925 hash=False elapsed=40.2s
step   500/700 tau=0.0718 loss=0.293157 mse_soft=0.293019 ent_in=1.0349 ent_out=0.3497 rowmax_in=0.5484 rowmax_out=0.8344 discrete_mse=692.553894 best_discrete=7.627925 hash=False elapsed=42.4s
step   525/700 tau=0.0630 loss=0.283506 mse_soft=0.283367 ent_in=1.0349 ent_out=0.3485 rowmax_in=0.5488 rowmax_out=0.8335 discrete_mse=827.445557 best_discrete=7.627925 hash=False elapsed=44.5s
step   550/700 tau=0.0552 loss=0.311900 mse_soft=0.311763 ent_in=1.0241 ent_out=0.3470 rowmax_in=0.5569 rowmax_out=0.8336 discrete_mse=136.784927 best_discrete=7.627925 hash=False elapsed=46.8s
step   575/700 tau=0.0484 loss=0.302796 mse_soft=0.302659 ent_in=1.0283 ent_out=0.3392 rowmax_in=0.5510 rowmax_out=0.8358 discrete_mse=898.312561 best_discrete=7.627925 hash=False elapsed=48.8s
step   600/700 tau=0.0424 loss=0.307073 mse_soft=0.306939 ent_in=1.0067 ent_out=0.3291 rowmax_in=0.5620 rowmax_out=0.8379 discrete_mse=273.922516 best_discrete=7.627925 hash=False elapsed=51.1s
step   625/700 tau=0.0371 loss=0.311583 mse_soft=0.311462 ent_in=0.9238 ent_out=0.2918 rowmax_in=0.5793 rowmax_out=0.8585 discrete_mse=52.246510 best_discrete=7.627925 hash=False elapsed=53.3s
step   650/700 tau=0.0325 loss=0.394935 mse_soft=0.394825 ent_in=0.8326 ent_out=0.2689 rowmax_in=0.6130 rowmax_out=0.8734 discrete_mse=367.949738 best_discrete=7.627925 hash=False elapsed=55.2s
step   675/700 tau=0.0285 loss=0.312394 mse_soft=0.312283 ent_in=0.8555 ent_out=0.2600 rowmax_in=0.5956 rowmax_out=0.8710 discrete_mse=100.061302 best_discrete=7.627925 hash=False elapsed=57.2s
step   700/700 tau=0.0250 loss=0.336811 mse_soft=0.336703 ent_in=0.8150 ent_out=0.2623 rowmax_in=0.6028 rowmax_out=0.8656 discrete_mse=25.967550 best_discrete=7.627925 hash=False elapsed=59.2s

Final metrics:
  soft_mse_full=0.322333
  rowmax_in_mean=0.6089
  rowmax_out_mean=0.8693
  ent_in_mean=0.8118
  ent_out_mean=0.2559
  final_discrete_mse=42.741188
  hash_match=False
  best_discrete_mse_seen=7.627925
Saved results to overnight_b035_j4.json
