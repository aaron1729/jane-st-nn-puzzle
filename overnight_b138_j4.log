Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.015
step     1/700 tau=1.0000 loss=1.064171 mse_soft=1.063397 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=19.014475 best_discrete=19.014475 hash=False elapsed=0.5s
step    25/700 tau=0.8810 loss=0.972092 mse_soft=0.971332 ent_in=3.7930 ent_out=3.8053 rowmax_in=0.0330 rowmax_out=0.0323 discrete_mse=176.055878 best_discrete=19.014475 hash=False elapsed=2.7s
step    50/700 tau=0.7721 loss=0.787104 mse_soft=0.786396 ent_in=3.5162 ent_out=3.5660 rowmax_in=0.0568 rowmax_out=0.0540 discrete_mse=8376.263672 best_discrete=19.014475 hash=False elapsed=5.1s
step    75/700 tau=0.6767 loss=0.643901 mse_soft=0.643264 ent_in=3.1359 ent_out=3.2335 rowmax_in=0.0965 rowmax_out=0.0925 discrete_mse=13329.761719 best_discrete=19.014475 hash=False elapsed=7.2s
step   100/700 tau=0.5931 loss=0.535049 mse_soft=0.534493 ent_in=2.7283 ent_out=2.8331 rowmax_in=0.1812 rowmax_out=0.1698 discrete_mse=1827.625977 best_discrete=19.014475 hash=False elapsed=9.8s
step   125/700 tau=0.5198 loss=0.435942 mse_soft=0.435507 ent_in=2.1892 ent_out=2.1660 rowmax_in=0.3111 rowmax_out=0.3309 discrete_mse=1046.044800 best_discrete=19.014475 hash=False elapsed=12.1s
step   150/700 tau=0.4555 loss=0.373797 mse_soft=0.373467 ent_in=1.7790 ent_out=1.5274 rowmax_in=0.3990 rowmax_out=0.5117 discrete_mse=515.068115 best_discrete=19.014475 hash=False elapsed=14.3s
step   175/700 tau=0.3992 loss=0.334344 mse_soft=0.334089 ent_in=1.4676 ent_out=1.0803 rowmax_in=0.4833 rowmax_out=0.6221 discrete_mse=724.138611 best_discrete=19.014475 hash=False elapsed=16.6s
step   200/700 tau=0.3499 loss=0.308396 mse_soft=0.308197 ent_in=1.2585 ent_out=0.7283 rowmax_in=0.5258 rowmax_out=0.7391 discrete_mse=284.795898 best_discrete=19.014475 hash=False elapsed=19.0s
step   225/700 tau=0.3066 loss=0.293143 mse_soft=0.292976 ent_in=1.1552 ent_out=0.5165 rowmax_in=0.5435 rowmax_out=0.8046 discrete_mse=567.734253 best_discrete=19.014475 hash=False elapsed=21.2s
step   250/700 tau=0.2687 loss=0.284456 mse_soft=0.284300 ent_in=1.0917 ent_out=0.4650 rowmax_in=0.5499 rowmax_out=0.8036 discrete_mse=567.734253 best_discrete=19.014475 hash=False elapsed=23.3s
step   275/700 tau=0.2355 loss=0.280475 mse_soft=0.280329 ent_in=1.0511 ent_out=0.4105 rowmax_in=0.5611 rowmax_out=0.8107 discrete_mse=220.508499 best_discrete=19.014475 hash=False elapsed=25.6s
step   300/700 tau=0.2064 loss=0.278020 mse_soft=0.277879 ent_in=1.0236 ent_out=0.3844 rowmax_in=0.5619 rowmax_out=0.8178 discrete_mse=235.928101 best_discrete=19.014475 hash=False elapsed=27.9s
step   325/700 tau=0.1809 loss=0.277049 mse_soft=0.276912 ent_in=1.0011 ent_out=0.3703 rowmax_in=0.5691 rowmax_out=0.8260 discrete_mse=220.508499 best_discrete=19.014475 hash=False elapsed=30.2s
step   350/700 tau=0.1585 loss=0.277000 mse_soft=0.276865 ent_in=0.9847 ent_out=0.3636 rowmax_in=0.5732 rowmax_out=0.8287 discrete_mse=220.508499 best_discrete=19.014475 hash=False elapsed=32.6s
step   375/700 tau=0.1389 loss=0.275812 mse_soft=0.275678 ent_in=0.9778 ent_out=0.3583 rowmax_in=0.5738 rowmax_out=0.8301 discrete_mse=250.430237 best_discrete=19.014475 hash=False elapsed=34.9s
step   400/700 tau=0.1218 loss=0.276273 mse_soft=0.276141 ent_in=0.9689 ent_out=0.3521 rowmax_in=0.5748 rowmax_out=0.8338 discrete_mse=250.430237 best_discrete=19.014475 hash=False elapsed=37.2s
step   425/700 tau=0.1067 loss=0.275796 mse_soft=0.275666 ent_in=0.9551 ent_out=0.3443 rowmax_in=0.5791 rowmax_out=0.8377 discrete_mse=153.872925 best_discrete=19.014475 hash=False elapsed=39.4s
step   450/700 tau=0.0935 loss=0.276053 mse_soft=0.275925 ent_in=0.9451 ent_out=0.3417 rowmax_in=0.5830 rowmax_out=0.8388 discrete_mse=153.872925 best_discrete=19.014475 hash=False elapsed=41.7s
step   475/700 tau=0.0820 loss=0.276401 mse_soft=0.276273 ent_in=0.9447 ent_out=0.3379 rowmax_in=0.5827 rowmax_out=0.8380 discrete_mse=153.872925 best_discrete=19.014475 hash=False elapsed=43.8s
step   500/700 tau=0.0718 loss=0.278407 mse_soft=0.278279 ent_in=0.9406 ent_out=0.3346 rowmax_in=0.5857 rowmax_out=0.8378 discrete_mse=64.816948 best_discrete=19.014475 hash=False elapsed=46.0s
step   525/700 tau=0.0630 loss=0.279893 mse_soft=0.279767 ent_in=0.9314 ent_out=0.3309 rowmax_in=0.5899 rowmax_out=0.8389 discrete_mse=64.552673 best_discrete=19.014475 hash=False elapsed=48.1s
step   550/700 tau=0.0552 loss=0.299938 mse_soft=0.299815 ent_in=0.9011 ent_out=0.3367 rowmax_in=0.6022 rowmax_out=0.8336 discrete_mse=100.569870 best_discrete=19.014475 hash=False elapsed=50.3s
step   575/700 tau=0.0484 loss=0.278362 mse_soft=0.278243 ent_in=0.8743 ent_out=0.3193 rowmax_in=0.6140 rowmax_out=0.8465 discrete_mse=130.817810 best_discrete=19.014475 hash=False elapsed=52.5s
step   600/700 tau=0.0424 loss=0.281755 mse_soft=0.281637 ent_in=0.8576 ent_out=0.3190 rowmax_in=0.6210 rowmax_out=0.8462 discrete_mse=79.737389 best_discrete=19.014475 hash=False elapsed=54.9s
step   625/700 tau=0.0371 loss=0.281212 mse_soft=0.281096 ent_in=0.8459 ent_out=0.3117 rowmax_in=0.6243 rowmax_out=0.8486 discrete_mse=140.533569 best_discrete=19.014475 hash=False elapsed=57.2s
step   650/700 tau=0.0325 loss=0.284357 mse_soft=0.284246 ent_in=0.8031 ent_out=0.3014 rowmax_in=0.6368 rowmax_out=0.8518 discrete_mse=103.189888 best_discrete=19.014475 hash=False elapsed=59.4s
step   675/700 tau=0.0285 loss=0.308731 mse_soft=0.308629 ent_in=0.7521 ent_out=0.2665 rowmax_in=0.6493 rowmax_out=0.8731 discrete_mse=5.522882 best_discrete=5.522882 hash=False elapsed=61.8s
step   700/700 tau=0.0250 loss=0.401731 mse_soft=0.401668 ent_in=0.4330 ent_out=0.2035 rowmax_in=0.8145 rowmax_out=0.8988 discrete_mse=4.012400 best_discrete=4.012400 hash=False elapsed=64.2s

Final metrics:
  soft_mse_full=0.395313
  rowmax_in_mean=0.8151
  rowmax_out_mean=0.8927
  ent_in_mean=0.4277
  ent_out_mean=0.2122
  final_discrete_mse=2.550786
  hash_match=False
  best_discrete_mse_seen=4.012400
Saved results to overnight_b138_j4.json
