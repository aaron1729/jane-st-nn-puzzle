Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.065729 mse_soft=1.063407 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=146.083557 best_discrete=146.083557 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.864397 mse_soft=0.862207 ent_in=3.6315 ent_out=3.6689 rowmax_in=0.0460 rowmax_out=0.0437 discrete_mse=3886.529541 best_discrete=146.083557 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.654816 mse_soft=0.652910 ent_in=3.1265 ent_out=3.2259 rowmax_in=0.0915 rowmax_out=0.0862 discrete_mse=8318.652344 best_discrete=146.083557 hash=False elapsed=5.2s
step    75/900 tau=0.7493 loss=0.516236 mse_soft=0.514659 ent_in=2.5778 ent_out=2.6809 rowmax_in=0.2034 rowmax_out=0.1978 discrete_mse=399.332458 best_discrete=146.083557 hash=False elapsed=7.6s
step   100/900 tau=0.6797 loss=0.408651 mse_soft=0.407506 ent_in=1.9292 ent_out=1.8877 rowmax_in=0.3654 rowmax_out=0.4027 discrete_mse=4851.435547 best_discrete=146.083557 hash=False elapsed=10.0s
step   125/900 tau=0.6165 loss=0.346715 mse_soft=0.345890 ent_in=1.5312 ent_out=1.2177 rowmax_in=0.4644 rowmax_out=0.6046 discrete_mse=2350.801270 best_discrete=146.083557 hash=False elapsed=12.4s
step   150/900 tau=0.5592 loss=0.323145 mse_soft=0.322490 ent_in=1.3445 ent_out=0.8384 rowmax_in=0.4929 rowmax_out=0.7211 discrete_mse=65.578133 best_discrete=65.578133 hash=False elapsed=14.6s
step   175/900 tau=0.5073 loss=0.310606 mse_soft=0.310027 ent_in=1.2545 ent_out=0.6743 rowmax_in=0.5092 rowmax_out=0.7540 discrete_mse=53.712261 best_discrete=53.712261 hash=False elapsed=17.1s
step   200/900 tau=0.4602 loss=0.301641 mse_soft=0.301114 ent_in=1.2011 ent_out=0.5550 rowmax_in=0.5204 rowmax_out=0.7883 discrete_mse=567.113159 best_discrete=53.712261 hash=False elapsed=19.4s
step   225/900 tau=0.4174 loss=0.296644 mse_soft=0.296151 ent_in=1.1682 ent_out=0.4747 rowmax_in=0.5280 rowmax_out=0.8180 discrete_mse=585.335510 best_discrete=53.712261 hash=False elapsed=22.0s
step   250/900 tau=0.3786 loss=0.292692 mse_soft=0.292220 ent_in=1.1425 ent_out=0.4306 rowmax_in=0.5342 rowmax_out=0.8324 discrete_mse=480.833374 best_discrete=53.712261 hash=False elapsed=24.5s
step   275/900 tau=0.3434 loss=0.288681 mse_soft=0.288222 ent_in=1.1292 ent_out=0.4004 rowmax_in=0.5369 rowmax_out=0.8433 discrete_mse=480.833374 best_discrete=53.712261 hash=False elapsed=26.9s
step   300/900 tau=0.3115 loss=0.287523 mse_soft=0.287073 ent_in=1.1150 ent_out=0.3848 rowmax_in=0.5398 rowmax_out=0.8459 discrete_mse=276.611603 best_discrete=53.712261 hash=False elapsed=29.3s
step   325/900 tau=0.2826 loss=0.285103 mse_soft=0.284662 ent_in=1.1034 ent_out=0.3677 rowmax_in=0.5407 rowmax_out=0.8505 discrete_mse=276.611603 best_discrete=53.712261 hash=False elapsed=31.6s
step   350/900 tau=0.2563 loss=0.285013 mse_soft=0.284580 ent_in=1.0929 ent_out=0.3524 rowmax_in=0.5415 rowmax_out=0.8547 discrete_mse=276.611603 best_discrete=53.712261 hash=False elapsed=33.9s
step   375/900 tau=0.2325 loss=0.283747 mse_soft=0.283320 ent_in=1.0807 ent_out=0.3440 rowmax_in=0.5427 rowmax_out=0.8566 discrete_mse=276.611603 best_discrete=53.712261 hash=False elapsed=36.3s
step   400/900 tau=0.2109 loss=0.283939 mse_soft=0.283517 ent_in=1.0710 ent_out=0.3328 rowmax_in=0.5423 rowmax_out=0.8598 discrete_mse=276.611603 best_discrete=53.712261 hash=False elapsed=38.8s
step   425/900 tau=0.1913 loss=0.284451 mse_soft=0.284033 ent_in=1.0670 ent_out=0.3246 rowmax_in=0.5439 rowmax_out=0.8627 discrete_mse=222.389313 best_discrete=53.712261 hash=False elapsed=41.3s
step   450/900 tau=0.1735 loss=0.281798 mse_soft=0.281385 ent_in=1.0599 ent_out=0.3174 rowmax_in=0.5454 rowmax_out=0.8655 discrete_mse=149.522064 best_discrete=53.712261 hash=False elapsed=43.8s
step   475/900 tau=0.1574 loss=0.281799 mse_soft=0.281388 ent_in=1.0548 ent_out=0.3143 rowmax_in=0.5472 rowmax_out=0.8661 discrete_mse=276.611603 best_discrete=53.712261 hash=False elapsed=46.3s
step   500/900 tau=0.1428 loss=0.284163 mse_soft=0.283753 ent_in=1.0489 ent_out=0.3168 rowmax_in=0.5482 rowmax_out=0.8595 discrete_mse=390.134491 best_discrete=53.712261 hash=False elapsed=48.6s
step   525/900 tau=0.1295 loss=0.282499 mse_soft=0.282090 ent_in=1.0437 ent_out=0.3182 rowmax_in=0.5487 rowmax_out=0.8613 discrete_mse=489.969482 best_discrete=53.712261 hash=False elapsed=51.1s
step   550/900 tau=0.1175 loss=0.288416 mse_soft=0.288015 ent_in=1.0255 ent_out=0.3100 rowmax_in=0.5571 rowmax_out=0.8619 discrete_mse=292.633484 best_discrete=53.712261 hash=False elapsed=53.5s
step   575/900 tau=0.1066 loss=0.286173 mse_soft=0.285770 ent_in=1.0312 ent_out=0.3103 rowmax_in=0.5573 rowmax_out=0.8629 discrete_mse=383.076538 best_discrete=53.712261 hash=False elapsed=56.2s
step   600/900 tau=0.0967 loss=0.288801 mse_soft=0.288398 ent_in=1.0353 ent_out=0.3077 rowmax_in=0.5524 rowmax_out=0.8617 discrete_mse=183.792023 best_discrete=53.712261 hash=False elapsed=58.7s
step   625/900 tau=0.0877 loss=0.306658 mse_soft=0.306255 ent_in=1.0332 ent_out=0.3080 rowmax_in=0.5569 rowmax_out=0.8624 discrete_mse=366.412506 best_discrete=53.712261 hash=False elapsed=61.1s
step   650/900 tau=0.0795 loss=0.427798 mse_soft=0.427414 ent_in=0.9895 ent_out=0.2914 rowmax_in=0.5801 rowmax_out=0.8823 discrete_mse=168.803467 best_discrete=53.712261 hash=False elapsed=63.5s
step   675/900 tau=0.0722 loss=0.312846 mse_soft=0.312506 ent_in=0.8455 ent_out=0.2878 rowmax_in=0.6379 rowmax_out=0.8785 discrete_mse=385.072327 best_discrete=53.712261 hash=False elapsed=65.7s
step   700/900 tau=0.0655 loss=0.301243 mse_soft=0.300894 ent_in=0.8663 ent_out=0.2979 rowmax_in=0.6197 rowmax_out=0.8572 discrete_mse=367.149933 best_discrete=53.712261 hash=False elapsed=68.0s
step   725/900 tau=0.0594 loss=0.322170 mse_soft=0.321817 ent_in=0.8877 ent_out=0.2896 rowmax_in=0.6083 rowmax_out=0.8681 discrete_mse=296.360504 best_discrete=53.712261 hash=False elapsed=70.2s
step   750/900 tau=0.0539 loss=0.316120 mse_soft=0.315777 ent_in=0.8607 ent_out=0.2828 rowmax_in=0.6157 rowmax_out=0.8677 discrete_mse=360.007751 best_discrete=53.712261 hash=False elapsed=72.4s
step   775/900 tau=0.0489 loss=0.312353 mse_soft=0.312009 ent_in=0.8679 ent_out=0.2799 rowmax_in=0.6137 rowmax_out=0.8724 discrete_mse=251.561066 best_discrete=53.712261 hash=False elapsed=74.6s
step   800/900 tau=0.0443 loss=0.323654 mse_soft=0.323311 ent_in=0.8544 ent_out=0.2894 rowmax_in=0.6175 rowmax_out=0.8589 discrete_mse=176.100616 best_discrete=53.712261 hash=False elapsed=76.8s
step   825/900 tau=0.0402 loss=0.447747 mse_soft=0.447570 ent_in=0.4422 ent_out=0.1479 rowmax_in=0.7920 rowmax_out=0.9247 discrete_mse=1.765348 best_discrete=1.765348 hash=False elapsed=79.2s
step   850/900 tau=0.0365 loss=0.422627 mse_soft=0.422468 ent_in=0.3826 ent_out=0.1467 rowmax_in=0.8152 rowmax_out=0.9182 discrete_mse=24.691826 best_discrete=1.765348 hash=False elapsed=81.6s
step   875/900 tau=0.0331 loss=0.419073 mse_soft=0.418923 ent_in=0.3732 ent_out=0.1256 rowmax_in=0.8149 rowmax_out=0.9252 discrete_mse=8.198686 best_discrete=1.765348 hash=False elapsed=84.1s
step   900/900 tau=0.0300 loss=0.421760 mse_soft=0.421618 ent_in=0.3500 ent_out=0.1238 rowmax_in=0.8227 rowmax_out=0.9257 discrete_mse=40.270836 best_discrete=1.765348 hash=False elapsed=86.4s

Final metrics:
  soft_mse_full=0.428432
  rowmax_in_mean=0.8277
  rowmax_out_mean=0.9258
  ent_in_mean=0.3474
  ent_out_mean=0.1237
  final_discrete_mse=40.270836
  hash_match=False
  best_discrete_mse_seen=1.765348
Saved results to overnight_b164_j1.json
