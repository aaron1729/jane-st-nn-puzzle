Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.093664 mse_soft=1.091341 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=54.116962 best_discrete=54.116962 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.885546 mse_soft=0.883356 ent_in=3.6354 ent_out=3.6652 rowmax_in=0.0448 rowmax_out=0.0446 discrete_mse=320.733154 best_discrete=54.116962 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.663459 mse_soft=0.661556 ent_in=3.1303 ent_out=3.2125 rowmax_in=0.0915 rowmax_out=0.0895 discrete_mse=3926.203125 best_discrete=54.116962 hash=False elapsed=4.8s
step    75/900 tau=0.7493 loss=0.517821 mse_soft=0.516248 ent_in=2.5869 ent_out=2.6547 rowmax_in=0.2089 rowmax_out=0.2085 discrete_mse=2221.442627 best_discrete=54.116962 hash=False elapsed=7.0s
step   100/900 tau=0.6797 loss=0.403036 mse_soft=0.401907 ent_in=1.9694 ent_out=1.7930 rowmax_in=0.3533 rowmax_out=0.4263 discrete_mse=256.513458 best_discrete=54.116962 hash=False elapsed=9.1s
step   125/900 tau=0.6165 loss=0.336580 mse_soft=0.335785 ent_in=1.5528 ent_out=1.0990 rowmax_in=0.4528 rowmax_out=0.6589 discrete_mse=618.840698 best_discrete=54.116962 hash=False elapsed=11.0s
step   150/900 tau=0.5592 loss=0.311066 mse_soft=0.310428 ent_in=1.3885 ent_out=0.7367 rowmax_in=0.4793 rowmax_out=0.7564 discrete_mse=1088.427856 best_discrete=54.116962 hash=False elapsed=13.1s
step   175/900 tau=0.5073 loss=0.297494 mse_soft=0.296926 ent_in=1.3076 ent_out=0.5865 rowmax_in=0.4918 rowmax_out=0.7938 discrete_mse=576.869324 best_discrete=54.116962 hash=False elapsed=15.1s
step   200/900 tau=0.4602 loss=0.287375 mse_soft=0.286852 ent_in=1.2604 ent_out=0.4849 rowmax_in=0.4943 rowmax_out=0.8238 discrete_mse=460.952698 best_discrete=54.116962 hash=False elapsed=17.1s
step   225/900 tau=0.4174 loss=0.281341 mse_soft=0.280849 ent_in=1.2358 ent_out=0.4034 rowmax_in=0.4900 rowmax_out=0.8457 discrete_mse=460.952698 best_discrete=54.116962 hash=False elapsed=19.1s
step   250/900 tau=0.3786 loss=0.276847 mse_soft=0.276384 ent_in=1.1988 ent_out=0.3464 rowmax_in=0.4975 rowmax_out=0.8600 discrete_mse=1007.981262 best_discrete=54.116962 hash=False elapsed=21.1s
step   275/900 tau=0.3434 loss=0.276174 mse_soft=0.275719 ent_in=1.1831 ent_out=0.3328 rowmax_in=0.4975 rowmax_out=0.8545 discrete_mse=1063.413574 best_discrete=54.116962 hash=False elapsed=23.2s
step   300/900 tau=0.3115 loss=0.275025 mse_soft=0.274573 ent_in=1.1712 ent_out=0.3358 rowmax_in=0.4982 rowmax_out=0.8507 discrete_mse=1063.413574 best_discrete=54.116962 hash=False elapsed=25.2s
step   325/900 tau=0.2826 loss=0.273404 mse_soft=0.272955 ent_in=1.1601 ent_out=0.3351 rowmax_in=0.4996 rowmax_out=0.8471 discrete_mse=826.650146 best_discrete=54.116962 hash=False elapsed=27.2s
step   350/900 tau=0.2563 loss=0.273086 mse_soft=0.272643 ent_in=1.1529 ent_out=0.3258 rowmax_in=0.4981 rowmax_out=0.8503 discrete_mse=826.650146 best_discrete=54.116962 hash=False elapsed=29.3s
step   375/900 tau=0.2325 loss=0.272108 mse_soft=0.271669 ent_in=1.1471 ent_out=0.3178 rowmax_in=0.4984 rowmax_out=0.8511 discrete_mse=877.229797 best_discrete=54.116962 hash=False elapsed=31.4s
step   400/900 tau=0.2109 loss=0.273032 mse_soft=0.272594 ent_in=1.1454 ent_out=0.3126 rowmax_in=0.4972 rowmax_out=0.8519 discrete_mse=1653.754150 best_discrete=54.116962 hash=False elapsed=33.4s
step   425/900 tau=0.1913 loss=0.273678 mse_soft=0.273242 ent_in=1.1444 ent_out=0.3089 rowmax_in=0.4970 rowmax_out=0.8525 discrete_mse=877.229797 best_discrete=54.116962 hash=False elapsed=35.6s
step   450/900 tau=0.1735 loss=0.272076 mse_soft=0.271641 ent_in=1.1449 ent_out=0.3060 rowmax_in=0.4968 rowmax_out=0.8530 discrete_mse=1344.954224 best_discrete=54.116962 hash=False elapsed=37.7s
step   475/900 tau=0.1574 loss=0.278620 mse_soft=0.278186 ent_in=1.1442 ent_out=0.3020 rowmax_in=0.4964 rowmax_out=0.8538 discrete_mse=888.184998 best_discrete=54.116962 hash=False elapsed=39.8s
step   500/900 tau=0.1428 loss=0.279491 mse_soft=0.279062 ent_in=1.1395 ent_out=0.2919 rowmax_in=0.4926 rowmax_out=0.8578 discrete_mse=1691.827515 best_discrete=54.116962 hash=False elapsed=41.7s
step   525/900 tau=0.1295 loss=0.271642 mse_soft=0.271218 ent_in=1.1326 ent_out=0.2811 rowmax_in=0.4923 rowmax_out=0.8611 discrete_mse=1691.827515 best_discrete=54.116962 hash=False elapsed=43.5s
step   550/900 tau=0.1175 loss=0.283758 mse_soft=0.283335 ent_in=1.1320 ent_out=0.2770 rowmax_in=0.4921 rowmax_out=0.8590 discrete_mse=861.093567 best_discrete=54.116962 hash=False elapsed=45.4s
step   575/900 tau=0.1066 loss=0.276834 mse_soft=0.276421 ent_in=1.1073 ent_out=0.2707 rowmax_in=0.4978 rowmax_out=0.8648 discrete_mse=252.440170 best_discrete=54.116962 hash=False elapsed=47.3s
step   600/900 tau=0.0967 loss=0.285001 mse_soft=0.284586 ent_in=1.1133 ent_out=0.2701 rowmax_in=0.4918 rowmax_out=0.8614 discrete_mse=433.717041 best_discrete=54.116962 hash=False elapsed=49.2s
step   625/900 tau=0.0877 loss=0.289254 mse_soft=0.288867 ent_in=1.0631 ent_out=0.2259 rowmax_in=0.5235 rowmax_out=0.8832 discrete_mse=573.945984 best_discrete=54.116962 hash=False elapsed=51.0s
step   650/900 tau=0.0795 loss=0.282963 mse_soft=0.282587 ent_in=1.0385 ent_out=0.2151 rowmax_in=0.5331 rowmax_out=0.8948 discrete_mse=231.343414 best_discrete=54.116962 hash=False elapsed=53.0s
step   675/900 tau=0.0722 loss=0.275848 mse_soft=0.275476 ent_in=1.0246 ent_out=0.2158 rowmax_in=0.5420 rowmax_out=0.8895 discrete_mse=361.125183 best_discrete=54.116962 hash=False elapsed=54.9s
step   700/900 tau=0.0655 loss=0.288151 mse_soft=0.287799 ent_in=0.9640 ent_out=0.2083 rowmax_in=0.5706 rowmax_out=0.8979 discrete_mse=303.412781 best_discrete=54.116962 hash=False elapsed=56.9s
step   725/900 tau=0.0594 loss=0.279852 mse_soft=0.279506 ent_in=0.9500 ent_out=0.2043 rowmax_in=0.5707 rowmax_out=0.9002 discrete_mse=406.155304 best_discrete=54.116962 hash=False elapsed=58.9s
step   750/900 tau=0.0539 loss=0.308321 mse_soft=0.308003 ent_in=0.8458 ent_out=0.2136 rowmax_in=0.5990 rowmax_out=0.8866 discrete_mse=72.029739 best_discrete=54.116962 hash=False elapsed=60.7s
step   775/900 tau=0.0489 loss=0.310038 mse_soft=0.309725 ent_in=0.8311 ent_out=0.2133 rowmax_in=0.6037 rowmax_out=0.8889 discrete_mse=61.640244 best_discrete=54.116962 hash=False elapsed=62.5s
step   800/900 tau=0.0443 loss=0.328397 mse_soft=0.328100 ent_in=0.7889 ent_out=0.2010 rowmax_in=0.6227 rowmax_out=0.8989 discrete_mse=30.876537 best_discrete=30.876537 hash=False elapsed=64.4s
step   825/900 tau=0.0402 loss=0.398496 mse_soft=0.398293 ent_in=0.5243 ent_out=0.1505 rowmax_in=0.7648 rowmax_out=0.9274 discrete_mse=11.360269 best_discrete=11.360269 hash=False elapsed=66.3s
step   850/900 tau=0.0365 loss=0.348564 mse_soft=0.348347 ent_in=0.5474 ent_out=0.1769 rowmax_in=0.7463 rowmax_out=0.9059 discrete_mse=22.814850 best_discrete=11.360269 hash=False elapsed=68.5s
step   875/900 tau=0.0331 loss=0.404909 mse_soft=0.404728 ent_in=0.4606 ent_out=0.1427 rowmax_in=0.7655 rowmax_out=0.9285 discrete_mse=30.889261 best_discrete=11.360269 hash=False elapsed=70.7s
step   900/900 tau=0.0300 loss=0.399298 mse_soft=0.399145 ent_in=0.3814 ent_out=0.1268 rowmax_in=0.8127 rowmax_out=0.9276 discrete_mse=2.080204 best_discrete=2.080204 hash=False elapsed=72.7s

Final metrics:
  soft_mse_full=0.392284
  rowmax_in_mean=0.8031
  rowmax_out_mean=0.9265
  ent_in_mean=0.3905
  ent_out_mean=0.1301
  final_discrete_mse=27.060743
  hash_match=False
  best_discrete_mse_seen=2.080204
Saved results to overnight_b024_j1.json
