Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.047364 mse_soft=1.045042 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=30.325150 best_discrete=30.325150 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.851368 mse_soft=0.849178 ent_in=3.6338 ent_out=3.6682 rowmax_in=0.0453 rowmax_out=0.0448 discrete_mse=1066.435303 best_discrete=30.325150 hash=False elapsed=2.5s
step    50/900 tau=0.8260 loss=0.643735 mse_soft=0.641826 ent_in=3.1295 ent_out=3.2314 rowmax_in=0.0935 rowmax_out=0.0880 discrete_mse=2390.201904 best_discrete=30.325150 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.506813 mse_soft=0.505216 ent_in=2.6263 ent_out=2.6972 rowmax_in=0.1990 rowmax_out=0.1957 discrete_mse=105.818512 best_discrete=30.325150 hash=False elapsed=7.1s
step   100/900 tau=0.6797 loss=0.397860 mse_soft=0.396668 ent_in=2.0610 ent_out=1.9124 rowmax_in=0.3375 rowmax_out=0.3949 discrete_mse=72.494560 best_discrete=30.325150 hash=False elapsed=9.3s
step   125/900 tau=0.6165 loss=0.343833 mse_soft=0.342972 ent_in=1.6745 ent_out=1.1979 rowmax_in=0.4195 rowmax_out=0.6155 discrete_mse=1086.548340 best_discrete=30.325150 hash=False elapsed=11.4s
step   150/900 tau=0.5592 loss=0.313006 mse_soft=0.312316 ent_in=1.4542 ent_out=0.8463 rowmax_in=0.4617 rowmax_out=0.7186 discrete_mse=462.976196 best_discrete=30.325150 hash=False elapsed=13.5s
step   175/900 tau=0.5073 loss=0.297389 mse_soft=0.296785 ent_in=1.3374 ent_out=0.6752 rowmax_in=0.4803 rowmax_out=0.7601 discrete_mse=293.726807 best_discrete=30.325150 hash=False elapsed=15.5s
step   200/900 tau=0.4602 loss=0.290343 mse_soft=0.289792 ent_in=1.2683 ent_out=0.5703 rowmax_in=0.4902 rowmax_out=0.7826 discrete_mse=125.435875 best_discrete=30.325150 hash=False elapsed=17.7s
step   225/900 tau=0.4174 loss=0.286638 mse_soft=0.286111 ent_in=1.2372 ent_out=0.5204 rowmax_in=0.4931 rowmax_out=0.7920 discrete_mse=20.856783 best_discrete=20.856783 hash=False elapsed=19.9s
step   250/900 tau=0.3786 loss=0.284727 mse_soft=0.284220 ent_in=1.2063 ent_out=0.4831 rowmax_in=0.4994 rowmax_out=0.8016 discrete_mse=28.371496 best_discrete=20.856783 hash=False elapsed=22.3s
step   275/900 tau=0.3434 loss=0.284150 mse_soft=0.283655 ent_in=1.1900 ent_out=0.4596 rowmax_in=0.5006 rowmax_out=0.8054 discrete_mse=108.366188 best_discrete=20.856783 hash=False elapsed=24.5s
step   300/900 tau=0.3115 loss=0.280742 mse_soft=0.280259 ent_in=1.1757 ent_out=0.4361 rowmax_in=0.5021 rowmax_out=0.8118 discrete_mse=45.939960 best_discrete=20.856783 hash=False elapsed=26.7s
step   325/900 tau=0.2826 loss=0.280195 mse_soft=0.279718 ent_in=1.1658 ent_out=0.4243 rowmax_in=0.5018 rowmax_out=0.8114 discrete_mse=85.071358 best_discrete=20.856783 hash=False elapsed=29.0s
step   350/900 tau=0.2563 loss=0.278355 mse_soft=0.277884 ent_in=1.1523 ent_out=0.4167 rowmax_in=0.5037 rowmax_out=0.8093 discrete_mse=115.186821 best_discrete=20.856783 hash=False elapsed=31.3s
step   375/900 tau=0.2325 loss=0.277211 mse_soft=0.276746 ent_in=1.1411 ent_out=0.4106 rowmax_in=0.5058 rowmax_out=0.8060 discrete_mse=54.596748 best_discrete=20.856783 hash=False elapsed=33.7s
step   400/900 tau=0.2109 loss=0.276965 mse_soft=0.276504 ent_in=1.1294 ent_out=0.4052 rowmax_in=0.5099 rowmax_out=0.8057 discrete_mse=48.894798 best_discrete=20.856783 hash=False elapsed=35.7s
step   425/900 tau=0.1913 loss=0.276409 mse_soft=0.275954 ent_in=1.1210 ent_out=0.3960 rowmax_in=0.5120 rowmax_out=0.8090 discrete_mse=295.554108 best_discrete=20.856783 hash=False elapsed=37.9s
step   450/900 tau=0.1735 loss=0.274117 mse_soft=0.273664 ent_in=1.1092 ent_out=0.3981 rowmax_in=0.5158 rowmax_out=0.8057 discrete_mse=96.881271 best_discrete=20.856783 hash=False elapsed=40.2s
step   475/900 tau=0.1574 loss=0.277592 mse_soft=0.277142 ent_in=1.1008 ent_out=0.3966 rowmax_in=0.5171 rowmax_out=0.8053 discrete_mse=255.789566 best_discrete=20.856783 hash=False elapsed=42.4s
step   500/900 tau=0.1428 loss=0.277733 mse_soft=0.277290 ent_in=1.0883 ent_out=0.3894 rowmax_in=0.5183 rowmax_out=0.8116 discrete_mse=251.794922 best_discrete=20.856783 hash=False elapsed=44.6s
step   525/900 tau=0.1295 loss=0.272184 mse_soft=0.271742 ent_in=1.0826 ent_out=0.3883 rowmax_in=0.5201 rowmax_out=0.8123 discrete_mse=647.039856 best_discrete=20.856783 hash=False elapsed=47.1s
step   550/900 tau=0.1175 loss=0.274554 mse_soft=0.274118 ent_in=1.0749 ent_out=0.3776 rowmax_in=0.5195 rowmax_out=0.8156 discrete_mse=711.299805 best_discrete=20.856783 hash=False elapsed=49.3s
step   575/900 tau=0.1066 loss=0.275954 mse_soft=0.275523 ent_in=1.0679 ent_out=0.3672 rowmax_in=0.5208 rowmax_out=0.8194 discrete_mse=824.873962 best_discrete=20.856783 hash=False elapsed=51.4s
step   600/900 tau=0.0967 loss=0.277702 mse_soft=0.277272 ent_in=1.0699 ent_out=0.3650 rowmax_in=0.5185 rowmax_out=0.8168 discrete_mse=477.529724 best_discrete=20.856783 hash=False elapsed=53.7s
step   625/900 tau=0.0877 loss=0.291193 mse_soft=0.290763 ent_in=1.0656 ent_out=0.3648 rowmax_in=0.5175 rowmax_out=0.8188 discrete_mse=633.600586 best_discrete=20.856783 hash=False elapsed=56.0s
step   650/900 tau=0.0795 loss=0.318873 mse_soft=0.318448 ent_in=1.0510 ent_out=0.3649 rowmax_in=0.5232 rowmax_out=0.8159 discrete_mse=128.930801 best_discrete=20.856783 hash=False elapsed=58.1s
step   675/900 tau=0.0722 loss=0.284628 mse_soft=0.284224 ent_in=0.9848 ent_out=0.3609 rowmax_in=0.5376 rowmax_out=0.8169 discrete_mse=192.883621 best_discrete=20.856783 hash=False elapsed=60.1s
step   700/900 tau=0.0655 loss=0.305265 mse_soft=0.304873 ent_in=0.9644 ent_out=0.3400 rowmax_in=0.5592 rowmax_out=0.8371 discrete_mse=133.606918 best_discrete=20.856783 hash=False elapsed=62.2s
step   725/900 tau=0.0594 loss=0.317022 mse_soft=0.316667 ent_in=0.8953 ent_out=0.2884 rowmax_in=0.5809 rowmax_out=0.8560 discrete_mse=25.354815 best_discrete=20.856783 hash=False elapsed=64.2s
step   750/900 tau=0.0539 loss=0.352759 mse_soft=0.352502 ent_in=0.6208 ent_out=0.2358 rowmax_in=0.6927 rowmax_out=0.8873 discrete_mse=8.599397 best_discrete=8.599397 hash=False elapsed=66.4s
step   775/900 tau=0.0489 loss=0.330969 mse_soft=0.330717 ent_in=0.5813 ent_out=0.2576 rowmax_in=0.7180 rowmax_out=0.8652 discrete_mse=11.021744 best_discrete=8.599397 hash=False elapsed=68.5s
step   800/900 tau=0.0443 loss=0.356291 mse_soft=0.356072 ent_in=0.5064 ent_out=0.2252 rowmax_in=0.7531 rowmax_out=0.8828 discrete_mse=20.995674 best_discrete=8.599397 hash=False elapsed=70.6s
step   825/900 tau=0.0402 loss=0.337220 mse_soft=0.337001 ent_in=0.5073 ent_out=0.2233 rowmax_in=0.7436 rowmax_out=0.8841 discrete_mse=10.918653 best_discrete=8.599397 hash=False elapsed=72.7s
step   850/900 tau=0.0365 loss=0.337857 mse_soft=0.337638 ent_in=0.4984 ent_out=0.2318 rowmax_in=0.7434 rowmax_out=0.8826 discrete_mse=14.595694 best_discrete=8.599397 hash=False elapsed=74.7s
step   875/900 tau=0.0331 loss=0.337619 mse_soft=0.337395 ent_in=0.5213 ent_out=0.2254 rowmax_in=0.7247 rowmax_out=0.8854 discrete_mse=51.013100 best_discrete=8.599397 hash=False elapsed=76.9s
step   900/900 tau=0.0300 loss=0.340717 mse_soft=0.340504 ent_in=0.4866 ent_out=0.2256 rowmax_in=0.7403 rowmax_out=0.8709 discrete_mse=48.659744 best_discrete=8.599397 hash=False elapsed=79.2s

Final metrics:
  soft_mse_full=0.347561
  rowmax_in_mean=0.7358
  rowmax_out_mean=0.8707
  ent_in_mean=0.4913
  ent_out_mean=0.2283
  final_discrete_mse=42.654297
  hash_match=False
  best_discrete_mse_seen=8.599397
Saved results to overnight_b118_j1.json
