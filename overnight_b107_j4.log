Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.015
step     1/700 tau=1.0000 loss=1.064182 mse_soft=1.063407 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=51.227661 best_discrete=51.227661 hash=False elapsed=0.5s
step    25/700 tau=0.8810 loss=0.972116 mse_soft=0.971356 ent_in=3.7934 ent_out=3.8054 rowmax_in=0.0331 rowmax_out=0.0323 discrete_mse=1162.206787 best_discrete=51.227661 hash=False elapsed=2.4s
step    50/700 tau=0.7721 loss=0.786957 mse_soft=0.786249 ent_in=3.5166 ent_out=3.5664 rowmax_in=0.0570 rowmax_out=0.0538 discrete_mse=1831.564575 best_discrete=51.227661 hash=False elapsed=4.6s
step    75/700 tau=0.6767 loss=0.641500 mse_soft=0.640864 ent_in=3.1270 ent_out=3.2307 rowmax_in=0.0969 rowmax_out=0.0914 discrete_mse=2796.042725 best_discrete=51.227661 hash=False elapsed=6.9s
step   100/700 tau=0.5931 loss=0.532766 mse_soft=0.532214 ent_in=2.7034 ent_out=2.8221 rowmax_in=0.1848 rowmax_out=0.1693 discrete_mse=2076.389404 best_discrete=51.227661 hash=False elapsed=9.3s
step   125/700 tau=0.5198 loss=0.431892 mse_soft=0.431465 ent_in=2.1452 ent_out=2.1301 rowmax_in=0.3129 rowmax_out=0.3380 discrete_mse=2090.752441 best_discrete=51.227661 hash=False elapsed=11.5s
step   150/700 tau=0.4555 loss=0.358353 mse_soft=0.358041 ent_in=1.7058 ent_out=1.4213 rowmax_in=0.4166 rowmax_out=0.5417 discrete_mse=1359.061157 best_discrete=51.227661 hash=False elapsed=13.8s
step   175/700 tau=0.3992 loss=0.320392 mse_soft=0.320154 ent_in=1.4404 ent_out=0.9445 rowmax_in=0.4818 rowmax_out=0.6759 discrete_mse=1021.207458 best_discrete=51.227661 hash=False elapsed=16.0s
step   200/700 tau=0.3499 loss=0.302687 mse_soft=0.302491 ent_in=1.3105 ent_out=0.6457 rowmax_in=0.5010 rowmax_out=0.7585 discrete_mse=388.517853 best_discrete=51.227661 hash=False elapsed=18.3s
step   225/700 tau=0.3066 loss=0.293522 mse_soft=0.293350 ent_in=1.2277 ent_out=0.4863 rowmax_in=0.5140 rowmax_out=0.8065 discrete_mse=92.483391 best_discrete=51.227661 hash=False elapsed=20.8s
step   250/700 tau=0.2687 loss=0.289410 mse_soft=0.289250 ent_in=1.1775 ent_out=0.4200 rowmax_in=0.5180 rowmax_out=0.8245 discrete_mse=322.966949 best_discrete=51.227661 hash=False elapsed=22.9s
step   275/700 tau=0.2355 loss=0.289829 mse_soft=0.289676 ent_in=1.1528 ent_out=0.3772 rowmax_in=0.5173 rowmax_out=0.8375 discrete_mse=887.477966 best_discrete=51.227661 hash=False elapsed=25.2s
step   300/700 tau=0.2064 loss=0.286057 mse_soft=0.285908 ent_in=1.1358 ent_out=0.3494 rowmax_in=0.5203 rowmax_out=0.8449 discrete_mse=817.853394 best_discrete=51.227661 hash=False elapsed=27.5s
step   325/700 tau=0.1809 loss=0.284596 mse_soft=0.284450 ent_in=1.1219 ent_out=0.3374 rowmax_in=0.5226 rowmax_out=0.8473 discrete_mse=441.189697 best_discrete=51.227661 hash=False elapsed=30.0s
step   350/700 tau=0.1585 loss=0.284670 mse_soft=0.284526 ent_in=1.1115 ent_out=0.3269 rowmax_in=0.5235 rowmax_out=0.8491 discrete_mse=441.189697 best_discrete=51.227661 hash=False elapsed=32.2s
step   375/700 tau=0.1389 loss=0.283320 mse_soft=0.283178 ent_in=1.0994 ent_out=0.3213 rowmax_in=0.5247 rowmax_out=0.8494 discrete_mse=273.429932 best_discrete=51.227661 hash=False elapsed=34.5s
step   400/700 tau=0.1218 loss=0.282740 mse_soft=0.282600 ent_in=1.0843 ent_out=0.3113 rowmax_in=0.5279 rowmax_out=0.8521 discrete_mse=233.226517 best_discrete=51.227661 hash=False elapsed=36.7s
step   425/700 tau=0.1067 loss=0.285518 mse_soft=0.285380 ent_in=1.0731 ent_out=0.3007 rowmax_in=0.5330 rowmax_out=0.8566 discrete_mse=131.951370 best_discrete=51.227661 hash=False elapsed=38.7s
step   450/700 tau=0.0935 loss=0.282455 mse_soft=0.282319 ent_in=1.0657 ent_out=0.2994 rowmax_in=0.5329 rowmax_out=0.8548 discrete_mse=131.951370 best_discrete=51.227661 hash=False elapsed=40.9s
step   475/700 tau=0.0820 loss=0.284716 mse_soft=0.284581 ent_in=1.0545 ent_out=0.2901 rowmax_in=0.5395 rowmax_out=0.8610 discrete_mse=156.328949 best_discrete=51.227661 hash=False elapsed=43.2s
step   500/700 tau=0.0718 loss=0.287633 mse_soft=0.287501 ent_in=1.0443 ent_out=0.2805 rowmax_in=0.5406 rowmax_out=0.8646 discrete_mse=433.799377 best_discrete=51.227661 hash=False elapsed=45.5s
step   525/700 tau=0.0630 loss=0.293394 mse_soft=0.293262 ent_in=1.0395 ent_out=0.2725 rowmax_in=0.5379 rowmax_out=0.8687 discrete_mse=135.484116 best_discrete=51.227661 hash=False elapsed=47.9s
step   550/700 tau=0.0552 loss=0.284508 mse_soft=0.284379 ent_in=1.0247 ent_out=0.2638 rowmax_in=0.5422 rowmax_out=0.8779 discrete_mse=135.484116 best_discrete=51.227661 hash=False elapsed=50.0s
step   575/700 tau=0.0484 loss=0.313414 mse_soft=0.313285 ent_in=1.0264 ent_out=0.2641 rowmax_in=0.5384 rowmax_out=0.8738 discrete_mse=66.811409 best_discrete=51.227661 hash=False elapsed=52.2s
step   600/700 tau=0.0424 loss=0.290913 mse_soft=0.290796 ent_in=0.9350 ent_out=0.2313 rowmax_in=0.5703 rowmax_out=0.8843 discrete_mse=221.460388 best_discrete=51.227661 hash=False elapsed=54.3s
step   625/700 tau=0.0371 loss=0.288434 mse_soft=0.288318 ent_in=0.9352 ent_out=0.2285 rowmax_in=0.5708 rowmax_out=0.8883 discrete_mse=263.411652 best_discrete=51.227661 hash=False elapsed=56.6s
step   650/700 tau=0.0325 loss=0.288024 mse_soft=0.287908 ent_in=0.9339 ent_out=0.2254 rowmax_in=0.5664 rowmax_out=0.8898 discrete_mse=246.608841 best_discrete=51.227661 hash=False elapsed=58.8s
step   675/700 tau=0.0285 loss=0.314866 mse_soft=0.314761 ent_in=0.8421 ent_out=0.2089 rowmax_in=0.6100 rowmax_out=0.8942 discrete_mse=150.212234 best_discrete=51.227661 hash=False elapsed=61.1s
step   700/700 tau=0.0250 loss=0.375522 mse_soft=0.375445 ent_in=0.6140 ent_out=0.1528 rowmax_in=0.6964 rowmax_out=0.9191 discrete_mse=8.107643 best_discrete=8.107643 hash=False elapsed=63.4s

Final metrics:
  soft_mse_full=0.376453
  rowmax_in_mean=0.6852
  rowmax_out_mean=0.9220
  ent_in_mean=0.6143
  ent_out_mean=0.1488
  final_discrete_mse=10.540161
  hash_match=False
  best_discrete_mse_seen=8.107643
Saved results to overnight_b107_j4.json
