Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.063489 mse_soft=1.061166 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=44.603863 best_discrete=44.603863 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.855447 mse_soft=0.853257 ent_in=3.6333 ent_out=3.6672 rowmax_in=0.0467 rowmax_out=0.0443 discrete_mse=979.422363 best_discrete=44.603863 hash=False elapsed=2.5s
step    50/900 tau=0.8260 loss=0.628750 mse_soft=0.626849 ent_in=3.1223 ent_out=3.2165 rowmax_in=0.0950 rowmax_out=0.0881 discrete_mse=7322.878906 best_discrete=44.603863 hash=False elapsed=4.5s
step    75/900 tau=0.7493 loss=0.493326 mse_soft=0.491742 ent_in=2.5944 ent_out=2.6868 rowmax_in=0.2044 rowmax_out=0.1920 discrete_mse=688.767639 best_discrete=44.603863 hash=False elapsed=6.6s
step   100/900 tau=0.6797 loss=0.395544 mse_soft=0.394367 ent_in=2.0085 ent_out=1.9149 rowmax_in=0.3506 rowmax_out=0.3988 discrete_mse=2756.773438 best_discrete=44.603863 hash=False elapsed=8.6s
step   125/900 tau=0.6165 loss=0.333028 mse_soft=0.332178 ent_in=1.6082 ent_out=1.2247 rowmax_in=0.4271 rowmax_out=0.6101 discrete_mse=225.325989 best_discrete=44.603863 hash=False elapsed=11.0s
step   150/900 tau=0.5592 loss=0.305461 mse_soft=0.304793 ent_in=1.4108 ent_out=0.8155 rowmax_in=0.4746 rowmax_out=0.7268 discrete_mse=91.735779 best_discrete=44.603863 hash=False elapsed=13.1s
step   175/900 tau=0.5073 loss=0.292459 mse_soft=0.291878 ent_in=1.3345 ent_out=0.6026 rowmax_in=0.4863 rowmax_out=0.7835 discrete_mse=115.772850 best_discrete=44.603863 hash=False elapsed=15.1s
step   200/900 tau=0.4602 loss=0.286224 mse_soft=0.285686 ent_in=1.2879 ent_out=0.5044 rowmax_in=0.4900 rowmax_out=0.8105 discrete_mse=186.032776 best_discrete=44.603863 hash=False elapsed=17.2s
step   225/900 tau=0.4174 loss=0.283158 mse_soft=0.282647 ent_in=1.2553 ent_out=0.4502 rowmax_in=0.4917 rowmax_out=0.8246 discrete_mse=80.885071 best_discrete=44.603863 hash=False elapsed=19.1s
step   250/900 tau=0.3786 loss=0.277741 mse_soft=0.277252 ent_in=1.2225 ent_out=0.4103 rowmax_in=0.4930 rowmax_out=0.8388 discrete_mse=535.988953 best_discrete=44.603863 hash=False elapsed=21.4s
step   275/900 tau=0.3434 loss=0.276660 mse_soft=0.276181 ent_in=1.2055 ent_out=0.3890 rowmax_in=0.4970 rowmax_out=0.8445 discrete_mse=402.125427 best_discrete=44.603863 hash=False elapsed=23.4s
step   300/900 tau=0.3115 loss=0.276347 mse_soft=0.275875 ent_in=1.1980 ent_out=0.3765 rowmax_in=0.4983 rowmax_out=0.8470 discrete_mse=402.125427 best_discrete=44.603863 hash=False elapsed=25.5s
step   325/900 tau=0.2826 loss=0.272210 mse_soft=0.271745 ent_in=1.1840 ent_out=0.3680 rowmax_in=0.5028 rowmax_out=0.8490 discrete_mse=401.527405 best_discrete=44.603863 hash=False elapsed=27.5s
step   350/900 tau=0.2563 loss=0.275769 mse_soft=0.275309 ent_in=1.1756 ent_out=0.3594 rowmax_in=0.5046 rowmax_out=0.8513 discrete_mse=556.128357 best_discrete=44.603863 hash=False elapsed=29.7s
step   375/900 tau=0.2325 loss=0.272148 mse_soft=0.271691 ent_in=1.1713 ent_out=0.3518 rowmax_in=0.5049 rowmax_out=0.8533 discrete_mse=556.128357 best_discrete=44.603863 hash=False elapsed=32.0s
step   400/900 tau=0.2109 loss=0.272755 mse_soft=0.272301 ent_in=1.1689 ent_out=0.3444 rowmax_in=0.5046 rowmax_out=0.8555 discrete_mse=556.128357 best_discrete=44.603863 hash=False elapsed=34.0s
step   425/900 tau=0.1913 loss=0.270510 mse_soft=0.270059 ent_in=1.1674 ent_out=0.3380 rowmax_in=0.5079 rowmax_out=0.8573 discrete_mse=556.128357 best_discrete=44.603863 hash=False elapsed=36.2s
step   450/900 tau=0.1735 loss=0.272548 mse_soft=0.272099 ent_in=1.1654 ent_out=0.3324 rowmax_in=0.5056 rowmax_out=0.8580 discrete_mse=401.527405 best_discrete=44.603863 hash=False elapsed=38.2s
step   475/900 tau=0.1574 loss=0.279638 mse_soft=0.279191 ent_in=1.1595 ent_out=0.3297 rowmax_in=0.5060 rowmax_out=0.8577 discrete_mse=401.527405 best_discrete=44.603863 hash=False elapsed=40.3s
step   500/900 tau=0.1428 loss=0.292781 mse_soft=0.292335 ent_in=1.1572 ent_out=0.3314 rowmax_in=0.5071 rowmax_out=0.8551 discrete_mse=85.611870 best_discrete=44.603863 hash=False elapsed=42.4s
step   525/900 tau=0.1295 loss=0.276207 mse_soft=0.275761 ent_in=1.1562 ent_out=0.3287 rowmax_in=0.5065 rowmax_out=0.8549 discrete_mse=130.261246 best_discrete=44.603863 hash=False elapsed=44.6s
step   550/900 tau=0.1175 loss=0.293724 mse_soft=0.293281 ent_in=1.1409 ent_out=0.3335 rowmax_in=0.5075 rowmax_out=0.8480 discrete_mse=271.111755 best_discrete=44.603863 hash=False elapsed=46.8s
step   575/900 tau=0.1066 loss=0.289836 mse_soft=0.289400 ent_in=1.1266 ent_out=0.3250 rowmax_in=0.5089 rowmax_out=0.8498 discrete_mse=191.665863 best_discrete=44.603863 hash=False elapsed=48.9s
step   600/900 tau=0.0967 loss=0.274341 mse_soft=0.273908 ent_in=1.1249 ent_out=0.3179 rowmax_in=0.5104 rowmax_out=0.8524 discrete_mse=206.406555 best_discrete=44.603863 hash=False elapsed=50.9s
step   625/900 tau=0.0877 loss=0.288015 mse_soft=0.287583 ent_in=1.1172 ent_out=0.3221 rowmax_in=0.5136 rowmax_out=0.8490 discrete_mse=314.809906 best_discrete=44.603863 hash=False elapsed=52.9s
step   650/900 tau=0.0795 loss=0.292695 mse_soft=0.292279 ent_in=1.0554 ent_out=0.3282 rowmax_in=0.5402 rowmax_out=0.8465 discrete_mse=73.323311 best_discrete=44.603863 hash=False elapsed=54.9s
step   675/900 tau=0.0722 loss=0.298829 mse_soft=0.298414 ent_in=1.0521 ent_out=0.3323 rowmax_in=0.5313 rowmax_out=0.8398 discrete_mse=466.977478 best_discrete=44.603863 hash=False elapsed=56.9s
step   700/900 tau=0.0655 loss=0.284230 mse_soft=0.283814 ent_in=1.0483 ent_out=0.3386 rowmax_in=0.5288 rowmax_out=0.8321 discrete_mse=485.650574 best_discrete=44.603863 hash=False elapsed=59.0s
step   725/900 tau=0.0594 loss=0.289875 mse_soft=0.289464 ent_in=1.0356 ent_out=0.3340 rowmax_in=0.5382 rowmax_out=0.8316 discrete_mse=364.624329 best_discrete=44.603863 hash=False elapsed=60.9s
step   750/900 tau=0.0539 loss=0.332243 mse_soft=0.331908 ent_in=0.8637 ent_out=0.2522 rowmax_in=0.5857 rowmax_out=0.8707 discrete_mse=27.049618 best_discrete=27.049618 hash=False elapsed=63.1s
step   775/900 tau=0.0489 loss=0.300079 mse_soft=0.299748 ent_in=0.8346 ent_out=0.2684 rowmax_in=0.5993 rowmax_out=0.8470 discrete_mse=205.953918 best_discrete=27.049618 hash=False elapsed=65.3s
step   800/900 tau=0.0443 loss=0.295670 mse_soft=0.295344 ent_in=0.8332 ent_out=0.2553 rowmax_in=0.6013 rowmax_out=0.8567 discrete_mse=128.618500 best_discrete=27.049618 hash=False elapsed=67.3s
step   825/900 tau=0.0402 loss=0.298631 mse_soft=0.298305 ent_in=0.8323 ent_out=0.2534 rowmax_in=0.6044 rowmax_out=0.8583 discrete_mse=200.904388 best_discrete=27.049618 hash=False elapsed=69.4s
step   850/900 tau=0.0365 loss=0.308850 mse_soft=0.308527 ent_in=0.8227 ent_out=0.2551 rowmax_in=0.6040 rowmax_out=0.8558 discrete_mse=134.576996 best_discrete=27.049618 hash=False elapsed=71.4s
step   875/900 tau=0.0331 loss=0.659189 mse_soft=0.659013 ent_in=0.4085 ent_out=0.1798 rowmax_in=0.8171 rowmax_out=0.9048 discrete_mse=12.688245 best_discrete=12.688245 hash=False elapsed=73.4s
step   900/900 tau=0.0300 loss=0.542597 mse_soft=0.542496 ent_in=0.2331 ent_out=0.1043 rowmax_in=0.8723 rowmax_out=0.9423 discrete_mse=10.716244 best_discrete=10.716244 hash=False elapsed=75.3s

Final metrics:
  soft_mse_full=0.564158
  rowmax_in_mean=0.8722
  rowmax_out_mean=0.9423
  ent_in_mean=0.2325
  ent_out_mean=0.1045
  final_discrete_mse=2.237900
  hash_match=False
  best_discrete_mse_seen=10.716244
Saved results to sinkhorn_par5.json
