Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.054766 mse_soft=1.052443 ent_in=3.8711 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=335.389130 best_discrete=335.389130 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.849345 mse_soft=0.847155 ent_in=3.6324 ent_out=3.6675 rowmax_in=0.0461 rowmax_out=0.0441 discrete_mse=6031.335938 best_discrete=335.389130 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.638097 mse_soft=0.636186 ent_in=3.1325 ent_out=3.2374 rowmax_in=0.0926 rowmax_out=0.0835 discrete_mse=4295.172852 best_discrete=335.389130 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.510447 mse_soft=0.508845 ent_in=2.6215 ent_out=2.7163 rowmax_in=0.2000 rowmax_out=0.1933 discrete_mse=908.662598 best_discrete=335.389130 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.403408 mse_soft=0.402238 ent_in=2.0270 ent_out=1.8745 rowmax_in=0.3547 rowmax_out=0.4149 discrete_mse=238.144913 best_discrete=238.144913 hash=False elapsed=9.6s
step   125/900 tau=0.6165 loss=0.345854 mse_soft=0.344998 ent_in=1.6237 ent_out=1.2289 rowmax_in=0.4364 rowmax_out=0.6079 discrete_mse=59.812775 best_discrete=59.812775 hash=False elapsed=11.9s
step   150/900 tau=0.5592 loss=0.318218 mse_soft=0.317546 ent_in=1.4221 ent_out=0.8163 rowmax_in=0.4681 rowmax_out=0.7327 discrete_mse=222.524399 best_discrete=59.812775 hash=False elapsed=14.3s
step   175/900 tau=0.5073 loss=0.302718 mse_soft=0.302127 ent_in=1.3329 ent_out=0.6390 rowmax_in=0.4850 rowmax_out=0.7735 discrete_mse=280.799530 best_discrete=59.812775 hash=False elapsed=16.5s
step   200/900 tau=0.4602 loss=0.291245 mse_soft=0.290717 ent_in=1.2448 ent_out=0.5131 rowmax_in=0.5063 rowmax_out=0.7924 discrete_mse=1019.055054 best_discrete=59.812775 hash=False elapsed=18.9s
step   225/900 tau=0.4174 loss=0.284032 mse_soft=0.283536 ent_in=1.2093 ent_out=0.4445 rowmax_in=0.5128 rowmax_out=0.8051 discrete_mse=994.129395 best_discrete=59.812775 hash=False elapsed=21.3s
step   250/900 tau=0.3786 loss=0.280127 mse_soft=0.279649 ent_in=1.1957 ent_out=0.3968 rowmax_in=0.5145 rowmax_out=0.8208 discrete_mse=851.495178 best_discrete=59.812775 hash=False elapsed=23.5s
step   275/900 tau=0.3434 loss=0.277502 mse_soft=0.277038 ent_in=1.1837 ent_out=0.3630 rowmax_in=0.5143 rowmax_out=0.8328 discrete_mse=694.638306 best_discrete=59.812775 hash=False elapsed=25.9s
step   300/900 tau=0.3115 loss=0.272667 mse_soft=0.272216 ent_in=1.1672 ent_out=0.3358 rowmax_in=0.5163 rowmax_out=0.8459 discrete_mse=694.638306 best_discrete=59.812775 hash=False elapsed=28.1s
step   325/900 tau=0.2826 loss=0.272060 mse_soft=0.271619 ent_in=1.1513 ent_out=0.3196 rowmax_in=0.5177 rowmax_out=0.8486 discrete_mse=694.638306 best_discrete=59.812775 hash=False elapsed=30.4s
step   350/900 tau=0.2563 loss=0.269743 mse_soft=0.269310 ent_in=1.1392 ent_out=0.3049 rowmax_in=0.5186 rowmax_out=0.8562 discrete_mse=567.885559 best_discrete=59.812775 hash=False elapsed=32.6s
step   375/900 tau=0.2325 loss=0.274423 mse_soft=0.273994 ent_in=1.1345 ent_out=0.2954 rowmax_in=0.5188 rowmax_out=0.8593 discrete_mse=567.885559 best_discrete=59.812775 hash=False elapsed=34.9s
step   400/900 tau=0.2109 loss=0.271197 mse_soft=0.270770 ent_in=1.1350 ent_out=0.2886 rowmax_in=0.5188 rowmax_out=0.8600 discrete_mse=694.638306 best_discrete=59.812775 hash=False elapsed=37.2s
step   425/900 tau=0.1913 loss=0.268036 mse_soft=0.267613 ent_in=1.1303 ent_out=0.2786 rowmax_in=0.5215 rowmax_out=0.8649 discrete_mse=567.885559 best_discrete=59.812775 hash=False elapsed=39.6s
step   450/900 tau=0.1735 loss=0.273675 mse_soft=0.273257 ent_in=1.1232 ent_out=0.2699 rowmax_in=0.5222 rowmax_out=0.8687 discrete_mse=484.383789 best_discrete=59.812775 hash=False elapsed=41.9s
step   475/900 tau=0.1574 loss=0.267667 mse_soft=0.267250 ent_in=1.1190 ent_out=0.2691 rowmax_in=0.5226 rowmax_out=0.8656 discrete_mse=484.383789 best_discrete=59.812775 hash=False elapsed=44.0s
step   500/900 tau=0.1428 loss=0.275234 mse_soft=0.274829 ent_in=1.1034 ent_out=0.2466 rowmax_in=0.5280 rowmax_out=0.8820 discrete_mse=285.560181 best_discrete=59.812775 hash=False elapsed=46.2s
step   525/900 tau=0.1295 loss=0.275702 mse_soft=0.275300 ent_in=1.0936 ent_out=0.2477 rowmax_in=0.5284 rowmax_out=0.8782 discrete_mse=484.383789 best_discrete=59.812775 hash=False elapsed=48.5s
step   550/900 tau=0.1175 loss=0.274151 mse_soft=0.273753 ent_in=1.0886 ent_out=0.2384 rowmax_in=0.5317 rowmax_out=0.8805 discrete_mse=512.235535 best_discrete=59.812775 hash=False elapsed=50.9s
step   575/900 tau=0.1066 loss=0.284198 mse_soft=0.283797 ent_in=1.0910 ent_out=0.2461 rowmax_in=0.5282 rowmax_out=0.8710 discrete_mse=280.324738 best_discrete=59.812775 hash=False elapsed=53.1s
step   600/900 tau=0.0967 loss=0.283474 mse_soft=0.283083 ent_in=1.0784 ent_out=0.2248 rowmax_in=0.5310 rowmax_out=0.8808 discrete_mse=181.541077 best_discrete=59.812775 hash=False elapsed=55.3s
step   625/900 tau=0.0877 loss=0.283031 mse_soft=0.282644 ent_in=1.0673 ent_out=0.2225 rowmax_in=0.5330 rowmax_out=0.8809 discrete_mse=275.627289 best_discrete=59.812775 hash=False elapsed=57.5s
step   650/900 tau=0.0795 loss=0.281706 mse_soft=0.281334 ent_in=1.0220 ent_out=0.2197 rowmax_in=0.5582 rowmax_out=0.8823 discrete_mse=95.523659 best_discrete=59.812775 hash=False elapsed=59.9s
step   675/900 tau=0.0722 loss=0.302098 mse_soft=0.301741 ent_in=0.9847 ent_out=0.2067 rowmax_in=0.5639 rowmax_out=0.8884 discrete_mse=66.751465 best_discrete=59.812775 hash=False elapsed=62.3s
step   700/900 tau=0.0655 loss=0.288436 mse_soft=0.288096 ent_in=0.9506 ent_out=0.1828 rowmax_in=0.5764 rowmax_out=0.9061 discrete_mse=161.353165 best_discrete=59.812775 hash=False elapsed=64.7s
step   725/900 tau=0.0594 loss=0.327776 mse_soft=0.327452 ent_in=0.9106 ent_out=0.1696 rowmax_in=0.5867 rowmax_out=0.9142 discrete_mse=123.974907 best_discrete=59.812775 hash=False elapsed=66.8s
step   750/900 tau=0.0539 loss=0.399478 mse_soft=0.399214 ent_in=0.7538 ent_out=0.1254 rowmax_in=0.6644 rowmax_out=0.9313 discrete_mse=109.497200 best_discrete=59.812775 hash=False elapsed=69.1s
step   775/900 tau=0.0489 loss=0.425881 mse_soft=0.425703 ent_in=0.4724 ent_out=0.1201 rowmax_in=0.7778 rowmax_out=0.9310 discrete_mse=1.062570 best_discrete=1.062570 hash=False elapsed=71.3s
step   800/900 tau=0.0443 loss=0.366609 mse_soft=0.366427 ent_in=0.4861 ent_out=0.1194 rowmax_in=0.7578 rowmax_out=0.9321 discrete_mse=4.165033 best_discrete=1.062570 hash=False elapsed=73.5s
step   825/900 tau=0.0402 loss=0.358850 mse_soft=0.358664 ent_in=0.5060 ent_out=0.1151 rowmax_in=0.7437 rowmax_out=0.9350 discrete_mse=4.165033 best_discrete=1.062570 hash=False elapsed=75.6s
step   850/900 tau=0.0365 loss=0.357622 mse_soft=0.357432 ent_in=0.5173 ent_out=0.1156 rowmax_in=0.7364 rowmax_out=0.9346 discrete_mse=4.165033 best_discrete=1.062570 hash=False elapsed=77.9s
step   875/900 tau=0.0331 loss=0.350728 mse_soft=0.350534 ent_in=0.5298 ent_out=0.1147 rowmax_in=0.7266 rowmax_out=0.9348 discrete_mse=1.420716 best_discrete=1.062570 hash=False elapsed=80.2s
step   900/900 tau=0.0300 loss=0.367982 mse_soft=0.367798 ent_in=0.4965 ent_out=0.1174 rowmax_in=0.7404 rowmax_out=0.9327 discrete_mse=10.371912 best_discrete=1.062570 hash=False elapsed=82.3s

Final metrics:
  soft_mse_full=0.383259
  rowmax_in_mean=0.7543
  rowmax_out_mean=0.9323
  ent_in_mean=0.4774
  ent_out_mean=0.1175
  final_discrete_mse=16.061443
  hash_match=False
  best_discrete_mse_seen=1.062570
Saved results to overnight_b195_j1.json
