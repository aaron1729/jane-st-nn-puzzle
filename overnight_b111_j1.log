Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.066382 mse_soft=1.064059 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=43.531322 best_discrete=43.531322 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.864404 mse_soft=0.862213 ent_in=3.6342 ent_out=3.6687 rowmax_in=0.0461 rowmax_out=0.0441 discrete_mse=649.962830 best_discrete=43.531322 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.644394 mse_soft=0.642485 ent_in=3.1335 ent_out=3.2276 rowmax_in=0.0960 rowmax_out=0.0885 discrete_mse=9790.801758 best_discrete=43.531322 hash=False elapsed=4.6s
step    75/900 tau=0.7493 loss=0.518119 mse_soft=0.516521 ent_in=2.6271 ent_out=2.6998 rowmax_in=0.1859 rowmax_out=0.1889 discrete_mse=1150.615601 best_discrete=43.531322 hash=False elapsed=6.9s
step   100/900 tau=0.6797 loss=0.407104 mse_soft=0.405936 ent_in=2.0061 ent_out=1.8871 rowmax_in=0.3490 rowmax_out=0.3920 discrete_mse=1447.100830 best_discrete=43.531322 hash=False elapsed=9.3s
step   125/900 tau=0.6165 loss=0.338964 mse_soft=0.338131 ent_in=1.5180 ent_out=1.2571 rowmax_in=0.4698 rowmax_out=0.5640 discrete_mse=851.798584 best_discrete=43.531322 hash=False elapsed=11.6s
step   150/900 tau=0.5592 loss=0.309526 mse_soft=0.308876 ent_in=1.3003 ent_out=0.8674 rowmax_in=0.5174 rowmax_out=0.6862 discrete_mse=315.808929 best_discrete=43.531322 hash=False elapsed=13.9s
step   175/900 tau=0.5073 loss=0.292994 mse_soft=0.292430 ent_in=1.2071 ent_out=0.6736 rowmax_in=0.5354 rowmax_out=0.7407 discrete_mse=71.606194 best_discrete=43.531322 hash=False elapsed=16.0s
step   200/900 tau=0.4602 loss=0.284921 mse_soft=0.284408 ent_in=1.1462 ent_out=0.5640 rowmax_in=0.5407 rowmax_out=0.7807 discrete_mse=153.633606 best_discrete=43.531322 hash=False elapsed=18.4s
step   225/900 tau=0.4174 loss=0.278296 mse_soft=0.277815 ent_in=1.1045 ent_out=0.4973 rowmax_in=0.5454 rowmax_out=0.8033 discrete_mse=68.106987 best_discrete=43.531322 hash=False elapsed=20.6s
step   250/900 tau=0.3786 loss=0.276044 mse_soft=0.275580 ent_in=1.0821 ent_out=0.4631 rowmax_in=0.5480 rowmax_out=0.8126 discrete_mse=16.765654 best_discrete=16.765654 hash=False elapsed=23.0s
step   275/900 tau=0.3434 loss=0.274992 mse_soft=0.274535 ent_in=1.0699 ent_out=0.4516 rowmax_in=0.5479 rowmax_out=0.8145 discrete_mse=68.106987 best_discrete=16.765654 hash=False elapsed=25.5s
step   300/900 tau=0.3115 loss=0.273238 mse_soft=0.272787 ent_in=1.0617 ent_out=0.4434 rowmax_in=0.5499 rowmax_out=0.8169 discrete_mse=27.786118 best_discrete=16.765654 hash=False elapsed=27.8s
step   325/900 tau=0.2826 loss=0.273372 mse_soft=0.272924 ent_in=1.0574 ent_out=0.4357 rowmax_in=0.5497 rowmax_out=0.8196 discrete_mse=28.331116 best_discrete=16.765654 hash=False elapsed=30.1s
step   350/900 tau=0.2563 loss=0.272628 mse_soft=0.272180 ent_in=1.0570 ent_out=0.4367 rowmax_in=0.5485 rowmax_out=0.8169 discrete_mse=42.333908 best_discrete=16.765654 hash=False elapsed=32.4s
step   375/900 tau=0.2325 loss=0.275377 mse_soft=0.274932 ent_in=1.0545 ent_out=0.4296 rowmax_in=0.5501 rowmax_out=0.8193 discrete_mse=42.333908 best_discrete=16.765654 hash=False elapsed=34.6s
step   400/900 tau=0.2109 loss=0.275030 mse_soft=0.274584 ent_in=1.0541 ent_out=0.4295 rowmax_in=0.5469 rowmax_out=0.8175 discrete_mse=42.333908 best_discrete=16.765654 hash=False elapsed=37.1s
step   425/900 tau=0.1913 loss=0.274090 mse_soft=0.273647 ent_in=1.0502 ent_out=0.4255 rowmax_in=0.5491 rowmax_out=0.8169 discrete_mse=42.333908 best_discrete=16.765654 hash=False elapsed=39.5s
step   450/900 tau=0.1735 loss=0.272928 mse_soft=0.272486 ent_in=1.0501 ent_out=0.4204 rowmax_in=0.5480 rowmax_out=0.8199 discrete_mse=42.333908 best_discrete=16.765654 hash=False elapsed=41.9s
step   475/900 tau=0.1574 loss=0.278850 mse_soft=0.278410 ent_in=1.0483 ent_out=0.4184 rowmax_in=0.5491 rowmax_out=0.8209 discrete_mse=42.333908 best_discrete=16.765654 hash=False elapsed=44.3s
step   500/900 tau=0.1428 loss=0.274313 mse_soft=0.273875 ent_in=1.0482 ent_out=0.4130 rowmax_in=0.5501 rowmax_out=0.8243 discrete_mse=72.882683 best_discrete=16.765654 hash=False elapsed=46.7s
step   525/900 tau=0.1295 loss=0.295430 mse_soft=0.294992 ent_in=1.0465 ent_out=0.4141 rowmax_in=0.5489 rowmax_out=0.8242 discrete_mse=72.882683 best_discrete=16.765654 hash=False elapsed=49.0s
step   550/900 tau=0.1175 loss=0.282299 mse_soft=0.281861 ent_in=1.0468 ent_out=0.4113 rowmax_in=0.5483 rowmax_out=0.8247 discrete_mse=26.839918 best_discrete=16.765654 hash=False elapsed=51.3s
step   575/900 tau=0.1066 loss=0.288256 mse_soft=0.287822 ent_in=1.0328 ent_out=0.4155 rowmax_in=0.5550 rowmax_out=0.8186 discrete_mse=22.015404 best_discrete=16.765654 hash=False elapsed=53.6s
step   600/900 tau=0.0967 loss=0.284703 mse_soft=0.284276 ent_in=1.0310 ent_out=0.3933 rowmax_in=0.5570 rowmax_out=0.8339 discrete_mse=24.383259 best_discrete=16.765654 hash=False elapsed=55.9s
step   625/900 tau=0.0877 loss=0.308491 mse_soft=0.308081 ent_in=0.9897 ent_out=0.3769 rowmax_in=0.5780 rowmax_out=0.8418 discrete_mse=155.291519 best_discrete=16.765654 hash=False elapsed=58.3s
step   650/900 tau=0.0795 loss=0.288169 mse_soft=0.287773 ent_in=0.9335 ent_out=0.3845 rowmax_in=0.5915 rowmax_out=0.8254 discrete_mse=5.410054 best_discrete=5.410054 hash=False elapsed=60.6s
step   675/900 tau=0.0722 loss=0.277967 mse_soft=0.277573 ent_in=0.9477 ent_out=0.3675 rowmax_in=0.5826 rowmax_out=0.8415 discrete_mse=176.367493 best_discrete=5.410054 hash=False elapsed=62.9s
step   700/900 tau=0.0655 loss=0.280857 mse_soft=0.280461 ent_in=0.9552 ent_out=0.3648 rowmax_in=0.5807 rowmax_out=0.8427 discrete_mse=176.367493 best_discrete=5.410054 hash=False elapsed=65.3s
step   725/900 tau=0.0594 loss=0.289642 mse_soft=0.289254 ent_in=0.9355 ent_out=0.3587 rowmax_in=0.5855 rowmax_out=0.8402 discrete_mse=10.864587 best_discrete=5.410054 hash=False elapsed=67.6s
step   750/900 tau=0.0539 loss=0.295956 mse_soft=0.295572 ent_in=0.9197 ent_out=0.3596 rowmax_in=0.5958 rowmax_out=0.8374 discrete_mse=143.306046 best_discrete=5.410054 hash=False elapsed=70.0s
step   775/900 tau=0.0489 loss=0.320165 mse_soft=0.319838 ent_in=0.7542 ent_out=0.3372 rowmax_in=0.6580 rowmax_out=0.8229 discrete_mse=135.135590 best_discrete=5.410054 hash=False elapsed=72.4s
step   800/900 tau=0.0443 loss=0.325394 mse_soft=0.325100 ent_in=0.6639 ent_out=0.3148 rowmax_in=0.6903 rowmax_out=0.8427 discrete_mse=56.361759 best_discrete=5.410054 hash=False elapsed=74.8s
step   825/900 tau=0.0402 loss=0.344565 mse_soft=0.344281 ent_in=0.6640 ent_out=0.2846 rowmax_in=0.6620 rowmax_out=0.8545 discrete_mse=43.894894 best_discrete=5.410054 hash=False elapsed=77.0s
step   850/900 tau=0.0365 loss=0.488842 mse_soft=0.488603 ent_in=0.5396 ent_out=0.2555 rowmax_in=0.7395 rowmax_out=0.8686 discrete_mse=26.449656 best_discrete=5.410054 hash=False elapsed=79.5s
step   875/900 tau=0.0331 loss=0.381794 mse_soft=0.381597 ent_in=0.4264 ent_out=0.2294 rowmax_in=0.7932 rowmax_out=0.8818 discrete_mse=90.487915 best_discrete=5.410054 hash=False elapsed=81.7s
step   900/900 tau=0.0300 loss=0.416803 mse_soft=0.416619 ent_in=0.4170 ent_out=0.1955 rowmax_in=0.7932 rowmax_out=0.8981 discrete_mse=129.330429 best_discrete=5.410054 hash=False elapsed=83.9s

Final metrics:
  soft_mse_full=0.429463
  rowmax_in_mean=0.7972
  rowmax_out_mean=0.8982
  ent_in_mean=0.4082
  ent_out_mean=0.1955
  final_discrete_mse=120.749832
  hash_match=False
  best_discrete_mse_seen=5.410054
Saved results to overnight_b111_j1.json
