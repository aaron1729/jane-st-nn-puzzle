Using device: cuda
Input X: mean L2 norm = 5.5153
         std  L2 norm = 0.5459

======================================================================
Full pairing matrix: mean( ||B(ReLU(A(x)))||₂ / ||x||₂ ) for all 48×48 combos
======================================================================

Ratio ||delta||/||x|| stats across all 2304 pairings:
  mean=0.28228  std=0.08294  min=0.10788  max=0.79276

||delta|| stats:
  mean=1.5469  std=0.4538  min=0.5958  max=4.3495

======================================================================
Per expand piece: ratio distribution and beam-found contract rank
======================================================================
 exp   min_ratio  mean_ratio   max_ratio  b10_con   b10_ratio  b10_rank  b200_con  b200_ratio  b200_rank
---------------------------------------------------------------------------------------------------------
   0     0.24408     0.30288     0.71538       76     0.28548        27        54     0.26533         15
   1     0.21965     0.27248     0.62444       24     0.24300        18        12     0.27125         33
   2     0.24145     0.30266     0.69969       66     0.26033        11        70     0.25205          2
   3     0.22501     0.28359     0.67026       53     0.26247        25        40     0.24534         11
   4     0.19570     0.25357     0.57524       19     0.22845        18        52     0.24689         30
   5     0.18202     0.23618     0.50665       20     0.20217         7        11     0.28612         40
  10     0.22318     0.28793     0.69435       21     0.24587         9        20     0.26323         22
  13     0.24449     0.30869     0.73134       75     0.34590        38        34     0.38632         42
  14     0.20620     0.26906     0.65219       17     0.22064         4         8     0.23658         17
  15     0.22821     0.28524     0.69295        9     0.22821         0        66     0.25619         20
  16     0.24779     0.31427     0.76690       54     0.29035        26        90     0.32683         35
  18     0.24612     0.31082     0.75844        6     0.38137        42        63     0.30489         30
  23     0.20828     0.26354     0.60213       57     0.24516        26        19     0.23237         16
  27     0.18845     0.23255     0.54069       67     0.19634         7        17     0.19082          4
  28     0.17845     0.22791     0.53270       47     0.23470        34        25     0.20945         25
  31     0.25918     0.33030     0.79276       36     0.35401        38        26     0.29251         18
  35     0.24090     0.30211     0.71734       12     0.28742        30        22     0.33756         38
  37     0.25704     0.32346     0.77571       40     0.28244        12        67     0.26993          6
  39     0.23028     0.30009     0.69387       90     0.31408        37        32     0.26353         12
  41     0.21801     0.27101     0.61804       46     0.23406        10        51     0.36747         45
  42     0.24015     0.32351     0.74436       92     0.27217         5        46     0.28090         13
  43     0.10788     0.13178     0.27888       11     0.15066        39        53     0.11705         16
  44     0.23712     0.29871     0.72287       70     0.24418         2         7     0.27912         25
  45     0.23465     0.30226     0.76379       32     0.27976        24        33     0.25476          8
  48     0.21432     0.26405     0.59574       38     0.22058         4         9     0.23283         14
  49     0.25811     0.32742     0.77757       93     0.77757        47        93     0.77757         47
  50     0.22263     0.27776     0.65750        7     0.27151        30        36     0.27925         35
  56     0.24187     0.30830     0.73661       80     0.26725        16        21     0.25411          4
  58     0.24527     0.31050     0.72218       78     0.44240        45        78     0.44240         45
  59     0.24989     0.31680     0.77926       79     0.26016         3        92     0.26610          6
  60     0.25229     0.31118     0.72941       29     0.27105        11        29     0.27105         11
  61     0.25016     0.31530     0.69870       30     0.28689        24        83     0.28188         21
  62     0.19979     0.25274     0.59065       25     0.23401        27        57     0.23272         23
  64     0.19379     0.24147     0.57318       83     0.21994        25        55     0.31059         43
  65     0.13581     0.16853     0.35780        8     0.14861        17        24     0.15665         26
  68     0.23259     0.29852     0.72833       26     0.26238        14        47     0.30989         36
  69     0.16350     0.20017     0.42674       52     0.19972        34        89     0.23645         40
  73     0.26185     0.32513     0.73513       72     0.44792        45        72     0.44792         45
  74     0.26284     0.32597     0.79070       96     0.26284         0        80     0.30013         28
  77     0.22768     0.29112     0.69373       89     0.27628        28        82     0.26156         21
  81     0.18075     0.23619     0.55086       51     0.33282        46        75     0.26609         38
  84     0.24483     0.30321     0.68901       63     0.31006        35        96     0.24483          0
  86     0.25436     0.31515     0.72533       82     0.29436        24        76     0.29092         22
  87     0.24217     0.30330     0.71721       71     0.28188        26        71     0.28188         26
  88     0.23745     0.29581     0.72735       22     0.32396        37        38     0.26450         17
  91     0.23562     0.30152     0.72358       34     0.35339        40        30     0.29187         32
  94     0.19756     0.24934     0.59207       55     0.32549        43         6     0.30896         42
  95     0.21614     0.27527     0.67859       33     0.23171         7        79     0.23110          5

Beam-10 contract rank stats (0=smallest ratio, 47=largest):
  mean=23.3  median=25  min=0  max=47
  How many in top-5: 6/48
  How many in top-10: 11/48

Beam-200 contract rank stats:
  mean=24.0  median=22  min=0  max=47
  How many in top-5: 4/48
  How many in top-10: 8/48

======================================================================
Beam pairings vs random pairings: ratio comparison
======================================================================
  Beam-10 pairings:  mean=0.28317  std=0.09373  min=0.14861  max=0.77757
  Beam-200 pairings: mean=0.28495  std=0.09190  min=0.11705  max=0.77757
  Shared (5 pairs):  mean=0.44416  vals=['0.2711', '0.2819', '0.4424', '0.4479', '0.7776']
  Random pairings:   mean=0.28228  std=0.08266  min=0.10788  max=0.79276

======================================================================
Sequential: ||delta|| / ||h|| through the network
======================================================================

  Beam-10:
    Pos  0 (87,71): ||delta||/||h||=0.2819 (max=0.495)  ||h||=5.515  ||delta||=1.5354
    Pos  1 (31,36): ||delta||/||h||=0.3221 (max=0.550)  ||h||=5.286  ||delta||=1.6899
    Pos  2 (58,78): ||delta||/||h||=0.3611 (max=0.773)  ||h||=5.205  ||delta||=1.8805
    Pos  3 (73,72): ||delta||/||h||=0.3152 (max=0.556)  ||h||=5.276  ||delta||=1.6627
    Pos  4 (18, 6): ||delta||/||h||=0.3698 (max=0.607)  ||h||=5.651  ||delta||=2.0866
    Pos  5 (49,93): ||delta||/||h||=0.4225 (max=0.706)  ||h||=6.608  ||delta||=2.7924
    Pos  6 (43,11): ||delta||/||h||=0.2682 (max=0.503)  ||h||=6.535  ||delta||=1.7564
    Pos  7 (95,33): ||delta||/||h||=0.3194 (max=0.499)  ||h||=7.097  ||delta||=2.2724
    Pos  8 (81,51): ||delta||/||h||=0.5645 (max=0.854)  ||h||=7.401  ||delta||=4.1951
    Pos  9 (68,26): ||delta||/||h||=0.2817 (max=0.421)  ||h||=9.078  ||delta||=2.5561
    Pos 10 (13,75): ||delta||/||h||=0.2812 (max=0.454)  ||h||=9.143  ||delta||=2.5778
    Pos 11 (94,55): ||delta||/||h||=0.5785 (max=0.747)  ||h||=10.052  ||delta||=5.8920
    Pos 12 ( 5,20): ||delta||/||h||=0.3596 (max=0.451)  ||h||=13.584  ||delta||=4.9388
    Pos 13 (60,29): ||delta||/||h||=0.1424 (max=0.258)  ||h||=15.248  ||delta||=2.1833
    Pos 14 (37,40): ||delta||/||h||=0.1888 (max=0.338)  ||h||=15.755  ||delta||=2.9665
    Pos 15 (10,21): ||delta||/||h||=0.2615 (max=0.346)  ||h||=16.148  ||delta||=4.2467
    Pos 16 (15, 9): ||delta||/||h||=0.3453 (max=0.465)  ||h||=16.005  ||delta||=5.5755
    Pos 17 (16,54): ||delta||/||h||=0.2782 (max=0.356)  ||h||=16.590  ||delta||=4.6390
    Pos 18 ( 4,19): ||delta||/||h||=0.2891 (max=0.357)  ||h||=18.888  ||delta||=5.4936
    Pos 19 (28,47): ||delta||/||h||=0.4241 (max=0.526)  ||h||=21.291  ||delta||=9.1105
    Pos 20 (74,96): ||delta||/||h||=0.1267 (max=0.180)  ||h||=25.812  ||delta||=3.3153
    Pos 21 (35,12): ||delta||/||h||=0.1906 (max=0.249)  ||h||=26.411  ||delta||=5.0761
    Pos 22 (48,38): ||delta||/||h||=0.2836 (max=0.361)  ||h||=26.749  ||delta||=7.5890
    Pos 23 ( 2,66): ||delta||/||h||=0.1185 (max=0.214)  ||h||=30.433  ||delta||=3.6268
    Pos 24 ( 3,53): ||delta||/||h||=0.1454 (max=0.245)  ||h||=31.153  ||delta||=4.5269
    Pos 25 (61,30): ||delta||/||h||=0.1380 (max=0.188)  ||h||=31.138  ||delta||=4.3016
    Pos 26 ( 0,76): ||delta||/||h||=0.0926 (max=0.149)  ||h||=32.970  ||delta||=3.0778
    Pos 27 (59,79): ||delta||/||h||=0.2048 (max=0.268)  ||h||=33.126  ||delta||=6.8526
    Pos 28 (44,70): ||delta||/||h||=0.1598 (max=0.221)  ||h||=33.230  ||delta||=5.3061
    Pos 29 (69,52): ||delta||/||h||=0.3948 (max=0.451)  ||h||=35.896  ||delta||=14.3357
    Pos 30 (64,83): ||delta||/||h||=0.2554 (max=0.304)  ||h||=42.243  ||delta||=10.9421
    Pos 31 (45,32): ||delta||/||h||=0.1822 (max=0.223)  ||h||=47.405  ||delta||=8.7239
    Pos 32 (84,63): ||delta||/||h||=0.1216 (max=0.165)  ||h||=51.039  ||delta||=6.2929
    Pos 33 (41,46): ||delta||/||h||=0.2395 (max=0.293)  ||h||=51.536  ||delta||=12.3396
    Pos 34 (39,90): ||delta||/||h||=0.2393 (max=0.284)  ||h||=55.605  ||delta||=13.3593
    Pos 35 (91,34): ||delta||/||h||=0.1778 (max=0.225)  ||h||=60.498  ||delta||=10.8615
    Pos 36 (62,25): ||delta||/||h||=0.2629 (max=0.306)  ||h||=61.539  ||delta||=16.3762
    Pos 37 (56,80): ||delta||/||h||=0.1481 (max=0.182)  ||h||=68.553  ||delta||=10.2190
    Pos 38 (88,22): ||delta||/||h||=0.1562 (max=0.181)  ||h||=71.796  ||delta||=11.2829
    Pos 39 (65, 8): ||delta||/||h||=0.2442 (max=0.276)  ||h||=75.325  ||delta||=18.5925
    Pos 40 (42,92): ||delta||/||h||=0.1312 (max=0.160)  ||h||=78.660  ||delta||=10.5334
    Pos 41 (27,67): ||delta||/||h||=0.2325 (max=0.282)  ||h||=81.720  ||delta||=18.9846
    Pos 42 ( 1,24): ||delta||/||h||=0.2556 (max=0.321)  ||h||=87.113  ||delta||=22.2660
    Pos 43 (77,89): ||delta||/||h||=0.1929 (max=0.241)  ||h||=95.821  ||delta||=18.3963
    Pos 44 (50, 7): ||delta||/||h||=0.1928 (max=0.208)  ||h||=99.889  ||delta||=19.4597
    Pos 45 (14,17): ||delta||/||h||=0.2150 (max=0.249)  ||h||=104.107  ||delta||=22.5393
    Pos 46 (86,82): ||delta||/||h||=0.1408 (max=0.167)  ||h||=113.163  ||delta||=15.9494
    Pos 47 (23,57): ||delta||/||h||=0.2008 (max=0.228)  ||h||=117.307  ||delta||=23.5711

  Beam-200:
    Pos  0 (48, 9): ||delta||/||h||=0.2328 (max=0.439)  ||h||=5.515  ||delta||=1.2706
    Pos  1 (87,71): ||delta||/||h||=0.2585 (max=0.467)  ||h||=5.285  ||delta||=1.3472
    Pos  2 (58,78): ||delta||/||h||=0.4532 (max=0.883)  ||h||=5.146  ||delta||=2.3290
    Pos  3 (49,93): ||delta||/||h||=0.5916 (max=1.014)  ||h||=5.060  ||delta||=3.0052
    Pos  4 (73,72): ||delta||/||h||=0.5452 (max=0.909)  ||h||=5.593  ||delta||=3.0793
    Pos  5 (31,26): ||delta||/||h||=0.3571 (max=0.564)  ||h||=6.473  ||delta||=2.3200
    Pos  6 (81,75): ||delta||/||h||=0.4016 (max=0.611)  ||h||=6.681  ||delta||=2.7012
    Pos  7 ( 0,54): ||delta||/||h||=0.2476 (max=0.392)  ||h||=7.518  ||delta||=1.8720
    Pos  8 (41,51): ||delta||/||h||=0.5035 (max=0.711)  ||h||=7.847  ||delta||=3.9724
    Pos  9 (39,32): ||delta||/||h||=0.3832 (max=0.503)  ||h||=9.499  ||delta||=3.6681
    Pos 10 ( 4,52): ||delta||/||h||=0.3849 (max=0.523)  ||h||=10.436  ||delta||=4.0469
    Pos 11 (45,33): ||delta||/||h||=0.2872 (max=0.401)  ||h||=12.052  ||delta||=3.4508
    Pos 12 ( 3,40): ||delta||/||h||=0.2393 (max=0.321)  ||h||=12.657  ||delta||=3.0433
    Pos 13 ( 2,70): ||delta||/||h||=0.1645 (max=0.278)  ||h||=13.660  ||delta||=2.2495
    Pos 14 (68,47): ||delta||/||h||=0.2458 (max=0.346)  ||h||=13.778  ||delta||=3.4036
    Pos 15 (59,92): ||delta||/||h||=0.2155 (max=0.306)  ||h||=13.933  ||delta||=3.0043
    Pos 16 (61,83): ||delta||/||h||=0.2120 (max=0.291)  ||h||=14.564  ||delta||=3.0823
    Pos 17 (15,66): ||delta||/||h||=0.2224 (max=0.284)  ||h||=15.650  ||delta||=3.4606
    Pos 18 (35,22): ||delta||/||h||=0.2403 (max=0.330)  ||h||=16.977  ||delta||=4.0830
    Pos 19 (16,90): ||delta||/||h||=0.2150 (max=0.290)  ||h||=16.497  ||delta||=3.5688
    Pos 20 (91,30): ||delta||/||h||=0.1771 (max=0.260)  ||h||=17.190  ||delta||=3.0603
    Pos 21 (56,21): ||delta||/||h||=0.1338 (max=0.216)  ||h||=17.969  ||delta||=2.4312
    Pos 22 (42,46): ||delta||/||h||=0.1308 (max=0.259)  ||h||=18.259  ||delta||=2.3662
    Pos 23 (10,20): ||delta||/||h||=0.1755 (max=0.260)  ||h||=18.683  ||delta||=3.2861
    Pos 24 (13,34): ||delta||/||h||=0.1337 (max=0.217)  ||h||=19.041  ||delta||=2.5133
    Pos 25 ( 1,12): ||delta||/||h||=0.2593 (max=0.347)  ||h||=19.273  ||delta||=4.9783
    Pos 26 (18,63): ||delta||/||h||=0.1450 (max=0.207)  ||h||=20.814  ||delta||=3.0810
    Pos 27 (28,25): ||delta||/||h||=0.2424 (max=0.328)  ||h||=21.456  ||delta||=5.1963
    Pos 28 (74,80): ||delta||/||h||=0.1234 (max=0.213)  ||h||=23.457  ||delta||=2.8714
    Pos 29 (44, 7): ||delta||/||h||=0.1294 (max=0.204)  ||h||=24.183  ||delta||=3.1342
    Pos 30 (86,76): ||delta||/||h||=0.1840 (max=0.258)  ||h||=24.339  ||delta||=4.5315
    Pos 31 (69,89): ||delta||/||h||=0.2194 (max=0.346)  ||h||=24.496  ||delta||=5.4237
    Pos 32 (14, 8): ||delta||/||h||=0.1469 (max=0.239)  ||h||=24.277  ||delta||=3.5405
    Pos 33 (43,53): ||delta||/||h||=0.2852 (max=0.364)  ||h||=25.720  ||delta||=7.3707
    Pos 34 (84,96): ||delta||/||h||=0.1035 (max=0.175)  ||h||=28.193  ||delta||=2.9342
    Pos 35 (95,79): ||delta||/||h||=0.1605 (max=0.220)  ||h||=28.945  ||delta||=4.6874
    Pos 36 (88,38): ||delta||/||h||=0.0870 (max=0.158)  ||h||=30.706  ||delta||=2.6893
    Pos 37 (27,17): ||delta||/||h||=0.1932 (max=0.285)  ||h||=31.875  ||delta||=6.1270
    Pos 38 (50,36): ||delta||/||h||=0.1368 (max=0.203)  ||h||=33.411  ||delta||=4.6067
    Pos 39 (37,67): ||delta||/||h||=0.1832 (max=0.239)  ||h||=34.163  ||delta||=6.3002
    Pos 40 ( 5,11): ||delta||/||h||=0.2722 (max=0.375)  ||h||=36.368  ||delta||=9.9331
    Pos 41 (23,19): ||delta||/||h||=0.1948 (max=0.278)  ||h||=37.276  ||delta||=7.2407
    Pos 42 (94, 6): ||delta||/||h||=0.3234 (max=0.412)  ||h||=40.781  ||delta||=13.2646
    Pos 43 (64,55): ||delta||/||h||=0.2962 (max=0.436)  ||h||=40.701  ||delta||=12.1060
    Pos 44 (60,29): ||delta||/||h||=0.1746 (max=0.233)  ||h||=42.778  ||delta||=7.5034
    Pos 45 (62,57): ||delta||/||h||=0.2160 (max=0.275)  ||h||=44.972  ||delta||=9.7662
    Pos 46 (65,24): ||delta||/||h||=0.3013 (max=0.408)  ||h||=47.288  ||delta||=14.4788
    Pos 47 (77,82): ||delta||/||h||=0.2445 (max=0.293)  ||h||=53.931  ||delta||=13.3274

======================================================================
Minimum-ratio pairing (Hungarian-style: smallest total ratio)
======================================================================
Greedy min-ratio pairing:
  ( 0,12): ratio=0.29311
  ( 1,21): ratio=0.22803
  ( 2, 7): ratio=0.28873
  ( 3,26): ratio=0.24589
  ( 4,38): ratio=0.21739
  ( 5,32): ratio=0.20045
  (10,19): ratio=0.25383
  (13,89): ratio=0.30323
  (14,46): ratio=0.22381
  (15,29): ratio=0.24879
  (16,90): ratio=0.32683 [b200]
  (18,22): ratio=0.32807
  (23,67): ratio=0.22021
  (27,20): ratio=0.18993
  (28,53): ratio=0.18884
  (31,72): ratio=0.42896
  (35,57): ratio=0.28163
  (37,55): ratio=0.43273
  (39,30): ratio=0.27152
  (41,66): ratio=0.22358
  (42,80): ratio=0.29082
  (43, 9): ratio=0.10788
  (44,76): ratio=0.27767
  (45,82): ratio=0.26522
  (48, 8): ratio=0.22718
  (49,78): ratio=0.42489
  (50,40): ratio=0.23600
  (56,52): ratio=0.29252
  (58,36): ratio=0.30983
  (59,11): ratio=0.35633
  (60,34): ratio=0.37173
  (61,75): ratio=0.36131
  (62,33): ratio=0.21010
  (64,92): ratio=0.20334
  (65,96): ratio=0.13581
  (68,25): ratio=0.26818
  (69,79): ratio=0.16350
  (73,51): ratio=0.48118
  (74,93): ratio=0.79070
  (77,54): ratio=0.24947
  (81,70): ratio=0.18672
  (84,47): ratio=0.30265
  (86, 6): ratio=0.38883
  (87,63): ratio=0.29492
  (88,24): ratio=0.27009
  (91,83): ratio=0.26869
  (94,17): ratio=0.20507
  (95,71): ratio=0.22950

Overlap with beam-10: 0/48
Overlap with beam-200: 1/48

Evaluating greedy-min-ratio pairing with beam-10 ordering logic...
  MSE (beam-10 expand order): 32.673592
