Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.082112 mse_soft=1.079789 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=27.662580 best_discrete=27.662580 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.875005 mse_soft=0.872814 ent_in=3.6338 ent_out=3.6686 rowmax_in=0.0455 rowmax_out=0.0439 discrete_mse=2770.405029 best_discrete=27.662580 hash=False elapsed=2.4s
step    50/900 tau=0.8260 loss=0.662109 mse_soft=0.660200 ent_in=3.1286 ent_out=3.2347 rowmax_in=0.0918 rowmax_out=0.0843 discrete_mse=6062.345703 best_discrete=27.662580 hash=False elapsed=4.5s
step    75/900 tau=0.7493 loss=0.519793 mse_soft=0.518205 ent_in=2.6008 ent_out=2.6905 rowmax_in=0.2081 rowmax_out=0.1985 discrete_mse=3827.228760 best_discrete=27.662580 hash=False elapsed=6.7s
step   100/900 tau=0.6797 loss=0.401906 mse_soft=0.400743 ent_in=2.0029 ent_out=1.8746 rowmax_in=0.3501 rowmax_out=0.4122 discrete_mse=338.027985 best_discrete=27.662580 hash=False elapsed=8.8s
step   125/900 tau=0.6165 loss=0.337961 mse_soft=0.337117 ent_in=1.5916 ent_out=1.2245 rowmax_in=0.4532 rowmax_out=0.5751 discrete_mse=596.391968 best_discrete=27.662580 hash=False elapsed=11.0s
step   150/900 tau=0.5592 loss=0.313862 mse_soft=0.313143 ent_in=1.4410 ent_out=0.9553 rowmax_in=0.4857 rowmax_out=0.6334 discrete_mse=452.131104 best_discrete=27.662580 hash=False elapsed=13.2s
step   175/900 tau=0.5073 loss=0.300936 mse_soft=0.300295 ent_in=1.3512 ent_out=0.7855 rowmax_in=0.4968 rowmax_out=0.6873 discrete_mse=552.646484 best_discrete=27.662580 hash=False elapsed=15.6s
step   200/900 tau=0.4602 loss=0.294261 mse_soft=0.293670 ent_in=1.2812 ent_out=0.6867 rowmax_in=0.5059 rowmax_out=0.7097 discrete_mse=398.477875 best_discrete=27.662580 hash=False elapsed=17.9s
step   225/900 tau=0.4174 loss=0.288992 mse_soft=0.288433 ent_in=1.2302 ent_out=0.6342 rowmax_in=0.5169 rowmax_out=0.7227 discrete_mse=72.610924 best_discrete=27.662580 hash=False elapsed=20.1s
step   250/900 tau=0.3786 loss=0.284819 mse_soft=0.284288 ent_in=1.1895 ent_out=0.5808 rowmax_in=0.5272 rowmax_out=0.7400 discrete_mse=65.154526 best_discrete=27.662580 hash=False elapsed=22.3s
step   275/900 tau=0.3434 loss=0.282988 mse_soft=0.282477 ent_in=1.1593 ent_out=0.5460 rowmax_in=0.5342 rowmax_out=0.7519 discrete_mse=65.154526 best_discrete=27.662580 hash=False elapsed=24.4s
step   300/900 tau=0.3115 loss=0.281983 mse_soft=0.281483 ent_in=1.1394 ent_out=0.5287 rowmax_in=0.5387 rowmax_out=0.7566 discrete_mse=65.154526 best_discrete=27.662580 hash=False elapsed=26.5s
step   325/900 tau=0.2826 loss=0.279879 mse_soft=0.279387 ent_in=1.1232 ent_out=0.5159 rowmax_in=0.5423 rowmax_out=0.7608 discrete_mse=65.154526 best_discrete=27.662580 hash=False elapsed=28.7s
step   350/900 tau=0.2563 loss=0.279414 mse_soft=0.278928 ent_in=1.1108 ent_out=0.5099 rowmax_in=0.5448 rowmax_out=0.7614 discrete_mse=44.857975 best_discrete=27.662580 hash=False elapsed=30.9s
step   375/900 tau=0.2325 loss=0.280298 mse_soft=0.279817 ent_in=1.1000 ent_out=0.5036 rowmax_in=0.5471 rowmax_out=0.7630 discrete_mse=32.836861 best_discrete=27.662580 hash=False elapsed=33.2s
step   400/900 tau=0.2109 loss=0.279789 mse_soft=0.279311 ent_in=1.0965 ent_out=0.4959 rowmax_in=0.5468 rowmax_out=0.7669 discrete_mse=130.611603 best_discrete=27.662580 hash=False elapsed=35.3s
step   425/900 tau=0.1913 loss=0.281841 mse_soft=0.281368 ent_in=1.0884 ent_out=0.4893 rowmax_in=0.5481 rowmax_out=0.7704 discrete_mse=130.611603 best_discrete=27.662580 hash=False elapsed=37.4s
step   450/900 tau=0.1735 loss=0.276650 mse_soft=0.276179 ent_in=1.0849 ent_out=0.4843 rowmax_in=0.5471 rowmax_out=0.7732 discrete_mse=15.491809 best_discrete=15.491809 hash=False elapsed=39.7s
step   475/900 tau=0.1574 loss=0.276153 mse_soft=0.275684 ent_in=1.0832 ent_out=0.4794 rowmax_in=0.5483 rowmax_out=0.7755 discrete_mse=9.960800 best_discrete=9.960800 hash=False elapsed=41.8s
step   500/900 tau=0.1428 loss=0.291390 mse_soft=0.290924 ent_in=1.0796 ent_out=0.4736 rowmax_in=0.5483 rowmax_out=0.7764 discrete_mse=21.572805 best_discrete=9.960800 hash=False elapsed=44.0s
step   525/900 tau=0.1295 loss=0.320161 mse_soft=0.319702 ent_in=1.0446 ent_out=0.4865 rowmax_in=0.5698 rowmax_out=0.7698 discrete_mse=2.993860 best_discrete=2.993860 hash=False elapsed=46.4s
step   550/900 tau=0.1175 loss=0.285366 mse_soft=0.284924 ent_in=1.0215 ent_out=0.4523 rowmax_in=0.5691 rowmax_out=0.7873 discrete_mse=42.252037 best_discrete=2.993860 hash=False elapsed=48.8s
step   575/900 tau=0.1066 loss=0.295808 mse_soft=0.295368 ent_in=1.0193 ent_out=0.4475 rowmax_in=0.5676 rowmax_out=0.7885 discrete_mse=42.252037 best_discrete=2.993860 hash=False elapsed=50.9s
step   600/900 tau=0.0967 loss=0.279572 mse_soft=0.279137 ent_in=1.0135 ent_out=0.4364 rowmax_in=0.5659 rowmax_out=0.7947 discrete_mse=36.779835 best_discrete=2.993860 hash=False elapsed=52.8s
step   625/900 tau=0.0877 loss=0.312498 mse_soft=0.312066 ent_in=1.0162 ent_out=0.4248 rowmax_in=0.5612 rowmax_out=0.8009 discrete_mse=0.861992 best_discrete=0.861992 hash=False elapsed=54.7s
step   650/900 tau=0.0795 loss=0.287592 mse_soft=0.287166 ent_in=1.0070 ent_out=0.4152 rowmax_in=0.5624 rowmax_out=0.8045 discrete_mse=36.779835 best_discrete=0.861992 hash=False elapsed=56.7s
step   675/900 tau=0.0722 loss=0.279521 mse_soft=0.279100 ent_in=0.9994 ent_out=0.4037 rowmax_in=0.5700 rowmax_out=0.8086 discrete_mse=20.485733 best_discrete=0.861992 hash=False elapsed=58.8s
step   700/900 tau=0.0655 loss=0.308562 mse_soft=0.308147 ent_in=0.9842 ent_out=0.4014 rowmax_in=0.5722 rowmax_out=0.8101 discrete_mse=15.179084 best_discrete=0.861992 hash=False elapsed=61.0s
step   725/900 tau=0.0594 loss=0.348434 mse_soft=0.348074 ent_in=0.8572 ent_out=0.3434 rowmax_in=0.6271 rowmax_out=0.8468 discrete_mse=37.937107 best_discrete=0.861992 hash=False elapsed=63.3s
step   750/900 tau=0.0539 loss=0.346223 mse_soft=0.345929 ent_in=0.6744 ent_out=0.3051 rowmax_in=0.6896 rowmax_out=0.8536 discrete_mse=76.995323 best_discrete=0.861992 hash=False elapsed=65.3s
step   775/900 tau=0.0489 loss=0.371819 mse_soft=0.371525 ent_in=0.6627 ent_out=0.3147 rowmax_in=0.6783 rowmax_out=0.8425 discrete_mse=26.321093 best_discrete=0.861992 hash=False elapsed=67.3s
step   800/900 tau=0.0443 loss=0.337896 mse_soft=0.337618 ent_in=0.6303 ent_out=0.2954 rowmax_in=0.6985 rowmax_out=0.8477 discrete_mse=63.281437 best_discrete=0.861992 hash=False elapsed=69.5s
step   825/900 tau=0.0402 loss=0.344261 mse_soft=0.344014 ent_in=0.5459 ent_out=0.2758 rowmax_in=0.7495 rowmax_out=0.8560 discrete_mse=31.831886 best_discrete=0.861992 hash=False elapsed=71.7s
step   850/900 tau=0.0365 loss=0.370062 mse_soft=0.369854 ent_in=0.4449 ent_out=0.2481 rowmax_in=0.7912 rowmax_out=0.8697 discrete_mse=25.971581 best_discrete=0.861992 hash=False elapsed=73.8s
step   875/900 tau=0.0331 loss=0.365259 mse_soft=0.365064 ent_in=0.4045 ent_out=0.2460 rowmax_in=0.8013 rowmax_out=0.8648 discrete_mse=23.892639 best_discrete=0.861992 hash=False elapsed=75.8s
step   900/900 tau=0.0300 loss=0.350095 mse_soft=0.349905 ent_in=0.3937 ent_out=0.2390 rowmax_in=0.8097 rowmax_out=0.8654 discrete_mse=10.662170 best_discrete=0.861992 hash=False elapsed=78.1s

Final metrics:
  soft_mse_full=0.351788
  rowmax_in_mean=0.8108
  rowmax_out_mean=0.8662
  ent_in_mean=0.3938
  ent_out_mean=0.2382
  final_discrete_mse=12.055373
  hash_match=False
  best_discrete_mse_seen=0.861992
Saved results to overnight_b156_j1.json
