Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.076385 mse_soft=1.074062 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=148.243149 best_discrete=148.243149 hash=False elapsed=0.6s
step    25/900 tau=0.9106 loss=0.871456 mse_soft=0.869266 ent_in=3.6335 ent_out=3.6675 rowmax_in=0.0463 rowmax_out=0.0436 discrete_mse=1990.387207 best_discrete=148.243149 hash=False elapsed=3.0s
step    50/900 tau=0.8260 loss=0.659051 mse_soft=0.657146 ent_in=3.1311 ent_out=3.2212 rowmax_in=0.0950 rowmax_out=0.0860 discrete_mse=1253.150513 best_discrete=148.243149 hash=False elapsed=5.5s
step    75/900 tau=0.7493 loss=0.525833 mse_soft=0.524250 ent_in=2.5940 ent_out=2.6822 rowmax_in=0.2050 rowmax_out=0.1971 discrete_mse=435.866577 best_discrete=148.243149 hash=False elapsed=8.1s
step   100/900 tau=0.6797 loss=0.411187 mse_soft=0.410033 ent_in=1.9980 ent_out=1.8481 rowmax_in=0.3441 rowmax_out=0.4133 discrete_mse=297.410278 best_discrete=148.243149 hash=False elapsed=10.6s
step   125/900 tau=0.6165 loss=0.342790 mse_soft=0.341980 ent_in=1.6132 ent_out=1.0899 rowmax_in=0.4335 rowmax_out=0.6503 discrete_mse=565.834778 best_discrete=148.243149 hash=False elapsed=13.0s
step   150/900 tau=0.5592 loss=0.317641 mse_soft=0.317015 ent_in=1.4416 ent_out=0.6442 rowmax_in=0.4604 rowmax_out=0.7903 discrete_mse=1505.817749 best_discrete=148.243149 hash=False elapsed=15.5s
step   175/900 tau=0.5073 loss=0.304887 mse_soft=0.304347 ent_in=1.3430 ent_out=0.4589 rowmax_in=0.4768 rowmax_out=0.8423 discrete_mse=336.028503 best_discrete=148.243149 hash=False elapsed=17.9s
step   200/900 tau=0.4602 loss=0.296026 mse_soft=0.295539 ent_in=1.2707 ent_out=0.3510 rowmax_in=0.4861 rowmax_out=0.8757 discrete_mse=313.164062 best_discrete=148.243149 hash=False elapsed=20.4s
step   225/900 tau=0.4174 loss=0.289520 mse_soft=0.289061 ent_in=1.2235 ent_out=0.3070 rowmax_in=0.4929 rowmax_out=0.8849 discrete_mse=162.636826 best_discrete=148.243149 hash=False elapsed=23.1s
step   250/900 tau=0.3786 loss=0.286661 mse_soft=0.286223 ent_in=1.1810 ent_out=0.2786 rowmax_in=0.5027 rowmax_out=0.8912 discrete_mse=263.681030 best_discrete=148.243149 hash=False elapsed=25.6s
step   275/900 tau=0.3434 loss=0.286054 mse_soft=0.285626 ent_in=1.1645 ent_out=0.2616 rowmax_in=0.5037 rowmax_out=0.8952 discrete_mse=263.681030 best_discrete=148.243149 hash=False elapsed=28.1s
step   300/900 tau=0.3115 loss=0.284073 mse_soft=0.283652 ent_in=1.1563 ent_out=0.2466 rowmax_in=0.5013 rowmax_out=0.9016 discrete_mse=160.140472 best_discrete=148.243149 hash=False elapsed=30.5s
step   325/900 tau=0.2826 loss=0.284970 mse_soft=0.284552 ent_in=1.1533 ent_out=0.2402 rowmax_in=0.4983 rowmax_out=0.9042 discrete_mse=71.163780 best_discrete=71.163780 hash=False elapsed=32.9s
step   350/900 tau=0.2563 loss=0.283253 mse_soft=0.282837 ent_in=1.1507 ent_out=0.2360 rowmax_in=0.4968 rowmax_out=0.9040 discrete_mse=71.163780 best_discrete=71.163780 hash=False elapsed=35.5s
step   375/900 tau=0.2325 loss=0.283376 mse_soft=0.282965 ent_in=1.1448 ent_out=0.2257 rowmax_in=0.4975 rowmax_out=0.9076 discrete_mse=71.163780 best_discrete=71.163780 hash=False elapsed=37.7s
step   400/900 tau=0.2109 loss=0.283969 mse_soft=0.283558 ent_in=1.1429 ent_out=0.2265 rowmax_in=0.4964 rowmax_out=0.9065 discrete_mse=71.163780 best_discrete=71.163780 hash=False elapsed=39.9s
step   425/900 tau=0.1913 loss=0.281007 mse_soft=0.280598 ent_in=1.1410 ent_out=0.2214 rowmax_in=0.4962 rowmax_out=0.9096 discrete_mse=75.211296 best_discrete=71.163780 hash=False elapsed=42.2s
step   450/900 tau=0.1735 loss=0.280696 mse_soft=0.280291 ent_in=1.1357 ent_out=0.2147 rowmax_in=0.4972 rowmax_out=0.9128 discrete_mse=139.057739 best_discrete=71.163780 hash=False elapsed=44.5s
step   475/900 tau=0.1574 loss=0.280042 mse_soft=0.279641 ent_in=1.1317 ent_out=0.2062 rowmax_in=0.4966 rowmax_out=0.9180 discrete_mse=101.432770 best_discrete=71.163780 hash=False elapsed=46.8s
step   500/900 tau=0.1428 loss=0.282588 mse_soft=0.282194 ent_in=1.1157 ent_out=0.1972 rowmax_in=0.5015 rowmax_out=0.9203 discrete_mse=101.432770 best_discrete=71.163780 hash=False elapsed=49.1s
step   525/900 tau=0.1295 loss=0.279333 mse_soft=0.278945 ent_in=1.1051 ent_out=0.1872 rowmax_in=0.5052 rowmax_out=0.9235 discrete_mse=47.657688 best_discrete=47.657688 hash=False elapsed=51.5s
step   550/900 tau=0.1175 loss=0.279461 mse_soft=0.279075 ent_in=1.1010 ent_out=0.1843 rowmax_in=0.5065 rowmax_out=0.9239 discrete_mse=35.583454 best_discrete=35.583454 hash=False elapsed=53.8s
step   575/900 tau=0.1066 loss=0.284008 mse_soft=0.283627 ent_in=1.0863 ent_out=0.1818 rowmax_in=0.5133 rowmax_out=0.9245 discrete_mse=36.961506 best_discrete=35.583454 hash=False elapsed=56.2s
step   600/900 tau=0.0967 loss=0.285005 mse_soft=0.284630 ent_in=1.0726 ent_out=0.1783 rowmax_in=0.5193 rowmax_out=0.9255 discrete_mse=50.046688 best_discrete=35.583454 hash=False elapsed=58.5s
step   625/900 tau=0.0877 loss=0.283732 mse_soft=0.283359 ent_in=1.0684 ent_out=0.1738 rowmax_in=0.5175 rowmax_out=0.9272 discrete_mse=50.046688 best_discrete=35.583454 hash=False elapsed=61.0s
step   650/900 tau=0.0795 loss=0.282478 mse_soft=0.282118 ent_in=1.0397 ent_out=0.1607 rowmax_in=0.5317 rowmax_out=0.9317 discrete_mse=25.891928 best_discrete=25.891928 hash=False elapsed=63.4s
step   675/900 tau=0.0722 loss=0.299601 mse_soft=0.299261 ent_in=0.9908 ent_out=0.1425 rowmax_in=0.5615 rowmax_out=0.9396 discrete_mse=4.197997 best_discrete=4.197997 hash=False elapsed=65.6s
step   700/900 tau=0.0655 loss=0.294949 mse_soft=0.294623 ent_in=0.9500 ent_out=0.1365 rowmax_in=0.5653 rowmax_out=0.9408 discrete_mse=51.483978 best_discrete=4.197997 hash=False elapsed=67.8s
step   725/900 tau=0.0594 loss=0.283410 mse_soft=0.283089 ent_in=0.9352 ent_out=0.1352 rowmax_in=0.5675 rowmax_out=0.9390 discrete_mse=218.731476 best_discrete=4.197997 hash=False elapsed=69.9s
step   750/900 tau=0.0539 loss=0.301396 mse_soft=0.301098 ent_in=0.8723 ent_out=0.1211 rowmax_in=0.5964 rowmax_out=0.9455 discrete_mse=8.840204 best_discrete=4.197997 hash=False elapsed=72.1s
step   775/900 tau=0.0489 loss=0.439207 mse_soft=0.438977 ent_in=0.6551 ent_out=0.1122 rowmax_in=0.7024 rowmax_out=0.9504 discrete_mse=6.071495 best_discrete=4.197997 hash=False elapsed=74.4s
step   800/900 tau=0.0443 loss=0.329958 mse_soft=0.329731 ent_in=0.6558 ent_out=0.1025 rowmax_in=0.6820 rowmax_out=0.9492 discrete_mse=21.338152 best_discrete=4.197997 hash=False elapsed=76.5s
step   825/900 tau=0.0402 loss=0.316970 mse_soft=0.316738 ent_in=0.6720 ent_out=0.1005 rowmax_in=0.6630 rowmax_out=0.9489 discrete_mse=9.131762 best_discrete=4.197997 hash=False elapsed=78.7s
step   850/900 tau=0.0365 loss=0.325577 mse_soft=0.325363 ent_in=0.6272 ent_out=0.0857 rowmax_in=0.6831 rowmax_out=0.9493 discrete_mse=9.001970 best_discrete=4.197997 hash=False elapsed=80.9s
step   875/900 tau=0.0331 loss=0.315746 mse_soft=0.315523 ent_in=0.6557 ent_out=0.0855 rowmax_in=0.6669 rowmax_out=0.9498 discrete_mse=17.408293 best_discrete=4.197997 hash=False elapsed=83.2s
step   900/900 tau=0.0300 loss=0.403988 mse_soft=0.403829 ent_in=0.4509 ent_out=0.0783 rowmax_in=0.7641 rowmax_out=0.9502 discrete_mse=283.096283 best_discrete=4.197997 hash=False elapsed=85.4s

Final metrics:
  soft_mse_full=0.398507
  rowmax_in_mean=0.7665
  rowmax_out_mean=0.9493
  ent_in_mean=0.4527
  ent_out_mean=0.0788
  final_discrete_mse=40.452808
  hash_match=False
  best_discrete_mse_seen=4.197997
Saved results to overnight_b162_j1.json
