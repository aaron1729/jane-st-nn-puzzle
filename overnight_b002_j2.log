Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.050677 mse_soft=1.048354 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=4.271870 best_discrete=4.271870 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.850688 mse_soft=0.848497 ent_in=3.6350 ent_out=3.6700 rowmax_in=0.0455 rowmax_out=0.0438 discrete_mse=1510.170532 best_discrete=4.271870 hash=False elapsed=3.0s
step    50/900 tau=0.8229 loss=0.645782 mse_soft=0.643864 ent_in=3.1440 ent_out=3.2463 rowmax_in=0.0946 rowmax_out=0.0843 discrete_mse=5003.891113 best_discrete=4.271870 hash=False elapsed=5.4s
step    75/900 tau=0.7450 loss=0.506333 mse_soft=0.504744 ent_in=2.6129 ent_out=2.6850 rowmax_in=0.2054 rowmax_out=0.1970 discrete_mse=1154.080566 best_discrete=4.271870 hash=False elapsed=7.8s
step   100/900 tau=0.6745 loss=0.397401 mse_soft=0.396245 ent_in=1.9664 ent_out=1.8869 rowmax_in=0.3735 rowmax_out=0.3982 discrete_mse=1452.608643 best_discrete=4.271870 hash=False elapsed=10.1s
step   125/900 tau=0.6107 loss=0.336693 mse_soft=0.335855 ent_in=1.5197 ent_out=1.2744 rowmax_in=0.4905 rowmax_out=0.5801 discrete_mse=1552.591553 best_discrete=4.271870 hash=False elapsed=12.5s
step   150/900 tau=0.5529 loss=0.312303 mse_soft=0.311595 ent_in=1.3579 ent_out=1.0005 rowmax_in=0.5180 rowmax_out=0.6490 discrete_mse=2180.710449 best_discrete=4.271870 hash=False elapsed=15.0s
step   175/900 tau=0.5006 loss=0.297198 mse_soft=0.296586 ent_in=1.2592 ent_out=0.7801 rowmax_in=0.5247 rowmax_out=0.7088 discrete_mse=132.253998 best_discrete=4.271870 hash=False elapsed=17.2s
step   200/900 tau=0.4532 loss=0.286723 mse_soft=0.286184 ent_in=1.1788 ent_out=0.6160 rowmax_in=0.5352 rowmax_out=0.7766 discrete_mse=352.118591 best_discrete=4.271870 hash=False elapsed=19.5s
step   225/900 tau=0.4103 loss=0.280933 mse_soft=0.280434 ent_in=1.1426 ent_out=0.5194 rowmax_in=0.5374 rowmax_out=0.8045 discrete_mse=346.164856 best_discrete=4.271870 hash=False elapsed=21.7s
step   250/900 tau=0.3715 loss=0.278108 mse_soft=0.277623 ent_in=1.1302 ent_out=0.4866 rowmax_in=0.5395 rowmax_out=0.8093 discrete_mse=185.647476 best_discrete=4.271870 hash=False elapsed=23.9s
step   275/900 tau=0.3363 loss=0.275600 mse_soft=0.275128 ent_in=1.1177 ent_out=0.4545 rowmax_in=0.5405 rowmax_out=0.8168 discrete_mse=31.029417 best_discrete=4.271870 hash=False elapsed=26.2s
step   300/900 tau=0.3045 loss=0.274536 mse_soft=0.274076 ent_in=1.1018 ent_out=0.4305 rowmax_in=0.5436 rowmax_out=0.8239 discrete_mse=167.627655 best_discrete=4.271870 hash=False elapsed=28.5s
step   325/900 tau=0.2756 loss=0.272125 mse_soft=0.271673 ent_in=1.0788 ent_out=0.4264 rowmax_in=0.5493 rowmax_out=0.8261 discrete_mse=104.424660 best_discrete=4.271870 hash=False elapsed=30.7s
step   350/900 tau=0.2496 loss=0.271558 mse_soft=0.271113 ent_in=1.0649 ent_out=0.4193 rowmax_in=0.5501 rowmax_out=0.8264 discrete_mse=12.165940 best_discrete=4.271870 hash=False elapsed=33.0s
step   375/900 tau=0.2259 loss=0.269613 mse_soft=0.269173 ent_in=1.0522 ent_out=0.4133 rowmax_in=0.5538 rowmax_out=0.8259 discrete_mse=12.857146 best_discrete=4.271870 hash=False elapsed=35.2s
step   400/900 tau=0.2046 loss=0.270100 mse_soft=0.269664 ent_in=1.0437 ent_out=0.4073 rowmax_in=0.5554 rowmax_out=0.8254 discrete_mse=12.857146 best_discrete=4.271870 hash=False elapsed=37.4s
step   425/900 tau=0.1852 loss=0.268498 mse_soft=0.268067 ent_in=1.0315 ent_out=0.4052 rowmax_in=0.5561 rowmax_out=0.8201 discrete_mse=7.220190 best_discrete=4.271870 hash=False elapsed=39.6s
step   450/900 tau=0.1677 loss=0.268293 mse_soft=0.267865 ent_in=1.0268 ent_out=0.3990 rowmax_in=0.5540 rowmax_out=0.8212 discrete_mse=18.905701 best_discrete=4.271870 hash=False elapsed=41.8s
step   475/900 tau=0.1518 loss=0.268092 mse_soft=0.267667 ent_in=1.0223 ent_out=0.3952 rowmax_in=0.5567 rowmax_out=0.8174 discrete_mse=18.905701 best_discrete=4.271870 hash=False elapsed=44.0s
step   500/900 tau=0.1374 loss=0.267943 mse_soft=0.267518 ent_in=1.0254 ent_out=0.3902 rowmax_in=0.5536 rowmax_out=0.8187 discrete_mse=55.296459 best_discrete=4.271870 hash=False elapsed=46.2s
step   525/900 tau=0.1244 loss=0.271840 mse_soft=0.271419 ent_in=1.0209 ent_out=0.3845 rowmax_in=0.5556 rowmax_out=0.8194 discrete_mse=125.198837 best_discrete=4.271870 hash=False elapsed=48.5s
step   550/900 tau=0.1126 loss=0.268578 mse_soft=0.268159 ent_in=1.0181 ent_out=0.3804 rowmax_in=0.5545 rowmax_out=0.8203 discrete_mse=42.778519 best_discrete=4.271870 hash=False elapsed=50.8s
step   575/900 tau=0.1020 loss=0.310684 mse_soft=0.310282 ent_in=0.9738 ent_out=0.3649 rowmax_in=0.5739 rowmax_out=0.8246 discrete_mse=302.047241 best_discrete=4.271870 hash=False elapsed=53.1s
step   600/900 tau=0.0923 loss=0.299618 mse_soft=0.299257 ent_in=0.8957 ent_out=0.3090 rowmax_in=0.5853 rowmax_out=0.8549 discrete_mse=73.628220 best_discrete=4.271870 hash=False elapsed=55.6s
step   625/900 tau=0.0836 loss=0.279300 mse_soft=0.278941 ent_in=0.8710 ent_out=0.3254 rowmax_in=0.5797 rowmax_out=0.8441 discrete_mse=153.707077 best_discrete=4.271870 hash=False elapsed=57.8s
step   650/900 tau=0.0757 loss=0.279358 mse_soft=0.279007 ent_in=0.8547 ent_out=0.3172 rowmax_in=0.5894 rowmax_out=0.8478 discrete_mse=31.098053 best_discrete=4.271870 hash=False elapsed=60.0s
step   675/900 tau=0.0685 loss=0.276113 mse_soft=0.275764 ent_in=0.8517 ent_out=0.3096 rowmax_in=0.5892 rowmax_out=0.8460 discrete_mse=6.323532 best_discrete=4.271870 hash=False elapsed=62.4s
step   700/900 tau=0.0620 loss=0.282359 mse_soft=0.282017 ent_in=0.8322 ent_out=0.3066 rowmax_in=0.5966 rowmax_out=0.8489 discrete_mse=1.141913 best_discrete=1.141913 hash=False elapsed=64.6s
step   725/900 tau=0.0562 loss=0.298739 mse_soft=0.298403 ent_in=0.8255 ent_out=0.2966 rowmax_in=0.5917 rowmax_out=0.8609 discrete_mse=161.100494 best_discrete=1.141913 hash=False elapsed=66.8s
step   750/900 tau=0.0508 loss=0.400024 mse_soft=0.399768 ent_in=0.6383 ent_out=0.2153 rowmax_in=0.6902 rowmax_out=0.8964 discrete_mse=40.186749 best_discrete=1.141913 hash=False elapsed=68.9s
step   775/900 tau=0.0460 loss=0.321570 mse_soft=0.321334 ent_in=0.5702 ent_out=0.2170 rowmax_in=0.7241 rowmax_out=0.8854 discrete_mse=17.473499 best_discrete=1.141913 hash=False elapsed=71.0s
step   800/900 tau=0.0417 loss=0.311138 mse_soft=0.310896 ent_in=0.5806 ent_out=0.2254 rowmax_in=0.7014 rowmax_out=0.8842 discrete_mse=8.950790 best_discrete=1.141913 hash=False elapsed=73.1s
step   825/900 tau=0.0377 loss=0.346060 mse_soft=0.345838 ent_in=0.5554 ent_out=0.1850 rowmax_in=0.7115 rowmax_out=0.9057 discrete_mse=9.706064 best_discrete=1.141913 hash=False elapsed=75.3s
step   850/900 tau=0.0342 loss=0.456277 mse_soft=0.456104 ent_in=0.3849 ent_out=0.1908 rowmax_in=0.8153 rowmax_out=0.9032 discrete_mse=26.405737 best_discrete=1.141913 hash=False elapsed=77.7s
step   875/900 tau=0.0309 loss=0.389458 mse_soft=0.389293 ent_in=0.3424 ent_out=0.2079 rowmax_in=0.8211 rowmax_out=0.8951 discrete_mse=15.674698 best_discrete=1.141913 hash=False elapsed=79.9s
step   900/900 tau=0.0280 loss=0.429704 mse_soft=0.429569 ent_in=0.3115 ent_out=0.1376 rowmax_in=0.8282 rowmax_out=0.9249 discrete_mse=19.880844 best_discrete=1.141913 hash=False elapsed=82.2s

Final metrics:
  soft_mse_full=0.436451
  rowmax_in_mean=0.8255
  rowmax_out_mean=0.9252
  ent_in_mean=0.3123
  ent_out_mean=0.1370
  final_discrete_mse=17.440804
  hash_match=False
  best_discrete_mse_seen=1.141913
Saved results to overnight_b002_j2.json
