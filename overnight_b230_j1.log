Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.051127 mse_soft=1.048805 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=228.037292 best_discrete=228.037292 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.853793 mse_soft=0.851603 ent_in=3.6337 ent_out=3.6664 rowmax_in=0.0463 rowmax_out=0.0443 discrete_mse=1748.362549 best_discrete=228.037292 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.645200 mse_soft=0.643294 ent_in=3.1290 ent_out=3.2212 rowmax_in=0.0956 rowmax_out=0.0871 discrete_mse=3807.640381 best_discrete=228.037292 hash=False elapsed=4.8s
step    75/900 tau=0.7493 loss=0.508175 mse_soft=0.506599 ent_in=2.5903 ent_out=2.6609 rowmax_in=0.2089 rowmax_out=0.1988 discrete_mse=284.470306 best_discrete=228.037292 hash=False elapsed=6.9s
step   100/900 tau=0.6797 loss=0.389387 mse_soft=0.388274 ent_in=1.9202 ent_out=1.7904 rowmax_in=0.3615 rowmax_out=0.4465 discrete_mse=58.186535 best_discrete=58.186535 hash=False elapsed=9.3s
step   125/900 tau=0.6165 loss=0.330789 mse_soft=0.330024 ent_in=1.4691 ent_out=1.0788 rowmax_in=0.4759 rowmax_out=0.6546 discrete_mse=12.946534 best_discrete=12.946534 hash=False elapsed=11.6s
step   150/900 tau=0.5592 loss=0.303569 mse_soft=0.302980 ent_in=1.3162 ent_out=0.6500 rowmax_in=0.5053 rowmax_out=0.8012 discrete_mse=47.302029 best_discrete=12.946534 hash=False elapsed=13.8s
step   175/900 tau=0.5073 loss=0.288356 mse_soft=0.287848 ent_in=1.2103 ent_out=0.4849 rowmax_in=0.5105 rowmax_out=0.8299 discrete_mse=600.750610 best_discrete=12.946534 hash=False elapsed=16.0s
step   200/900 tau=0.4602 loss=0.281565 mse_soft=0.281102 ent_in=1.1459 ent_out=0.3975 rowmax_in=0.5149 rowmax_out=0.8571 discrete_mse=1119.988525 best_discrete=12.946534 hash=False elapsed=18.2s
step   225/900 tau=0.4174 loss=0.277698 mse_soft=0.277257 ent_in=1.1232 ent_out=0.3498 rowmax_in=0.5150 rowmax_out=0.8688 discrete_mse=888.342896 best_discrete=12.946534 hash=False elapsed=20.4s
step   250/900 tau=0.3786 loss=0.274699 mse_soft=0.274272 ent_in=1.1084 ent_out=0.3154 rowmax_in=0.5170 rowmax_out=0.8674 discrete_mse=285.396912 best_discrete=12.946534 hash=False elapsed=22.7s
step   275/900 tau=0.3434 loss=0.272009 mse_soft=0.271594 ent_in=1.0957 ent_out=0.2873 rowmax_in=0.5183 rowmax_out=0.8763 discrete_mse=104.636925 best_discrete=12.946534 hash=False elapsed=24.9s
step   300/900 tau=0.3115 loss=0.270450 mse_soft=0.270036 ent_in=1.0904 ent_out=0.2884 rowmax_in=0.5175 rowmax_out=0.8725 discrete_mse=136.684067 best_discrete=12.946534 hash=False elapsed=27.1s
step   325/900 tau=0.2826 loss=0.271517 mse_soft=0.271108 ent_in=1.0824 ent_out=0.2804 rowmax_in=0.5208 rowmax_out=0.8747 discrete_mse=244.944824 best_discrete=12.946534 hash=False elapsed=29.2s
step   350/900 tau=0.2563 loss=0.269393 mse_soft=0.268986 ent_in=1.0744 ent_out=0.2824 rowmax_in=0.5215 rowmax_out=0.8743 discrete_mse=240.867996 best_discrete=12.946534 hash=False elapsed=31.6s
step   375/900 tau=0.2325 loss=0.269592 mse_soft=0.269185 ent_in=1.0709 ent_out=0.2847 rowmax_in=0.5215 rowmax_out=0.8731 discrete_mse=240.867996 best_discrete=12.946534 hash=False elapsed=34.0s
step   400/900 tau=0.2109 loss=0.269551 mse_soft=0.269142 ent_in=1.0728 ent_out=0.2897 rowmax_in=0.5188 rowmax_out=0.8722 discrete_mse=121.361275 best_discrete=12.946534 hash=False elapsed=36.4s
step   425/900 tau=0.1913 loss=0.268818 mse_soft=0.268411 ent_in=1.0654 ent_out=0.2904 rowmax_in=0.5219 rowmax_out=0.8739 discrete_mse=121.361275 best_discrete=12.946534 hash=False elapsed=38.7s
step   450/900 tau=0.1735 loss=0.270826 mse_soft=0.270423 ent_in=1.0579 ent_out=0.2884 rowmax_in=0.5256 rowmax_out=0.8736 discrete_mse=199.965424 best_discrete=12.946534 hash=False elapsed=41.1s
step   475/900 tau=0.1574 loss=0.268156 mse_soft=0.267751 ent_in=1.0568 ent_out=0.2926 rowmax_in=0.5250 rowmax_out=0.8689 discrete_mse=121.361275 best_discrete=12.946534 hash=False elapsed=43.3s
step   500/900 tau=0.1428 loss=0.270061 mse_soft=0.269658 ent_in=1.0538 ent_out=0.2912 rowmax_in=0.5264 rowmax_out=0.8704 discrete_mse=199.965424 best_discrete=12.946534 hash=False elapsed=45.4s
step   525/900 tau=0.1295 loss=0.271531 mse_soft=0.271126 ent_in=1.0572 ent_out=0.2914 rowmax_in=0.5226 rowmax_out=0.8707 discrete_mse=111.732750 best_discrete=12.946534 hash=False elapsed=47.7s
step   550/900 tau=0.1175 loss=0.268248 mse_soft=0.267844 ent_in=1.0555 ent_out=0.2905 rowmax_in=0.5246 rowmax_out=0.8717 discrete_mse=104.636925 best_discrete=12.946534 hash=False elapsed=50.0s
step   575/900 tau=0.1066 loss=0.270308 mse_soft=0.269906 ent_in=1.0535 ent_out=0.2892 rowmax_in=0.5262 rowmax_out=0.8720 discrete_mse=134.252975 best_discrete=12.946534 hash=False elapsed=52.2s
step   600/900 tau=0.0967 loss=0.274581 mse_soft=0.274182 ent_in=1.0545 ent_out=0.2766 rowmax_in=0.5222 rowmax_out=0.8764 discrete_mse=100.788322 best_discrete=12.946534 hash=False elapsed=54.4s
step   625/900 tau=0.0877 loss=0.275316 mse_soft=0.274918 ent_in=1.0521 ent_out=0.2736 rowmax_in=0.5217 rowmax_out=0.8764 discrete_mse=96.039574 best_discrete=12.946534 hash=False elapsed=56.5s
step   650/900 tau=0.0795 loss=0.270202 mse_soft=0.269811 ent_in=1.0370 ent_out=0.2655 rowmax_in=0.5303 rowmax_out=0.8806 discrete_mse=100.788322 best_discrete=12.946534 hash=False elapsed=58.9s
step   675/900 tau=0.0722 loss=0.272837 mse_soft=0.272446 ent_in=1.0326 ent_out=0.2684 rowmax_in=0.5323 rowmax_out=0.8727 discrete_mse=96.039574 best_discrete=12.946534 hash=False elapsed=61.2s
step   700/900 tau=0.0655 loss=0.289863 mse_soft=0.289477 ent_in=1.0140 ent_out=0.2722 rowmax_in=0.5328 rowmax_out=0.8661 discrete_mse=244.693939 best_discrete=12.946534 hash=False elapsed=63.5s
step   725/900 tau=0.0594 loss=0.275135 mse_soft=0.274762 ent_in=0.9798 ent_out=0.2656 rowmax_in=0.5541 rowmax_out=0.8682 discrete_mse=70.321198 best_discrete=12.946534 hash=False elapsed=65.7s
step   750/900 tau=0.0539 loss=0.285226 mse_soft=0.284886 ent_in=0.8959 ent_out=0.2384 rowmax_in=0.5856 rowmax_out=0.8747 discrete_mse=72.577248 best_discrete=12.946534 hash=False elapsed=68.1s
step   775/900 tau=0.0489 loss=0.303933 mse_soft=0.303654 ent_in=0.7177 ent_out=0.2122 rowmax_in=0.6512 rowmax_out=0.8825 discrete_mse=48.853279 best_discrete=12.946534 hash=False elapsed=70.3s
step   800/900 tau=0.0443 loss=0.312177 mse_soft=0.311886 ent_in=0.7592 ent_out=0.2136 rowmax_in=0.6315 rowmax_out=0.8813 discrete_mse=54.856159 best_discrete=12.946534 hash=False elapsed=72.6s
step   825/900 tau=0.0402 loss=0.311573 mse_soft=0.311309 ent_in=0.6648 ent_out=0.2149 rowmax_in=0.6648 rowmax_out=0.8792 discrete_mse=77.156258 best_discrete=12.946534 hash=False elapsed=74.8s
step   850/900 tau=0.0365 loss=0.383794 mse_soft=0.383566 ent_in=0.5649 ent_out=0.1945 rowmax_in=0.7288 rowmax_out=0.8974 discrete_mse=63.632984 best_discrete=12.946534 hash=False elapsed=77.1s
step   875/900 tau=0.0331 loss=0.361411 mse_soft=0.361238 ent_in=0.4152 ent_out=0.1616 rowmax_in=0.7865 rowmax_out=0.9088 discrete_mse=22.227747 best_discrete=12.946534 hash=False elapsed=79.3s
step   900/900 tau=0.0300 loss=0.347509 mse_soft=0.347335 ent_in=0.4170 ent_out=0.1621 rowmax_in=0.7656 rowmax_out=0.9060 discrete_mse=34.010563 best_discrete=12.946534 hash=False elapsed=81.5s

Final metrics:
  soft_mse_full=0.354401
  rowmax_in_mean=0.7668
  rowmax_out_mean=0.9072
  ent_in_mean=0.4163
  ent_out_mean=0.1602
  final_discrete_mse=15.982017
  hash_match=False
  best_discrete_mse_seen=12.946534
Saved results to overnight_b230_j1.json
