Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.056002 mse_soft=1.053679 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=11.087969 best_discrete=11.087969 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.850943 mse_soft=0.848753 ent_in=3.6337 ent_out=3.6666 rowmax_in=0.0456 rowmax_out=0.0443 discrete_mse=8047.375977 best_discrete=11.087969 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.638601 mse_soft=0.636690 ent_in=3.1424 ent_out=3.2277 rowmax_in=0.0919 rowmax_out=0.0864 discrete_mse=3176.857422 best_discrete=11.087969 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.503274 mse_soft=0.501684 ent_in=2.6193 ent_out=2.6805 rowmax_in=0.2038 rowmax_out=0.2006 discrete_mse=1186.310913 best_discrete=11.087969 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.394535 mse_soft=0.393375 ent_in=2.0224 ent_out=1.8465 rowmax_in=0.3473 rowmax_out=0.4321 discrete_mse=5075.012207 best_discrete=11.087969 hash=False elapsed=9.5s
step   125/900 tau=0.6165 loss=0.335656 mse_soft=0.334773 ent_in=1.7105 ent_out=1.2315 rowmax_in=0.4130 rowmax_out=0.6086 discrete_mse=38575.199219 best_discrete=11.087969 hash=False elapsed=11.8s
step   150/900 tau=0.5592 loss=0.307648 mse_soft=0.306928 ent_in=1.5209 ent_out=0.8800 rowmax_in=0.4502 rowmax_out=0.7151 discrete_mse=2712.697021 best_discrete=11.087969 hash=False elapsed=14.2s
step   175/900 tau=0.5073 loss=0.294609 mse_soft=0.293995 ent_in=1.4107 ent_out=0.6383 rowmax_in=0.4646 rowmax_out=0.7976 discrete_mse=8509.326172 best_discrete=11.087969 hash=False elapsed=16.4s
step   200/900 tau=0.4602 loss=0.287044 mse_soft=0.286494 ent_in=1.3553 ent_out=0.4788 rowmax_in=0.4674 rowmax_out=0.8439 discrete_mse=10296.769531 best_discrete=11.087969 hash=False elapsed=18.5s
step   225/900 tau=0.4174 loss=0.281300 mse_soft=0.280796 ent_in=1.3160 ent_out=0.3646 rowmax_in=0.4694 rowmax_out=0.8740 discrete_mse=3410.403564 best_discrete=11.087969 hash=False elapsed=20.6s
step   250/900 tau=0.3786 loss=0.278638 mse_soft=0.278160 ent_in=1.2904 ent_out=0.3026 rowmax_in=0.4731 rowmax_out=0.8892 discrete_mse=5348.625000 best_discrete=11.087969 hash=False elapsed=22.7s
step   275/900 tau=0.3434 loss=0.273825 mse_soft=0.273362 ent_in=1.2799 ent_out=0.2644 rowmax_in=0.4723 rowmax_out=0.8967 discrete_mse=7808.023926 best_discrete=11.087969 hash=False elapsed=24.6s
step   300/900 tau=0.3115 loss=0.272977 mse_soft=0.272527 ent_in=1.2631 ent_out=0.2369 rowmax_in=0.4733 rowmax_out=0.9029 discrete_mse=7808.023926 best_discrete=11.087969 hash=False elapsed=26.7s
step   325/900 tau=0.2826 loss=0.271693 mse_soft=0.271253 ent_in=1.2506 ent_out=0.2188 rowmax_in=0.4738 rowmax_out=0.9062 discrete_mse=16398.736328 best_discrete=11.087969 hash=False elapsed=28.8s
step   350/900 tau=0.2563 loss=0.269656 mse_soft=0.269223 ent_in=1.2382 ent_out=0.2071 rowmax_in=0.4741 rowmax_out=0.9077 discrete_mse=3395.852783 best_discrete=11.087969 hash=False elapsed=31.1s
step   375/900 tau=0.2325 loss=0.271550 mse_soft=0.271122 ent_in=1.2271 ent_out=0.2002 rowmax_in=0.4753 rowmax_out=0.9088 discrete_mse=3395.852783 best_discrete=11.087969 hash=False elapsed=33.3s
step   400/900 tau=0.2109 loss=0.268553 mse_soft=0.268128 ent_in=1.2226 ent_out=0.1959 rowmax_in=0.4754 rowmax_out=0.9094 discrete_mse=3904.661621 best_discrete=11.087969 hash=False elapsed=35.6s
step   425/900 tau=0.1913 loss=0.268169 mse_soft=0.267747 ent_in=1.2153 ent_out=0.1922 rowmax_in=0.4798 rowmax_out=0.9109 discrete_mse=3880.414307 best_discrete=11.087969 hash=False elapsed=38.0s
step   450/900 tau=0.1735 loss=0.274286 mse_soft=0.273866 ent_in=1.2080 ent_out=0.1898 rowmax_in=0.4836 rowmax_out=0.9113 discrete_mse=3904.661621 best_discrete=11.087969 hash=False elapsed=40.1s
step   475/900 tau=0.1574 loss=0.270238 mse_soft=0.269820 ent_in=1.2067 ent_out=0.1877 rowmax_in=0.4808 rowmax_out=0.9133 discrete_mse=3904.661621 best_discrete=11.087969 hash=False elapsed=42.3s
step   500/900 tau=0.1428 loss=0.284639 mse_soft=0.284220 ent_in=1.2077 ent_out=0.1870 rowmax_in=0.4802 rowmax_out=0.9111 discrete_mse=1897.979736 best_discrete=11.087969 hash=False elapsed=44.4s
step   525/900 tau=0.1295 loss=0.274301 mse_soft=0.273885 ent_in=1.2032 ent_out=0.1847 rowmax_in=0.4793 rowmax_out=0.9132 discrete_mse=490.978790 best_discrete=11.087969 hash=False elapsed=46.7s
step   550/900 tau=0.1175 loss=0.288506 mse_soft=0.288091 ent_in=1.2005 ent_out=0.1819 rowmax_in=0.4796 rowmax_out=0.9134 discrete_mse=905.365051 best_discrete=11.087969 hash=False elapsed=48.9s
step   575/900 tau=0.1066 loss=0.273841 mse_soft=0.273427 ent_in=1.1983 ent_out=0.1792 rowmax_in=0.4804 rowmax_out=0.9156 discrete_mse=408.254913 best_discrete=11.087969 hash=False elapsed=51.2s
step   600/900 tau=0.0967 loss=0.290205 mse_soft=0.289796 ent_in=1.1877 ent_out=0.1758 rowmax_in=0.4829 rowmax_out=0.9164 discrete_mse=421.228394 best_discrete=11.087969 hash=False elapsed=53.4s
step   625/900 tau=0.0877 loss=0.283472 mse_soft=0.283078 ent_in=1.1512 ent_out=0.1615 rowmax_in=0.4938 rowmax_out=0.9197 discrete_mse=401.258270 best_discrete=11.087969 hash=False elapsed=55.7s
step   650/900 tau=0.0795 loss=0.277182 mse_soft=0.276786 ent_in=1.1572 ent_out=0.1640 rowmax_in=0.4846 rowmax_out=0.9193 discrete_mse=187.342148 best_discrete=11.087969 hash=False elapsed=58.1s
step   675/900 tau=0.0722 loss=0.291116 mse_soft=0.290721 ent_in=1.1479 ent_out=0.1689 rowmax_in=0.4893 rowmax_out=0.9182 discrete_mse=440.638275 best_discrete=11.087969 hash=False elapsed=60.4s
step   700/900 tau=0.0655 loss=0.332377 mse_soft=0.331988 ent_in=1.1367 ent_out=0.1613 rowmax_in=0.4940 rowmax_out=0.9192 discrete_mse=200.884857 best_discrete=11.087969 hash=False elapsed=62.7s
step   725/900 tau=0.0594 loss=0.391774 mse_soft=0.391529 ent_in=0.7377 ent_out=0.0814 rowmax_in=0.6436 rowmax_out=0.9739 discrete_mse=135.766815 best_discrete=11.087969 hash=False elapsed=64.7s
step   750/900 tau=0.0539 loss=0.360748 mse_soft=0.360491 ent_in=0.7250 ent_out=0.1299 rowmax_in=0.6213 rowmax_out=0.9377 discrete_mse=67.858925 best_discrete=11.087969 hash=False elapsed=66.8s
step   775/900 tau=0.0489 loss=0.338167 mse_soft=0.337917 ent_in=0.7071 ent_out=0.1266 rowmax_in=0.6283 rowmax_out=0.9386 discrete_mse=46.328884 best_discrete=11.087969 hash=False elapsed=68.9s
step   800/900 tau=0.0443 loss=0.330671 mse_soft=0.330419 ent_in=0.7217 ent_out=0.1202 rowmax_in=0.6228 rowmax_out=0.9453 discrete_mse=31.659311 best_discrete=11.087969 hash=False elapsed=71.3s
step   825/900 tau=0.0402 loss=0.328140 mse_soft=0.327880 ent_in=0.7389 ent_out=0.1272 rowmax_in=0.6095 rowmax_out=0.9364 discrete_mse=72.560936 best_discrete=11.087969 hash=False elapsed=73.4s
step   850/900 tau=0.0365 loss=0.902911 mse_soft=0.902713 ent_in=0.5452 ent_out=0.1176 rowmax_in=0.7320 rowmax_out=0.9433 discrete_mse=183.418915 best_discrete=11.087969 hash=False elapsed=75.6s
step   875/900 tau=0.0331 loss=0.437120 mse_soft=0.436990 ent_in=0.3598 ent_out=0.0761 rowmax_in=0.8156 rowmax_out=0.9589 discrete_mse=1.098221 best_discrete=1.098221 hash=False elapsed=78.0s
step   900/900 tau=0.0300 loss=0.415792 mse_soft=0.415662 ent_in=0.3518 ent_out=0.0809 rowmax_in=0.8268 rowmax_out=0.9558 discrete_mse=5.339230 best_discrete=1.098221 hash=False elapsed=80.3s

Final metrics:
  soft_mse_full=0.426035
  rowmax_in_mean=0.8272
  rowmax_out_mean=0.9559
  ent_in_mean=0.3513
  ent_out_mean=0.0807
  final_discrete_mse=5.339230
  hash_match=False
  best_discrete_mse_seen=1.098221
Saved results to overnight_b165_j1.json
