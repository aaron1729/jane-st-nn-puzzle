Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.064955 mse_soft=1.062632 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=38.194080 best_discrete=38.194080 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.866876 mse_soft=0.864687 ent_in=3.6342 ent_out=3.6642 rowmax_in=0.0462 rowmax_out=0.0448 discrete_mse=2543.274658 best_discrete=38.194080 hash=False elapsed=2.7s
step    50/900 tau=0.8229 loss=0.651346 mse_soft=0.649445 ent_in=3.1237 ent_out=3.2137 rowmax_in=0.0927 rowmax_out=0.0899 discrete_mse=6312.387207 best_discrete=38.194080 hash=False elapsed=5.2s
step    75/900 tau=0.7450 loss=0.502717 mse_soft=0.501147 ent_in=2.5827 ent_out=2.6534 rowmax_in=0.2076 rowmax_out=0.1970 discrete_mse=974.471558 best_discrete=38.194080 hash=False elapsed=7.4s
step   100/900 tau=0.6745 loss=0.401436 mse_soft=0.400256 ent_in=2.0368 ent_out=1.8983 rowmax_in=0.3331 rowmax_out=0.3975 discrete_mse=1715.036499 best_discrete=38.194080 hash=False elapsed=9.6s
step   125/900 tau=0.6107 loss=0.344712 mse_soft=0.343849 ent_in=1.6424 ent_out=1.2360 rowmax_in=0.4325 rowmax_out=0.5905 discrete_mse=674.700684 best_discrete=38.194080 hash=False elapsed=12.1s
step   150/900 tau=0.5529 loss=0.322629 mse_soft=0.321919 ent_in=1.4723 ent_out=0.8939 rowmax_in=0.4631 rowmax_out=0.6887 discrete_mse=603.265076 best_discrete=38.194080 hash=False elapsed=14.5s
step   175/900 tau=0.5006 loss=0.308512 mse_soft=0.307901 ent_in=1.3487 ent_out=0.6885 rowmax_in=0.4796 rowmax_out=0.7449 discrete_mse=472.422699 best_discrete=38.194080 hash=False elapsed=16.8s
step   200/900 tau=0.4532 loss=0.298575 mse_soft=0.298020 ent_in=1.2670 ent_out=0.5801 rowmax_in=0.4966 rowmax_out=0.7767 discrete_mse=672.410156 best_discrete=38.194080 hash=False elapsed=19.2s
step   225/900 tau=0.4103 loss=0.293845 mse_soft=0.293325 ent_in=1.2107 ent_out=0.5220 rowmax_in=0.5064 rowmax_out=0.7895 discrete_mse=125.399300 best_discrete=38.194080 hash=False elapsed=21.5s
step   250/900 tau=0.3715 loss=0.290297 mse_soft=0.289799 ent_in=1.1815 ent_out=0.4783 rowmax_in=0.5145 rowmax_out=0.8016 discrete_mse=281.316528 best_discrete=38.194080 hash=False elapsed=24.0s
step   275/900 tau=0.3363 loss=0.287364 mse_soft=0.286883 ent_in=1.1526 ent_out=0.4518 rowmax_in=0.5227 rowmax_out=0.8073 discrete_mse=549.528625 best_discrete=38.194080 hash=False elapsed=26.3s
step   300/900 tau=0.3045 loss=0.288040 mse_soft=0.287573 ent_in=1.1235 ent_out=0.4339 rowmax_in=0.5306 rowmax_out=0.8149 discrete_mse=549.528625 best_discrete=38.194080 hash=False elapsed=28.7s
step   325/900 tau=0.2756 loss=0.284311 mse_soft=0.283856 ent_in=1.1023 ent_out=0.4129 rowmax_in=0.5335 rowmax_out=0.8244 discrete_mse=355.618561 best_discrete=38.194080 hash=False elapsed=31.0s
step   350/900 tau=0.2496 loss=0.282791 mse_soft=0.282342 ent_in=1.0920 ent_out=0.4018 rowmax_in=0.5370 rowmax_out=0.8233 discrete_mse=355.618561 best_discrete=38.194080 hash=False elapsed=33.4s
step   375/900 tau=0.2259 loss=0.283982 mse_soft=0.283540 ent_in=1.0809 ent_out=0.3920 rowmax_in=0.5420 rowmax_out=0.8231 discrete_mse=355.618561 best_discrete=38.194080 hash=False elapsed=35.8s
step   400/900 tau=0.2046 loss=0.282175 mse_soft=0.281739 ent_in=1.0716 ent_out=0.3817 rowmax_in=0.5447 rowmax_out=0.8239 discrete_mse=355.618561 best_discrete=38.194080 hash=False elapsed=38.1s
step   425/900 tau=0.1852 loss=0.285388 mse_soft=0.284955 ent_in=1.0676 ent_out=0.3772 rowmax_in=0.5458 rowmax_out=0.8239 discrete_mse=355.618561 best_discrete=38.194080 hash=False elapsed=40.5s
step   450/900 tau=0.1677 loss=0.285365 mse_soft=0.284934 ent_in=1.0632 ent_out=0.3727 rowmax_in=0.5465 rowmax_out=0.8267 discrete_mse=355.618561 best_discrete=38.194080 hash=False elapsed=42.9s
step   475/900 tau=0.1518 loss=0.282922 mse_soft=0.282496 ent_in=1.0538 ent_out=0.3662 rowmax_in=0.5511 rowmax_out=0.8288 discrete_mse=355.618561 best_discrete=38.194080 hash=False elapsed=45.3s
step   500/900 tau=0.1374 loss=0.282357 mse_soft=0.281938 ent_in=1.0362 ent_out=0.3599 rowmax_in=0.5561 rowmax_out=0.8333 discrete_mse=601.075012 best_discrete=38.194080 hash=False elapsed=47.7s
step   525/900 tau=0.1244 loss=0.281175 mse_soft=0.280765 ent_in=1.0248 ent_out=0.3431 rowmax_in=0.5594 rowmax_out=0.8398 discrete_mse=167.138275 best_discrete=38.194080 hash=False elapsed=50.0s
step   550/900 tau=0.1126 loss=0.283949 mse_soft=0.283550 ent_in=1.0050 ent_out=0.3279 rowmax_in=0.5647 rowmax_out=0.8432 discrete_mse=230.612595 best_discrete=38.194080 hash=False elapsed=52.4s
step   575/900 tau=0.1020 loss=0.277243 mse_soft=0.276849 ent_in=0.9938 ent_out=0.3178 rowmax_in=0.5674 rowmax_out=0.8481 discrete_mse=269.808838 best_discrete=38.194080 hash=False elapsed=54.8s
step   600/900 tau=0.0923 loss=0.277144 mse_soft=0.276759 ent_in=0.9777 ent_out=0.3050 rowmax_in=0.5710 rowmax_out=0.8506 discrete_mse=333.999756 best_discrete=38.194080 hash=False elapsed=57.1s
step   625/900 tau=0.0836 loss=0.289274 mse_soft=0.288892 ent_in=0.9759 ent_out=0.3001 rowmax_in=0.5689 rowmax_out=0.8507 discrete_mse=174.215744 best_discrete=38.194080 hash=False elapsed=59.3s
step   650/900 tau=0.0757 loss=0.287029 mse_soft=0.286650 ent_in=0.9699 ent_out=0.2931 rowmax_in=0.5659 rowmax_out=0.8541 discrete_mse=174.215744 best_discrete=38.194080 hash=False elapsed=61.8s
step   675/900 tau=0.0685 loss=0.289272 mse_soft=0.288904 ent_in=0.9385 ent_out=0.2894 rowmax_in=0.5816 rowmax_out=0.8568 discrete_mse=116.512848 best_discrete=38.194080 hash=False elapsed=64.0s
step   700/900 tau=0.0620 loss=0.293944 mse_soft=0.293577 ent_in=0.9387 ent_out=0.2846 rowmax_in=0.5755 rowmax_out=0.8568 discrete_mse=101.624374 best_discrete=38.194080 hash=False elapsed=66.2s
step   725/900 tau=0.0562 loss=0.530374 mse_soft=0.530204 ent_in=0.3851 ent_out=0.1833 rowmax_in=0.8254 rowmax_out=0.9005 discrete_mse=30.653662 best_discrete=30.653662 hash=False elapsed=68.4s
step   750/900 tau=0.0508 loss=0.479559 mse_soft=0.479390 ent_in=0.3943 ent_out=0.1696 rowmax_in=0.7967 rowmax_out=0.9019 discrete_mse=68.932320 best_discrete=30.653662 hash=False elapsed=70.5s
step   775/900 tau=0.0460 loss=0.452660 mse_soft=0.452511 ent_in=0.3606 ent_out=0.1349 rowmax_in=0.8258 rowmax_out=0.9166 discrete_mse=119.723572 best_discrete=30.653662 hash=False elapsed=72.6s
step   800/900 tau=0.0417 loss=0.445597 mse_soft=0.445442 ent_in=0.3861 ent_out=0.1309 rowmax_in=0.8195 rowmax_out=0.9169 discrete_mse=157.921021 best_discrete=30.653662 hash=False elapsed=74.7s
step   825/900 tau=0.0377 loss=0.482555 mse_soft=0.482396 ent_in=0.4102 ent_out=0.1207 rowmax_in=0.7924 rowmax_out=0.9203 discrete_mse=42.255367 best_discrete=30.653662 hash=False elapsed=76.9s
step   850/900 tau=0.0342 loss=0.450142 mse_soft=0.450004 ent_in=0.3614 ent_out=0.0986 rowmax_in=0.8112 rowmax_out=0.9236 discrete_mse=35.642376 best_discrete=30.653662 hash=False elapsed=79.0s
step   875/900 tau=0.0309 loss=0.430030 mse_soft=0.429885 ent_in=0.3884 ent_out=0.0964 rowmax_in=0.7908 rowmax_out=0.9305 discrete_mse=99.845245 best_discrete=30.653662 hash=False elapsed=81.0s
step   900/900 tau=0.0280 loss=0.457163 mse_soft=0.457034 ent_in=0.3323 ent_out=0.0977 rowmax_in=0.8354 rowmax_out=0.9306 discrete_mse=102.550308 best_discrete=30.653662 hash=False elapsed=83.2s

Final metrics:
  soft_mse_full=0.460212
  rowmax_in_mean=0.8322
  rowmax_out_mean=0.9306
  ent_in_mean=0.3347
  ent_out_mean=0.0975
  final_discrete_mse=102.550308
  hash_match=False
  best_discrete_mse_seen=30.653662
Saved results to overnight_b178_j2.json
