Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.082791 mse_soft=1.080468 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=41.789700 best_discrete=41.789700 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.875323 mse_soft=0.873134 ent_in=3.6313 ent_out=3.6652 rowmax_in=0.0465 rowmax_out=0.0442 discrete_mse=3813.663574 best_discrete=41.789700 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.651768 mse_soft=0.649867 ent_in=3.1222 ent_out=3.2154 rowmax_in=0.0947 rowmax_out=0.0897 discrete_mse=3620.804688 best_discrete=41.789700 hash=False elapsed=5.1s
step    75/900 tau=0.7493 loss=0.510656 mse_soft=0.509073 ent_in=2.5996 ent_out=2.6762 rowmax_in=0.2034 rowmax_out=0.2021 discrete_mse=804.041260 best_discrete=41.789700 hash=False elapsed=7.4s
step   100/900 tau=0.6797 loss=0.405477 mse_soft=0.404310 ent_in=2.0261 ent_out=1.8645 rowmax_in=0.3404 rowmax_out=0.4067 discrete_mse=825.546265 best_discrete=41.789700 hash=False elapsed=9.8s
step   125/900 tau=0.6165 loss=0.346716 mse_soft=0.345846 ent_in=1.6547 ent_out=1.2451 rowmax_in=0.4145 rowmax_out=0.5838 discrete_mse=372.341888 best_discrete=41.789700 hash=False elapsed=12.2s
step   150/900 tau=0.5592 loss=0.316397 mse_soft=0.315730 ent_in=1.4236 ent_out=0.7984 rowmax_in=0.4558 rowmax_out=0.7192 discrete_mse=317.189056 best_discrete=41.789700 hash=False elapsed=14.7s
step   175/900 tau=0.5073 loss=0.304950 mse_soft=0.304354 ent_in=1.3343 ent_out=0.6522 rowmax_in=0.4655 rowmax_out=0.7544 discrete_mse=1170.435669 best_discrete=41.789700 hash=False elapsed=17.1s
step   200/900 tau=0.4602 loss=0.296870 mse_soft=0.296312 ent_in=1.2863 ent_out=0.5741 rowmax_in=0.4762 rowmax_out=0.7716 discrete_mse=465.826630 best_discrete=41.789700 hash=False elapsed=19.4s
step   225/900 tau=0.4174 loss=0.289818 mse_soft=0.289299 ent_in=1.2297 ent_out=0.5010 rowmax_in=0.4916 rowmax_out=0.7978 discrete_mse=496.542236 best_discrete=41.789700 hash=False elapsed=21.6s
step   250/900 tau=0.3786 loss=0.283312 mse_soft=0.282823 ent_in=1.1726 ent_out=0.4570 rowmax_in=0.5128 rowmax_out=0.8122 discrete_mse=703.134216 best_discrete=41.789700 hash=False elapsed=24.0s
step   275/900 tau=0.3434 loss=0.280726 mse_soft=0.280251 ent_in=1.1431 ent_out=0.4410 rowmax_in=0.5244 rowmax_out=0.8160 discrete_mse=601.049988 best_discrete=41.789700 hash=False elapsed=26.2s
step   300/900 tau=0.3115 loss=0.279901 mse_soft=0.279439 ent_in=1.1311 ent_out=0.4105 rowmax_in=0.5248 rowmax_out=0.8279 discrete_mse=601.049988 best_discrete=41.789700 hash=False elapsed=28.6s
step   325/900 tau=0.2826 loss=0.283290 mse_soft=0.282839 ent_in=1.1238 ent_out=0.3792 rowmax_in=0.5249 rowmax_out=0.8386 discrete_mse=693.447754 best_discrete=41.789700 hash=False elapsed=31.0s
step   350/900 tau=0.2563 loss=0.277153 mse_soft=0.276709 ent_in=1.1127 ent_out=0.3675 rowmax_in=0.5242 rowmax_out=0.8416 discrete_mse=693.447754 best_discrete=41.789700 hash=False elapsed=33.4s
step   375/900 tau=0.2325 loss=0.277057 mse_soft=0.276617 ent_in=1.1088 ent_out=0.3575 rowmax_in=0.5228 rowmax_out=0.8448 discrete_mse=633.611877 best_discrete=41.789700 hash=False elapsed=36.0s
step   400/900 tau=0.2109 loss=0.277842 mse_soft=0.277407 ent_in=1.1041 ent_out=0.3442 rowmax_in=0.5234 rowmax_out=0.8484 discrete_mse=633.611877 best_discrete=41.789700 hash=False elapsed=38.3s
step   425/900 tau=0.1913 loss=0.278117 mse_soft=0.277686 ent_in=1.0964 ent_out=0.3424 rowmax_in=0.5251 rowmax_out=0.8491 discrete_mse=909.989868 best_discrete=41.789700 hash=False elapsed=40.7s
step   450/900 tau=0.1735 loss=0.277384 mse_soft=0.276953 ent_in=1.0897 ent_out=0.3452 rowmax_in=0.5264 rowmax_out=0.8475 discrete_mse=633.611877 best_discrete=41.789700 hash=False elapsed=42.9s
step   475/900 tau=0.1574 loss=0.275462 mse_soft=0.275033 ent_in=1.0837 ent_out=0.3476 rowmax_in=0.5275 rowmax_out=0.8463 discrete_mse=1006.870361 best_discrete=41.789700 hash=False elapsed=45.2s
step   500/900 tau=0.1428 loss=0.282234 mse_soft=0.281805 ent_in=1.0809 ent_out=0.3503 rowmax_in=0.5289 rowmax_out=0.8463 discrete_mse=510.840179 best_discrete=41.789700 hash=False elapsed=47.7s
step   525/900 tau=0.1295 loss=0.278021 mse_soft=0.277590 ent_in=1.0799 ent_out=0.3549 rowmax_in=0.5308 rowmax_out=0.8436 discrete_mse=693.447754 best_discrete=41.789700 hash=False elapsed=50.0s
step   550/900 tau=0.1175 loss=0.286066 mse_soft=0.285639 ent_in=1.0672 ent_out=0.3568 rowmax_in=0.5370 rowmax_out=0.8407 discrete_mse=281.830383 best_discrete=41.789700 hash=False elapsed=52.5s
step   575/900 tau=0.1066 loss=0.287522 mse_soft=0.287099 ent_in=1.0527 ent_out=0.3602 rowmax_in=0.5391 rowmax_out=0.8396 discrete_mse=693.447754 best_discrete=41.789700 hash=False elapsed=54.8s
step   600/900 tau=0.0967 loss=0.278731 mse_soft=0.278312 ent_in=1.0443 ent_out=0.3523 rowmax_in=0.5379 rowmax_out=0.8456 discrete_mse=693.447754 best_discrete=41.789700 hash=False elapsed=57.1s
step   625/900 tau=0.0877 loss=0.279207 mse_soft=0.278793 ent_in=1.0316 ent_out=0.3476 rowmax_in=0.5397 rowmax_out=0.8463 discrete_mse=693.447754 best_discrete=41.789700 hash=False elapsed=59.3s
step   650/900 tau=0.0795 loss=0.279307 mse_soft=0.278894 ent_in=1.0244 ent_out=0.3501 rowmax_in=0.5416 rowmax_out=0.8440 discrete_mse=518.974915 best_discrete=41.789700 hash=False elapsed=61.7s
step   675/900 tau=0.0722 loss=0.445766 mse_soft=0.445421 ent_in=0.8260 ent_out=0.3215 rowmax_in=0.6296 rowmax_out=0.8477 discrete_mse=16.794109 best_discrete=16.794109 hash=False elapsed=64.1s
step   700/900 tau=0.0655 loss=0.354894 mse_soft=0.354632 ent_in=0.5834 ent_out=0.2914 rowmax_in=0.7350 rowmax_out=0.8520 discrete_mse=21.302872 best_discrete=16.794109 hash=False elapsed=66.4s
step   725/900 tau=0.0594 loss=0.337250 mse_soft=0.336997 ent_in=0.5775 ent_out=0.2667 rowmax_in=0.7316 rowmax_out=0.8648 discrete_mse=11.117839 best_discrete=11.117839 hash=False elapsed=68.7s
step   750/900 tau=0.0539 loss=0.327956 mse_soft=0.327693 ent_in=0.6303 ent_out=0.2473 rowmax_in=0.6962 rowmax_out=0.8762 discrete_mse=25.147469 best_discrete=11.117839 hash=False elapsed=71.0s
step   775/900 tau=0.0489 loss=0.329272 mse_soft=0.329012 ent_in=0.6349 ent_out=0.2315 rowmax_in=0.6915 rowmax_out=0.8812 discrete_mse=26.416218 best_discrete=11.117839 hash=False elapsed=73.2s
step   800/900 tau=0.0443 loss=0.328351 mse_soft=0.328094 ent_in=0.6268 ent_out=0.2273 rowmax_in=0.6990 rowmax_out=0.8779 discrete_mse=26.416218 best_discrete=11.117839 hash=False elapsed=75.6s
step   825/900 tau=0.0402 loss=0.400275 mse_soft=0.400030 ent_in=0.5903 ent_out=0.2264 rowmax_in=0.7222 rowmax_out=0.8851 discrete_mse=18.389299 best_discrete=11.117839 hash=False elapsed=78.0s
step   850/900 tau=0.0365 loss=0.382560 mse_soft=0.382399 ent_in=0.3874 ent_out=0.1486 rowmax_in=0.8200 rowmax_out=0.9227 discrete_mse=59.128086 best_discrete=11.117839 hash=False elapsed=80.2s
step   875/900 tau=0.0331 loss=0.371994 mse_soft=0.371833 ent_in=0.3849 ent_out=0.1505 rowmax_in=0.8186 rowmax_out=0.9225 discrete_mse=80.858276 best_discrete=11.117839 hash=False elapsed=82.6s
step   900/900 tau=0.0300 loss=0.369009 mse_soft=0.368845 ent_in=0.3917 ent_out=0.1537 rowmax_in=0.8174 rowmax_out=0.9200 discrete_mse=80.858276 best_discrete=11.117839 hash=False elapsed=84.9s

Final metrics:
  soft_mse_full=0.368889
  rowmax_in_mean=0.8180
  rowmax_out_mean=0.9198
  ent_in_mean=0.3912
  ent_out_mean=0.1539
  final_discrete_mse=80.858276
  hash_match=False
  best_discrete_mse_seen=11.117839
Saved results to overnight_b198_j1.json
