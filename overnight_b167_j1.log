Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.056961 mse_soft=1.054639 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=23.023844 best_discrete=23.023844 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.851663 mse_soft=0.849472 ent_in=3.6364 ent_out=3.6643 rowmax_in=0.0449 rowmax_out=0.0451 discrete_mse=1225.722412 best_discrete=23.023844 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.641045 mse_soft=0.639125 ent_in=3.1564 ent_out=3.2448 rowmax_in=0.0902 rowmax_out=0.0850 discrete_mse=3999.247070 best_discrete=23.023844 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.500050 mse_soft=0.498448 ent_in=2.6427 ent_out=2.6971 rowmax_in=0.1984 rowmax_out=0.1956 discrete_mse=575.245239 best_discrete=23.023844 hash=False elapsed=7.2s
step   100/900 tau=0.6797 loss=0.391091 mse_soft=0.389922 ent_in=2.0435 ent_out=1.8510 rowmax_in=0.3421 rowmax_out=0.4184 discrete_mse=446.566742 best_discrete=23.023844 hash=False elapsed=9.5s
step   125/900 tau=0.6165 loss=0.324551 mse_soft=0.323720 ent_in=1.6264 ent_out=1.1439 rowmax_in=0.4350 rowmax_out=0.6304 discrete_mse=525.575012 best_discrete=23.023844 hash=False elapsed=11.7s
step   150/900 tau=0.5592 loss=0.298241 mse_soft=0.297566 ent_in=1.4412 ent_out=0.8064 rowmax_in=0.4640 rowmax_out=0.7044 discrete_mse=168.748550 best_discrete=23.023844 hash=False elapsed=13.8s
step   175/900 tau=0.5073 loss=0.286418 mse_soft=0.285818 ent_in=1.3661 ent_out=0.6345 rowmax_in=0.4705 rowmax_out=0.7541 discrete_mse=595.084656 best_discrete=23.023844 hash=False elapsed=15.9s
step   200/900 tau=0.4602 loss=0.279994 mse_soft=0.279438 ent_in=1.3054 ent_out=0.5452 rowmax_in=0.4745 rowmax_out=0.7714 discrete_mse=557.489502 best_discrete=23.023844 hash=False elapsed=18.2s
step   225/900 tau=0.4174 loss=0.276054 mse_soft=0.275522 ent_in=1.2655 ent_out=0.5076 rowmax_in=0.4891 rowmax_out=0.7723 discrete_mse=611.078369 best_discrete=23.023844 hash=False elapsed=20.6s
step   250/900 tau=0.3786 loss=0.273926 mse_soft=0.273413 ent_in=1.2329 ent_out=0.4786 rowmax_in=0.4922 rowmax_out=0.7810 discrete_mse=440.903992 best_discrete=23.023844 hash=False elapsed=23.0s
step   275/900 tau=0.3434 loss=0.271083 mse_soft=0.270588 ent_in=1.1980 ent_out=0.4519 rowmax_in=0.5011 rowmax_out=0.7919 discrete_mse=661.827209 best_discrete=23.023844 hash=False elapsed=25.4s
step   300/900 tau=0.3115 loss=0.270851 mse_soft=0.270367 ent_in=1.1746 ent_out=0.4388 rowmax_in=0.5075 rowmax_out=0.8011 discrete_mse=115.409096 best_discrete=23.023844 hash=False elapsed=28.0s
step   325/900 tau=0.2826 loss=0.267987 mse_soft=0.267514 ent_in=1.1549 ent_out=0.4233 rowmax_in=0.5116 rowmax_out=0.8104 discrete_mse=48.875317 best_discrete=23.023844 hash=False elapsed=30.5s
step   350/900 tau=0.2563 loss=0.265968 mse_soft=0.265504 ent_in=1.1403 ent_out=0.4094 rowmax_in=0.5140 rowmax_out=0.8168 discrete_mse=120.010345 best_discrete=23.023844 hash=False elapsed=32.9s
step   375/900 tau=0.2325 loss=0.264744 mse_soft=0.264287 ent_in=1.1234 ent_out=0.3994 rowmax_in=0.5192 rowmax_out=0.8194 discrete_mse=120.010345 best_discrete=23.023844 hash=False elapsed=35.3s
step   400/900 tau=0.2109 loss=0.265847 mse_soft=0.265397 ent_in=1.1138 ent_out=0.3885 rowmax_in=0.5210 rowmax_out=0.8212 discrete_mse=240.122299 best_discrete=23.023844 hash=False elapsed=37.8s
step   425/900 tau=0.1913 loss=0.263635 mse_soft=0.263196 ent_in=1.0882 ent_out=0.3769 rowmax_in=0.5370 rowmax_out=0.8253 discrete_mse=239.860321 best_discrete=23.023844 hash=False elapsed=39.9s
step   450/900 tau=0.1735 loss=0.262574 mse_soft=0.262137 ent_in=1.0841 ent_out=0.3733 rowmax_in=0.5367 rowmax_out=0.8290 discrete_mse=239.860321 best_discrete=23.023844 hash=False elapsed=42.1s
step   475/900 tau=0.1574 loss=0.262533 mse_soft=0.262100 ent_in=1.0770 ent_out=0.3662 rowmax_in=0.5369 rowmax_out=0.8330 discrete_mse=290.466461 best_discrete=23.023844 hash=False elapsed=44.4s
step   500/900 tau=0.1428 loss=0.264793 mse_soft=0.264364 ent_in=1.0707 ent_out=0.3601 rowmax_in=0.5379 rowmax_out=0.8364 discrete_mse=239.860321 best_discrete=23.023844 hash=False elapsed=46.7s
step   525/900 tau=0.1295 loss=0.267448 mse_soft=0.267023 ent_in=1.0674 ent_out=0.3471 rowmax_in=0.5380 rowmax_out=0.8417 discrete_mse=239.860321 best_discrete=23.023844 hash=False elapsed=49.1s
step   550/900 tau=0.1175 loss=0.262435 mse_soft=0.262014 ent_in=1.0700 ent_out=0.3363 rowmax_in=0.5358 rowmax_out=0.8444 discrete_mse=239.860321 best_discrete=23.023844 hash=False elapsed=51.6s
step   575/900 tau=0.1066 loss=0.269893 mse_soft=0.269477 ent_in=1.0666 ent_out=0.3211 rowmax_in=0.5360 rowmax_out=0.8478 discrete_mse=183.553268 best_discrete=23.023844 hash=False elapsed=53.8s
step   600/900 tau=0.0967 loss=0.263581 mse_soft=0.263170 ent_in=1.0593 ent_out=0.3100 rowmax_in=0.5370 rowmax_out=0.8594 discrete_mse=186.900681 best_discrete=23.023844 hash=False elapsed=56.0s
step   625/900 tau=0.0877 loss=0.485325 mse_soft=0.485007 ent_in=0.8511 ent_out=0.2097 rowmax_in=0.6204 rowmax_out=0.9104 discrete_mse=37.469856 best_discrete=23.023844 hash=False elapsed=58.1s
step   650/900 tau=0.0795 loss=0.344744 mse_soft=0.344464 ent_in=0.7365 ent_out=0.1967 rowmax_in=0.6412 rowmax_out=0.9000 discrete_mse=10.557037 best_discrete=10.557037 hash=False elapsed=60.4s
step   675/900 tau=0.0722 loss=0.330764 mse_soft=0.330495 ent_in=0.7428 ent_out=0.1544 rowmax_in=0.6335 rowmax_out=0.9200 discrete_mse=49.504284 best_discrete=10.557037 hash=False elapsed=62.5s
step   700/900 tau=0.0655 loss=0.326591 mse_soft=0.326321 ent_in=0.7346 ent_out=0.1662 rowmax_in=0.6337 rowmax_out=0.9086 discrete_mse=112.888084 best_discrete=10.557037 hash=False elapsed=64.8s
step   725/900 tau=0.0594 loss=0.319587 mse_soft=0.319319 ent_in=0.7417 ent_out=0.1519 rowmax_in=0.6284 rowmax_out=0.9207 discrete_mse=168.983414 best_discrete=10.557037 hash=False elapsed=67.1s
step   750/900 tau=0.0539 loss=0.322494 mse_soft=0.322229 ent_in=0.7414 ent_out=0.1403 rowmax_in=0.6272 rowmax_out=0.9220 discrete_mse=135.111786 best_discrete=10.557037 hash=False elapsed=69.4s
step   775/900 tau=0.0489 loss=0.321167 mse_soft=0.320903 ent_in=0.7367 ent_out=0.1424 rowmax_in=0.6272 rowmax_out=0.9228 discrete_mse=262.232422 best_discrete=10.557037 hash=False elapsed=71.8s
step   800/900 tau=0.0443 loss=0.371996 mse_soft=0.371762 ent_in=0.6534 ent_out=0.1291 rowmax_in=0.6724 rowmax_out=0.9263 discrete_mse=90.232521 best_discrete=10.557037 hash=False elapsed=74.1s
step   825/900 tau=0.0402 loss=0.333893 mse_soft=0.333667 ent_in=0.6256 ent_out=0.1260 rowmax_in=0.6753 rowmax_out=0.9265 discrete_mse=108.965523 best_discrete=10.557037 hash=False elapsed=76.4s
step   850/900 tau=0.0365 loss=0.327886 mse_soft=0.327657 ent_in=0.6384 ent_out=0.1256 rowmax_in=0.6584 rowmax_out=0.9262 discrete_mse=108.965523 best_discrete=10.557037 hash=False elapsed=78.9s
step   875/900 tau=0.0331 loss=0.344736 mse_soft=0.344508 ent_in=0.6351 ent_out=0.1273 rowmax_in=0.6659 rowmax_out=0.9226 discrete_mse=186.655899 best_discrete=10.557037 hash=False elapsed=81.3s
step   900/900 tau=0.0300 loss=1.149866 mse_soft=1.149776 ent_in=0.2308 ent_out=0.0664 rowmax_in=0.8680 rowmax_out=0.9567 discrete_mse=175.988373 best_discrete=10.557037 hash=False elapsed=83.6s

Final metrics:
  soft_mse_full=0.808243
  rowmax_in_mean=0.8595
  rowmax_out_mean=0.9567
  ent_in_mean=0.2441
  ent_out_mean=0.0661
  final_discrete_mse=175.988373
  hash_match=False
  best_discrete_mse_seen=10.557037
Saved results to overnight_b167_j1.json
