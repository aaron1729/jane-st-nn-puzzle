Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.065547 mse_soft=1.063224 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=18.676977 best_discrete=18.676977 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.857553 mse_soft=0.855364 ent_in=3.6332 ent_out=3.6660 rowmax_in=0.0462 rowmax_out=0.0447 discrete_mse=4465.098633 best_discrete=18.676977 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.634230 mse_soft=0.632325 ent_in=3.1269 ent_out=3.2236 rowmax_in=0.0939 rowmax_out=0.0873 discrete_mse=1774.035767 best_discrete=18.676977 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.498668 mse_soft=0.497087 ent_in=2.5857 ent_out=2.6845 rowmax_in=0.2025 rowmax_out=0.1910 discrete_mse=227.905045 best_discrete=18.676977 hash=False elapsed=7.4s
step   100/900 tau=0.6797 loss=0.399552 mse_soft=0.398380 ent_in=1.9740 ent_out=1.9336 rowmax_in=0.3545 rowmax_out=0.3807 discrete_mse=8129.794434 best_discrete=18.676977 hash=False elapsed=9.6s
step   125/900 tau=0.6165 loss=0.339647 mse_soft=0.338785 ent_in=1.6004 ent_out=1.2723 rowmax_in=0.4391 rowmax_out=0.5697 discrete_mse=819.814270 best_discrete=18.676977 hash=False elapsed=11.8s
step   150/900 tau=0.5592 loss=0.313891 mse_soft=0.313210 ent_in=1.4535 ent_out=0.8189 rowmax_in=0.4746 rowmax_out=0.7180 discrete_mse=318.589752 best_discrete=18.676977 hash=False elapsed=13.8s
step   175/900 tau=0.5073 loss=0.300331 mse_soft=0.299754 ent_in=1.3591 ent_out=0.5644 rowmax_in=0.4930 rowmax_out=0.8056 discrete_mse=370.166992 best_discrete=18.676977 hash=False elapsed=16.0s
step   200/900 tau=0.4602 loss=0.293461 mse_soft=0.292929 ent_in=1.3008 ent_out=0.4725 rowmax_in=0.5019 rowmax_out=0.8404 discrete_mse=14.436556 best_discrete=14.436556 hash=False elapsed=18.1s
step   225/900 tau=0.4174 loss=0.286635 mse_soft=0.286131 ent_in=1.2564 ent_out=0.4235 rowmax_in=0.5119 rowmax_out=0.8554 discrete_mse=14.436556 best_discrete=14.436556 hash=False elapsed=20.4s
step   250/900 tau=0.3786 loss=0.283540 mse_soft=0.283058 ent_in=1.2225 ent_out=0.3841 rowmax_in=0.5173 rowmax_out=0.8626 discrete_mse=325.060730 best_discrete=14.436556 hash=False elapsed=22.8s
step   275/900 tau=0.3434 loss=0.285762 mse_soft=0.285293 ent_in=1.1976 ent_out=0.3665 rowmax_in=0.5209 rowmax_out=0.8626 discrete_mse=160.627625 best_discrete=14.436556 hash=False elapsed=25.0s
step   300/900 tau=0.3115 loss=0.279294 mse_soft=0.278838 ent_in=1.1742 ent_out=0.3476 rowmax_in=0.5232 rowmax_out=0.8650 discrete_mse=201.558197 best_discrete=14.436556 hash=False elapsed=27.2s
step   325/900 tau=0.2826 loss=0.290487 mse_soft=0.290039 ent_in=1.1611 ent_out=0.3313 rowmax_in=0.5210 rowmax_out=0.8654 discrete_mse=183.598068 best_discrete=14.436556 hash=False elapsed=29.6s
step   350/900 tau=0.2563 loss=0.278723 mse_soft=0.278284 ent_in=1.1461 ent_out=0.3181 rowmax_in=0.5254 rowmax_out=0.8679 discrete_mse=183.598068 best_discrete=14.436556 hash=False elapsed=31.9s
step   375/900 tau=0.2325 loss=0.277240 mse_soft=0.276807 ent_in=1.1375 ent_out=0.3067 rowmax_in=0.5266 rowmax_out=0.8706 discrete_mse=183.598068 best_discrete=14.436556 hash=False elapsed=34.0s
step   400/900 tau=0.2109 loss=0.277257 mse_soft=0.276826 ent_in=1.1329 ent_out=0.3026 rowmax_in=0.5262 rowmax_out=0.8668 discrete_mse=183.598068 best_discrete=14.436556 hash=False elapsed=35.9s
step   425/900 tau=0.1913 loss=0.276837 mse_soft=0.276411 ent_in=1.1242 ent_out=0.2975 rowmax_in=0.5280 rowmax_out=0.8708 discrete_mse=183.598068 best_discrete=14.436556 hash=False elapsed=37.8s
step   450/900 tau=0.1735 loss=0.276891 mse_soft=0.276467 ent_in=1.1159 ent_out=0.2959 rowmax_in=0.5311 rowmax_out=0.8676 discrete_mse=183.598068 best_discrete=14.436556 hash=False elapsed=39.8s
step   475/900 tau=0.1574 loss=0.280977 mse_soft=0.280556 ent_in=1.1088 ent_out=0.2923 rowmax_in=0.5309 rowmax_out=0.8666 discrete_mse=183.598068 best_discrete=14.436556 hash=False elapsed=41.7s
step   500/900 tau=0.1428 loss=0.277803 mse_soft=0.277383 ent_in=1.1031 ent_out=0.2960 rowmax_in=0.5337 rowmax_out=0.8674 discrete_mse=532.832397 best_discrete=14.436556 hash=False elapsed=43.7s
step   525/900 tau=0.1295 loss=0.294104 mse_soft=0.293684 ent_in=1.0973 ent_out=0.3004 rowmax_in=0.5330 rowmax_out=0.8646 discrete_mse=532.832397 best_discrete=14.436556 hash=False elapsed=45.6s
step   550/900 tau=0.1175 loss=0.311969 mse_soft=0.311551 ent_in=1.0900 ent_out=0.3034 rowmax_in=0.5347 rowmax_out=0.8655 discrete_mse=480.041290 best_discrete=14.436556 hash=False elapsed=47.6s
step   575/900 tau=0.1066 loss=0.287794 mse_soft=0.287383 ent_in=1.0547 ent_out=0.3131 rowmax_in=0.5479 rowmax_out=0.8556 discrete_mse=513.261108 best_discrete=14.436556 hash=False elapsed=49.6s
step   600/900 tau=0.0967 loss=0.286440 mse_soft=0.286030 ent_in=1.0527 ent_out=0.3123 rowmax_in=0.5440 rowmax_out=0.8574 discrete_mse=201.558197 best_discrete=14.436556 hash=False elapsed=51.5s
step   625/900 tau=0.0877 loss=0.287088 mse_soft=0.286683 ent_in=1.0366 ent_out=0.3129 rowmax_in=0.5457 rowmax_out=0.8583 discrete_mse=349.586548 best_discrete=14.436556 hash=False elapsed=53.4s
step   650/900 tau=0.0795 loss=0.321089 mse_soft=0.320706 ent_in=0.9708 ent_out=0.3068 rowmax_in=0.5721 rowmax_out=0.8429 discrete_mse=19.121315 best_discrete=14.436556 hash=False elapsed=55.4s
step   675/900 tau=0.0722 loss=0.291265 mse_soft=0.290885 ent_in=0.9770 ent_out=0.2897 rowmax_in=0.5576 rowmax_out=0.8490 discrete_mse=20.523657 best_discrete=14.436556 hash=False elapsed=57.3s
step   700/900 tau=0.0655 loss=0.291265 mse_soft=0.290891 ent_in=0.9640 ent_out=0.2840 rowmax_in=0.5598 rowmax_out=0.8499 discrete_mse=69.088211 best_discrete=14.436556 hash=False elapsed=59.1s
step   725/900 tau=0.0594 loss=0.293880 mse_soft=0.293516 ent_in=0.9386 ent_out=0.2726 rowmax_in=0.5682 rowmax_out=0.8524 discrete_mse=64.514168 best_discrete=14.436556 hash=False elapsed=61.2s
step   750/900 tau=0.0539 loss=0.324089 mse_soft=0.323757 ent_in=0.8766 ent_out=0.2281 rowmax_in=0.5869 rowmax_out=0.8896 discrete_mse=35.272953 best_discrete=14.436556 hash=False elapsed=63.3s
step   775/900 tau=0.0489 loss=0.304712 mse_soft=0.304383 ent_in=0.8644 ent_out=0.2344 rowmax_in=0.5720 rowmax_out=0.8830 discrete_mse=142.912552 best_discrete=14.436556 hash=False elapsed=65.4s
step   800/900 tau=0.0443 loss=0.302859 mse_soft=0.302528 ent_in=0.8519 ent_out=0.2510 rowmax_in=0.5856 rowmax_out=0.8686 discrete_mse=25.814926 best_discrete=14.436556 hash=False elapsed=67.5s
step   825/900 tau=0.0402 loss=1.086262 mse_soft=1.086047 ent_in=0.4954 ent_out=0.2195 rowmax_in=0.7920 rowmax_out=0.8766 discrete_mse=27.331600 best_discrete=14.436556 hash=False elapsed=69.5s
step   850/900 tau=0.0365 loss=0.701081 mse_soft=0.700915 ent_in=0.3663 ent_out=0.1867 rowmax_in=0.8097 rowmax_out=0.8762 discrete_mse=73.302811 best_discrete=14.436556 hash=False elapsed=71.8s
step   875/900 tau=0.0331 loss=0.522096 mse_soft=0.521982 ent_in=0.2459 ent_out=0.1337 rowmax_in=0.8757 rowmax_out=0.9066 discrete_mse=44.747093 best_discrete=14.436556 hash=False elapsed=73.9s
step   900/900 tau=0.0300 loss=0.512373 mse_soft=0.512268 ent_in=0.2243 ent_out=0.1261 rowmax_in=0.8839 rowmax_out=0.9117 discrete_mse=44.747093 best_discrete=14.436556 hash=False elapsed=76.1s

Final metrics:
  soft_mse_full=0.523813
  rowmax_in_mean=0.8841
  rowmax_out_mean=0.9119
  ent_in_mean=0.2239
  ent_out_mean=0.1256
  final_discrete_mse=44.747093
  hash_match=False
  best_discrete_mse_seen=14.436556
Saved results to overnight_b025_j1.json
