Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.069367 mse_soft=1.067045 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=1.633944 best_discrete=1.633944 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.859494 mse_soft=0.857305 ent_in=3.6319 ent_out=3.6650 rowmax_in=0.0457 rowmax_out=0.0451 discrete_mse=1155.087280 best_discrete=1.633944 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.642755 mse_soft=0.640847 ent_in=3.1330 ent_out=3.2258 rowmax_in=0.0910 rowmax_out=0.0882 discrete_mse=6587.604004 best_discrete=1.633944 hash=False elapsed=5.0s
step    75/900 tau=0.7450 loss=0.511153 mse_soft=0.509558 ent_in=2.6316 ent_out=2.6869 rowmax_in=0.1911 rowmax_out=0.2099 discrete_mse=531.797668 best_discrete=1.633944 hash=False elapsed=7.2s
step   100/900 tau=0.6745 loss=0.413450 mse_soft=0.412251 ent_in=2.0781 ent_out=1.9186 rowmax_in=0.3360 rowmax_out=0.4025 discrete_mse=596.992493 best_discrete=1.633944 hash=False elapsed=9.4s
step   125/900 tau=0.6107 loss=0.345993 mse_soft=0.345147 ent_in=1.6583 ent_out=1.1613 rowmax_in=0.4532 rowmax_out=0.6553 discrete_mse=129.766571 best_discrete=1.633944 hash=False elapsed=11.6s
step   150/900 tau=0.5529 loss=0.319753 mse_soft=0.319049 ent_in=1.4922 ent_out=0.8547 rowmax_in=0.4832 rowmax_out=0.7233 discrete_mse=214.526398 best_discrete=1.633944 hash=False elapsed=13.9s
step   175/900 tau=0.5006 loss=0.302973 mse_soft=0.302355 ent_in=1.3804 ent_out=0.6782 rowmax_in=0.4994 rowmax_out=0.7486 discrete_mse=528.732422 best_discrete=1.633944 hash=False elapsed=16.2s
step   200/900 tau=0.4532 loss=0.295850 mse_soft=0.295292 ent_in=1.3169 ent_out=0.5439 rowmax_in=0.5031 rowmax_out=0.7817 discrete_mse=1288.624023 best_discrete=1.633944 hash=False elapsed=18.5s
step   225/900 tau=0.4103 loss=0.290507 mse_soft=0.289984 ent_in=1.2653 ent_out=0.4771 rowmax_in=0.5113 rowmax_out=0.7991 discrete_mse=201.556351 best_discrete=1.633944 hash=False elapsed=20.7s
step   250/900 tau=0.3715 loss=0.286194 mse_soft=0.285698 ent_in=1.2189 ent_out=0.4358 rowmax_in=0.5196 rowmax_out=0.8133 discrete_mse=201.556351 best_discrete=1.633944 hash=False elapsed=22.9s
step   275/900 tau=0.3363 loss=0.283283 mse_soft=0.282800 ent_in=1.1960 ent_out=0.4116 rowmax_in=0.5235 rowmax_out=0.8174 discrete_mse=159.652847 best_discrete=1.633944 hash=False elapsed=25.2s
step   300/900 tau=0.3045 loss=0.281666 mse_soft=0.281195 ent_in=1.1736 ent_out=0.3973 rowmax_in=0.5276 rowmax_out=0.8173 discrete_mse=171.142990 best_discrete=1.633944 hash=False elapsed=27.4s
step   325/900 tau=0.2756 loss=0.280153 mse_soft=0.279690 ent_in=1.1562 ent_out=0.3866 rowmax_in=0.5315 rowmax_out=0.8191 discrete_mse=171.142990 best_discrete=1.633944 hash=False elapsed=29.5s
step   350/900 tau=0.2496 loss=0.279500 mse_soft=0.279045 ent_in=1.1445 ent_out=0.3728 rowmax_in=0.5335 rowmax_out=0.8218 discrete_mse=171.142990 best_discrete=1.633944 hash=False elapsed=31.8s
step   375/900 tau=0.2259 loss=0.280452 mse_soft=0.280003 ent_in=1.1309 ent_out=0.3647 rowmax_in=0.5365 rowmax_out=0.8225 discrete_mse=1.041638 best_discrete=1.041638 hash=False elapsed=34.1s
step   400/900 tau=0.2046 loss=0.277753 mse_soft=0.277308 ent_in=1.1253 ent_out=0.3584 rowmax_in=0.5352 rowmax_out=0.8249 discrete_mse=11.474351 best_discrete=1.041638 hash=False elapsed=36.3s
step   425/900 tau=0.1852 loss=0.279297 mse_soft=0.278857 ent_in=1.1168 ent_out=0.3507 rowmax_in=0.5366 rowmax_out=0.8278 discrete_mse=672.318420 best_discrete=1.041638 hash=False elapsed=38.6s
step   450/900 tau=0.1677 loss=0.277310 mse_soft=0.276875 ent_in=1.1076 ent_out=0.3442 rowmax_in=0.5405 rowmax_out=0.8328 discrete_mse=249.060638 best_discrete=1.041638 hash=False elapsed=40.9s
step   475/900 tau=0.1518 loss=0.281255 mse_soft=0.280821 ent_in=1.1071 ent_out=0.3382 rowmax_in=0.5377 rowmax_out=0.8378 discrete_mse=249.060638 best_discrete=1.041638 hash=False elapsed=43.0s
step   500/900 tau=0.1374 loss=0.279126 mse_soft=0.278695 ent_in=1.1037 ent_out=0.3333 rowmax_in=0.5394 rowmax_out=0.8413 discrete_mse=15.446479 best_discrete=1.041638 hash=False elapsed=45.0s
step   525/900 tau=0.1244 loss=0.276699 mse_soft=0.276269 ent_in=1.1035 ent_out=0.3283 rowmax_in=0.5395 rowmax_out=0.8449 discrete_mse=200.869217 best_discrete=1.041638 hash=False elapsed=46.9s
step   550/900 tau=0.1126 loss=0.285663 mse_soft=0.285235 ent_in=1.0967 ent_out=0.3287 rowmax_in=0.5434 rowmax_out=0.8450 discrete_mse=200.869217 best_discrete=1.041638 hash=False elapsed=49.0s
step   575/900 tau=0.1020 loss=0.276392 mse_soft=0.275964 ent_in=1.0972 ent_out=0.3280 rowmax_in=0.5401 rowmax_out=0.8453 discrete_mse=89.671364 best_discrete=1.041638 hash=False elapsed=51.0s
step   600/900 tau=0.0923 loss=0.287175 mse_soft=0.286750 ent_in=1.0935 ent_out=0.3252 rowmax_in=0.5412 rowmax_out=0.8462 discrete_mse=141.922592 best_discrete=1.041638 hash=False elapsed=53.0s
step   625/900 tau=0.0836 loss=0.287276 mse_soft=0.286849 ent_in=1.0932 ent_out=0.3333 rowmax_in=0.5389 rowmax_out=0.8380 discrete_mse=141.922592 best_discrete=1.041638 hash=False elapsed=55.0s
step   650/900 tau=0.0757 loss=0.323526 mse_soft=0.323105 ent_in=1.0667 ent_out=0.3380 rowmax_in=0.5375 rowmax_out=0.8326 discrete_mse=146.766403 best_discrete=1.041638 hash=False elapsed=56.9s
step   675/900 tau=0.0685 loss=0.308245 mse_soft=0.307824 ent_in=1.0654 ent_out=0.3385 rowmax_in=0.5446 rowmax_out=0.8270 discrete_mse=177.959839 best_discrete=1.041638 hash=False elapsed=58.8s
step   700/900 tau=0.0620 loss=0.300033 mse_soft=0.299614 ent_in=1.0614 ent_out=0.3368 rowmax_in=0.5404 rowmax_out=0.8313 discrete_mse=147.821472 best_discrete=1.041638 hash=False elapsed=60.7s
step   725/900 tau=0.0562 loss=0.310552 mse_soft=0.310136 ent_in=1.0431 ent_out=0.3439 rowmax_in=0.5504 rowmax_out=0.8284 discrete_mse=507.356781 best_discrete=1.041638 hash=False elapsed=62.7s
step   750/900 tau=0.0508 loss=0.298646 mse_soft=0.298251 ent_in=0.9706 ent_out=0.3432 rowmax_in=0.5731 rowmax_out=0.8229 discrete_mse=560.433167 best_discrete=1.041638 hash=False elapsed=64.6s
step   775/900 tau=0.0460 loss=0.300967 mse_soft=0.300593 ent_in=0.9266 ent_out=0.3206 rowmax_in=0.5800 rowmax_out=0.8386 discrete_mse=25.317867 best_discrete=1.041638 hash=False elapsed=66.6s
step   800/900 tau=0.0417 loss=0.321323 mse_soft=0.321011 ent_in=0.7769 ent_out=0.2622 rowmax_in=0.6288 rowmax_out=0.8824 discrete_mse=137.968491 best_discrete=1.041638 hash=False elapsed=68.6s
step   825/900 tau=0.0377 loss=0.307506 mse_soft=0.307197 ent_in=0.7561 ent_out=0.2733 rowmax_in=0.6410 rowmax_out=0.8673 discrete_mse=23.799170 best_discrete=1.041638 hash=False elapsed=70.6s
step   850/900 tau=0.0342 loss=0.309210 mse_soft=0.308911 ent_in=0.7400 ent_out=0.2555 rowmax_in=0.6533 rowmax_out=0.8773 discrete_mse=12.560784 best_discrete=1.041638 hash=False elapsed=72.7s
step   875/900 tau=0.0309 loss=0.562271 mse_soft=0.562097 ent_in=0.4301 ent_out=0.1485 rowmax_in=0.7876 rowmax_out=0.9423 discrete_mse=32.376354 best_discrete=1.041638 hash=False elapsed=74.7s
step   900/900 tau=0.0280 loss=0.461163 mse_soft=0.461041 ent_in=0.3362 ent_out=0.0710 rowmax_in=0.8224 rowmax_out=0.9614 discrete_mse=6.927350 best_discrete=1.041638 hash=False elapsed=76.7s

Final metrics:
  soft_mse_full=0.453658
  rowmax_in_mean=0.8153
  rowmax_out_mean=0.9613
  ent_in_mean=0.3488
  ent_out_mean=0.0713
  final_discrete_mse=6.927350
  hash_match=False
  best_discrete_mse_seen=1.041638
Saved results to overnight_b140_j2.json
