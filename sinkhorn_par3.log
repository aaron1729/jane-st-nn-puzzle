Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.048839 mse_soft=1.041097 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=74.441559 best_discrete=74.441559 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.849964 mse_soft=0.842664 ent_in=3.6334 ent_out=3.6670 rowmax_in=0.0452 rowmax_out=0.0442 discrete_mse=1676.395508 best_discrete=74.441559 hash=False elapsed=2.5s
step    50/900 tau=0.8260 loss=0.645360 mse_soft=0.639001 ent_in=3.1341 ent_out=3.2243 rowmax_in=0.0941 rowmax_out=0.0901 discrete_mse=1130.548462 best_discrete=74.441559 hash=False elapsed=4.8s
step    75/900 tau=0.7493 loss=0.508261 mse_soft=0.502980 ent_in=2.6029 ent_out=2.6779 rowmax_in=0.2072 rowmax_out=0.1932 discrete_mse=6000.125488 best_discrete=74.441559 hash=False elapsed=6.8s
step   100/900 tau=0.6797 loss=0.398910 mse_soft=0.395048 ent_in=1.9634 ent_out=1.8983 rowmax_in=0.3649 rowmax_out=0.4031 discrete_mse=103.815277 best_discrete=74.441559 hash=False elapsed=9.0s
step   125/900 tau=0.6165 loss=0.335381 mse_soft=0.332635 ent_in=1.5416 ent_out=1.2040 rowmax_in=0.4566 rowmax_out=0.6027 discrete_mse=1944.083130 best_discrete=74.441559 hash=False elapsed=11.3s
step   150/900 tau=0.5592 loss=0.312998 mse_soft=0.310751 ent_in=1.3669 ent_out=0.8807 rowmax_in=0.4961 rowmax_out=0.6700 discrete_mse=571.836304 best_discrete=74.441559 hash=False elapsed=13.5s
step   175/900 tau=0.5073 loss=0.300690 mse_soft=0.298730 ent_in=1.2909 ent_out=0.6687 rowmax_in=0.5081 rowmax_out=0.7283 discrete_mse=173.116714 best_discrete=74.441559 hash=False elapsed=15.6s
step   200/900 tau=0.4602 loss=0.292985 mse_soft=0.291175 ent_in=1.2355 ent_out=0.5750 rowmax_in=0.5175 rowmax_out=0.7518 discrete_mse=143.968246 best_discrete=74.441559 hash=False elapsed=17.8s
step   225/900 tau=0.4174 loss=0.287847 mse_soft=0.286126 ent_in=1.2085 ent_out=0.5123 rowmax_in=0.5191 rowmax_out=0.7664 discrete_mse=508.041687 best_discrete=74.441559 hash=False elapsed=20.1s
step   250/900 tau=0.3786 loss=0.284531 mse_soft=0.282879 ent_in=1.1868 ent_out=0.4652 rowmax_in=0.5253 rowmax_out=0.7805 discrete_mse=98.716095 best_discrete=74.441559 hash=False elapsed=22.1s
step   275/900 tau=0.3434 loss=0.281000 mse_soft=0.279390 ent_in=1.1779 ent_out=0.4330 rowmax_in=0.5257 rowmax_out=0.7912 discrete_mse=389.978516 best_discrete=74.441559 hash=False elapsed=24.4s
step   300/900 tau=0.3115 loss=0.281641 mse_soft=0.280073 ent_in=1.1588 ent_out=0.4094 rowmax_in=0.5277 rowmax_out=0.7997 discrete_mse=254.440399 best_discrete=74.441559 hash=False elapsed=26.5s
step   325/900 tau=0.2826 loss=0.278281 mse_soft=0.276742 ent_in=1.1456 ent_out=0.3930 rowmax_in=0.5267 rowmax_out=0.8033 discrete_mse=510.509491 best_discrete=74.441559 hash=False elapsed=28.8s
step   350/900 tau=0.2563 loss=0.278398 mse_soft=0.276880 ent_in=1.1366 ent_out=0.3814 rowmax_in=0.5272 rowmax_out=0.8096 discrete_mse=254.440399 best_discrete=74.441559 hash=False elapsed=31.1s
step   375/900 tau=0.2325 loss=0.277378 mse_soft=0.275881 ent_in=1.1228 ent_out=0.3749 rowmax_in=0.5302 rowmax_out=0.8128 discrete_mse=376.737946 best_discrete=74.441559 hash=False elapsed=33.2s
step   400/900 tau=0.2109 loss=0.277953 mse_soft=0.276468 ent_in=1.1163 ent_out=0.3682 rowmax_in=0.5285 rowmax_out=0.8160 discrete_mse=376.737946 best_discrete=74.441559 hash=False elapsed=35.3s
step   425/900 tau=0.1913 loss=0.278778 mse_soft=0.277303 ent_in=1.1089 ent_out=0.3657 rowmax_in=0.5300 rowmax_out=0.8154 discrete_mse=376.737946 best_discrete=74.441559 hash=False elapsed=37.4s
step   450/900 tau=0.1735 loss=0.276237 mse_soft=0.274764 ent_in=1.1128 ent_out=0.3609 rowmax_in=0.5272 rowmax_out=0.8146 discrete_mse=158.976196 best_discrete=74.441559 hash=False elapsed=39.6s
step   475/900 tau=0.1574 loss=0.275454 mse_soft=0.273984 ent_in=1.1110 ent_out=0.3595 rowmax_in=0.5267 rowmax_out=0.8170 discrete_mse=175.379364 best_discrete=74.441559 hash=False elapsed=41.8s
step   500/900 tau=0.1428 loss=0.284129 mse_soft=0.282666 ent_in=1.1093 ent_out=0.3527 rowmax_in=0.5266 rowmax_out=0.8225 discrete_mse=398.587463 best_discrete=74.441559 hash=False elapsed=44.1s
step   525/900 tau=0.1295 loss=0.278083 mse_soft=0.276621 ent_in=1.1115 ent_out=0.3505 rowmax_in=0.5230 rowmax_out=0.8257 discrete_mse=181.042755 best_discrete=74.441559 hash=False elapsed=46.6s
step   550/900 tau=0.1175 loss=0.281307 mse_soft=0.279855 ent_in=1.1079 ent_out=0.3445 rowmax_in=0.5250 rowmax_out=0.8253 discrete_mse=523.588074 best_discrete=74.441559 hash=False elapsed=48.7s
step   575/900 tau=0.1066 loss=0.311277 mse_soft=0.309922 ent_in=1.0419 ent_out=0.3133 rowmax_in=0.5596 rowmax_out=0.8491 discrete_mse=218.503448 best_discrete=74.441559 hash=False elapsed=50.9s
step   600/900 tau=0.0967 loss=0.286617 mse_soft=0.285241 ent_in=1.0507 ent_out=0.3253 rowmax_in=0.5442 rowmax_out=0.8318 discrete_mse=112.385483 best_discrete=74.441559 hash=False elapsed=53.2s
step   625/900 tau=0.0877 loss=0.284428 mse_soft=0.283057 ent_in=1.0447 ent_out=0.3264 rowmax_in=0.5433 rowmax_out=0.8313 discrete_mse=249.037766 best_discrete=74.441559 hash=False elapsed=55.6s
step   650/900 tau=0.0795 loss=0.305653 mse_soft=0.304320 ent_in=0.9953 ent_out=0.3377 rowmax_in=0.5675 rowmax_out=0.8088 discrete_mse=270.708160 best_discrete=74.441559 hash=False elapsed=58.0s
step   675/900 tau=0.0722 loss=0.284474 mse_soft=0.283199 ent_in=0.9641 ent_out=0.3106 rowmax_in=0.5760 rowmax_out=0.8356 discrete_mse=2038.123535 best_discrete=74.441559 hash=False elapsed=60.4s
step   700/900 tau=0.0655 loss=0.365317 mse_soft=0.364367 ent_in=0.6478 ent_out=0.3022 rowmax_in=0.6810 rowmax_out=0.8193 discrete_mse=55.010437 best_discrete=55.010437 hash=False elapsed=62.7s
step   725/900 tau=0.0594 loss=0.341379 mse_soft=0.340476 ent_in=0.6292 ent_out=0.2743 rowmax_in=0.6865 rowmax_out=0.8545 discrete_mse=74.309135 best_discrete=55.010437 hash=False elapsed=65.0s
step   750/900 tau=0.0539 loss=0.392895 mse_soft=0.391973 ent_in=0.6467 ent_out=0.2747 rowmax_in=0.6729 rowmax_out=0.8515 discrete_mse=80.196762 best_discrete=55.010437 hash=False elapsed=67.2s
step   775/900 tau=0.0489 loss=0.337516 mse_soft=0.336636 ent_in=0.6266 ent_out=0.2534 rowmax_in=0.6731 rowmax_out=0.8572 discrete_mse=275.253845 best_discrete=55.010437 hash=False elapsed=69.6s
step   800/900 tau=0.0443 loss=0.333969 mse_soft=0.333098 ent_in=0.6216 ent_out=0.2488 rowmax_in=0.6657 rowmax_out=0.8571 discrete_mse=46.354282 best_discrete=46.354282 hash=False elapsed=72.0s
step   825/900 tau=0.0402 loss=0.337805 mse_soft=0.336961 ent_in=0.6010 ent_out=0.2428 rowmax_in=0.6787 rowmax_out=0.8585 discrete_mse=40.773655 best_discrete=40.773655 hash=False elapsed=74.3s
step   850/900 tau=0.0365 loss=0.439084 mse_soft=0.438350 ent_in=0.4978 ent_out=0.2358 rowmax_in=0.7460 rowmax_out=0.8617 discrete_mse=54.102299 best_discrete=40.773655 hash=False elapsed=76.4s
step   875/900 tau=0.0331 loss=0.416827 mse_soft=0.416324 ent_in=0.3819 ent_out=0.1214 rowmax_in=0.7978 rowmax_out=0.9244 discrete_mse=12.122556 best_discrete=12.122556 hash=False elapsed=78.6s
step   900/900 tau=0.0300 loss=0.406256 mse_soft=0.405763 ent_in=0.3788 ent_out=0.1146 rowmax_in=0.7993 rowmax_out=0.9287 discrete_mse=1.236405 best_discrete=1.236405 hash=False elapsed=81.0s

Final metrics:
  soft_mse_full=0.410306
  rowmax_in_mean=0.7981
  rowmax_out_mean=0.9287
  ent_in_mean=0.3811
  ent_out_mean=0.1145
  final_discrete_mse=1.236405
  hash_match=False
  best_discrete_mse_seen=1.236405
Saved results to sinkhorn_par3.json
