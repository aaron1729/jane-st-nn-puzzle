Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.074273 mse_soft=1.071950 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=117.351425 best_discrete=117.351425 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.865838 mse_soft=0.863648 ent_in=3.6336 ent_out=3.6675 rowmax_in=0.0461 rowmax_out=0.0442 discrete_mse=4398.592773 best_discrete=117.351425 hash=False elapsed=2.4s
step    50/900 tau=0.8229 loss=0.641037 mse_soft=0.639131 ent_in=3.1286 ent_out=3.2231 rowmax_in=0.0931 rowmax_out=0.0872 discrete_mse=2429.846436 best_discrete=117.351425 hash=False elapsed=4.4s
step    75/900 tau=0.7450 loss=0.508122 mse_soft=0.506540 ent_in=2.5902 ent_out=2.6834 rowmax_in=0.2030 rowmax_out=0.1914 discrete_mse=108.593658 best_discrete=108.593658 hash=False elapsed=6.9s
step   100/900 tau=0.6745 loss=0.410197 mse_soft=0.409012 ent_in=2.0108 ent_out=1.9400 rowmax_in=0.3319 rowmax_out=0.3722 discrete_mse=207.858093 best_discrete=108.593658 hash=False elapsed=9.3s
step   125/900 tau=0.6107 loss=0.353076 mse_soft=0.352207 ent_in=1.6421 ent_out=1.2537 rowmax_in=0.4208 rowmax_out=0.5753 discrete_mse=1039.803345 best_discrete=108.593658 hash=False elapsed=11.7s
step   150/900 tau=0.5529 loss=0.321468 mse_soft=0.320774 ent_in=1.4546 ent_out=0.8566 rowmax_in=0.4634 rowmax_out=0.6914 discrete_mse=596.677673 best_discrete=108.593658 hash=False elapsed=14.1s
step   175/900 tau=0.5006 loss=0.302553 mse_soft=0.301964 ent_in=1.3349 ent_out=0.6286 rowmax_in=0.4796 rowmax_out=0.7727 discrete_mse=923.840393 best_discrete=108.593658 hash=False elapsed=16.4s
step   200/900 tau=0.4532 loss=0.290550 mse_soft=0.290042 ent_in=1.2495 ent_out=0.4449 rowmax_in=0.4925 rowmax_out=0.8319 discrete_mse=518.331177 best_discrete=108.593658 hash=False elapsed=18.7s
step   225/900 tau=0.4103 loss=0.283849 mse_soft=0.283369 ent_in=1.2003 ent_out=0.4014 rowmax_in=0.5042 rowmax_out=0.8457 discrete_mse=678.726440 best_discrete=108.593658 hash=False elapsed=21.0s
step   250/900 tau=0.3715 loss=0.281471 mse_soft=0.281011 ent_in=1.1674 ent_out=0.3678 rowmax_in=0.5075 rowmax_out=0.8557 discrete_mse=678.726440 best_discrete=108.593658 hash=False elapsed=23.0s
step   275/900 tau=0.3363 loss=0.279617 mse_soft=0.279166 ent_in=1.1576 ent_out=0.3471 rowmax_in=0.5111 rowmax_out=0.8603 discrete_mse=295.803650 best_discrete=108.593658 hash=False elapsed=25.1s
step   300/900 tau=0.3045 loss=0.278414 mse_soft=0.277970 ent_in=1.1450 ent_out=0.3371 rowmax_in=0.5130 rowmax_out=0.8621 discrete_mse=295.803650 best_discrete=108.593658 hash=False elapsed=27.2s
step   325/900 tau=0.2756 loss=0.276573 mse_soft=0.276139 ent_in=1.1301 ent_out=0.3186 rowmax_in=0.5156 rowmax_out=0.8729 discrete_mse=509.829285 best_discrete=108.593658 hash=False elapsed=29.3s
step   350/900 tau=0.2496 loss=0.275533 mse_soft=0.275106 ent_in=1.1218 ent_out=0.2993 rowmax_in=0.5193 rowmax_out=0.8788 discrete_mse=476.108276 best_discrete=108.593658 hash=False elapsed=31.6s
step   375/900 tau=0.2259 loss=0.274744 mse_soft=0.274321 ent_in=1.1209 ent_out=0.2887 rowmax_in=0.5182 rowmax_out=0.8824 discrete_mse=476.108276 best_discrete=108.593658 hash=False elapsed=34.0s
step   400/900 tau=0.2046 loss=0.274123 mse_soft=0.273703 ent_in=1.1229 ent_out=0.2777 rowmax_in=0.5156 rowmax_out=0.8861 discrete_mse=643.162781 best_discrete=108.593658 hash=False elapsed=36.4s
step   425/900 tau=0.1852 loss=0.274784 mse_soft=0.274369 ent_in=1.1144 ent_out=0.2696 rowmax_in=0.5153 rowmax_out=0.8890 discrete_mse=798.141602 best_discrete=108.593658 hash=False elapsed=38.8s
step   450/900 tau=0.1677 loss=0.283267 mse_soft=0.282853 ent_in=1.1200 ent_out=0.2600 rowmax_in=0.5080 rowmax_out=0.8939 discrete_mse=798.141602 best_discrete=108.593658 hash=False elapsed=41.2s
step   475/900 tau=0.1518 loss=0.272210 mse_soft=0.271799 ent_in=1.1126 ent_out=0.2591 rowmax_in=0.5110 rowmax_out=0.8920 discrete_mse=798.141602 best_discrete=108.593658 hash=False elapsed=43.5s
step   500/900 tau=0.1374 loss=0.283566 mse_soft=0.283156 ent_in=1.1122 ent_out=0.2569 rowmax_in=0.5118 rowmax_out=0.8932 discrete_mse=370.484833 best_discrete=108.593658 hash=False elapsed=45.7s
step   525/900 tau=0.1244 loss=0.283668 mse_soft=0.283256 ent_in=1.1132 ent_out=0.2579 rowmax_in=0.5102 rowmax_out=0.8934 discrete_mse=370.484833 best_discrete=108.593658 hash=False elapsed=47.9s
step   550/900 tau=0.1126 loss=0.279533 mse_soft=0.279126 ent_in=1.1007 ent_out=0.2547 rowmax_in=0.5189 rowmax_out=0.8923 discrete_mse=388.733826 best_discrete=108.593658 hash=False elapsed=50.2s
step   575/900 tau=0.1020 loss=0.296858 mse_soft=0.296457 ent_in=1.0903 ent_out=0.2491 rowmax_in=0.5168 rowmax_out=0.8963 discrete_mse=302.125244 best_discrete=108.593658 hash=False elapsed=52.4s
step   600/900 tau=0.0923 loss=0.280379 mse_soft=0.279979 ent_in=1.0901 ent_out=0.2422 rowmax_in=0.5123 rowmax_out=0.8979 discrete_mse=766.991455 best_discrete=108.593658 hash=False elapsed=54.8s
step   625/900 tau=0.0836 loss=0.287520 mse_soft=0.287125 ent_in=1.0730 ent_out=0.2430 rowmax_in=0.5226 rowmax_out=0.8936 discrete_mse=766.991455 best_discrete=108.593658 hash=False elapsed=57.0s
step   650/900 tau=0.0757 loss=0.293390 mse_soft=0.293004 ent_in=1.0513 ent_out=0.2344 rowmax_in=0.5240 rowmax_out=0.8981 discrete_mse=255.214600 best_discrete=108.593658 hash=False elapsed=59.2s
step   675/900 tau=0.0685 loss=0.317143 mse_soft=0.316793 ent_in=0.9686 ent_out=0.1967 rowmax_in=0.5516 rowmax_out=0.9108 discrete_mse=186.216141 best_discrete=108.593658 hash=False elapsed=61.4s
step   700/900 tau=0.0620 loss=0.304735 mse_soft=0.304407 ent_in=0.8914 ent_out=0.2047 rowmax_in=0.5840 rowmax_out=0.9015 discrete_mse=275.618256 best_discrete=108.593658 hash=False elapsed=63.6s
step   725/900 tau=0.0562 loss=0.351743 mse_soft=0.351442 ent_in=0.8307 ent_out=0.1755 rowmax_in=0.6132 rowmax_out=0.9230 discrete_mse=27.220058 best_discrete=27.220058 hash=False elapsed=66.0s
step   750/900 tau=0.0508 loss=0.341340 mse_soft=0.341068 ent_in=0.7295 ent_out=0.1772 rowmax_in=0.6614 rowmax_out=0.9123 discrete_mse=25.519478 best_discrete=25.519478 hash=False elapsed=68.2s
step   775/900 tau=0.0460 loss=0.339058 mse_soft=0.338768 ent_in=0.7655 ent_out=0.1991 rowmax_in=0.6126 rowmax_out=0.8997 discrete_mse=77.059570 best_discrete=25.519478 hash=False elapsed=70.2s
step   800/900 tau=0.0417 loss=0.305967 mse_soft=0.305688 ent_in=0.7504 ent_out=0.1795 rowmax_in=0.6307 rowmax_out=0.9182 discrete_mse=66.134445 best_discrete=25.519478 hash=False elapsed=72.3s
step   825/900 tau=0.0377 loss=0.324960 mse_soft=0.324691 ent_in=0.7159 ent_out=0.1800 rowmax_in=0.6432 rowmax_out=0.9159 discrete_mse=65.993462 best_discrete=25.519478 hash=False elapsed=74.6s
step   850/900 tau=0.0342 loss=0.427352 mse_soft=0.427161 ent_in=0.5000 ent_out=0.1362 rowmax_in=0.7560 rowmax_out=0.9299 discrete_mse=54.573235 best_discrete=25.519478 hash=False elapsed=76.6s
step   875/900 tau=0.0309 loss=0.340649 mse_soft=0.340465 ent_in=0.5320 ent_out=0.0801 rowmax_in=0.7268 rowmax_out=0.9625 discrete_mse=51.683655 best_discrete=25.519478 hash=False elapsed=78.7s
step   900/900 tau=0.0280 loss=0.333973 mse_soft=0.333784 ent_in=0.5527 ent_out=0.0788 rowmax_in=0.7082 rowmax_out=0.9629 discrete_mse=59.463806 best_discrete=25.519478 hash=False elapsed=81.0s

Final metrics:
  soft_mse_full=0.337870
  rowmax_in_mean=0.7077
  rowmax_out_mean=0.9627
  ent_in_mean=0.5531
  ent_out_mean=0.0793
  final_discrete_mse=59.463806
  hash_match=False
  best_discrete_mse_seen=25.519478
Saved results to overnight_b212_j2.json
