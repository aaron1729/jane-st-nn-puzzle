Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.052094 mse_soft=1.049771 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=39.234993 best_discrete=39.234993 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.851602 mse_soft=0.849411 ent_in=3.6356 ent_out=3.6669 rowmax_in=0.0456 rowmax_out=0.0444 discrete_mse=7087.641602 best_discrete=39.234993 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.643585 mse_soft=0.641671 ent_in=3.1437 ent_out=3.2360 rowmax_in=0.0916 rowmax_out=0.0866 discrete_mse=4409.410645 best_discrete=39.234993 hash=False elapsed=4.8s
step    75/900 tau=0.7493 loss=0.512091 mse_soft=0.510486 ent_in=2.6412 ent_out=2.7092 rowmax_in=0.1993 rowmax_out=0.1939 discrete_mse=4467.349121 best_discrete=39.234993 hash=False elapsed=7.2s
step   100/900 tau=0.6797 loss=0.408418 mse_soft=0.407224 ent_in=2.0640 ent_out=1.9153 rowmax_in=0.3341 rowmax_out=0.3953 discrete_mse=1629.389404 best_discrete=39.234993 hash=False elapsed=9.5s
step   125/900 tau=0.6165 loss=0.352496 mse_soft=0.351604 ent_in=1.7123 ent_out=1.2613 rowmax_in=0.4044 rowmax_out=0.5957 discrete_mse=1068.966553 best_discrete=39.234993 hash=False elapsed=12.0s
step   150/900 tau=0.5592 loss=0.320914 mse_soft=0.320207 ent_in=1.4895 ent_out=0.8661 rowmax_in=0.4558 rowmax_out=0.6999 discrete_mse=138.433090 best_discrete=39.234993 hash=False elapsed=14.3s
step   175/900 tau=0.5073 loss=0.306641 mse_soft=0.306031 ent_in=1.3653 ent_out=0.6674 rowmax_in=0.4742 rowmax_out=0.7516 discrete_mse=80.537727 best_discrete=39.234993 hash=False elapsed=16.7s
step   200/900 tau=0.4602 loss=0.294213 mse_soft=0.293663 ent_in=1.2718 ent_out=0.5617 rowmax_in=0.5008 rowmax_out=0.7790 discrete_mse=137.404266 best_discrete=39.234993 hash=False elapsed=19.1s
step   225/900 tau=0.4174 loss=0.288567 mse_soft=0.288047 ent_in=1.2203 ent_out=0.5130 rowmax_in=0.5075 rowmax_out=0.7831 discrete_mse=97.269226 best_discrete=39.234993 hash=False elapsed=21.6s
step   250/900 tau=0.3786 loss=0.286170 mse_soft=0.285668 ent_in=1.1998 ent_out=0.4735 rowmax_in=0.5101 rowmax_out=0.7928 discrete_mse=143.280243 best_discrete=39.234993 hash=False elapsed=23.9s
step   275/900 tau=0.3434 loss=0.283778 mse_soft=0.283288 ent_in=1.1859 ent_out=0.4464 rowmax_in=0.5112 rowmax_out=0.8031 discrete_mse=136.246063 best_discrete=39.234993 hash=False elapsed=26.2s
step   300/900 tau=0.3115 loss=0.283759 mse_soft=0.283279 ent_in=1.1740 ent_out=0.4257 rowmax_in=0.5124 rowmax_out=0.8119 discrete_mse=136.246063 best_discrete=39.234993 hash=False elapsed=28.5s
step   325/900 tau=0.2826 loss=0.280807 mse_soft=0.280333 ent_in=1.1680 ent_out=0.4117 rowmax_in=0.5138 rowmax_out=0.8160 discrete_mse=136.246063 best_discrete=39.234993 hash=False elapsed=30.9s
step   350/900 tau=0.2563 loss=0.284474 mse_soft=0.284007 ent_in=1.1604 ent_out=0.3951 rowmax_in=0.5194 rowmax_out=0.8219 discrete_mse=136.246063 best_discrete=39.234993 hash=False elapsed=33.0s
step   375/900 tau=0.2325 loss=0.279223 mse_soft=0.278765 ent_in=1.1499 ent_out=0.3788 rowmax_in=0.5222 rowmax_out=0.8285 discrete_mse=161.343842 best_discrete=39.234993 hash=False elapsed=35.1s
step   400/900 tau=0.2109 loss=0.278287 mse_soft=0.277834 ent_in=1.1441 ent_out=0.3634 rowmax_in=0.5212 rowmax_out=0.8357 discrete_mse=427.680389 best_discrete=39.234993 hash=False elapsed=37.3s
step   425/900 tau=0.1913 loss=0.279152 mse_soft=0.278704 ent_in=1.1387 ent_out=0.3560 rowmax_in=0.5206 rowmax_out=0.8388 discrete_mse=161.343842 best_discrete=39.234993 hash=False elapsed=39.6s
step   450/900 tau=0.1735 loss=0.278763 mse_soft=0.278317 ent_in=1.1348 ent_out=0.3513 rowmax_in=0.5211 rowmax_out=0.8403 discrete_mse=161.343842 best_discrete=39.234993 hash=False elapsed=41.8s
step   475/900 tau=0.1574 loss=0.287423 mse_soft=0.286980 ent_in=1.1264 ent_out=0.3476 rowmax_in=0.5223 rowmax_out=0.8399 discrete_mse=427.680389 best_discrete=39.234993 hash=False elapsed=44.1s
step   500/900 tau=0.1428 loss=0.279011 mse_soft=0.278573 ent_in=1.1175 ent_out=0.3403 rowmax_in=0.5235 rowmax_out=0.8445 discrete_mse=427.680389 best_discrete=39.234993 hash=False elapsed=46.5s
step   525/900 tau=0.1295 loss=0.280277 mse_soft=0.279844 ent_in=1.1124 ent_out=0.3296 rowmax_in=0.5232 rowmax_out=0.8501 discrete_mse=161.343842 best_discrete=39.234993 hash=False elapsed=48.8s
step   550/900 tau=0.1175 loss=0.278677 mse_soft=0.278250 ent_in=1.1029 ent_out=0.3204 rowmax_in=0.5237 rowmax_out=0.8512 discrete_mse=451.818390 best_discrete=39.234993 hash=False elapsed=51.0s
step   575/900 tau=0.1066 loss=0.311821 mse_soft=0.311407 ent_in=1.0547 ent_out=0.3253 rowmax_in=0.5415 rowmax_out=0.8328 discrete_mse=75.732536 best_discrete=39.234993 hash=False elapsed=53.3s
step   600/900 tau=0.0967 loss=0.284825 mse_soft=0.284417 ent_in=1.0450 ent_out=0.3176 rowmax_in=0.5415 rowmax_out=0.8442 discrete_mse=38.658993 best_discrete=38.658993 hash=False elapsed=55.5s
step   625/900 tau=0.0877 loss=0.280134 mse_soft=0.279722 ent_in=1.0626 ent_out=0.3104 rowmax_in=0.5324 rowmax_out=0.8508 discrete_mse=38.658993 best_discrete=38.658993 hash=False elapsed=57.7s
step   650/900 tau=0.0795 loss=0.288445 mse_soft=0.288038 ent_in=1.0492 ent_out=0.3075 rowmax_in=0.5382 rowmax_out=0.8514 discrete_mse=33.010681 best_discrete=33.010681 hash=False elapsed=59.9s
step   675/900 tau=0.0722 loss=0.332565 mse_soft=0.332167 ent_in=1.0234 ent_out=0.3015 rowmax_in=0.5494 rowmax_out=0.8521 discrete_mse=67.703873 best_discrete=33.010681 hash=False elapsed=62.1s
step   700/900 tau=0.0655 loss=0.287200 mse_soft=0.286817 ent_in=0.9784 ent_out=0.2964 rowmax_in=0.5601 rowmax_out=0.8482 discrete_mse=95.727272 best_discrete=33.010681 hash=False elapsed=64.3s
step   725/900 tau=0.0594 loss=0.376412 mse_soft=0.376037 ent_in=0.9561 ent_out=0.2951 rowmax_in=0.5775 rowmax_out=0.8450 discrete_mse=105.156738 best_discrete=33.010681 hash=False elapsed=66.2s
step   750/900 tau=0.0539 loss=0.572279 mse_soft=0.572017 ent_in=0.6512 ent_out=0.2235 rowmax_in=0.6994 rowmax_out=0.8889 discrete_mse=48.515270 best_discrete=33.010681 hash=False elapsed=68.0s
step   775/900 tau=0.0489 loss=0.487882 mse_soft=0.487721 ent_in=0.3732 ent_out=0.1640 rowmax_in=0.8220 rowmax_out=0.9095 discrete_mse=56.486843 best_discrete=33.010681 hash=False elapsed=69.8s
step   800/900 tau=0.0443 loss=0.417866 mse_soft=0.417703 ent_in=0.4046 ent_out=0.1391 rowmax_in=0.8031 rowmax_out=0.9251 discrete_mse=28.518053 best_discrete=28.518053 hash=False elapsed=71.8s
step   825/900 tau=0.0402 loss=0.401110 mse_soft=0.400943 ent_in=0.4204 ent_out=0.1341 rowmax_in=0.7959 rowmax_out=0.9250 discrete_mse=51.878750 best_discrete=28.518053 hash=False elapsed=73.9s
step   850/900 tau=0.0365 loss=0.399604 mse_soft=0.399438 ent_in=0.4218 ent_out=0.1329 rowmax_in=0.7937 rowmax_out=0.9260 discrete_mse=31.026030 best_discrete=28.518053 hash=False elapsed=76.1s
step   875/900 tau=0.0331 loss=0.398226 mse_soft=0.398059 ent_in=0.4211 ent_out=0.1329 rowmax_in=0.7957 rowmax_out=0.9260 discrete_mse=31.026030 best_discrete=28.518053 hash=False elapsed=78.3s
step   900/900 tau=0.0300 loss=0.396592 mse_soft=0.396429 ent_in=0.4157 ent_out=0.1261 rowmax_in=0.7985 rowmax_out=0.9285 discrete_mse=31.026030 best_discrete=28.518053 hash=False elapsed=80.8s

Final metrics:
  soft_mse_full=0.402813
  rowmax_in_mean=0.7983
  rowmax_out_mean=0.9283
  ent_in_mean=0.4156
  ent_out_mean=0.1262
  final_discrete_mse=31.026030
  hash_match=False
  best_discrete_mse_seen=28.518053
Saved results to overnight_b170_j1.json
