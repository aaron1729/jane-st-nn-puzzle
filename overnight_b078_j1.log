Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.071965 mse_soft=1.069643 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=63.335579 best_discrete=63.335579 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.866072 mse_soft=0.863882 ent_in=3.6330 ent_out=3.6689 rowmax_in=0.0460 rowmax_out=0.0445 discrete_mse=2173.976074 best_discrete=63.335579 hash=False elapsed=2.4s
step    50/900 tau=0.8260 loss=0.649493 mse_soft=0.647583 ent_in=3.1295 ent_out=3.2384 rowmax_in=0.0928 rowmax_out=0.0868 discrete_mse=2647.310791 best_discrete=63.335579 hash=False elapsed=4.4s
step    75/900 tau=0.7493 loss=0.509474 mse_soft=0.507892 ent_in=2.5941 ent_out=2.6795 rowmax_in=0.2017 rowmax_out=0.1979 discrete_mse=976.359375 best_discrete=63.335579 hash=False elapsed=6.5s
step   100/900 tau=0.6797 loss=0.399410 mse_soft=0.398257 ent_in=1.9753 ent_out=1.8697 rowmax_in=0.3441 rowmax_out=0.4125 discrete_mse=895.638977 best_discrete=63.335579 hash=False elapsed=8.5s
step   125/900 tau=0.6165 loss=0.337651 mse_soft=0.336816 ent_in=1.6067 ent_out=1.1749 rowmax_in=0.4443 rowmax_out=0.6102 discrete_mse=644.162537 best_discrete=63.335579 hash=False elapsed=10.6s
step   150/900 tau=0.5592 loss=0.304470 mse_soft=0.303798 ent_in=1.4129 ent_out=0.8297 rowmax_in=0.4828 rowmax_out=0.7105 discrete_mse=391.202759 best_discrete=63.335579 hash=False elapsed=12.6s
step   175/900 tau=0.5073 loss=0.292380 mse_soft=0.291786 ent_in=1.2955 ent_out=0.6854 rowmax_in=0.4991 rowmax_out=0.7506 discrete_mse=852.056458 best_discrete=63.335579 hash=False elapsed=14.8s
step   200/900 tau=0.4602 loss=0.285525 mse_soft=0.284971 ent_in=1.2417 ent_out=0.6058 rowmax_in=0.5096 rowmax_out=0.7653 discrete_mse=594.702637 best_discrete=63.335579 hash=False elapsed=17.2s
step   225/900 tau=0.4174 loss=0.280594 mse_soft=0.280062 ent_in=1.2124 ent_out=0.5591 rowmax_in=0.5152 rowmax_out=0.7744 discrete_mse=690.317383 best_discrete=63.335579 hash=False elapsed=19.2s
step   250/900 tau=0.3786 loss=0.276392 mse_soft=0.275878 ent_in=1.1890 ent_out=0.5247 rowmax_in=0.5168 rowmax_out=0.7822 discrete_mse=335.524811 best_discrete=63.335579 hash=False elapsed=21.2s
step   275/900 tau=0.3434 loss=0.274341 mse_soft=0.273841 ent_in=1.1617 ent_out=0.5074 rowmax_in=0.5223 rowmax_out=0.7847 discrete_mse=420.717346 best_discrete=63.335579 hash=False elapsed=23.3s
step   300/900 tau=0.3115 loss=0.272262 mse_soft=0.271769 ent_in=1.1518 ent_out=0.4913 rowmax_in=0.5240 rowmax_out=0.7838 discrete_mse=364.253998 best_discrete=63.335579 hash=False elapsed=25.2s
step   325/900 tau=0.2826 loss=0.272818 mse_soft=0.272333 ent_in=1.1386 ent_out=0.4782 rowmax_in=0.5232 rowmax_out=0.7851 discrete_mse=379.740448 best_discrete=63.335579 hash=False elapsed=27.4s
step   350/900 tau=0.2563 loss=0.271375 mse_soft=0.270894 ent_in=1.1301 ent_out=0.4735 rowmax_in=0.5259 rowmax_out=0.7821 discrete_mse=248.799194 best_discrete=63.335579 hash=False elapsed=29.7s
step   375/900 tau=0.2325 loss=0.270075 mse_soft=0.269601 ent_in=1.1216 ent_out=0.4599 rowmax_in=0.5279 rowmax_out=0.7874 discrete_mse=301.368103 best_discrete=63.335579 hash=False elapsed=31.9s
step   400/900 tau=0.2109 loss=0.271323 mse_soft=0.270857 ent_in=1.1128 ent_out=0.4411 rowmax_in=0.5288 rowmax_out=0.7946 discrete_mse=228.866165 best_discrete=63.335579 hash=False elapsed=34.2s
step   425/900 tau=0.1913 loss=0.269779 mse_soft=0.269321 ent_in=1.1027 ent_out=0.4243 rowmax_in=0.5314 rowmax_out=0.7991 discrete_mse=183.842010 best_discrete=63.335579 hash=False elapsed=36.5s
step   450/900 tau=0.1735 loss=0.267380 mse_soft=0.266932 ent_in=1.0925 ent_out=0.4013 rowmax_in=0.5306 rowmax_out=0.8099 discrete_mse=98.000313 best_discrete=63.335579 hash=False elapsed=38.9s
step   475/900 tau=0.1574 loss=0.268351 mse_soft=0.267920 ent_in=1.0724 ent_out=0.3667 rowmax_in=0.5401 rowmax_out=0.8281 discrete_mse=114.655647 best_discrete=63.335579 hash=False elapsed=41.1s
step   500/900 tau=0.1428 loss=0.270883 mse_soft=0.270466 ent_in=1.0555 ent_out=0.3351 rowmax_in=0.5464 rowmax_out=0.8405 discrete_mse=114.655647 best_discrete=63.335579 hash=False elapsed=43.3s
step   525/900 tau=0.1295 loss=0.268217 mse_soft=0.267806 ent_in=1.0513 ent_out=0.3200 rowmax_in=0.5446 rowmax_out=0.8481 discrete_mse=152.033493 best_discrete=63.335579 hash=False elapsed=45.5s
step   550/900 tau=0.1175 loss=0.274453 mse_soft=0.274043 ent_in=1.0474 ent_out=0.3178 rowmax_in=0.5439 rowmax_out=0.8461 discrete_mse=118.520996 best_discrete=63.335579 hash=False elapsed=47.8s
step   575/900 tau=0.1066 loss=0.267045 mse_soft=0.266639 ent_in=1.0400 ent_out=0.3154 rowmax_in=0.5481 rowmax_out=0.8456 discrete_mse=118.520996 best_discrete=63.335579 hash=False elapsed=50.2s
step   600/900 tau=0.0967 loss=0.268078 mse_soft=0.267679 ent_in=1.0161 ent_out=0.3154 rowmax_in=0.5579 rowmax_out=0.8428 discrete_mse=159.994110 best_discrete=63.335579 hash=False elapsed=52.5s
step   625/900 tau=0.0877 loss=0.316150 mse_soft=0.315772 ent_in=0.9501 ent_out=0.3116 rowmax_in=0.5892 rowmax_out=0.8440 discrete_mse=42.288567 best_discrete=42.288567 hash=False elapsed=54.6s
step   650/900 tau=0.0795 loss=0.274798 mse_soft=0.274433 ent_in=0.9296 ent_out=0.2852 rowmax_in=0.5775 rowmax_out=0.8604 discrete_mse=49.117767 best_discrete=42.288567 hash=False elapsed=56.9s
step   675/900 tau=0.0722 loss=0.272538 mse_soft=0.272179 ent_in=0.9165 ent_out=0.2828 rowmax_in=0.5828 rowmax_out=0.8591 discrete_mse=50.026352 best_discrete=42.288567 hash=False elapsed=59.2s
step   700/900 tau=0.0655 loss=0.302755 mse_soft=0.302407 ent_in=0.8912 ent_out=0.2687 rowmax_in=0.5863 rowmax_out=0.8672 discrete_mse=121.948288 best_discrete=42.288567 hash=False elapsed=61.5s
step   725/900 tau=0.0594 loss=0.510303 mse_soft=0.510080 ent_in=0.5667 ent_out=0.1770 rowmax_in=0.7422 rowmax_out=0.9240 discrete_mse=211.637573 best_discrete=42.288567 hash=False elapsed=63.8s
step   750/900 tau=0.0539 loss=0.478570 mse_soft=0.478386 ent_in=0.3897 ent_out=0.2217 rowmax_in=0.8153 rowmax_out=0.8943 discrete_mse=42.243279 best_discrete=42.243279 hash=False elapsed=66.3s
step   775/900 tau=0.0489 loss=0.402241 mse_soft=0.402035 ent_in=0.4111 ent_out=0.2751 rowmax_in=0.7996 rowmax_out=0.8543 discrete_mse=149.694000 best_discrete=42.243279 hash=False elapsed=68.7s
step   800/900 tau=0.0443 loss=0.392631 mse_soft=0.392424 ent_in=0.4256 ent_out=0.2632 rowmax_in=0.7887 rowmax_out=0.8534 discrete_mse=83.859825 best_discrete=42.243279 hash=False elapsed=71.1s
step   825/900 tau=0.0402 loss=0.387635 mse_soft=0.387432 ent_in=0.4179 ent_out=0.2599 rowmax_in=0.7983 rowmax_out=0.8615 discrete_mse=105.797974 best_discrete=42.243279 hash=False elapsed=73.5s
step   850/900 tau=0.0365 loss=0.380688 mse_soft=0.380479 ent_in=0.4263 ent_out=0.2695 rowmax_in=0.7897 rowmax_out=0.8605 discrete_mse=149.694000 best_discrete=42.243279 hash=False elapsed=75.7s
step   875/900 tau=0.0331 loss=0.437628 mse_soft=0.437436 ent_in=0.4418 ent_out=0.1997 rowmax_in=0.7622 rowmax_out=0.9018 discrete_mse=7.844885 best_discrete=7.844885 hash=False elapsed=78.0s
step   900/900 tau=0.0300 loss=0.413225 mse_soft=0.413062 ent_in=0.3623 ent_out=0.1809 rowmax_in=0.8093 rowmax_out=0.9080 discrete_mse=75.834694 best_discrete=7.844885 hash=False elapsed=80.4s

Final metrics:
  soft_mse_full=0.427345
  rowmax_in_mean=0.8096
  rowmax_out_mean=0.9077
  ent_in_mean=0.3633
  ent_out_mean=0.1812
  final_discrete_mse=78.465141
  hash_match=False
  best_discrete_mse_seen=7.844885
Saved results to overnight_b078_j1.json
