Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.083005 mse_soft=1.080683 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=27.516718 best_discrete=27.516718 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.876648 mse_soft=0.874458 ent_in=3.6327 ent_out=3.6665 rowmax_in=0.0455 rowmax_out=0.0446 discrete_mse=8196.503906 best_discrete=27.516718 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.659980 mse_soft=0.658071 ent_in=3.1331 ent_out=3.2289 rowmax_in=0.0912 rowmax_out=0.0880 discrete_mse=2623.464600 best_discrete=27.516718 hash=False elapsed=4.7s
step    75/900 tau=0.7493 loss=0.511955 mse_soft=0.510374 ent_in=2.5929 ent_out=2.6783 rowmax_in=0.2007 rowmax_out=0.1949 discrete_mse=472.501831 best_discrete=27.516718 hash=False elapsed=6.8s
step   100/900 tau=0.6797 loss=0.404392 mse_soft=0.403211 ent_in=2.0074 ent_out=1.9295 rowmax_in=0.3440 rowmax_out=0.3777 discrete_mse=2070.956055 best_discrete=27.516718 hash=False elapsed=9.0s
step   125/900 tau=0.6165 loss=0.340151 mse_soft=0.339288 ent_in=1.6011 ent_out=1.2732 rowmax_in=0.4406 rowmax_out=0.5734 discrete_mse=1795.020386 best_discrete=27.516718 hash=False elapsed=11.3s
step   150/900 tau=0.5592 loss=0.312053 mse_soft=0.311361 ent_in=1.4325 ent_out=0.8738 rowmax_in=0.4678 rowmax_out=0.6878 discrete_mse=828.818909 best_discrete=27.516718 hash=False elapsed=13.4s
step   175/900 tau=0.5073 loss=0.297842 mse_soft=0.297253 ent_in=1.3431 ent_out=0.6182 rowmax_in=0.4816 rowmax_out=0.7637 discrete_mse=679.598572 best_discrete=27.516718 hash=False elapsed=15.5s
step   200/900 tau=0.4602 loss=0.290050 mse_soft=0.289521 ent_in=1.2882 ent_out=0.4753 rowmax_in=0.4929 rowmax_out=0.8057 discrete_mse=505.299377 best_discrete=27.516718 hash=False elapsed=17.7s
step   225/900 tau=0.4174 loss=0.285157 mse_soft=0.284649 ent_in=1.2754 ent_out=0.4175 rowmax_in=0.4897 rowmax_out=0.8177 discrete_mse=645.634705 best_discrete=27.516718 hash=False elapsed=20.2s
step   250/900 tau=0.3786 loss=0.281947 mse_soft=0.281456 ent_in=1.2605 ent_out=0.3747 rowmax_in=0.4927 rowmax_out=0.8218 discrete_mse=698.557068 best_discrete=27.516718 hash=False elapsed=22.4s
step   275/900 tau=0.3434 loss=0.281615 mse_soft=0.281136 ent_in=1.2448 ent_out=0.3518 rowmax_in=0.4941 rowmax_out=0.8268 discrete_mse=827.196289 best_discrete=27.516718 hash=False elapsed=24.7s
step   300/900 tau=0.3115 loss=0.278307 mse_soft=0.277837 ent_in=1.2344 ent_out=0.3325 rowmax_in=0.4962 rowmax_out=0.8337 discrete_mse=827.196289 best_discrete=27.516718 hash=False elapsed=27.0s
step   325/900 tau=0.2826 loss=0.278303 mse_soft=0.277837 ent_in=1.2296 ent_out=0.3219 rowmax_in=0.4966 rowmax_out=0.8401 discrete_mse=982.168152 best_discrete=27.516718 hash=False elapsed=29.3s
step   350/900 tau=0.2563 loss=0.275988 mse_soft=0.275527 ent_in=1.2235 ent_out=0.3152 rowmax_in=0.4964 rowmax_out=0.8447 discrete_mse=1109.425537 best_discrete=27.516718 hash=False elapsed=31.5s
step   375/900 tau=0.2325 loss=0.275470 mse_soft=0.275012 ent_in=1.2175 ent_out=0.3071 rowmax_in=0.4945 rowmax_out=0.8514 discrete_mse=1109.425537 best_discrete=27.516718 hash=False elapsed=33.6s
step   400/900 tau=0.2109 loss=0.273825 mse_soft=0.273373 ent_in=1.2091 ent_out=0.2985 rowmax_in=0.4966 rowmax_out=0.8564 discrete_mse=1316.315186 best_discrete=27.516718 hash=False elapsed=35.9s
step   425/900 tau=0.1913 loss=0.275534 mse_soft=0.275086 ent_in=1.2070 ent_out=0.2884 rowmax_in=0.4952 rowmax_out=0.8615 discrete_mse=1316.315186 best_discrete=27.516718 hash=False elapsed=38.3s
step   450/900 tau=0.1735 loss=0.273426 mse_soft=0.272979 ent_in=1.2073 ent_out=0.2816 rowmax_in=0.4951 rowmax_out=0.8658 discrete_mse=1316.315186 best_discrete=27.516718 hash=False elapsed=40.5s
step   475/900 tau=0.1574 loss=0.271991 mse_soft=0.271549 ent_in=1.1978 ent_out=0.2744 rowmax_in=0.4974 rowmax_out=0.8686 discrete_mse=1316.315186 best_discrete=27.516718 hash=False elapsed=42.6s
step   500/900 tau=0.1428 loss=0.273971 mse_soft=0.273533 ent_in=1.1919 ent_out=0.2676 rowmax_in=0.4974 rowmax_out=0.8703 discrete_mse=1811.989014 best_discrete=27.516718 hash=False elapsed=44.8s
step   525/900 tau=0.1295 loss=0.271972 mse_soft=0.271536 ent_in=1.1882 ent_out=0.2636 rowmax_in=0.4982 rowmax_out=0.8727 discrete_mse=897.459961 best_discrete=27.516718 hash=False elapsed=47.3s
step   550/900 tau=0.1175 loss=0.272829 mse_soft=0.272395 ent_in=1.1853 ent_out=0.2617 rowmax_in=0.4982 rowmax_out=0.8740 discrete_mse=897.459961 best_discrete=27.516718 hash=False elapsed=49.6s
step   575/900 tau=0.1066 loss=0.283781 mse_soft=0.283349 ent_in=1.1827 ent_out=0.2573 rowmax_in=0.4975 rowmax_out=0.8755 discrete_mse=1304.530396 best_discrete=27.516718 hash=False elapsed=51.9s
step   600/900 tau=0.0967 loss=0.292749 mse_soft=0.292318 ent_in=1.1831 ent_out=0.2526 rowmax_in=0.4958 rowmax_out=0.8749 discrete_mse=321.748901 best_discrete=27.516718 hash=False elapsed=54.1s
step   625/900 tau=0.0877 loss=0.285063 mse_soft=0.284631 ent_in=1.1828 ent_out=0.2564 rowmax_in=0.5002 rowmax_out=0.8769 discrete_mse=476.470825 best_discrete=27.516718 hash=False elapsed=56.4s
step   650/900 tau=0.0795 loss=0.301050 mse_soft=0.300623 ent_in=1.1699 ent_out=0.2532 rowmax_in=0.5056 rowmax_out=0.8770 discrete_mse=892.591370 best_discrete=27.516718 hash=False elapsed=58.9s
step   675/900 tau=0.0722 loss=0.326611 mse_soft=0.326206 ent_in=1.1106 ent_out=0.2409 rowmax_in=0.5108 rowmax_out=0.8822 discrete_mse=427.420288 best_discrete=27.516718 hash=False elapsed=61.2s
step   700/900 tau=0.0655 loss=0.281526 mse_soft=0.281138 ent_in=1.0560 ent_out=0.2398 rowmax_in=0.5198 rowmax_out=0.8852 discrete_mse=283.658447 best_discrete=27.516718 hash=False elapsed=63.6s
step   725/900 tau=0.0594 loss=0.279693 mse_soft=0.279306 ent_in=1.0648 ent_out=0.2261 rowmax_in=0.5155 rowmax_out=0.8924 discrete_mse=372.499084 best_discrete=27.516718 hash=False elapsed=65.9s
step   750/900 tau=0.0539 loss=0.285464 mse_soft=0.285082 ent_in=1.0491 ent_out=0.2233 rowmax_in=0.5224 rowmax_out=0.8936 discrete_mse=395.117950 best_discrete=27.516718 hash=False elapsed=68.1s
step   775/900 tau=0.0489 loss=0.280432 mse_soft=0.280051 ent_in=1.0490 ent_out=0.2208 rowmax_in=0.5201 rowmax_out=0.8926 discrete_mse=534.463074 best_discrete=27.516718 hash=False elapsed=70.4s
step   800/900 tau=0.0443 loss=0.567767 mse_soft=0.567571 ent_in=0.4917 ent_out=0.1626 rowmax_in=0.7910 rowmax_out=0.9256 discrete_mse=31.980230 best_discrete=27.516718 hash=False elapsed=72.5s
step   825/900 tau=0.0402 loss=0.408725 mse_soft=0.408577 ent_in=0.3379 ent_out=0.1542 rowmax_in=0.8430 rowmax_out=0.9313 discrete_mse=32.695461 best_discrete=27.516718 hash=False elapsed=74.8s
step   850/900 tau=0.0365 loss=0.379635 mse_soft=0.379481 ent_in=0.3723 ent_out=0.1426 rowmax_in=0.8275 rowmax_out=0.9188 discrete_mse=36.667095 best_discrete=27.516718 hash=False elapsed=77.0s
step   875/900 tau=0.0331 loss=0.435754 mse_soft=0.435623 ent_in=0.3128 ent_out=0.1256 rowmax_in=0.8564 rowmax_out=0.9379 discrete_mse=55.928642 best_discrete=27.516718 hash=False elapsed=79.3s
step   900/900 tau=0.0300 loss=0.392736 mse_soft=0.392600 ent_in=0.3298 ent_out=0.1234 rowmax_in=0.8457 rowmax_out=0.9401 discrete_mse=72.067062 best_discrete=27.516718 hash=False elapsed=81.5s

Final metrics:
  soft_mse_full=0.393713
  rowmax_in_mean=0.8444
  rowmax_out_mean=0.9396
  ent_in_mean=0.3313
  ent_out_mean=0.1242
  final_discrete_mse=54.877125
  hash_match=False
  best_discrete_mse_seen=27.516718
Saved results to overnight_b180_j1.json
