Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.061447 mse_soft=1.059124 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=9.721332 best_discrete=9.721332 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.854543 mse_soft=0.852353 ent_in=3.6338 ent_out=3.6664 rowmax_in=0.0458 rowmax_out=0.0444 discrete_mse=5795.528809 best_discrete=9.721332 hash=False elapsed=2.5s
step    50/900 tau=0.8229 loss=0.634992 mse_soft=0.633083 ent_in=3.1361 ent_out=3.2291 rowmax_in=0.0917 rowmax_out=0.0868 discrete_mse=5644.922363 best_discrete=9.721332 hash=False elapsed=4.5s
step    75/900 tau=0.7450 loss=0.495235 mse_soft=0.493649 ent_in=2.6076 ent_out=2.6810 rowmax_in=0.2087 rowmax_out=0.2048 discrete_mse=541.579834 best_discrete=9.721332 hash=False elapsed=6.6s
step   100/900 tau=0.6745 loss=0.395138 mse_soft=0.393955 ent_in=2.0382 ent_out=1.9069 rowmax_in=0.3403 rowmax_out=0.3928 discrete_mse=3606.271484 best_discrete=9.721332 hash=False elapsed=8.6s
step   125/900 tau=0.6107 loss=0.343071 mse_soft=0.342160 ent_in=1.6860 ent_out=1.3525 rowmax_in=0.4095 rowmax_out=0.5550 discrete_mse=8434.889648 best_discrete=9.721332 hash=False elapsed=10.6s
step   150/900 tau=0.5529 loss=0.318136 mse_soft=0.317377 ent_in=1.5019 ent_out=1.0281 rowmax_in=0.4576 rowmax_out=0.6329 discrete_mse=1859.203369 best_discrete=9.721332 hash=False elapsed=12.7s
step   175/900 tau=0.5006 loss=0.300286 mse_soft=0.299647 ent_in=1.3719 ent_out=0.7565 rowmax_in=0.4806 rowmax_out=0.7228 discrete_mse=5691.969238 best_discrete=9.721332 hash=False elapsed=14.8s
step   200/900 tau=0.4532 loss=0.291120 mse_soft=0.290551 ent_in=1.3064 ent_out=0.5884 rowmax_in=0.4875 rowmax_out=0.7777 discrete_mse=9504.381836 best_discrete=9.721332 hash=False elapsed=16.9s
step   225/900 tau=0.4103 loss=0.288522 mse_soft=0.287995 ent_in=1.2581 ent_out=0.4967 rowmax_in=0.4928 rowmax_out=0.8040 discrete_mse=25591.234375 best_discrete=9.721332 hash=False elapsed=19.0s
step   250/900 tau=0.3715 loss=0.284958 mse_soft=0.284456 ent_in=1.2298 ent_out=0.4415 rowmax_in=0.4964 rowmax_out=0.8211 discrete_mse=22674.150391 best_discrete=9.721332 hash=False elapsed=21.1s
step   275/900 tau=0.3363 loss=0.281072 mse_soft=0.280589 ent_in=1.2142 ent_out=0.3966 rowmax_in=0.5010 rowmax_out=0.8337 discrete_mse=20296.027344 best_discrete=9.721332 hash=False elapsed=23.2s
step   300/900 tau=0.3045 loss=0.279682 mse_soft=0.279210 ent_in=1.2062 ent_out=0.3673 rowmax_in=0.5018 rowmax_out=0.8409 discrete_mse=7927.678223 best_discrete=9.721332 hash=False elapsed=25.4s
step   325/900 tau=0.2756 loss=0.281923 mse_soft=0.281459 ent_in=1.1966 ent_out=0.3523 rowmax_in=0.5026 rowmax_out=0.8443 discrete_mse=8373.115234 best_discrete=9.721332 hash=False elapsed=27.4s
step   350/900 tau=0.2496 loss=0.280652 mse_soft=0.280192 ent_in=1.1900 ent_out=0.3434 rowmax_in=0.5031 rowmax_out=0.8457 discrete_mse=8373.115234 best_discrete=9.721332 hash=False elapsed=29.5s
step   375/900 tau=0.2259 loss=0.284723 mse_soft=0.284266 ent_in=1.1791 ent_out=0.3416 rowmax_in=0.5055 rowmax_out=0.8443 discrete_mse=6535.663574 best_discrete=9.721332 hash=False elapsed=31.5s
step   400/900 tau=0.2046 loss=0.276660 mse_soft=0.276207 ent_in=1.1702 ent_out=0.3398 rowmax_in=0.5080 rowmax_out=0.8452 discrete_mse=4694.777344 best_discrete=9.721332 hash=False elapsed=33.8s
step   425/900 tau=0.1852 loss=0.285990 mse_soft=0.285539 ent_in=1.1651 ent_out=0.3389 rowmax_in=0.5070 rowmax_out=0.8458 discrete_mse=1415.334717 best_discrete=9.721332 hash=False elapsed=36.1s
step   450/900 tau=0.1677 loss=0.276168 mse_soft=0.275719 ent_in=1.1562 ent_out=0.3373 rowmax_in=0.5079 rowmax_out=0.8425 discrete_mse=5595.922363 best_discrete=9.721332 hash=False elapsed=38.3s
step   475/900 tau=0.1518 loss=0.278323 mse_soft=0.277878 ent_in=1.1456 ent_out=0.3386 rowmax_in=0.5113 rowmax_out=0.8389 discrete_mse=4694.777344 best_discrete=9.721332 hash=False elapsed=40.6s
step   500/900 tau=0.1374 loss=0.279225 mse_soft=0.278784 ent_in=1.1362 ent_out=0.3312 rowmax_in=0.5133 rowmax_out=0.8480 discrete_mse=2746.617432 best_discrete=9.721332 hash=False elapsed=42.8s
step   525/900 tau=0.1244 loss=0.295207 mse_soft=0.294766 ent_in=1.1363 ent_out=0.3323 rowmax_in=0.5089 rowmax_out=0.8447 discrete_mse=3634.227051 best_discrete=9.721332 hash=False elapsed=45.0s
step   550/900 tau=0.1126 loss=0.279272 mse_soft=0.278832 ent_in=1.1259 ent_out=0.3387 rowmax_in=0.5119 rowmax_out=0.8431 discrete_mse=4988.339355 best_discrete=9.721332 hash=False elapsed=47.1s
step   575/900 tau=0.1020 loss=0.277674 mse_soft=0.277239 ent_in=1.1222 ent_out=0.3289 rowmax_in=0.5153 rowmax_out=0.8519 discrete_mse=4927.446777 best_discrete=9.721332 hash=False elapsed=49.3s
step   600/900 tau=0.0923 loss=0.306041 mse_soft=0.305613 ent_in=1.0985 ent_out=0.3299 rowmax_in=0.5320 rowmax_out=0.8469 discrete_mse=11342.284180 best_discrete=9.721332 hash=False elapsed=51.6s
step   625/900 tau=0.0836 loss=0.308847 mse_soft=0.308415 ent_in=1.1082 ent_out=0.3318 rowmax_in=0.5183 rowmax_out=0.8396 discrete_mse=3115.577148 best_discrete=9.721332 hash=False elapsed=53.7s
step   650/900 tau=0.0757 loss=0.336361 mse_soft=0.335946 ent_in=1.0578 ent_out=0.3267 rowmax_in=0.5353 rowmax_out=0.8317 discrete_mse=2365.967041 best_discrete=9.721332 hash=False elapsed=55.8s
step   675/900 tau=0.0685 loss=0.310308 mse_soft=0.309897 ent_in=1.0330 ent_out=0.3357 rowmax_in=0.5395 rowmax_out=0.8250 discrete_mse=2224.197510 best_discrete=9.721332 hash=False elapsed=58.2s
step   700/900 tau=0.0620 loss=0.294453 mse_soft=0.294054 ent_in=1.0123 ent_out=0.3150 rowmax_in=0.5390 rowmax_out=0.8505 discrete_mse=4526.235840 best_discrete=9.721332 hash=False elapsed=60.2s
step   725/900 tau=0.0562 loss=0.346698 mse_soft=0.346328 ent_in=0.9186 ent_out=0.3152 rowmax_in=0.5907 rowmax_out=0.8430 discrete_mse=2172.742432 best_discrete=9.721332 hash=False elapsed=62.4s
step   750/900 tau=0.0508 loss=0.362903 mse_soft=0.362623 ent_in=0.6860 ent_out=0.2470 rowmax_in=0.6735 rowmax_out=0.8484 discrete_mse=81.368965 best_discrete=9.721332 hash=False elapsed=64.8s
step   775/900 tau=0.0460 loss=0.345527 mse_soft=0.345256 ent_in=0.6538 ent_out=0.2505 rowmax_in=0.6827 rowmax_out=0.8490 discrete_mse=76.520363 best_discrete=9.721332 hash=False elapsed=66.9s
step   800/900 tau=0.0417 loss=0.365650 mse_soft=0.365393 ent_in=0.6458 ent_out=0.2123 rowmax_in=0.6864 rowmax_out=0.8748 discrete_mse=242.515488 best_discrete=9.721332 hash=False elapsed=69.1s
step   825/900 tau=0.0377 loss=0.346181 mse_soft=0.345924 ent_in=0.6268 ent_out=0.2295 rowmax_in=0.6855 rowmax_out=0.8560 discrete_mse=178.596619 best_discrete=9.721332 hash=False elapsed=71.4s
step   850/900 tau=0.0342 loss=0.386718 mse_soft=0.386489 ent_in=0.5577 ent_out=0.2045 rowmax_in=0.7260 rowmax_out=0.8749 discrete_mse=350.496826 best_discrete=9.721332 hash=False elapsed=73.6s
step   875/900 tau=0.0309 loss=0.354694 mse_soft=0.354470 ent_in=0.5480 ent_out=0.1991 rowmax_in=0.7110 rowmax_out=0.8790 discrete_mse=124.467224 best_discrete=9.721332 hash=False elapsed=75.9s
step   900/900 tau=0.0280 loss=0.628040 mse_soft=0.627936 ent_in=0.2486 ent_out=0.0961 rowmax_in=0.8762 rowmax_out=0.9139 discrete_mse=5.483384 best_discrete=5.483384 hash=False elapsed=78.1s

Final metrics:
  soft_mse_full=0.628936
  rowmax_in_mean=0.8779
  rowmax_out_mean=0.9142
  ent_in_mean=0.2462
  ent_out_mean=0.0954
  final_discrete_mse=5.483384
  hash_match=False
  best_discrete_mse_seen=5.483384
Saved results to overnight_b050_j2.json
