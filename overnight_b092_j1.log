Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.043641 mse_soft=1.041319 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=6.614379 best_discrete=6.614379 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.843972 mse_soft=0.841781 ent_in=3.6339 ent_out=3.6676 rowmax_in=0.0454 rowmax_out=0.0446 discrete_mse=2591.273682 best_discrete=6.614379 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.637927 mse_soft=0.636015 ent_in=3.1452 ent_out=3.2287 rowmax_in=0.0930 rowmax_out=0.0903 discrete_mse=1623.615967 best_discrete=6.614379 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.505792 mse_soft=0.504190 ent_in=2.6350 ent_out=2.7057 rowmax_in=0.1978 rowmax_out=0.1919 discrete_mse=1329.231567 best_discrete=6.614379 hash=False elapsed=7.2s
step   100/900 tau=0.6797 loss=0.401384 mse_soft=0.400183 ent_in=2.0473 ent_out=1.9558 rowmax_in=0.3279 rowmax_out=0.3895 discrete_mse=2898.913818 best_discrete=6.614379 hash=False elapsed=9.4s
step   125/900 tau=0.6165 loss=0.340617 mse_soft=0.339727 ent_in=1.6299 ent_out=1.3356 rowmax_in=0.4294 rowmax_out=0.5382 discrete_mse=1549.937744 best_discrete=6.614379 hash=False elapsed=11.4s
step   150/900 tau=0.5592 loss=0.305594 mse_soft=0.304880 ent_in=1.3793 ent_out=1.0014 rowmax_in=0.4822 rowmax_out=0.6235 discrete_mse=596.098755 best_discrete=6.614379 hash=False elapsed=13.4s
step   175/900 tau=0.5073 loss=0.287634 mse_soft=0.287013 ent_in=1.2809 ent_out=0.7898 rowmax_in=0.4892 rowmax_out=0.6724 discrete_mse=4194.766113 best_discrete=6.614379 hash=False elapsed=15.5s
step   200/900 tau=0.4602 loss=0.278364 mse_soft=0.277794 ent_in=1.2364 ent_out=0.6628 rowmax_in=0.4937 rowmax_out=0.7209 discrete_mse=812.607422 best_discrete=6.614379 hash=False elapsed=17.6s
step   225/900 tau=0.4174 loss=0.272205 mse_soft=0.271668 ent_in=1.2048 ent_out=0.5852 rowmax_in=0.4970 rowmax_out=0.7532 discrete_mse=812.607422 best_discrete=6.614379 hash=False elapsed=19.8s
step   250/900 tau=0.3786 loss=0.269563 mse_soft=0.269044 ent_in=1.1865 ent_out=0.5409 rowmax_in=0.4992 rowmax_out=0.7687 discrete_mse=362.125580 best_discrete=6.614379 hash=False elapsed=21.9s
step   275/900 tau=0.3434 loss=0.272257 mse_soft=0.271749 ent_in=1.1774 ent_out=0.5166 rowmax_in=0.5012 rowmax_out=0.7787 discrete_mse=392.294037 best_discrete=6.614379 hash=False elapsed=24.2s
step   300/900 tau=0.3115 loss=0.265935 mse_soft=0.265434 ent_in=1.1673 ent_out=0.5008 rowmax_in=0.5026 rowmax_out=0.7836 discrete_mse=1209.001465 best_discrete=6.614379 hash=False elapsed=26.4s
step   325/900 tau=0.2826 loss=0.267824 mse_soft=0.267330 ent_in=1.1601 ent_out=0.4850 rowmax_in=0.5042 rowmax_out=0.7879 discrete_mse=1209.001465 best_discrete=6.614379 hash=False elapsed=28.6s
step   350/900 tau=0.2563 loss=0.263842 mse_soft=0.263355 ent_in=1.1525 ent_out=0.4697 rowmax_in=0.5031 rowmax_out=0.7909 discrete_mse=1766.838745 best_discrete=6.614379 hash=False elapsed=30.6s
step   375/900 tau=0.2325 loss=0.264747 mse_soft=0.264265 ent_in=1.1490 ent_out=0.4594 rowmax_in=0.5046 rowmax_out=0.7922 discrete_mse=1766.838745 best_discrete=6.614379 hash=False elapsed=32.7s
step   400/900 tau=0.2109 loss=0.264399 mse_soft=0.263919 ent_in=1.1458 ent_out=0.4557 rowmax_in=0.5041 rowmax_out=0.7902 discrete_mse=672.840332 best_discrete=6.614379 hash=False elapsed=34.8s
step   425/900 tau=0.1913 loss=0.263658 mse_soft=0.263180 ent_in=1.1440 ent_out=0.4520 rowmax_in=0.5018 rowmax_out=0.7904 discrete_mse=672.840332 best_discrete=6.614379 hash=False elapsed=37.1s
step   450/900 tau=0.1735 loss=0.263042 mse_soft=0.262565 ent_in=1.1427 ent_out=0.4466 rowmax_in=0.5023 rowmax_out=0.7914 discrete_mse=398.580078 best_discrete=6.614379 hash=False elapsed=39.3s
step   475/900 tau=0.1574 loss=0.264381 mse_soft=0.263905 ent_in=1.1440 ent_out=0.4431 rowmax_in=0.5009 rowmax_out=0.7922 discrete_mse=609.503479 best_discrete=6.614379 hash=False elapsed=41.4s
step   500/900 tau=0.1428 loss=0.263146 mse_soft=0.262674 ent_in=1.1413 ent_out=0.4328 rowmax_in=0.5010 rowmax_out=0.7968 discrete_mse=702.207825 best_discrete=6.614379 hash=False elapsed=43.6s
step   525/900 tau=0.1295 loss=0.265988 mse_soft=0.265523 ent_in=1.1301 ent_out=0.4210 rowmax_in=0.5036 rowmax_out=0.7989 discrete_mse=1957.271118 best_discrete=6.614379 hash=False elapsed=45.8s
step   550/900 tau=0.1175 loss=0.275617 mse_soft=0.275150 ent_in=1.1413 ent_out=0.4170 rowmax_in=0.5001 rowmax_out=0.8003 discrete_mse=419.211426 best_discrete=6.614379 hash=False elapsed=48.0s
step   575/900 tau=0.1066 loss=0.274158 mse_soft=0.273693 ent_in=1.1324 ent_out=0.4161 rowmax_in=0.5012 rowmax_out=0.7994 discrete_mse=711.647156 best_discrete=6.614379 hash=False elapsed=50.1s
step   600/900 tau=0.0967 loss=0.284628 mse_soft=0.284168 ent_in=1.1272 ent_out=0.4049 rowmax_in=0.5037 rowmax_out=0.8046 discrete_mse=422.203979 best_discrete=6.614379 hash=False elapsed=52.2s
step   625/900 tau=0.0877 loss=0.277251 mse_soft=0.276802 ent_in=1.1055 ent_out=0.3912 rowmax_in=0.5106 rowmax_out=0.8076 discrete_mse=903.106201 best_discrete=6.614379 hash=False elapsed=54.3s
step   650/900 tau=0.0795 loss=0.284589 mse_soft=0.284146 ent_in=1.1030 ent_out=0.3733 rowmax_in=0.5081 rowmax_out=0.8173 discrete_mse=1476.666748 best_discrete=6.614379 hash=False elapsed=56.6s
step   675/900 tau=0.0722 loss=0.266754 mse_soft=0.266324 ent_in=1.0596 ent_out=0.3764 rowmax_in=0.5234 rowmax_out=0.8183 discrete_mse=2126.637207 best_discrete=6.614379 hash=False elapsed=58.8s
step   700/900 tau=0.0655 loss=0.294475 mse_soft=0.294112 ent_in=0.8809 ent_out=0.3286 rowmax_in=0.5771 rowmax_out=0.8372 discrete_mse=593.295776 best_discrete=6.614379 hash=False elapsed=61.0s
step   725/900 tau=0.0594 loss=0.293445 mse_soft=0.293084 ent_in=0.8824 ent_out=0.3223 rowmax_in=0.5592 rowmax_out=0.8370 discrete_mse=730.058655 best_discrete=6.614379 hash=False elapsed=63.1s
step   750/900 tau=0.0539 loss=0.283317 mse_soft=0.282956 ent_in=0.8829 ent_out=0.3198 rowmax_in=0.5602 rowmax_out=0.8393 discrete_mse=342.176178 best_discrete=6.614379 hash=False elapsed=65.1s
step   775/900 tau=0.0489 loss=0.288572 mse_soft=0.288214 ent_in=0.8769 ent_out=0.3180 rowmax_in=0.5608 rowmax_out=0.8446 discrete_mse=278.238678 best_discrete=6.614379 hash=False elapsed=67.2s
step   800/900 tau=0.0443 loss=0.337077 mse_soft=0.336773 ent_in=0.7362 ent_out=0.2795 rowmax_in=0.6393 rowmax_out=0.8653 discrete_mse=389.974640 best_discrete=6.614379 hash=False elapsed=69.3s
step   825/900 tau=0.0402 loss=0.327282 mse_soft=0.327021 ent_in=0.6356 ent_out=0.2329 rowmax_in=0.6789 rowmax_out=0.8901 discrete_mse=14.563365 best_discrete=6.614379 hash=False elapsed=71.3s
step   850/900 tau=0.0365 loss=0.322779 mse_soft=0.322505 ent_in=0.6623 ent_out=0.2523 rowmax_in=0.6641 rowmax_out=0.8668 discrete_mse=33.983784 best_discrete=6.614379 hash=False elapsed=73.3s
step   875/900 tau=0.0331 loss=0.325172 mse_soft=0.324922 ent_in=0.5884 ent_out=0.2440 rowmax_in=0.6872 rowmax_out=0.8630 discrete_mse=17.353951 best_discrete=6.614379 hash=False elapsed=75.3s
step   900/900 tau=0.0300 loss=0.317340 mse_soft=0.317096 ent_in=0.5764 ent_out=0.2350 rowmax_in=0.7052 rowmax_out=0.8710 discrete_mse=15.246736 best_discrete=6.614379 hash=False elapsed=77.4s

Final metrics:
  soft_mse_full=0.328365
  rowmax_in_mean=0.6989
  rowmax_out_mean=0.8674
  ent_in_mean=0.5819
  ent_out_mean=0.2374
  final_discrete_mse=77.219009
  hash_match=False
  best_discrete_mse_seen=6.614379
Saved results to overnight_b092_j1.json
