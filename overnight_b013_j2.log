Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.043088 mse_soft=1.040766 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=85.335930 best_discrete=85.335930 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.840958 mse_soft=0.838768 ent_in=3.6321 ent_out=3.6674 rowmax_in=0.0461 rowmax_out=0.0441 discrete_mse=866.141174 best_discrete=85.335930 hash=False elapsed=2.9s
step    50/900 tau=0.8229 loss=0.627575 mse_soft=0.625668 ent_in=3.1265 ent_out=3.2319 rowmax_in=0.0943 rowmax_out=0.0855 discrete_mse=5315.038086 best_discrete=85.335930 hash=False elapsed=5.3s
step    75/900 tau=0.7450 loss=0.486779 mse_soft=0.485198 ent_in=2.5907 ent_out=2.6801 rowmax_in=0.2064 rowmax_out=0.1912 discrete_mse=582.824097 best_discrete=85.335930 hash=False elapsed=7.7s
step   100/900 tau=0.6745 loss=0.387964 mse_soft=0.386784 ent_in=2.0661 ent_out=1.8680 rowmax_in=0.3211 rowmax_out=0.4164 discrete_mse=1261.335571 best_discrete=85.335930 hash=False elapsed=10.0s
step   125/900 tau=0.6107 loss=0.326555 mse_soft=0.325711 ent_in=1.6730 ent_out=1.1424 rowmax_in=0.4010 rowmax_out=0.6405 discrete_mse=187.817139 best_discrete=85.335930 hash=False elapsed=12.3s
step   150/900 tau=0.5529 loss=0.300866 mse_soft=0.300188 ent_in=1.4632 ent_out=0.7989 rowmax_in=0.4530 rowmax_out=0.7169 discrete_mse=188.274338 best_discrete=85.335930 hash=False elapsed=14.8s
step   175/900 tau=0.5006 loss=0.285098 mse_soft=0.284516 ent_in=1.3116 ent_out=0.6295 rowmax_in=0.4877 rowmax_out=0.7520 discrete_mse=187.340683 best_discrete=85.335930 hash=False elapsed=17.1s
step   200/900 tau=0.4532 loss=0.276113 mse_soft=0.275585 ent_in=1.2375 ent_out=0.5240 rowmax_in=0.5011 rowmax_out=0.7905 discrete_mse=124.764793 best_discrete=85.335930 hash=False elapsed=19.5s
step   225/900 tau=0.4103 loss=0.270431 mse_soft=0.269938 ent_in=1.1831 ent_out=0.4621 rowmax_in=0.5164 rowmax_out=0.8176 discrete_mse=361.678802 best_discrete=85.335930 hash=False elapsed=21.9s
step   250/900 tau=0.3715 loss=0.266778 mse_soft=0.266302 ent_in=1.1567 ent_out=0.4305 rowmax_in=0.5225 rowmax_out=0.8272 discrete_mse=238.987289 best_discrete=85.335930 hash=False elapsed=24.4s
step   275/900 tau=0.3363 loss=0.265060 mse_soft=0.264592 ent_in=1.1500 ent_out=0.4124 rowmax_in=0.5201 rowmax_out=0.8330 discrete_mse=586.774658 best_discrete=85.335930 hash=False elapsed=26.7s
step   300/900 tau=0.3045 loss=0.264676 mse_soft=0.264215 ent_in=1.1374 ent_out=0.3998 rowmax_in=0.5227 rowmax_out=0.8360 discrete_mse=117.521187 best_discrete=85.335930 hash=False elapsed=29.1s
step   325/900 tau=0.2756 loss=0.264577 mse_soft=0.264123 ent_in=1.1273 ent_out=0.3872 rowmax_in=0.5229 rowmax_out=0.8406 discrete_mse=58.298691 best_discrete=58.298691 hash=False elapsed=31.3s
step   350/900 tau=0.2496 loss=0.264409 mse_soft=0.263959 ent_in=1.1229 ent_out=0.3797 rowmax_in=0.5232 rowmax_out=0.8426 discrete_mse=58.298691 best_discrete=58.298691 hash=False elapsed=33.4s
step   375/900 tau=0.2259 loss=0.264706 mse_soft=0.264258 ent_in=1.1179 ent_out=0.3769 rowmax_in=0.5234 rowmax_out=0.8424 discrete_mse=58.298691 best_discrete=58.298691 hash=False elapsed=35.5s
step   400/900 tau=0.2046 loss=0.262986 mse_soft=0.262541 ent_in=1.1124 ent_out=0.3715 rowmax_in=0.5238 rowmax_out=0.8438 discrete_mse=98.151253 best_discrete=58.298691 hash=False elapsed=37.7s
step   425/900 tau=0.1852 loss=0.262527 mse_soft=0.262085 ent_in=1.1065 ent_out=0.3659 rowmax_in=0.5229 rowmax_out=0.8450 discrete_mse=105.776001 best_discrete=58.298691 hash=False elapsed=39.8s
step   450/900 tau=0.1677 loss=0.264198 mse_soft=0.263759 ent_in=1.1014 ent_out=0.3621 rowmax_in=0.5243 rowmax_out=0.8469 discrete_mse=172.368546 best_discrete=58.298691 hash=False elapsed=42.0s
step   475/900 tau=0.1518 loss=0.262539 mse_soft=0.262101 ent_in=1.0996 ent_out=0.3587 rowmax_in=0.5228 rowmax_out=0.8475 discrete_mse=172.368546 best_discrete=58.298691 hash=False elapsed=44.2s
step   500/900 tau=0.1374 loss=0.263746 mse_soft=0.263311 ent_in=1.0969 ent_out=0.3522 rowmax_in=0.5253 rowmax_out=0.8500 discrete_mse=172.368546 best_discrete=58.298691 hash=False elapsed=46.3s
step   525/900 tau=0.1244 loss=0.267187 mse_soft=0.266758 ent_in=1.0907 ent_out=0.3414 rowmax_in=0.5280 rowmax_out=0.8545 discrete_mse=172.368546 best_discrete=58.298691 hash=False elapsed=48.4s
step   550/900 tau=0.1126 loss=0.262694 mse_soft=0.262269 ent_in=1.0889 ent_out=0.3292 rowmax_in=0.5276 rowmax_out=0.8573 discrete_mse=78.458656 best_discrete=58.298691 hash=False elapsed=50.4s
step   575/900 tau=0.1020 loss=0.278871 mse_soft=0.278463 ent_in=1.0488 ent_out=0.3116 rowmax_in=0.5504 rowmax_out=0.8657 discrete_mse=129.466965 best_discrete=58.298691 hash=False elapsed=52.4s
step   600/900 tau=0.0923 loss=0.276354 mse_soft=0.275947 ent_in=1.0483 ent_out=0.3084 rowmax_in=0.5382 rowmax_out=0.8475 discrete_mse=66.207489 best_discrete=58.298691 hash=False elapsed=54.6s
step   625/900 tau=0.0836 loss=0.266461 mse_soft=0.266055 ent_in=1.0497 ent_out=0.3048 rowmax_in=0.5337 rowmax_out=0.8548 discrete_mse=98.789513 best_discrete=58.298691 hash=False elapsed=56.7s
step   650/900 tau=0.0757 loss=0.277833 mse_soft=0.277430 ent_in=1.0459 ent_out=0.2973 rowmax_in=0.5338 rowmax_out=0.8605 discrete_mse=19.383059 best_discrete=19.383059 hash=False elapsed=58.9s
step   675/900 tau=0.0685 loss=0.271259 mse_soft=0.270862 ent_in=1.0352 ent_out=0.2887 rowmax_in=0.5362 rowmax_out=0.8616 discrete_mse=23.991890 best_discrete=19.383059 hash=False elapsed=61.0s
step   700/900 tau=0.0620 loss=0.339155 mse_soft=0.338809 ent_in=0.8933 ent_out=0.2596 rowmax_in=0.6071 rowmax_out=0.8796 discrete_mse=6.354198 best_discrete=6.354198 hash=False elapsed=63.1s
step   725/900 tau=0.0562 loss=0.291074 mse_soft=0.290747 ent_in=0.8023 ent_out=0.2863 rowmax_in=0.6120 rowmax_out=0.8464 discrete_mse=62.699825 best_discrete=6.354198 hash=False elapsed=65.3s
step   750/900 tau=0.0508 loss=0.347932 mse_soft=0.347627 ent_in=0.7811 ent_out=0.2375 rowmax_in=0.6396 rowmax_out=0.8772 discrete_mse=14.517853 best_discrete=6.354198 hash=False elapsed=67.4s
step   775/900 tau=0.0460 loss=0.299097 mse_soft=0.298803 ent_in=0.7264 ent_out=0.2526 rowmax_in=0.6338 rowmax_out=0.8647 discrete_mse=14.636309 best_discrete=6.354198 hash=False elapsed=69.7s
step   800/900 tau=0.0417 loss=0.345370 mse_soft=0.345082 ent_in=0.7059 ent_out=0.2563 rowmax_in=0.6619 rowmax_out=0.8605 discrete_mse=40.351967 best_discrete=6.354198 hash=False elapsed=71.7s
step   825/900 tau=0.0377 loss=0.320636 mse_soft=0.320370 ent_in=0.6826 ent_out=0.2060 rowmax_in=0.6447 rowmax_out=0.8903 discrete_mse=7.162991 best_discrete=6.354198 hash=False elapsed=73.7s
step   850/900 tau=0.0342 loss=0.297678 mse_soft=0.297407 ent_in=0.6968 ent_out=0.2067 rowmax_in=0.6453 rowmax_out=0.8882 discrete_mse=18.071644 best_discrete=6.354198 hash=False elapsed=75.9s
step   875/900 tau=0.0309 loss=0.478434 mse_soft=0.478310 ent_in=0.2314 ent_out=0.1823 rowmax_in=0.8871 rowmax_out=0.8986 discrete_mse=3.780899 best_discrete=3.780899 hash=False elapsed=78.0s
step   900/900 tau=0.0280 loss=0.453458 mse_soft=0.453352 ent_in=0.1997 ent_out=0.1554 rowmax_in=0.9119 rowmax_out=0.9131 discrete_mse=0.824446 best_discrete=0.824446 hash=False elapsed=80.2s

Final metrics:
  soft_mse_full=0.471025
  rowmax_in_mean=0.9101
  rowmax_out_mean=0.9129
  ent_in_mean=0.2032
  ent_out_mean=0.1563
  final_discrete_mse=0.824446
  hash_match=False
  best_discrete_mse_seen=0.824446
Saved results to overnight_b013_j2.json
