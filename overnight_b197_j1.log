Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.061688 mse_soft=1.059365 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=12.217442 best_discrete=12.217442 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.861740 mse_soft=0.859548 ent_in=3.6352 ent_out=3.6687 rowmax_in=0.0456 rowmax_out=0.0439 discrete_mse=9894.716797 best_discrete=12.217442 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.651990 mse_soft=0.650077 ent_in=3.1417 ent_out=3.2333 rowmax_in=0.0954 rowmax_out=0.0866 discrete_mse=2795.779541 best_discrete=12.217442 hash=False elapsed=5.2s
step    75/900 tau=0.7493 loss=0.509411 mse_soft=0.507818 ent_in=2.6054 ent_out=2.7039 rowmax_in=0.2147 rowmax_out=0.1922 discrete_mse=3147.522705 best_discrete=12.217442 hash=False elapsed=7.5s
step   100/900 tau=0.6797 loss=0.405706 mse_soft=0.404519 ent_in=2.0493 ent_out=1.9070 rowmax_in=0.3409 rowmax_out=0.3906 discrete_mse=3364.565430 best_discrete=12.217442 hash=False elapsed=9.9s
step   125/900 tau=0.6165 loss=0.344738 mse_soft=0.343879 ent_in=1.6554 ent_out=1.2076 rowmax_in=0.4126 rowmax_out=0.6089 discrete_mse=3290.248047 best_discrete=12.217442 hash=False elapsed=12.2s
step   150/900 tau=0.5592 loss=0.317887 mse_soft=0.317199 ent_in=1.4381 ent_out=0.8544 rowmax_in=0.4541 rowmax_out=0.6986 discrete_mse=202.019867 best_discrete=12.217442 hash=False elapsed=14.4s
step   175/900 tau=0.5073 loss=0.304539 mse_soft=0.303938 ent_in=1.3456 ent_out=0.6574 rowmax_in=0.4748 rowmax_out=0.7434 discrete_mse=249.468536 best_discrete=12.217442 hash=False elapsed=16.6s
step   200/900 tau=0.4602 loss=0.294480 mse_soft=0.293918 ent_in=1.2978 ent_out=0.5766 rowmax_in=0.4767 rowmax_out=0.7495 discrete_mse=306.195709 best_discrete=12.217442 hash=False elapsed=18.8s
step   225/900 tau=0.4174 loss=0.289095 mse_soft=0.288565 ent_in=1.2592 ent_out=0.5082 rowmax_in=0.4764 rowmax_out=0.7741 discrete_mse=310.881836 best_discrete=12.217442 hash=False elapsed=21.1s
step   250/900 tau=0.3786 loss=0.285810 mse_soft=0.285304 ent_in=1.2303 ent_out=0.4579 rowmax_in=0.4805 rowmax_out=0.7907 discrete_mse=326.644623 best_discrete=12.217442 hash=False elapsed=23.3s
step   275/900 tau=0.3434 loss=0.282685 mse_soft=0.282192 ent_in=1.2117 ent_out=0.4326 rowmax_in=0.4835 rowmax_out=0.8016 discrete_mse=429.727539 best_discrete=12.217442 hash=False elapsed=25.4s
step   300/900 tau=0.3115 loss=0.280724 mse_soft=0.280242 ent_in=1.1986 ent_out=0.4086 rowmax_in=0.4881 rowmax_out=0.8119 discrete_mse=93.548637 best_discrete=12.217442 hash=False elapsed=27.8s
step   325/900 tau=0.2826 loss=0.280076 mse_soft=0.279603 ent_in=1.1877 ent_out=0.3893 rowmax_in=0.4887 rowmax_out=0.8177 discrete_mse=470.485687 best_discrete=12.217442 hash=False elapsed=30.0s
step   350/900 tau=0.2563 loss=0.281301 mse_soft=0.280832 ent_in=1.1824 ent_out=0.3801 rowmax_in=0.4894 rowmax_out=0.8208 discrete_mse=172.323471 best_discrete=12.217442 hash=False elapsed=32.2s
step   375/900 tau=0.2325 loss=0.278980 mse_soft=0.278516 ent_in=1.1738 ent_out=0.3734 rowmax_in=0.4921 rowmax_out=0.8247 discrete_mse=433.501892 best_discrete=12.217442 hash=False elapsed=34.3s
step   400/900 tau=0.2109 loss=0.281332 mse_soft=0.280871 ent_in=1.1700 ent_out=0.3692 rowmax_in=0.4939 rowmax_out=0.8287 discrete_mse=78.117691 best_discrete=12.217442 hash=False elapsed=36.5s
step   425/900 tau=0.1913 loss=0.277757 mse_soft=0.277296 ent_in=1.1712 ent_out=0.3645 rowmax_in=0.4944 rowmax_out=0.8322 discrete_mse=383.747284 best_discrete=12.217442 hash=False elapsed=38.8s
step   450/900 tau=0.1735 loss=0.281969 mse_soft=0.281508 ent_in=1.1739 ent_out=0.3617 rowmax_in=0.4957 rowmax_out=0.8345 discrete_mse=383.747284 best_discrete=12.217442 hash=False elapsed=41.2s
step   475/900 tau=0.1574 loss=0.277313 mse_soft=0.276853 ent_in=1.1716 ent_out=0.3592 rowmax_in=0.4976 rowmax_out=0.8335 discrete_mse=383.747284 best_discrete=12.217442 hash=False elapsed=43.5s
step   500/900 tau=0.1428 loss=0.278446 mse_soft=0.277988 ent_in=1.1695 ent_out=0.3578 rowmax_in=0.4990 rowmax_out=0.8337 discrete_mse=383.747284 best_discrete=12.217442 hash=False elapsed=45.7s
step   525/900 tau=0.1295 loss=0.277967 mse_soft=0.277509 ent_in=1.1695 ent_out=0.3563 rowmax_in=0.4973 rowmax_out=0.8340 discrete_mse=260.965546 best_discrete=12.217442 hash=False elapsed=48.0s
step   550/900 tau=0.1175 loss=0.277671 mse_soft=0.277216 ent_in=1.1643 ent_out=0.3525 rowmax_in=0.4958 rowmax_out=0.8348 discrete_mse=297.112274 best_discrete=12.217442 hash=False elapsed=50.1s
step   575/900 tau=0.1066 loss=0.292567 mse_soft=0.292129 ent_in=1.1169 ent_out=0.3426 rowmax_in=0.5102 rowmax_out=0.8358 discrete_mse=260.965546 best_discrete=12.217442 hash=False elapsed=52.5s
step   600/900 tau=0.0967 loss=0.282527 mse_soft=0.282093 ent_in=1.1219 ent_out=0.3249 rowmax_in=0.5053 rowmax_out=0.8461 discrete_mse=116.133896 best_discrete=12.217442 hash=False elapsed=54.6s
step   625/900 tau=0.0877 loss=0.273840 mse_soft=0.273415 ent_in=1.1026 ent_out=0.3140 rowmax_in=0.5104 rowmax_out=0.8469 discrete_mse=126.423782 best_discrete=12.217442 hash=False elapsed=56.7s
step   650/900 tau=0.0795 loss=0.322638 mse_soft=0.322266 ent_in=0.9828 ent_out=0.2583 rowmax_in=0.5569 rowmax_out=0.8750 discrete_mse=185.676041 best_discrete=12.217442 hash=False elapsed=58.9s
step   675/900 tau=0.0722 loss=0.296117 mse_soft=0.295760 ent_in=0.9444 ent_out=0.2454 rowmax_in=0.5604 rowmax_out=0.8812 discrete_mse=213.899048 best_discrete=12.217442 hash=False elapsed=61.0s
step   700/900 tau=0.0655 loss=0.328418 mse_soft=0.328066 ent_in=0.9391 ent_out=0.2363 rowmax_in=0.5449 rowmax_out=0.8794 discrete_mse=145.847870 best_discrete=12.217442 hash=False elapsed=63.6s
step   725/900 tau=0.0594 loss=0.300378 mse_soft=0.300042 ent_in=0.8535 ent_out=0.2658 rowmax_in=0.5859 rowmax_out=0.8723 discrete_mse=76.643471 best_discrete=12.217442 hash=False elapsed=65.8s
step   750/900 tau=0.0539 loss=0.290323 mse_soft=0.289992 ent_in=0.8562 ent_out=0.2491 rowmax_in=0.5849 rowmax_out=0.8770 discrete_mse=224.864197 best_discrete=12.217442 hash=False elapsed=67.9s
step   775/900 tau=0.0489 loss=0.461915 mse_soft=0.461702 ent_in=0.5190 ent_out=0.1913 rowmax_in=0.7682 rowmax_out=0.9038 discrete_mse=14.597628 best_discrete=12.217442 hash=False elapsed=70.2s
step   800/900 tau=0.0443 loss=0.377073 mse_soft=0.376855 ent_in=0.5269 ent_out=0.2002 rowmax_in=0.7483 rowmax_out=0.8891 discrete_mse=71.074249 best_discrete=12.217442 hash=False elapsed=72.5s
step   825/900 tau=0.0402 loss=0.370031 mse_soft=0.369811 ent_in=0.5303 ent_out=0.2054 rowmax_in=0.7428 rowmax_out=0.8871 discrete_mse=56.280910 best_discrete=12.217442 hash=False elapsed=74.7s
step   850/900 tau=0.0365 loss=0.466180 mse_soft=0.466015 ent_in=0.3909 ent_out=0.1584 rowmax_in=0.7955 rowmax_out=0.9109 discrete_mse=116.018532 best_discrete=12.217442 hash=False elapsed=76.9s
step   875/900 tau=0.0331 loss=0.433326 mse_soft=0.433161 ent_in=0.3943 ent_out=0.1564 rowmax_in=0.7899 rowmax_out=0.9085 discrete_mse=57.505711 best_discrete=12.217442 hash=False elapsed=79.1s
step   900/900 tau=0.0300 loss=0.423975 mse_soft=0.423807 ent_in=0.4112 ent_out=0.1496 rowmax_in=0.7759 rowmax_out=0.9140 discrete_mse=53.377716 best_discrete=12.217442 hash=False elapsed=81.3s

Final metrics:
  soft_mse_full=0.424161
  rowmax_in_mean=0.7755
  rowmax_out_mean=0.9140
  ent_in_mean=0.4118
  ent_out_mean=0.1499
  final_discrete_mse=53.377716
  hash_match=False
  best_discrete_mse_seen=12.217442
Saved results to overnight_b197_j1.json
