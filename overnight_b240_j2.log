Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.062222 mse_soft=1.059899 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=67.654099 best_discrete=67.654099 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.859151 mse_soft=0.856961 ent_in=3.6338 ent_out=3.6659 rowmax_in=0.0453 rowmax_out=0.0448 discrete_mse=6541.949219 best_discrete=67.654099 hash=False elapsed=2.4s
step    50/900 tau=0.8229 loss=0.645780 mse_soft=0.643869 ent_in=3.1410 ent_out=3.2313 rowmax_in=0.0927 rowmax_out=0.0896 discrete_mse=4101.913574 best_discrete=67.654099 hash=False elapsed=4.5s
step    75/900 tau=0.7450 loss=0.498399 mse_soft=0.496822 ent_in=2.5899 ent_out=2.6659 rowmax_in=0.2057 rowmax_out=0.2031 discrete_mse=7202.256836 best_discrete=67.654099 hash=False elapsed=6.5s
step   100/900 tau=0.6745 loss=0.396023 mse_soft=0.394847 ent_in=2.0088 ent_out=1.9109 rowmax_in=0.3466 rowmax_out=0.3914 discrete_mse=972.799255 best_discrete=67.654099 hash=False elapsed=8.4s
step   125/900 tau=0.6107 loss=0.338363 mse_soft=0.337482 ent_in=1.6232 ent_out=1.3128 rowmax_in=0.4296 rowmax_out=0.5519 discrete_mse=633.410278 best_discrete=67.654099 hash=False elapsed=10.3s
step   150/900 tau=0.5529 loss=0.314880 mse_soft=0.314172 ent_in=1.4229 ent_out=0.9357 rowmax_in=0.4726 rowmax_out=0.6421 discrete_mse=1139.755859 best_discrete=67.654099 hash=False elapsed=12.3s
step   175/900 tau=0.5006 loss=0.302305 mse_soft=0.301687 ent_in=1.3331 ent_out=0.7268 rowmax_in=0.4840 rowmax_out=0.7141 discrete_mse=570.789856 best_discrete=67.654099 hash=False elapsed=14.3s
step   200/900 tau=0.4532 loss=0.293240 mse_soft=0.292678 ent_in=1.2518 ent_out=0.6229 rowmax_in=0.4934 rowmax_out=0.7401 discrete_mse=672.464661 best_discrete=67.654099 hash=False elapsed=16.4s
step   225/900 tau=0.4103 loss=0.287961 mse_soft=0.287424 ent_in=1.2106 ent_out=0.5810 rowmax_in=0.4999 rowmax_out=0.7415 discrete_mse=253.258942 best_discrete=67.654099 hash=False elapsed=18.3s
step   250/900 tau=0.3715 loss=0.281921 mse_soft=0.281400 ent_in=1.1819 ent_out=0.5548 rowmax_in=0.5076 rowmax_out=0.7507 discrete_mse=22.954611 best_discrete=22.954611 hash=False elapsed=20.3s
step   275/900 tau=0.3363 loss=0.281159 mse_soft=0.280664 ent_in=1.1609 ent_out=0.4885 rowmax_in=0.5132 rowmax_out=0.7797 discrete_mse=96.939911 best_discrete=22.954611 hash=False elapsed=22.2s
step   300/900 tau=0.3045 loss=0.274304 mse_soft=0.273824 ent_in=1.1417 ent_out=0.4561 rowmax_in=0.5181 rowmax_out=0.7896 discrete_mse=49.221825 best_discrete=22.954611 hash=False elapsed=24.2s
step   325/900 tau=0.2756 loss=0.270747 mse_soft=0.270279 ent_in=1.1155 ent_out=0.4436 rowmax_in=0.5254 rowmax_out=0.7935 discrete_mse=49.221825 best_discrete=22.954611 hash=False elapsed=26.2s
step   350/900 tau=0.2496 loss=0.274424 mse_soft=0.273965 ent_in=1.0985 ent_out=0.4294 rowmax_in=0.5259 rowmax_out=0.7980 discrete_mse=49.221825 best_discrete=22.954611 hash=False elapsed=28.2s
step   375/900 tau=0.2259 loss=0.273296 mse_soft=0.272844 ent_in=1.0864 ent_out=0.4213 rowmax_in=0.5276 rowmax_out=0.7982 discrete_mse=49.221825 best_discrete=22.954611 hash=False elapsed=30.3s
step   400/900 tau=0.2046 loss=0.268835 mse_soft=0.268385 ent_in=1.0801 ent_out=0.4175 rowmax_in=0.5258 rowmax_out=0.7990 discrete_mse=49.221825 best_discrete=22.954611 hash=False elapsed=32.4s
step   425/900 tau=0.1852 loss=0.271741 mse_soft=0.271296 ent_in=1.0727 ent_out=0.4114 rowmax_in=0.5259 rowmax_out=0.8010 discrete_mse=49.221825 best_discrete=22.954611 hash=False elapsed=34.4s
step   450/900 tau=0.1677 loss=0.272430 mse_soft=0.271988 ent_in=1.0636 ent_out=0.4104 rowmax_in=0.5278 rowmax_out=0.7994 discrete_mse=186.042023 best_discrete=22.954611 hash=False elapsed=36.3s
step   475/900 tau=0.1518 loss=0.269766 mse_soft=0.269325 ent_in=1.0627 ent_out=0.4063 rowmax_in=0.5222 rowmax_out=0.8026 discrete_mse=186.042023 best_discrete=22.954611 hash=False elapsed=38.2s
step   500/900 tau=0.1374 loss=0.277712 mse_soft=0.277274 ent_in=1.0600 ent_out=0.3987 rowmax_in=0.5226 rowmax_out=0.8084 discrete_mse=120.743019 best_discrete=22.954611 hash=False elapsed=40.3s
step   525/900 tau=0.1244 loss=0.273717 mse_soft=0.273283 ent_in=1.0577 ent_out=0.3899 rowmax_in=0.5212 rowmax_out=0.8123 discrete_mse=105.545944 best_discrete=22.954611 hash=False elapsed=42.4s
step   550/900 tau=0.1126 loss=0.269736 mse_soft=0.269305 ent_in=1.0508 ent_out=0.3832 rowmax_in=0.5244 rowmax_out=0.8157 discrete_mse=128.131058 best_discrete=22.954611 hash=False elapsed=44.3s
step   575/900 tau=0.1020 loss=0.282634 mse_soft=0.282204 ent_in=1.0525 ent_out=0.3810 rowmax_in=0.5227 rowmax_out=0.8175 discrete_mse=128.131058 best_discrete=22.954611 hash=False elapsed=46.3s
step   600/900 tau=0.0923 loss=0.272871 mse_soft=0.272444 ent_in=1.0442 ent_out=0.3793 rowmax_in=0.5277 rowmax_out=0.8141 discrete_mse=80.592659 best_discrete=22.954611 hash=False elapsed=48.2s
step   625/900 tau=0.0836 loss=0.285646 mse_soft=0.285220 ent_in=1.0407 ent_out=0.3814 rowmax_in=0.5216 rowmax_out=0.8189 discrete_mse=105.545944 best_discrete=22.954611 hash=False elapsed=50.2s
step   650/900 tau=0.0757 loss=0.316839 mse_soft=0.316441 ent_in=0.9689 ent_out=0.3578 rowmax_in=0.5609 rowmax_out=0.8276 discrete_mse=18.771442 best_discrete=18.771442 hash=False elapsed=52.2s
step   675/900 tau=0.0685 loss=0.288322 mse_soft=0.287947 ent_in=0.9001 ent_out=0.3513 rowmax_in=0.5906 rowmax_out=0.8209 discrete_mse=95.501389 best_discrete=18.771442 hash=False elapsed=54.2s
step   700/900 tau=0.0620 loss=0.290022 mse_soft=0.289647 ent_in=0.9052 ent_out=0.3456 rowmax_in=0.5863 rowmax_out=0.8216 discrete_mse=29.490152 best_discrete=18.771442 hash=False elapsed=56.2s
step   725/900 tau=0.0562 loss=0.282476 mse_soft=0.282108 ent_in=0.8806 ent_out=0.3478 rowmax_in=0.5914 rowmax_out=0.8226 discrete_mse=15.347946 best_discrete=15.347946 hash=False elapsed=58.3s
step   750/900 tau=0.0508 loss=0.302614 mse_soft=0.302252 ent_in=0.8720 ent_out=0.3359 rowmax_in=0.5953 rowmax_out=0.8308 discrete_mse=118.399620 best_discrete=15.347946 hash=False elapsed=60.3s
step   775/900 tau=0.0460 loss=0.294837 mse_soft=0.294482 ent_in=0.8520 ent_out=0.3318 rowmax_in=0.5935 rowmax_out=0.8239 discrete_mse=83.301659 best_discrete=15.347946 hash=False elapsed=62.3s
step   800/900 tau=0.0417 loss=0.433464 mse_soft=0.433255 ent_in=0.5056 ent_out=0.1913 rowmax_in=0.7615 rowmax_out=0.8920 discrete_mse=36.810345 best_discrete=15.347946 hash=False elapsed=64.3s
step   825/900 tau=0.0377 loss=0.457107 mse_soft=0.456906 ent_in=0.4556 ent_out=0.2136 rowmax_in=0.7651 rowmax_out=0.8655 discrete_mse=6.937900 best_discrete=6.937900 hash=False elapsed=66.2s
step   850/900 tau=0.0342 loss=0.391347 mse_soft=0.391170 ent_in=0.4128 ent_out=0.1785 rowmax_in=0.7834 rowmax_out=0.8784 discrete_mse=4.417485 best_discrete=4.417485 hash=False elapsed=68.3s
step   875/900 tau=0.0309 loss=0.410536 mse_soft=0.410364 ent_in=0.4031 ent_out=0.1691 rowmax_in=0.7909 rowmax_out=0.8812 discrete_mse=3.360824 best_discrete=3.360824 hash=False elapsed=70.3s
step   900/900 tau=0.0280 loss=0.390941 mse_soft=0.390777 ent_in=0.3977 ent_out=0.1510 rowmax_in=0.7827 rowmax_out=0.8813 discrete_mse=1.276504 best_discrete=1.276504 hash=False elapsed=72.2s

Final metrics:
  soft_mse_full=0.409250
  rowmax_in_mean=0.7812
  rowmax_out_mean=0.8813
  ent_in_mean=0.3991
  ent_out_mean=0.1508
  final_discrete_mse=1.474443
  hash_match=False
  best_discrete_mse_seen=1.276504
Saved results to overnight_b240_j2.json
