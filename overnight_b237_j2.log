Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.058398 mse_soft=1.056076 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=118.675095 best_discrete=118.675095 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.857631 mse_soft=0.855440 ent_in=3.6338 ent_out=3.6684 rowmax_in=0.0454 rowmax_out=0.0441 discrete_mse=2930.795898 best_discrete=118.675095 hash=False elapsed=2.5s
step    50/900 tau=0.8229 loss=0.645246 mse_soft=0.643342 ent_in=3.1263 ent_out=3.2192 rowmax_in=0.0947 rowmax_out=0.0894 discrete_mse=4376.278809 best_discrete=118.675095 hash=False elapsed=4.6s
step    75/900 tau=0.7450 loss=0.505198 mse_soft=0.503625 ent_in=2.5829 ent_out=2.6606 rowmax_in=0.2130 rowmax_out=0.1986 discrete_mse=2319.150391 best_discrete=118.675095 hash=False elapsed=6.5s
step   100/900 tau=0.6745 loss=0.403399 mse_soft=0.402254 ent_in=1.9991 ent_out=1.8172 rowmax_in=0.3503 rowmax_out=0.4285 discrete_mse=398.395447 best_discrete=118.675095 hash=False elapsed=8.6s
step   125/900 tau=0.6107 loss=0.341547 mse_soft=0.340743 ent_in=1.5995 ent_out=1.0816 rowmax_in=0.4344 rowmax_out=0.6511 discrete_mse=373.267181 best_discrete=118.675095 hash=False elapsed=10.6s
step   150/900 tau=0.5529 loss=0.312386 mse_soft=0.311766 ent_in=1.3872 ent_out=0.6808 rowmax_in=0.4837 rowmax_out=0.7656 discrete_mse=264.898651 best_discrete=118.675095 hash=False elapsed=12.6s
step   175/900 tau=0.5006 loss=0.297816 mse_soft=0.297282 ent_in=1.2933 ent_out=0.4879 rowmax_in=0.5017 rowmax_out=0.8200 discrete_mse=255.717316 best_discrete=118.675095 hash=False elapsed=14.9s
step   200/900 tau=0.4532 loss=0.286132 mse_soft=0.285648 ent_in=1.2338 ent_out=0.3802 rowmax_in=0.5065 rowmax_out=0.8403 discrete_mse=108.970047 best_discrete=108.970047 hash=False elapsed=17.1s
step   225/900 tau=0.4103 loss=0.277424 mse_soft=0.276978 ent_in=1.1676 ent_out=0.3187 rowmax_in=0.5153 rowmax_out=0.8535 discrete_mse=430.410187 best_discrete=108.970047 hash=False elapsed=19.2s
step   250/900 tau=0.3715 loss=0.275262 mse_soft=0.274830 ent_in=1.1477 ent_out=0.2924 rowmax_in=0.5143 rowmax_out=0.8613 discrete_mse=428.842102 best_discrete=108.970047 hash=False elapsed=21.6s
step   275/900 tau=0.3363 loss=0.273182 mse_soft=0.272756 ent_in=1.1445 ent_out=0.2769 rowmax_in=0.5123 rowmax_out=0.8691 discrete_mse=529.756042 best_discrete=108.970047 hash=False elapsed=23.6s
step   300/900 tau=0.3045 loss=0.272801 mse_soft=0.272384 ent_in=1.1300 ent_out=0.2597 rowmax_in=0.5117 rowmax_out=0.8749 discrete_mse=398.766144 best_discrete=108.970047 hash=False elapsed=25.7s
step   325/900 tau=0.2756 loss=0.270829 mse_soft=0.270420 ent_in=1.1209 ent_out=0.2441 rowmax_in=0.5124 rowmax_out=0.8791 discrete_mse=338.276825 best_discrete=108.970047 hash=False elapsed=27.7s
step   350/900 tau=0.2496 loss=0.270797 mse_soft=0.270393 ent_in=1.1119 ent_out=0.2356 rowmax_in=0.5149 rowmax_out=0.8806 discrete_mse=309.873230 best_discrete=108.970047 hash=False elapsed=29.8s
step   375/900 tau=0.2259 loss=0.271099 mse_soft=0.270697 ent_in=1.1072 ent_out=0.2311 rowmax_in=0.5150 rowmax_out=0.8813 discrete_mse=282.284180 best_discrete=108.970047 hash=False elapsed=31.9s
step   400/900 tau=0.2046 loss=0.269469 mse_soft=0.269069 ent_in=1.1029 ent_out=0.2307 rowmax_in=0.5156 rowmax_out=0.8819 discrete_mse=312.204956 best_discrete=108.970047 hash=False elapsed=34.0s
step   425/900 tau=0.1852 loss=0.271037 mse_soft=0.270637 ent_in=1.1017 ent_out=0.2312 rowmax_in=0.5152 rowmax_out=0.8827 discrete_mse=312.204956 best_discrete=108.970047 hash=False elapsed=36.1s
step   450/900 tau=0.1677 loss=0.270687 mse_soft=0.270288 ent_in=1.0945 ent_out=0.2358 rowmax_in=0.5199 rowmax_out=0.8810 discrete_mse=312.204956 best_discrete=108.970047 hash=False elapsed=38.2s
step   475/900 tau=0.1518 loss=0.273569 mse_soft=0.273168 ent_in=1.0965 ent_out=0.2403 rowmax_in=0.5187 rowmax_out=0.8807 discrete_mse=239.718887 best_discrete=108.970047 hash=False elapsed=40.4s
step   500/900 tau=0.1374 loss=0.273740 mse_soft=0.273341 ent_in=1.0877 ent_out=0.2409 rowmax_in=0.5215 rowmax_out=0.8813 discrete_mse=317.596497 best_discrete=108.970047 hash=False elapsed=42.4s
step   525/900 tau=0.1244 loss=0.274689 mse_soft=0.274294 ent_in=1.0808 ent_out=0.2370 rowmax_in=0.5220 rowmax_out=0.8834 discrete_mse=317.596497 best_discrete=108.970047 hash=False elapsed=44.4s
step   550/900 tau=0.1126 loss=0.274395 mse_soft=0.274002 ent_in=1.0731 ent_out=0.2360 rowmax_in=0.5251 rowmax_out=0.8839 discrete_mse=140.513092 best_discrete=108.970047 hash=False elapsed=46.4s
step   575/900 tau=0.1020 loss=0.273978 mse_soft=0.273589 ent_in=1.0663 ent_out=0.2300 rowmax_in=0.5292 rowmax_out=0.8897 discrete_mse=140.513092 best_discrete=108.970047 hash=False elapsed=48.3s
step   600/900 tau=0.0923 loss=0.280134 mse_soft=0.279750 ent_in=1.0583 ent_out=0.2199 rowmax_in=0.5243 rowmax_out=0.8973 discrete_mse=75.826485 best_discrete=75.826485 hash=False elapsed=50.4s
step   625/900 tau=0.0836 loss=0.313869 mse_soft=0.313499 ent_in=1.0264 ent_out=0.2070 rowmax_in=0.5481 rowmax_out=0.9076 discrete_mse=113.821571 best_discrete=75.826485 hash=False elapsed=52.5s
step   650/900 tau=0.0757 loss=0.282186 mse_soft=0.281841 ent_in=0.9551 ent_out=0.1938 rowmax_in=0.5583 rowmax_out=0.9143 discrete_mse=191.352417 best_discrete=75.826485 hash=False elapsed=54.6s
step   675/900 tau=0.0685 loss=0.275194 mse_soft=0.274845 ent_in=0.9778 ent_out=0.1870 rowmax_in=0.5441 rowmax_out=0.9168 discrete_mse=193.301590 best_discrete=75.826485 hash=False elapsed=56.6s
step   700/900 tau=0.0620 loss=0.280902 mse_soft=0.280551 ent_in=0.9897 ent_out=0.1812 rowmax_in=0.5465 rowmax_out=0.9184 discrete_mse=112.381187 best_discrete=75.826485 hash=False elapsed=58.7s
step   725/900 tau=0.0562 loss=0.319400 mse_soft=0.319086 ent_in=0.8661 ent_out=0.1804 rowmax_in=0.6103 rowmax_out=0.9028 discrete_mse=38.287064 best_discrete=38.287064 hash=False elapsed=60.8s
step   750/900 tau=0.0508 loss=0.463602 mse_soft=0.463420 ent_in=0.4585 ent_out=0.1504 rowmax_in=0.8107 rowmax_out=0.9032 discrete_mse=5.997480 best_discrete=5.997480 hash=False elapsed=62.9s
step   775/900 tau=0.0460 loss=0.367493 mse_soft=0.367309 ent_in=0.4596 ent_out=0.1541 rowmax_in=0.7865 rowmax_out=0.8971 discrete_mse=21.575747 best_discrete=5.997480 hash=False elapsed=65.0s
step   800/900 tau=0.0417 loss=0.360045 mse_soft=0.359865 ent_in=0.4543 ent_out=0.1426 rowmax_in=0.7765 rowmax_out=0.9010 discrete_mse=21.979965 best_discrete=5.997480 hash=False elapsed=67.1s
step   825/900 tau=0.0377 loss=0.381060 mse_soft=0.380886 ent_in=0.4360 ent_out=0.1428 rowmax_in=0.7911 rowmax_out=0.9005 discrete_mse=12.194123 best_discrete=5.997480 hash=False elapsed=69.2s
step   850/900 tau=0.0342 loss=0.362916 mse_soft=0.362762 ent_in=0.3826 ent_out=0.1320 rowmax_in=0.8032 rowmax_out=0.9080 discrete_mse=8.048714 best_discrete=5.997480 hash=False elapsed=71.3s
step   875/900 tau=0.0309 loss=0.347492 mse_soft=0.347343 ent_in=0.3729 ent_out=0.1245 rowmax_in=0.8043 rowmax_out=0.9134 discrete_mse=13.551499 best_discrete=5.997480 hash=False elapsed=73.5s
step   900/900 tau=0.0280 loss=0.345826 mse_soft=0.345683 ent_in=0.3633 ent_out=0.1148 rowmax_in=0.8038 rowmax_out=0.9175 discrete_mse=8.325497 best_discrete=5.997480 hash=False elapsed=75.5s

Final metrics:
  soft_mse_full=0.349430
  rowmax_in_mean=0.8062
  rowmax_out_mean=0.9168
  ent_in_mean=0.3629
  ent_out_mean=0.1160
  final_discrete_mse=13.140550
  hash_match=False
  best_discrete_mse_seen=5.997480
Saved results to overnight_b237_j2.json
