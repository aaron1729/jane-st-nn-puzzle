Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.02
step     1/700 tau=1.0000 loss=1.065744 mse_soft=1.063421 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=53.607811 best_discrete=53.607811 hash=False elapsed=0.6s
step    25/700 tau=0.8866 loss=0.934761 mse_soft=0.932510 ent_in=3.7418 ent_out=3.7623 rowmax_in=0.0372 rowmax_out=0.0363 discrete_mse=2539.894043 best_discrete=53.607811 hash=False elapsed=2.7s
step    50/700 tau=0.7821 loss=0.710743 mse_soft=0.708709 ent_in=3.3595 ent_out=3.4193 rowmax_in=0.0702 rowmax_out=0.0668 discrete_mse=17839.884766 best_discrete=53.607811 hash=False elapsed=4.8s
step    75/700 tau=0.6899 loss=0.585987 mse_soft=0.584194 ent_in=2.9323 ent_out=3.0430 rowmax_in=0.1315 rowmax_out=0.1238 discrete_mse=690.246399 best_discrete=53.607811 hash=False elapsed=7.1s
step   100/700 tau=0.6086 loss=0.470186 mse_soft=0.468751 ent_in=2.3770 ent_out=2.4065 rowmax_in=0.2484 rowmax_out=0.2656 discrete_mse=114.891296 best_discrete=53.607811 hash=False elapsed=9.3s
step   125/700 tau=0.5368 loss=0.381464 mse_soft=0.380438 ent_in=1.8256 ent_out=1.5949 rowmax_in=0.3857 rowmax_out=0.5094 discrete_mse=630.254272 best_discrete=53.607811 hash=False elapsed=11.4s
step   150/700 tau=0.4736 loss=0.336144 mse_soft=0.335362 ent_in=1.5636 ent_out=1.0413 rowmax_in=0.4404 rowmax_out=0.6723 discrete_mse=5831.163574 best_discrete=53.607811 hash=False elapsed=13.7s
step   175/700 tau=0.4177 loss=0.314189 mse_soft=0.313540 ent_in=1.4260 ent_out=0.7405 rowmax_in=0.4637 rowmax_out=0.7449 discrete_mse=45.373039 best_discrete=45.373039 hash=False elapsed=15.8s
step   200/700 tau=0.3685 loss=0.303635 mse_soft=0.303055 ent_in=1.3306 ent_out=0.6010 rowmax_in=0.4824 rowmax_out=0.7697 discrete_mse=10.041645 best_discrete=10.041645 hash=False elapsed=18.0s
step   225/700 tau=0.3251 loss=0.298171 mse_soft=0.297627 ent_in=1.2821 ent_out=0.5326 rowmax_in=0.4880 rowmax_out=0.7820 discrete_mse=921.200195 best_discrete=10.041645 hash=False elapsed=20.0s
step   250/700 tau=0.2868 loss=0.293622 mse_soft=0.293102 ent_in=1.2467 ent_out=0.4855 rowmax_in=0.4927 rowmax_out=0.7939 discrete_mse=1674.975098 best_discrete=10.041645 hash=False elapsed=22.3s
step   275/700 tau=0.2530 loss=0.291443 mse_soft=0.290946 ent_in=1.2114 ent_out=0.4464 rowmax_in=0.4941 rowmax_out=0.7984 discrete_mse=1971.617920 best_discrete=10.041645 hash=False elapsed=24.5s
step   300/700 tau=0.2231 loss=0.297641 mse_soft=0.297167 ent_in=1.1755 ent_out=0.4053 rowmax_in=0.5028 rowmax_out=0.8160 discrete_mse=325.196503 best_discrete=10.041645 hash=False elapsed=26.6s
step   325/700 tau=0.1968 loss=0.287338 mse_soft=0.286882 ent_in=1.1435 ent_out=0.3746 rowmax_in=0.5135 rowmax_out=0.8274 discrete_mse=340.599396 best_discrete=10.041645 hash=False elapsed=28.7s
step   350/700 tau=0.1736 loss=0.287801 mse_soft=0.287355 ent_in=1.1259 ent_out=0.3602 rowmax_in=0.5172 rowmax_out=0.8299 discrete_mse=166.424438 best_discrete=10.041645 hash=False elapsed=31.0s
step   375/700 tau=0.1532 loss=0.287312 mse_soft=0.286873 ent_in=1.1107 ent_out=0.3506 rowmax_in=0.5220 rowmax_out=0.8355 discrete_mse=5.926281 best_discrete=5.926281 hash=False elapsed=33.3s
step   400/700 tau=0.1351 loss=0.285120 mse_soft=0.284688 ent_in=1.0983 ent_out=0.3400 rowmax_in=0.5262 rowmax_out=0.8396 discrete_mse=103.376633 best_discrete=5.926281 hash=False elapsed=35.3s
step   425/700 tau=0.1192 loss=0.283869 mse_soft=0.283443 ent_in=1.0874 ent_out=0.3336 rowmax_in=0.5297 rowmax_out=0.8430 discrete_mse=103.376633 best_discrete=5.926281 hash=False elapsed=37.5s
step   450/700 tau=0.1051 loss=0.292300 mse_soft=0.291878 ent_in=1.0748 ent_out=0.3296 rowmax_in=0.5334 rowmax_out=0.8443 discrete_mse=103.376633 best_discrete=5.926281 hash=False elapsed=39.7s
step   475/700 tau=0.0928 loss=0.294519 mse_soft=0.294103 ent_in=1.0673 ent_out=0.3202 rowmax_in=0.5353 rowmax_out=0.8497 discrete_mse=74.045021 best_discrete=5.926281 hash=False elapsed=42.0s
step   500/700 tau=0.0818 loss=0.286714 mse_soft=0.286300 ent_in=1.0641 ent_out=0.3152 rowmax_in=0.5339 rowmax_out=0.8521 discrete_mse=38.621941 best_discrete=5.926281 hash=False elapsed=44.3s
step   525/700 tau=0.0722 loss=0.287796 mse_soft=0.287388 ent_in=1.0567 ent_out=0.3028 rowmax_in=0.5359 rowmax_out=0.8550 discrete_mse=155.156570 best_discrete=5.926281 hash=False elapsed=46.5s
step   550/700 tau=0.0637 loss=0.292299 mse_soft=0.291893 ent_in=1.0604 ent_out=0.2948 rowmax_in=0.5280 rowmax_out=0.8582 discrete_mse=102.095421 best_discrete=5.926281 hash=False elapsed=48.9s
step   575/700 tau=0.0562 loss=0.286485 mse_soft=0.286083 ent_in=1.0453 ent_out=0.2933 rowmax_in=0.5331 rowmax_out=0.8577 discrete_mse=40.781651 best_discrete=5.926281 hash=False elapsed=51.1s
step   600/700 tau=0.0495 loss=0.325870 mse_soft=0.325478 ent_in=1.0316 ent_out=0.2772 rowmax_in=0.5395 rowmax_out=0.8555 discrete_mse=6.519724 best_discrete=5.926281 hash=False elapsed=53.3s
step   625/700 tau=0.0437 loss=0.306743 mse_soft=0.306357 ent_in=1.0202 ent_out=0.2662 rowmax_in=0.5388 rowmax_out=0.8643 discrete_mse=29.862555 best_discrete=5.926281 hash=False elapsed=55.4s
step   650/700 tau=0.0386 loss=0.304909 mse_soft=0.304563 ent_in=0.8933 ent_out=0.2613 rowmax_in=0.5786 rowmax_out=0.8692 discrete_mse=185.514664 best_discrete=5.926281 hash=False elapsed=57.7s
step   675/700 tau=0.0340 loss=0.394814 mse_soft=0.394570 ent_in=0.6175 ent_out=0.1970 rowmax_in=0.6923 rowmax_out=0.9007 discrete_mse=43.460266 best_discrete=5.926281 hash=False elapsed=59.9s
step   700/700 tau=0.0300 loss=0.356689 mse_soft=0.356453 ent_in=0.6020 ent_out=0.1864 rowmax_in=0.6865 rowmax_out=0.9159 discrete_mse=46.802799 best_discrete=5.926281 hash=False elapsed=62.0s

Final metrics:
  soft_mse_full=0.355018
  rowmax_in_mean=0.6901
  rowmax_out_mean=0.9183
  ent_in_mean=0.6007
  ent_out_mean=0.1838
  final_discrete_mse=56.315842
  hash_match=False
  best_discrete_mse_seen=5.926281
Saved results to overnight_b150_j3.json
