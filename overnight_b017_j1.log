Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.091297 mse_soft=1.088974 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=32.253078 best_discrete=32.253078 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.882587 mse_soft=0.880396 ent_in=3.6340 ent_out=3.6678 rowmax_in=0.0451 rowmax_out=0.0437 discrete_mse=3491.371094 best_discrete=32.253078 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.657255 mse_soft=0.655351 ent_in=3.1293 ent_out=3.2177 rowmax_in=0.0945 rowmax_out=0.0860 discrete_mse=12529.814453 best_discrete=32.253078 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.512065 mse_soft=0.510493 ent_in=2.5851 ent_out=2.6554 rowmax_in=0.2044 rowmax_out=0.2064 discrete_mse=1778.974121 best_discrete=32.253078 hash=False elapsed=7.1s
step   100/900 tau=0.6797 loss=0.399414 mse_soft=0.398259 ent_in=1.9902 ent_out=1.8615 rowmax_in=0.3505 rowmax_out=0.4135 discrete_mse=10185.610352 best_discrete=32.253078 hash=False elapsed=9.4s
step   125/900 tau=0.6165 loss=0.338840 mse_soft=0.338002 ent_in=1.6087 ent_out=1.1864 rowmax_in=0.4456 rowmax_out=0.6113 discrete_mse=1198.346191 best_discrete=32.253078 hash=False elapsed=11.6s
step   150/900 tau=0.5592 loss=0.315892 mse_soft=0.315193 ent_in=1.4642 ent_out=0.8676 rowmax_in=0.4698 rowmax_out=0.7058 discrete_mse=1458.808350 best_discrete=32.253078 hash=False elapsed=13.8s
step   175/900 tau=0.5073 loss=0.301767 mse_soft=0.301149 ent_in=1.3672 ent_out=0.6933 rowmax_in=0.4898 rowmax_out=0.7441 discrete_mse=693.226074 best_discrete=32.253078 hash=False elapsed=16.2s
step   200/900 tau=0.4602 loss=0.290432 mse_soft=0.289882 ent_in=1.2860 ent_out=0.5479 rowmax_in=0.5032 rowmax_out=0.7886 discrete_mse=638.172363 best_discrete=32.253078 hash=False elapsed=18.5s
step   225/900 tau=0.4174 loss=0.284193 mse_soft=0.283680 ent_in=1.2278 ent_out=0.4825 rowmax_in=0.5120 rowmax_out=0.8050 discrete_mse=488.175995 best_discrete=32.253078 hash=False elapsed=20.7s
step   250/900 tau=0.3786 loss=0.281193 mse_soft=0.280702 ent_in=1.1920 ent_out=0.4453 rowmax_in=0.5180 rowmax_out=0.8088 discrete_mse=479.490601 best_discrete=32.253078 hash=False elapsed=22.9s
step   275/900 tau=0.3434 loss=0.278912 mse_soft=0.278433 ent_in=1.1729 ent_out=0.4254 rowmax_in=0.5218 rowmax_out=0.8088 discrete_mse=479.490601 best_discrete=32.253078 hash=False elapsed=25.1s
step   300/900 tau=0.3115 loss=0.281728 mse_soft=0.281257 ent_in=1.1566 ent_out=0.4144 rowmax_in=0.5248 rowmax_out=0.8105 discrete_mse=445.669891 best_discrete=32.253078 hash=False elapsed=27.3s
step   325/900 tau=0.2826 loss=0.276565 mse_soft=0.276101 ent_in=1.1414 ent_out=0.4049 rowmax_in=0.5298 rowmax_out=0.8128 discrete_mse=387.210876 best_discrete=32.253078 hash=False elapsed=29.5s
step   350/900 tau=0.2563 loss=0.276205 mse_soft=0.275748 ent_in=1.1289 ent_out=0.3948 rowmax_in=0.5329 rowmax_out=0.8152 discrete_mse=387.210876 best_discrete=32.253078 hash=False elapsed=31.9s
step   375/900 tau=0.2325 loss=0.274456 mse_soft=0.274003 ent_in=1.1238 ent_out=0.3861 rowmax_in=0.5331 rowmax_out=0.8161 discrete_mse=299.504578 best_discrete=32.253078 hash=False elapsed=34.2s
step   400/900 tau=0.2109 loss=0.277156 mse_soft=0.276706 ent_in=1.1198 ent_out=0.3825 rowmax_in=0.5336 rowmax_out=0.8156 discrete_mse=372.251465 best_discrete=32.253078 hash=False elapsed=36.6s
step   425/900 tau=0.1913 loss=0.280624 mse_soft=0.280174 ent_in=1.1202 ent_out=0.3800 rowmax_in=0.5324 rowmax_out=0.8165 discrete_mse=236.623749 best_discrete=32.253078 hash=False elapsed=38.8s
step   450/900 tau=0.1735 loss=0.277510 mse_soft=0.277062 ent_in=1.1156 ent_out=0.3782 rowmax_in=0.5323 rowmax_out=0.8169 discrete_mse=204.479523 best_discrete=32.253078 hash=False elapsed=41.1s
step   475/900 tau=0.1574 loss=0.276620 mse_soft=0.276172 ent_in=1.1136 ent_out=0.3781 rowmax_in=0.5337 rowmax_out=0.8177 discrete_mse=236.623749 best_discrete=32.253078 hash=False elapsed=43.2s
step   500/900 tau=0.1428 loss=0.273410 mse_soft=0.272964 ent_in=1.1086 ent_out=0.3780 rowmax_in=0.5354 rowmax_out=0.8174 discrete_mse=236.623749 best_discrete=32.253078 hash=False elapsed=45.3s
step   525/900 tau=0.1295 loss=0.277294 mse_soft=0.276850 ent_in=1.1040 ent_out=0.3767 rowmax_in=0.5327 rowmax_out=0.8157 discrete_mse=236.623749 best_discrete=32.253078 hash=False elapsed=47.3s
step   550/900 tau=0.1175 loss=0.280098 mse_soft=0.279655 ent_in=1.1006 ent_out=0.3758 rowmax_in=0.5358 rowmax_out=0.8173 discrete_mse=236.623749 best_discrete=32.253078 hash=False elapsed=49.4s
step   575/900 tau=0.1066 loss=0.282760 mse_soft=0.282323 ent_in=1.0837 ent_out=0.3719 rowmax_in=0.5406 rowmax_out=0.8167 discrete_mse=346.547089 best_discrete=32.253078 hash=False elapsed=51.6s
step   600/900 tau=0.0967 loss=0.297972 mse_soft=0.297548 ent_in=1.0485 ent_out=0.3640 rowmax_in=0.5627 rowmax_out=0.8239 discrete_mse=110.866257 best_discrete=32.253078 hash=False elapsed=53.8s
step   625/900 tau=0.0877 loss=0.288043 mse_soft=0.287639 ent_in=1.0009 ent_out=0.3473 rowmax_in=0.5700 rowmax_out=0.8343 discrete_mse=179.337601 best_discrete=32.253078 hash=False elapsed=55.9s
step   650/900 tau=0.0795 loss=0.278379 mse_soft=0.277978 ent_in=0.9880 ent_out=0.3492 rowmax_in=0.5682 rowmax_out=0.8354 discrete_mse=98.395699 best_discrete=32.253078 hash=False elapsed=58.2s
step   675/900 tau=0.0722 loss=0.300607 mse_soft=0.300234 ent_in=0.9117 ent_out=0.3311 rowmax_in=0.5879 rowmax_out=0.8402 discrete_mse=179.019028 best_discrete=32.253078 hash=False elapsed=60.4s
step   700/900 tau=0.0655 loss=0.298622 mse_soft=0.298253 ent_in=0.9257 ent_out=0.3052 rowmax_in=0.5667 rowmax_out=0.8620 discrete_mse=120.583221 best_discrete=32.253078 hash=False elapsed=62.7s
step   725/900 tau=0.0594 loss=0.298766 mse_soft=0.298404 ent_in=0.9032 ent_out=0.3063 rowmax_in=0.5769 rowmax_out=0.8505 discrete_mse=99.888107 best_discrete=32.253078 hash=False elapsed=65.0s
step   750/900 tau=0.0539 loss=0.282211 mse_soft=0.281846 ent_in=0.9191 ent_out=0.3000 rowmax_in=0.5696 rowmax_out=0.8499 discrete_mse=121.966896 best_discrete=32.253078 hash=False elapsed=67.3s
step   775/900 tau=0.0489 loss=0.410431 mse_soft=0.410204 ent_in=0.5787 ent_out=0.1765 rowmax_in=0.7115 rowmax_out=0.9154 discrete_mse=39.060532 best_discrete=32.253078 hash=False elapsed=69.6s
step   800/900 tau=0.0443 loss=0.360770 mse_soft=0.360561 ent_in=0.5376 ent_out=0.1599 rowmax_in=0.7067 rowmax_out=0.9199 discrete_mse=35.376751 best_discrete=32.253078 hash=False elapsed=71.7s
step   825/900 tau=0.0402 loss=0.352811 mse_soft=0.352607 ent_in=0.5347 ent_out=0.1470 rowmax_in=0.7103 rowmax_out=0.9230 discrete_mse=21.270630 best_discrete=21.270630 hash=False elapsed=73.8s
step   850/900 tau=0.0365 loss=0.370456 mse_soft=0.370256 ent_in=0.5081 ent_out=0.1591 rowmax_in=0.7300 rowmax_out=0.9179 discrete_mse=25.215424 best_discrete=21.270630 hash=False elapsed=76.0s
step   875/900 tau=0.0331 loss=0.350964 mse_soft=0.350761 ent_in=0.5206 ent_out=0.1580 rowmax_in=0.7201 rowmax_out=0.9170 discrete_mse=34.790993 best_discrete=21.270630 hash=False elapsed=78.3s
step   900/900 tau=0.0300 loss=0.347477 mse_soft=0.347275 ent_in=0.5197 ent_out=0.1547 rowmax_in=0.7186 rowmax_out=0.9183 discrete_mse=34.790993 best_discrete=21.270630 hash=False elapsed=80.3s

Final metrics:
  soft_mse_full=0.359224
  rowmax_in_mean=0.7175
  rowmax_out_mean=0.9183
  ent_in_mean=0.5200
  ent_out_mean=0.1548
  final_discrete_mse=34.790993
  hash_match=False
  best_discrete_mse_seen=21.270630
Saved results to overnight_b017_j1.json
