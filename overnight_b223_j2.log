Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.063151 mse_soft=1.060828 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=60.458855 best_discrete=60.458855 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.862935 mse_soft=0.860745 ent_in=3.6305 ent_out=3.6669 rowmax_in=0.0458 rowmax_out=0.0447 discrete_mse=4019.519043 best_discrete=60.458855 hash=False elapsed=2.5s
step    50/900 tau=0.8229 loss=0.649418 mse_soft=0.647514 ent_in=3.1304 ent_out=3.2152 rowmax_in=0.0928 rowmax_out=0.0885 discrete_mse=883.042053 best_discrete=60.458855 hash=False elapsed=4.6s
step    75/900 tau=0.7450 loss=0.508003 mse_soft=0.506434 ent_in=2.5984 ent_out=2.6332 rowmax_in=0.2036 rowmax_out=0.2074 discrete_mse=1564.288818 best_discrete=60.458855 hash=False elapsed=6.7s
step   100/900 tau=0.6745 loss=0.399780 mse_soft=0.398630 ent_in=1.9965 ent_out=1.8377 rowmax_in=0.3368 rowmax_out=0.4077 discrete_mse=1057.682861 best_discrete=60.458855 hash=False elapsed=8.8s
step   125/900 tau=0.6107 loss=0.340022 mse_soft=0.339190 ent_in=1.6152 ent_out=1.1566 rowmax_in=0.4252 rowmax_out=0.6187 discrete_mse=441.921387 best_discrete=60.458855 hash=False elapsed=10.8s
step   150/900 tau=0.5529 loss=0.306879 mse_soft=0.306233 ent_in=1.4381 ent_out=0.7132 rowmax_in=0.4597 rowmax_out=0.7440 discrete_mse=409.646118 best_discrete=60.458855 hash=False elapsed=12.9s
step   175/900 tau=0.5006 loss=0.294581 mse_soft=0.294011 ent_in=1.3464 ent_out=0.5552 rowmax_in=0.4715 rowmax_out=0.7849 discrete_mse=512.199707 best_discrete=60.458855 hash=False elapsed=15.0s
step   200/900 tau=0.4532 loss=0.288899 mse_soft=0.288363 ent_in=1.2956 ent_out=0.4901 rowmax_in=0.4764 rowmax_out=0.7957 discrete_mse=401.397705 best_discrete=60.458855 hash=False elapsed=17.2s
step   225/900 tau=0.4103 loss=0.283961 mse_soft=0.283448 ent_in=1.2618 ent_out=0.4492 rowmax_in=0.4801 rowmax_out=0.8067 discrete_mse=566.805359 best_discrete=60.458855 hash=False elapsed=19.3s
step   250/900 tau=0.3715 loss=0.279425 mse_soft=0.278929 ent_in=1.2287 ent_out=0.4258 rowmax_in=0.4866 rowmax_out=0.8114 discrete_mse=634.443665 best_discrete=60.458855 hash=False elapsed=21.3s
step   275/900 tau=0.3363 loss=0.277345 mse_soft=0.276858 ent_in=1.2115 ent_out=0.4141 rowmax_in=0.4879 rowmax_out=0.8141 discrete_mse=312.853455 best_discrete=60.458855 hash=False elapsed=23.2s
step   300/900 tau=0.3045 loss=0.275693 mse_soft=0.275208 ent_in=1.2102 ent_out=0.4051 rowmax_in=0.4830 rowmax_out=0.8158 discrete_mse=200.418289 best_discrete=60.458855 hash=False elapsed=25.2s
step   325/900 tau=0.2756 loss=0.274246 mse_soft=0.273770 ent_in=1.1956 ent_out=0.3921 rowmax_in=0.4852 rowmax_out=0.8181 discrete_mse=156.790878 best_discrete=60.458855 hash=False elapsed=27.2s
step   350/900 tau=0.2496 loss=0.273784 mse_soft=0.273314 ent_in=1.1922 ent_out=0.3731 rowmax_in=0.4815 rowmax_out=0.8276 discrete_mse=212.999298 best_discrete=60.458855 hash=False elapsed=29.2s
step   375/900 tau=0.2259 loss=0.272221 mse_soft=0.271757 ent_in=1.1858 ent_out=0.3625 rowmax_in=0.4812 rowmax_out=0.8323 discrete_mse=212.999298 best_discrete=60.458855 hash=False elapsed=31.3s
step   400/900 tau=0.2046 loss=0.270398 mse_soft=0.269937 ent_in=1.1837 ent_out=0.3536 rowmax_in=0.4806 rowmax_out=0.8351 discrete_mse=475.484375 best_discrete=60.458855 hash=False elapsed=33.4s
step   425/900 tau=0.1852 loss=0.274104 mse_soft=0.273646 ent_in=1.1803 ent_out=0.3471 rowmax_in=0.4820 rowmax_out=0.8364 discrete_mse=198.032822 best_discrete=60.458855 hash=False elapsed=35.4s
step   450/900 tau=0.1677 loss=0.278851 mse_soft=0.278393 ent_in=1.1841 ent_out=0.3419 rowmax_in=0.4808 rowmax_out=0.8383 discrete_mse=198.032822 best_discrete=60.458855 hash=False elapsed=37.6s
step   475/900 tau=0.1518 loss=0.280558 mse_soft=0.280101 ent_in=1.1802 ent_out=0.3404 rowmax_in=0.4832 rowmax_out=0.8386 discrete_mse=198.032822 best_discrete=60.458855 hash=False elapsed=39.6s
step   500/900 tau=0.1374 loss=0.278004 mse_soft=0.277551 ent_in=1.1769 ent_out=0.3360 rowmax_in=0.4833 rowmax_out=0.8411 discrete_mse=218.969040 best_discrete=60.458855 hash=False elapsed=41.9s
step   525/900 tau=0.1244 loss=0.271611 mse_soft=0.271163 ent_in=1.1653 ent_out=0.3255 rowmax_in=0.4864 rowmax_out=0.8487 discrete_mse=208.791214 best_discrete=60.458855 hash=False elapsed=44.1s
step   550/900 tau=0.1126 loss=0.279388 mse_soft=0.278947 ent_in=1.1459 ent_out=0.3266 rowmax_in=0.4961 rowmax_out=0.8405 discrete_mse=365.535004 best_discrete=60.458855 hash=False elapsed=46.3s
step   575/900 tau=0.1020 loss=0.292645 mse_soft=0.292210 ent_in=1.1259 ent_out=0.3249 rowmax_in=0.5029 rowmax_out=0.8364 discrete_mse=208.893234 best_discrete=60.458855 hash=False elapsed=48.5s
step   600/900 tau=0.0923 loss=0.314472 mse_soft=0.314055 ent_in=1.0807 ent_out=0.3089 rowmax_in=0.5223 rowmax_out=0.8397 discrete_mse=263.577789 best_discrete=60.458855 hash=False elapsed=50.7s
step   625/900 tau=0.0836 loss=0.289286 mse_soft=0.288889 ent_in=1.0353 ent_out=0.2892 rowmax_in=0.5300 rowmax_out=0.8641 discrete_mse=224.830750 best_discrete=60.458855 hash=False elapsed=52.9s
step   650/900 tau=0.0757 loss=0.281623 mse_soft=0.281230 ent_in=1.0252 ent_out=0.2842 rowmax_in=0.5301 rowmax_out=0.8679 discrete_mse=114.836349 best_discrete=60.458855 hash=False elapsed=55.1s
step   675/900 tau=0.0685 loss=0.281899 mse_soft=0.281513 ent_in=1.0140 ent_out=0.2700 rowmax_in=0.5291 rowmax_out=0.8778 discrete_mse=404.590576 best_discrete=60.458855 hash=False elapsed=57.3s
step   700/900 tau=0.0620 loss=0.295342 mse_soft=0.294976 ent_in=0.9882 ent_out=0.2305 rowmax_in=0.5379 rowmax_out=0.8993 discrete_mse=160.092789 best_discrete=60.458855 hash=False elapsed=59.6s
step   725/900 tau=0.0562 loss=0.307057 mse_soft=0.306691 ent_in=0.9793 ent_out=0.2411 rowmax_in=0.5510 rowmax_out=0.8914 discrete_mse=134.739670 best_discrete=60.458855 hash=False elapsed=61.7s
step   750/900 tau=0.0508 loss=0.317853 mse_soft=0.317487 ent_in=0.9540 ent_out=0.2679 rowmax_in=0.5603 rowmax_out=0.8624 discrete_mse=580.463440 best_discrete=60.458855 hash=False elapsed=63.7s
step   775/900 tau=0.0460 loss=0.436744 mse_soft=0.436534 ent_in=0.5177 ent_out=0.1830 rowmax_in=0.7660 rowmax_out=0.9103 discrete_mse=43.522575 best_discrete=43.522575 hash=False elapsed=65.8s
step   800/900 tau=0.0417 loss=0.463255 mse_soft=0.463060 ent_in=0.4636 ent_out=0.1851 rowmax_in=0.7894 rowmax_out=0.8954 discrete_mse=161.086716 best_discrete=43.522575 hash=False elapsed=67.9s
step   825/900 tau=0.0377 loss=0.514494 mse_soft=0.514337 ent_in=0.3628 ent_out=0.1595 rowmax_in=0.8300 rowmax_out=0.9066 discrete_mse=104.250038 best_discrete=43.522575 hash=False elapsed=70.0s
step   850/900 tau=0.0342 loss=0.837694 mse_soft=0.837535 ent_in=0.3987 ent_out=0.1304 rowmax_in=0.8079 rowmax_out=0.9163 discrete_mse=169.662659 best_discrete=43.522575 hash=False elapsed=72.3s
step   875/900 tau=0.0309 loss=0.478606 mse_soft=0.478464 ent_in=0.3679 ent_out=0.1055 rowmax_in=0.8002 rowmax_out=0.9365 discrete_mse=182.796021 best_discrete=43.522575 hash=False elapsed=74.4s
step   900/900 tau=0.0280 loss=0.555254 mse_soft=0.555124 ent_in=0.3256 ent_out=0.1082 rowmax_in=0.8244 rowmax_out=0.9310 discrete_mse=127.326660 best_discrete=43.522575 hash=False elapsed=76.5s

Final metrics:
  soft_mse_full=0.631564
  rowmax_in_mean=0.8315
  rowmax_out_mean=0.9304
  ent_in_mean=0.3202
  ent_out_mean=0.1084
  final_discrete_mse=171.304367
  hash_match=False
  best_discrete_mse_seen=43.522575
Saved results to overnight_b223_j2.json
