Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.069565 mse_soft=1.067242 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=7.626594 best_discrete=7.626594 hash=False elapsed=0.6s
step    25/900 tau=0.9106 loss=0.870284 mse_soft=0.868094 ent_in=3.6321 ent_out=3.6691 rowmax_in=0.0454 rowmax_out=0.0443 discrete_mse=2381.859863 best_discrete=7.626594 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.654322 mse_soft=0.652420 ent_in=3.1160 ent_out=3.2225 rowmax_in=0.0953 rowmax_out=0.0861 discrete_mse=4075.857178 best_discrete=7.626594 hash=False elapsed=5.2s
step    75/900 tau=0.7493 loss=0.510568 mse_soft=0.508998 ent_in=2.5736 ent_out=2.6604 rowmax_in=0.2065 rowmax_out=0.2054 discrete_mse=965.766296 best_discrete=7.626594 hash=False elapsed=7.6s
step   100/900 tau=0.6797 loss=0.398992 mse_soft=0.397849 ent_in=1.9621 ent_out=1.8489 rowmax_in=0.3611 rowmax_out=0.4210 discrete_mse=2244.802979 best_discrete=7.626594 hash=False elapsed=9.8s
step   125/900 tau=0.6165 loss=0.336219 mse_soft=0.335390 ent_in=1.5493 ent_out=1.2159 rowmax_in=0.4600 rowmax_out=0.6044 discrete_mse=275.703522 best_discrete=7.626594 hash=False elapsed=12.4s
step   150/900 tau=0.5592 loss=0.312581 mse_soft=0.311878 ent_in=1.4171 ent_out=0.9274 rowmax_in=0.4782 rowmax_out=0.6869 discrete_mse=866.419556 best_discrete=7.626594 hash=False elapsed=14.8s
step   175/900 tau=0.5073 loss=0.295630 mse_soft=0.295001 ent_in=1.3046 ent_out=0.7930 rowmax_in=0.5038 rowmax_out=0.7092 discrete_mse=948.455566 best_discrete=7.626594 hash=False elapsed=16.9s
step   200/900 tau=0.4602 loss=0.285863 mse_soft=0.285293 ent_in=1.2355 ent_out=0.6642 rowmax_in=0.5144 rowmax_out=0.7532 discrete_mse=465.733551 best_discrete=7.626594 hash=False elapsed=18.9s
step   225/900 tau=0.4174 loss=0.279733 mse_soft=0.279200 ent_in=1.2114 ent_out=0.5649 rowmax_in=0.5157 rowmax_out=0.7811 discrete_mse=863.679504 best_discrete=7.626594 hash=False elapsed=21.0s
step   250/900 tau=0.3786 loss=0.275338 mse_soft=0.274836 ent_in=1.1812 ent_out=0.4930 rowmax_in=0.5192 rowmax_out=0.8028 discrete_mse=942.075500 best_discrete=7.626594 hash=False elapsed=23.3s
step   275/900 tau=0.3434 loss=0.272822 mse_soft=0.272339 ent_in=1.1659 ent_out=0.4441 rowmax_in=0.5203 rowmax_out=0.8147 discrete_mse=1033.275391 best_discrete=7.626594 hash=False elapsed=25.6s
step   300/900 tau=0.3115 loss=0.275545 mse_soft=0.275070 ent_in=1.1618 ent_out=0.4212 rowmax_in=0.5189 rowmax_out=0.8179 discrete_mse=883.116577 best_discrete=7.626594 hash=False elapsed=28.2s
step   325/900 tau=0.2826 loss=0.270415 mse_soft=0.269949 ent_in=1.1538 ent_out=0.4008 rowmax_in=0.5217 rowmax_out=0.8248 discrete_mse=1033.275391 best_discrete=7.626594 hash=False elapsed=30.5s
step   350/900 tau=0.2563 loss=0.270866 mse_soft=0.270405 ent_in=1.1514 ent_out=0.3862 rowmax_in=0.5204 rowmax_out=0.8302 discrete_mse=2066.409180 best_discrete=7.626594 hash=False elapsed=32.8s
step   375/900 tau=0.2325 loss=0.269379 mse_soft=0.268924 ent_in=1.1467 ent_out=0.3715 rowmax_in=0.5222 rowmax_out=0.8335 discrete_mse=353.246826 best_discrete=7.626594 hash=False elapsed=35.2s
step   400/900 tau=0.2109 loss=0.271246 mse_soft=0.270797 ent_in=1.1377 ent_out=0.3594 rowmax_in=0.5240 rowmax_out=0.8362 discrete_mse=553.695007 best_discrete=7.626594 hash=False elapsed=37.5s
step   425/900 tau=0.1913 loss=0.276943 mse_soft=0.276495 ent_in=1.1393 ent_out=0.3546 rowmax_in=0.5236 rowmax_out=0.8351 discrete_mse=553.695007 best_discrete=7.626594 hash=False elapsed=39.9s
step   450/900 tau=0.1735 loss=0.273204 mse_soft=0.272758 ent_in=1.1390 ent_out=0.3498 rowmax_in=0.5225 rowmax_out=0.8337 discrete_mse=553.695007 best_discrete=7.626594 hash=False elapsed=42.2s
step   475/900 tau=0.1574 loss=0.271894 mse_soft=0.271449 ent_in=1.1343 ent_out=0.3473 rowmax_in=0.5229 rowmax_out=0.8313 discrete_mse=963.713196 best_discrete=7.626594 hash=False elapsed=44.4s
step   500/900 tau=0.1428 loss=0.272846 mse_soft=0.272403 ent_in=1.1328 ent_out=0.3414 rowmax_in=0.5236 rowmax_out=0.8343 discrete_mse=762.882690 best_discrete=7.626594 hash=False elapsed=46.7s
step   525/900 tau=0.1295 loss=0.267591 mse_soft=0.267152 ent_in=1.1252 ent_out=0.3395 rowmax_in=0.5272 rowmax_out=0.8335 discrete_mse=762.882690 best_discrete=7.626594 hash=False elapsed=48.7s
step   550/900 tau=0.1175 loss=0.270995 mse_soft=0.270556 ent_in=1.1268 ent_out=0.3377 rowmax_in=0.5243 rowmax_out=0.8345 discrete_mse=762.882690 best_discrete=7.626594 hash=False elapsed=50.9s
step   575/900 tau=0.1066 loss=0.275046 mse_soft=0.274620 ent_in=1.0880 ent_out=0.3301 rowmax_in=0.5396 rowmax_out=0.8401 discrete_mse=510.999176 best_discrete=7.626594 hash=False elapsed=53.2s
step   600/900 tau=0.0967 loss=0.276298 mse_soft=0.275871 ent_in=1.0854 ent_out=0.3384 rowmax_in=0.5322 rowmax_out=0.8305 discrete_mse=205.201599 best_discrete=7.626594 hash=False elapsed=55.4s
step   625/900 tau=0.0877 loss=0.270715 mse_soft=0.270303 ent_in=1.0497 ent_out=0.3231 rowmax_in=0.5481 rowmax_out=0.8465 discrete_mse=942.748596 best_discrete=7.626594 hash=False elapsed=57.6s
step   650/900 tau=0.0795 loss=0.269668 mse_soft=0.269256 ent_in=1.0450 ent_out=0.3272 rowmax_in=0.5466 rowmax_out=0.8419 discrete_mse=2621.585938 best_discrete=7.626594 hash=False elapsed=59.9s
step   675/900 tau=0.0722 loss=0.279396 mse_soft=0.278984 ent_in=1.0396 ent_out=0.3317 rowmax_in=0.5419 rowmax_out=0.8330 discrete_mse=371.497375 best_discrete=7.626594 hash=False elapsed=62.0s
step   700/900 tau=0.0655 loss=0.335571 mse_soft=0.335188 ent_in=0.9529 ent_out=0.3245 rowmax_in=0.5772 rowmax_out=0.8276 discrete_mse=133.561096 best_discrete=7.626594 hash=False elapsed=64.2s
step   725/900 tau=0.0594 loss=0.298011 mse_soft=0.297651 ent_in=0.9159 ent_out=0.2828 rowmax_in=0.5777 rowmax_out=0.8471 discrete_mse=2047.537964 best_discrete=7.626594 hash=False elapsed=66.5s
step   750/900 tau=0.0539 loss=0.315873 mse_soft=0.315518 ent_in=0.9091 ent_out=0.2758 rowmax_in=0.5856 rowmax_out=0.8509 discrete_mse=321.505676 best_discrete=7.626594 hash=False elapsed=68.6s
step   775/900 tau=0.0489 loss=0.344836 mse_soft=0.344530 ent_in=0.7871 ent_out=0.2339 rowmax_in=0.6226 rowmax_out=0.8794 discrete_mse=125.545593 best_discrete=7.626594 hash=False elapsed=70.6s
step   800/900 tau=0.0443 loss=0.325608 mse_soft=0.325285 ent_in=0.8042 ent_out=0.2734 rowmax_in=0.5976 rowmax_out=0.8533 discrete_mse=672.861206 best_discrete=7.626594 hash=False elapsed=72.6s
step   825/900 tau=0.0402 loss=0.325870 mse_soft=0.325577 ent_in=0.7096 ent_out=0.2667 rowmax_in=0.6392 rowmax_out=0.8614 discrete_mse=4.755285 best_discrete=4.755285 hash=False elapsed=74.7s
step   850/900 tau=0.0365 loss=0.348547 mse_soft=0.348302 ent_in=0.5954 ent_out=0.2183 rowmax_in=0.6877 rowmax_out=0.8984 discrete_mse=3.481848 best_discrete=3.481848 hash=False elapsed=76.7s
step   875/900 tau=0.0331 loss=0.402992 mse_soft=0.402790 ent_in=0.4909 ent_out=0.1806 rowmax_in=0.7264 rowmax_out=0.8868 discrete_mse=2.299993 best_discrete=2.299993 hash=False elapsed=78.7s
step   900/900 tau=0.0300 loss=0.373122 mse_soft=0.372920 ent_in=0.4939 ent_out=0.1802 rowmax_in=0.7255 rowmax_out=0.8828 discrete_mse=40.210751 best_discrete=2.299993 hash=False elapsed=80.7s

Final metrics:
  soft_mse_full=0.380253
  rowmax_in_mean=0.7251
  rowmax_out_mean=0.8834
  ent_in_mean=0.4951
  ent_out_mean=0.1805
  final_discrete_mse=2.210123
  hash_match=False
  best_discrete_mse_seen=2.299993
Saved results to overnight_b123_j1.json
