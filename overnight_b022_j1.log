Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.054487 mse_soft=1.052164 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=25.930370 best_discrete=25.930370 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.855253 mse_soft=0.853062 ent_in=3.6349 ent_out=3.6669 rowmax_in=0.0448 rowmax_out=0.0441 discrete_mse=676.740356 best_discrete=25.930370 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.648081 mse_soft=0.646171 ent_in=3.1396 ent_out=3.2249 rowmax_in=0.0938 rowmax_out=0.0887 discrete_mse=1430.773560 best_discrete=25.930370 hash=False elapsed=5.3s
step    75/900 tau=0.7493 loss=0.505294 mse_soft=0.503716 ent_in=2.5944 ent_out=2.6655 rowmax_in=0.2062 rowmax_out=0.2015 discrete_mse=230.636826 best_discrete=25.930370 hash=False elapsed=7.7s
step   100/900 tau=0.6797 loss=0.402494 mse_soft=0.401338 ent_in=1.9674 ent_out=1.8874 rowmax_in=0.3637 rowmax_out=0.4025 discrete_mse=132.163269 best_discrete=25.930370 hash=False elapsed=10.0s
step   125/900 tau=0.6165 loss=0.347215 mse_soft=0.346349 ent_in=1.5929 ent_out=1.2930 rowmax_in=0.4318 rowmax_out=0.5583 discrete_mse=613.491150 best_discrete=25.930370 hash=False elapsed=12.1s
step   150/900 tau=0.5592 loss=0.318372 mse_soft=0.317653 ent_in=1.4142 ent_out=0.9835 rowmax_in=0.4506 rowmax_out=0.6392 discrete_mse=1367.877808 best_discrete=25.930370 hash=False elapsed=14.4s
step   175/900 tau=0.5073 loss=0.300836 mse_soft=0.300208 ent_in=1.3198 ent_out=0.7730 rowmax_in=0.4685 rowmax_out=0.7071 discrete_mse=511.381592 best_discrete=25.930370 hash=False elapsed=16.8s
step   200/900 tau=0.4602 loss=0.292880 mse_soft=0.292306 ent_in=1.2534 ent_out=0.6630 rowmax_in=0.4794 rowmax_out=0.7250 discrete_mse=1692.612305 best_discrete=25.930370 hash=False elapsed=19.0s
step   225/900 tau=0.4174 loss=0.287916 mse_soft=0.287369 ent_in=1.2202 ent_out=0.6036 rowmax_in=0.4822 rowmax_out=0.7459 discrete_mse=2176.300781 best_discrete=25.930370 hash=False elapsed=21.2s
step   250/900 tau=0.3786 loss=0.283840 mse_soft=0.283314 ent_in=1.1890 ent_out=0.5647 rowmax_in=0.4848 rowmax_out=0.7585 discrete_mse=1714.861206 best_discrete=25.930370 hash=False elapsed=23.3s
step   275/900 tau=0.3434 loss=0.281187 mse_soft=0.280682 ent_in=1.1639 ent_out=0.5183 rowmax_in=0.4894 rowmax_out=0.7761 discrete_mse=2076.520020 best_discrete=25.930370 hash=False elapsed=25.4s
step   300/900 tau=0.3115 loss=0.279731 mse_soft=0.279240 ent_in=1.1416 ent_out=0.4936 rowmax_in=0.4956 rowmax_out=0.7854 discrete_mse=2076.520020 best_discrete=25.930370 hash=False elapsed=27.8s
step   325/900 tau=0.2826 loss=0.280169 mse_soft=0.279687 ent_in=1.1277 ent_out=0.4773 rowmax_in=0.4987 rowmax_out=0.7916 discrete_mse=2385.836182 best_discrete=25.930370 hash=False elapsed=29.7s
step   350/900 tau=0.2563 loss=0.280870 mse_soft=0.280393 ent_in=1.1182 ent_out=0.4702 rowmax_in=0.4998 rowmax_out=0.7943 discrete_mse=2869.854248 best_discrete=25.930370 hash=False elapsed=32.0s
step   375/900 tau=0.2325 loss=0.277592 mse_soft=0.277121 ent_in=1.1075 ent_out=0.4616 rowmax_in=0.5032 rowmax_out=0.7966 discrete_mse=2869.854248 best_discrete=25.930370 hash=False elapsed=34.5s
step   400/900 tau=0.2109 loss=0.281529 mse_soft=0.281070 ent_in=1.0875 ent_out=0.4433 rowmax_in=0.5084 rowmax_out=0.8022 discrete_mse=2349.202393 best_discrete=25.930370 hash=False elapsed=36.9s
step   425/900 tau=0.1913 loss=0.280823 mse_soft=0.280371 ent_in=1.0745 ent_out=0.4299 rowmax_in=0.5108 rowmax_out=0.8085 discrete_mse=2017.515747 best_discrete=25.930370 hash=False elapsed=39.4s
step   450/900 tau=0.1735 loss=0.276303 mse_soft=0.275854 ent_in=1.0711 ent_out=0.4277 rowmax_in=0.5107 rowmax_out=0.8071 discrete_mse=2017.515747 best_discrete=25.930370 hash=False elapsed=41.9s
step   475/900 tau=0.1574 loss=0.276439 mse_soft=0.275991 ent_in=1.0669 ent_out=0.4242 rowmax_in=0.5089 rowmax_out=0.8074 discrete_mse=3069.542725 best_discrete=25.930370 hash=False elapsed=44.1s
step   500/900 tau=0.1428 loss=0.278497 mse_soft=0.278053 ent_in=1.0644 ent_out=0.4169 rowmax_in=0.5093 rowmax_out=0.8111 discrete_mse=2017.515747 best_discrete=25.930370 hash=False elapsed=46.2s
step   525/900 tau=0.1295 loss=0.281910 mse_soft=0.281469 ent_in=1.0608 ent_out=0.4110 rowmax_in=0.5136 rowmax_out=0.8130 discrete_mse=2017.515747 best_discrete=25.930370 hash=False elapsed=48.4s
step   550/900 tau=0.1175 loss=0.282685 mse_soft=0.282244 ent_in=1.0649 ent_out=0.4058 rowmax_in=0.5076 rowmax_out=0.8148 discrete_mse=2295.797363 best_discrete=25.930370 hash=False elapsed=50.6s
step   575/900 tau=0.1066 loss=0.276881 mse_soft=0.276446 ent_in=1.0594 ent_out=0.3924 rowmax_in=0.5112 rowmax_out=0.8224 discrete_mse=2295.797363 best_discrete=25.930370 hash=False elapsed=52.7s
step   600/900 tau=0.0967 loss=0.288534 mse_soft=0.288106 ent_in=1.0518 ent_out=0.3758 rowmax_in=0.5087 rowmax_out=0.8242 discrete_mse=1047.245605 best_discrete=25.930370 hash=False elapsed=54.7s
step   625/900 tau=0.0877 loss=0.278550 mse_soft=0.278126 ent_in=1.0480 ent_out=0.3648 rowmax_in=0.5127 rowmax_out=0.8332 discrete_mse=2605.320801 best_discrete=25.930370 hash=False elapsed=57.1s
step   650/900 tau=0.0795 loss=0.278730 mse_soft=0.278302 ent_in=1.0413 ent_out=0.3869 rowmax_in=0.5131 rowmax_out=0.8173 discrete_mse=2868.489258 best_discrete=25.930370 hash=False elapsed=59.3s
step   675/900 tau=0.0722 loss=0.305206 mse_soft=0.304797 ent_in=0.9739 ent_out=0.3894 rowmax_in=0.5569 rowmax_out=0.7980 discrete_mse=157.523926 best_discrete=25.930370 hash=False elapsed=61.6s
step   700/900 tau=0.0655 loss=0.324152 mse_soft=0.323778 ent_in=0.8793 ent_out=0.3685 rowmax_in=0.5929 rowmax_out=0.8087 discrete_mse=161.080414 best_discrete=25.930370 hash=False elapsed=63.8s
step   725/900 tau=0.0594 loss=0.327392 mse_soft=0.327040 ent_in=0.8143 ent_out=0.3592 rowmax_in=0.6027 rowmax_out=0.8118 discrete_mse=670.325684 best_discrete=25.930370 hash=False elapsed=65.9s
step   750/900 tau=0.0539 loss=0.300270 mse_soft=0.299917 ent_in=0.8317 ent_out=0.3466 rowmax_in=0.5866 rowmax_out=0.8220 discrete_mse=1729.858154 best_discrete=25.930370 hash=False elapsed=68.0s
step   775/900 tau=0.0489 loss=0.373226 mse_soft=0.372941 ent_in=0.6853 ent_out=0.2630 rowmax_in=0.6795 rowmax_out=0.8625 discrete_mse=27.528925 best_discrete=25.930370 hash=False elapsed=70.2s
step   800/900 tau=0.0443 loss=0.397825 mse_soft=0.397561 ent_in=0.6086 ent_out=0.2730 rowmax_in=0.6999 rowmax_out=0.8544 discrete_mse=147.578796 best_discrete=25.930370 hash=False elapsed=72.4s
step   825/900 tau=0.0402 loss=0.362677 mse_soft=0.362427 ent_in=0.5688 ent_out=0.2641 rowmax_in=0.7112 rowmax_out=0.8464 discrete_mse=19.999043 best_discrete=19.999043 hash=False elapsed=74.7s
step   850/900 tau=0.0365 loss=0.349146 mse_soft=0.348892 ent_in=0.5843 ent_out=0.2615 rowmax_in=0.7026 rowmax_out=0.8525 discrete_mse=112.762207 best_discrete=19.999043 hash=False elapsed=76.8s
step   875/900 tau=0.0331 loss=0.376541 mse_soft=0.376344 ent_in=0.4672 ent_out=0.1887 rowmax_in=0.7538 rowmax_out=0.8967 discrete_mse=113.259972 best_discrete=19.999043 hash=False elapsed=79.1s
step   900/900 tau=0.0300 loss=0.367252 mse_soft=0.367056 ent_in=0.4765 ent_out=0.1772 rowmax_in=0.7388 rowmax_out=0.9032 discrete_mse=38.227043 best_discrete=19.999043 hash=False elapsed=81.2s

Final metrics:
  soft_mse_full=0.366495
  rowmax_in_mean=0.7397
  rowmax_out_mean=0.9029
  ent_in_mean=0.4760
  ent_out_mean=0.1775
  final_discrete_mse=87.692413
  hash_match=False
  best_discrete_mse_seen=19.999043
Saved results to overnight_b022_j1.json
