Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.051712 mse_soft=1.049389 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=3.438723 best_discrete=3.438723 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.845880 mse_soft=0.843689 ent_in=3.6326 ent_out=3.6704 rowmax_in=0.0458 rowmax_out=0.0435 discrete_mse=3821.714600 best_discrete=3.438723 hash=False elapsed=2.9s
step    50/900 tau=0.8260 loss=0.636902 mse_soft=0.634987 ent_in=3.1404 ent_out=3.2409 rowmax_in=0.0942 rowmax_out=0.0870 discrete_mse=2228.995605 best_discrete=3.438723 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.502888 mse_soft=0.501290 ent_in=2.6216 ent_out=2.7054 rowmax_in=0.1995 rowmax_out=0.2024 discrete_mse=4202.440918 best_discrete=3.438723 hash=False elapsed=7.5s
step   100/900 tau=0.6797 loss=0.397995 mse_soft=0.396788 ent_in=2.0755 ent_out=1.9466 rowmax_in=0.3198 rowmax_out=0.3744 discrete_mse=2413.375488 best_discrete=3.438723 hash=False elapsed=9.7s
step   125/900 tau=0.6165 loss=0.338889 mse_soft=0.338000 ent_in=1.6708 ent_out=1.2923 rowmax_in=0.4317 rowmax_out=0.5656 discrete_mse=1756.925781 best_discrete=3.438723 hash=False elapsed=11.9s
step   150/900 tau=0.5592 loss=0.316700 mse_soft=0.315953 ent_in=1.4900 ent_out=0.9996 rowmax_in=0.4615 rowmax_out=0.6463 discrete_mse=795.072266 best_discrete=3.438723 hash=False elapsed=14.2s
step   175/900 tau=0.5073 loss=0.303123 mse_soft=0.302454 ent_in=1.4054 ent_out=0.8257 rowmax_in=0.4759 rowmax_out=0.6936 discrete_mse=1116.550049 best_discrete=3.438723 hash=False elapsed=16.4s
step   200/900 tau=0.4602 loss=0.294526 mse_soft=0.293925 ent_in=1.3317 ent_out=0.6721 rowmax_in=0.4872 rowmax_out=0.7499 discrete_mse=1116.550049 best_discrete=3.438723 hash=False elapsed=18.6s
step   225/900 tau=0.4174 loss=0.286979 mse_soft=0.286426 ent_in=1.2592 ent_out=0.5841 rowmax_in=0.4996 rowmax_out=0.7668 discrete_mse=861.025757 best_discrete=3.438723 hash=False elapsed=20.9s
step   250/900 tau=0.3786 loss=0.284542 mse_soft=0.284016 ent_in=1.2213 ent_out=0.5295 rowmax_in=0.5087 rowmax_out=0.7876 discrete_mse=271.258423 best_discrete=3.438723 hash=False elapsed=23.1s
step   275/900 tau=0.3434 loss=0.279298 mse_soft=0.278795 ent_in=1.1952 ent_out=0.4817 rowmax_in=0.5169 rowmax_out=0.8106 discrete_mse=601.388489 best_discrete=3.438723 hash=False elapsed=25.2s
step   300/900 tau=0.3115 loss=0.278140 mse_soft=0.277659 ent_in=1.1778 ent_out=0.4239 rowmax_in=0.5201 rowmax_out=0.8335 discrete_mse=601.388489 best_discrete=3.438723 hash=False elapsed=27.3s
step   325/900 tau=0.2826 loss=0.275038 mse_soft=0.274570 ent_in=1.1675 ent_out=0.3917 rowmax_in=0.5212 rowmax_out=0.8424 discrete_mse=563.775513 best_discrete=3.438723 hash=False elapsed=29.6s
step   350/900 tau=0.2563 loss=0.275610 mse_soft=0.275153 ent_in=1.1547 ent_out=0.3690 rowmax_in=0.5235 rowmax_out=0.8481 discrete_mse=563.775513 best_discrete=3.438723 hash=False elapsed=32.1s
step   375/900 tau=0.2325 loss=0.274859 mse_soft=0.274410 ent_in=1.1433 ent_out=0.3515 rowmax_in=0.5255 rowmax_out=0.8495 discrete_mse=563.775513 best_discrete=3.438723 hash=False elapsed=34.3s
step   400/900 tau=0.2109 loss=0.275726 mse_soft=0.275283 ent_in=1.1318 ent_out=0.3455 rowmax_in=0.5281 rowmax_out=0.8474 discrete_mse=929.323792 best_discrete=3.438723 hash=False elapsed=36.5s
step   425/900 tau=0.1913 loss=0.275675 mse_soft=0.275237 ent_in=1.1223 ent_out=0.3389 rowmax_in=0.5289 rowmax_out=0.8468 discrete_mse=1776.115967 best_discrete=3.438723 hash=False elapsed=38.7s
step   450/900 tau=0.1735 loss=0.270916 mse_soft=0.270481 ent_in=1.1171 ent_out=0.3323 rowmax_in=0.5286 rowmax_out=0.8478 discrete_mse=1290.700928 best_discrete=3.438723 hash=False elapsed=40.8s
step   475/900 tau=0.1574 loss=0.273773 mse_soft=0.273340 ent_in=1.1138 ent_out=0.3264 rowmax_in=0.5284 rowmax_out=0.8500 discrete_mse=1290.700928 best_discrete=3.438723 hash=False elapsed=43.0s
step   500/900 tau=0.1428 loss=0.276091 mse_soft=0.275662 ent_in=1.1040 ent_out=0.3278 rowmax_in=0.5310 rowmax_out=0.8477 discrete_mse=62.382637 best_discrete=3.438723 hash=False elapsed=45.5s
step   525/900 tau=0.1295 loss=0.277610 mse_soft=0.277182 ent_in=1.0930 ent_out=0.3321 rowmax_in=0.5326 rowmax_out=0.8449 discrete_mse=185.689590 best_discrete=3.438723 hash=False elapsed=48.1s
step   550/900 tau=0.1175 loss=0.278587 mse_soft=0.278162 ent_in=1.0806 ent_out=0.3347 rowmax_in=0.5381 rowmax_out=0.8422 discrete_mse=285.242401 best_discrete=3.438723 hash=False elapsed=50.3s
step   575/900 tau=0.1066 loss=0.270421 mse_soft=0.270000 ent_in=1.0724 ent_out=0.3307 rowmax_in=0.5398 rowmax_out=0.8441 discrete_mse=285.242401 best_discrete=3.438723 hash=False elapsed=52.7s
step   600/900 tau=0.0967 loss=0.291602 mse_soft=0.291185 ent_in=1.0654 ent_out=0.3270 rowmax_in=0.5359 rowmax_out=0.8434 discrete_mse=285.242401 best_discrete=3.438723 hash=False elapsed=55.1s
step   625/900 tau=0.0877 loss=0.275991 mse_soft=0.275576 ent_in=1.0606 ent_out=0.3228 rowmax_in=0.5386 rowmax_out=0.8442 discrete_mse=285.242401 best_discrete=3.438723 hash=False elapsed=57.3s
step   650/900 tau=0.0795 loss=0.280656 mse_soft=0.280244 ent_in=1.0524 ent_out=0.3188 rowmax_in=0.5406 rowmax_out=0.8444 discrete_mse=130.011765 best_discrete=3.438723 hash=False elapsed=59.6s
step   675/900 tau=0.0722 loss=0.297672 mse_soft=0.297266 ent_in=1.0338 ent_out=0.3190 rowmax_in=0.5450 rowmax_out=0.8444 discrete_mse=56.609550 best_discrete=3.438723 hash=False elapsed=61.7s
step   700/900 tau=0.0655 loss=0.281139 mse_soft=0.280738 ent_in=1.0155 ent_out=0.3210 rowmax_in=0.5488 rowmax_out=0.8427 discrete_mse=366.701355 best_discrete=3.438723 hash=False elapsed=64.1s
step   725/900 tau=0.0594 loss=0.373981 mse_soft=0.373684 ent_in=0.7397 ent_out=0.2483 rowmax_in=0.6746 rowmax_out=0.8851 discrete_mse=122.490097 best_discrete=3.438723 hash=False elapsed=66.3s
step   750/900 tau=0.0539 loss=0.332465 mse_soft=0.332183 ent_in=0.6903 ent_out=0.2479 rowmax_in=0.6767 rowmax_out=0.8803 discrete_mse=109.521774 best_discrete=3.438723 hash=False elapsed=68.5s
step   775/900 tau=0.0489 loss=0.330720 mse_soft=0.330428 ent_in=0.7134 ent_out=0.2622 rowmax_in=0.6523 rowmax_out=0.8708 discrete_mse=131.319321 best_discrete=3.438723 hash=False elapsed=70.8s
step   800/900 tau=0.0443 loss=0.308740 mse_soft=0.308469 ent_in=0.6579 ent_out=0.2461 rowmax_in=0.6761 rowmax_out=0.8827 discrete_mse=378.840332 best_discrete=3.438723 hash=False elapsed=73.0s
step   825/900 tau=0.0402 loss=0.334982 mse_soft=0.334731 ent_in=0.5686 ent_out=0.2690 rowmax_in=0.7308 rowmax_out=0.8606 discrete_mse=13.199393 best_discrete=3.438723 hash=False elapsed=75.5s
step   850/900 tau=0.0365 loss=0.329504 mse_soft=0.329256 ent_in=0.5712 ent_out=0.2564 rowmax_in=0.7235 rowmax_out=0.8739 discrete_mse=98.335297 best_discrete=3.438723 hash=False elapsed=77.7s
step   875/900 tau=0.0331 loss=0.318547 mse_soft=0.318292 ent_in=0.5957 ent_out=0.2521 rowmax_in=0.7085 rowmax_out=0.8767 discrete_mse=109.746201 best_discrete=3.438723 hash=False elapsed=79.9s
step   900/900 tau=0.0300 loss=0.337687 mse_soft=0.337434 ent_in=0.5981 ent_out=0.2453 rowmax_in=0.7039 rowmax_out=0.8797 discrete_mse=22.736406 best_discrete=3.438723 hash=False elapsed=82.1s

Final metrics:
  soft_mse_full=0.355406
  rowmax_in_mean=0.7186
  rowmax_out_mean=0.8824
  ent_in_mean=0.5882
  ent_out_mean=0.2397
  final_discrete_mse=7.628572
  hash_match=False
  best_discrete_mse_seen=3.438723
Saved results to overnight_b089_j1.json
