Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.050704 mse_soft=1.048381 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=28.859955 best_discrete=28.859955 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.848665 mse_soft=0.846475 ent_in=3.6359 ent_out=3.6647 rowmax_in=0.0448 rowmax_out=0.0448 discrete_mse=5754.533691 best_discrete=28.859955 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.639785 mse_soft=0.637875 ent_in=3.1407 ent_out=3.2262 rowmax_in=0.0927 rowmax_out=0.0892 discrete_mse=2215.898438 best_discrete=28.859955 hash=False elapsed=5.1s
step    75/900 tau=0.7493 loss=0.497384 mse_soft=0.495804 ent_in=2.5967 ent_out=2.6679 rowmax_in=0.2116 rowmax_out=0.2058 discrete_mse=530.992065 best_discrete=28.859955 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.396736 mse_soft=0.395575 ent_in=2.0351 ent_out=1.8346 rowmax_in=0.3301 rowmax_out=0.4078 discrete_mse=1241.437988 best_discrete=28.859955 hash=False elapsed=9.8s
step   125/900 tau=0.6165 loss=0.330689 mse_soft=0.329884 ent_in=1.6103 ent_out=1.0749 rowmax_in=0.4295 rowmax_out=0.6681 discrete_mse=1277.769897 best_discrete=28.859955 hash=False elapsed=12.4s
step   150/900 tau=0.5592 loss=0.301019 mse_soft=0.300357 ent_in=1.4074 ent_out=0.8013 rowmax_in=0.4653 rowmax_out=0.7184 discrete_mse=443.231476 best_discrete=28.859955 hash=False elapsed=14.7s
step   175/900 tau=0.5073 loss=0.289306 mse_soft=0.288744 ent_in=1.3059 ent_out=0.5702 rowmax_in=0.4774 rowmax_out=0.7910 discrete_mse=371.025177 best_discrete=28.859955 hash=False elapsed=17.1s
step   200/900 tau=0.4602 loss=0.282238 mse_soft=0.281725 ent_in=1.2798 ent_out=0.4324 rowmax_in=0.4805 rowmax_out=0.8293 discrete_mse=481.609985 best_discrete=28.859955 hash=False elapsed=19.5s
step   225/900 tau=0.4174 loss=0.278778 mse_soft=0.278288 ent_in=1.2569 ent_out=0.3755 rowmax_in=0.4832 rowmax_out=0.8399 discrete_mse=138.383118 best_discrete=28.859955 hash=False elapsed=21.8s
step   250/900 tau=0.3786 loss=0.277169 mse_soft=0.276693 ent_in=1.2447 ent_out=0.3391 rowmax_in=0.4812 rowmax_out=0.8509 discrete_mse=165.683273 best_discrete=28.859955 hash=False elapsed=24.1s
step   275/900 tau=0.3434 loss=0.274380 mse_soft=0.273912 ent_in=1.2377 ent_out=0.3220 rowmax_in=0.4794 rowmax_out=0.8550 discrete_mse=58.390148 best_discrete=28.859955 hash=False elapsed=26.7s
step   300/900 tau=0.3115 loss=0.273237 mse_soft=0.272774 ent_in=1.2332 ent_out=0.3097 rowmax_in=0.4812 rowmax_out=0.8634 discrete_mse=48.258331 best_discrete=28.859955 hash=False elapsed=29.0s
step   325/900 tau=0.2826 loss=0.273476 mse_soft=0.273018 ent_in=1.2252 ent_out=0.3024 rowmax_in=0.4785 rowmax_out=0.8663 discrete_mse=58.390148 best_discrete=28.859955 hash=False elapsed=31.4s
step   350/900 tau=0.2563 loss=0.272209 mse_soft=0.271754 ent_in=1.2216 ent_out=0.2946 rowmax_in=0.4774 rowmax_out=0.8678 discrete_mse=25.607864 best_discrete=25.607864 hash=False elapsed=33.8s
step   375/900 tau=0.2325 loss=0.273769 mse_soft=0.273318 ent_in=1.2129 ent_out=0.2902 rowmax_in=0.4775 rowmax_out=0.8687 discrete_mse=37.221855 best_discrete=25.607864 hash=False elapsed=36.3s
step   400/900 tau=0.2109 loss=0.274698 mse_soft=0.274252 ent_in=1.2035 ent_out=0.2839 rowmax_in=0.4800 rowmax_out=0.8720 discrete_mse=47.919773 best_discrete=25.607864 hash=False elapsed=38.6s
step   425/900 tau=0.1913 loss=0.273486 mse_soft=0.273042 ent_in=1.1992 ent_out=0.2818 rowmax_in=0.4787 rowmax_out=0.8688 discrete_mse=47.919773 best_discrete=25.607864 hash=False elapsed=40.9s
step   450/900 tau=0.1735 loss=0.272178 mse_soft=0.271737 ent_in=1.1956 ent_out=0.2746 rowmax_in=0.4781 rowmax_out=0.8720 discrete_mse=47.919773 best_discrete=25.607864 hash=False elapsed=43.2s
step   475/900 tau=0.1574 loss=0.274805 mse_soft=0.274365 ent_in=1.1950 ent_out=0.2722 rowmax_in=0.4767 rowmax_out=0.8710 discrete_mse=47.919773 best_discrete=25.607864 hash=False elapsed=45.8s
step   500/900 tau=0.1428 loss=0.277790 mse_soft=0.277351 ent_in=1.1974 ent_out=0.2661 rowmax_in=0.4752 rowmax_out=0.8751 discrete_mse=47.919773 best_discrete=25.607864 hash=False elapsed=48.2s
step   525/900 tau=0.1295 loss=0.275472 mse_soft=0.275034 ent_in=1.1942 ent_out=0.2683 rowmax_in=0.4761 rowmax_out=0.8716 discrete_mse=47.919773 best_discrete=25.607864 hash=False elapsed=50.9s
step   550/900 tau=0.1175 loss=0.274401 mse_soft=0.273962 ent_in=1.1941 ent_out=0.2664 rowmax_in=0.4738 rowmax_out=0.8711 discrete_mse=47.919773 best_discrete=25.607864 hash=False elapsed=53.2s
step   575/900 tau=0.1066 loss=0.274285 mse_soft=0.273850 ent_in=1.1879 ent_out=0.2627 rowmax_in=0.4766 rowmax_out=0.8715 discrete_mse=47.919773 best_discrete=25.607864 hash=False elapsed=55.6s
step   600/900 tau=0.0967 loss=0.285847 mse_soft=0.285412 ent_in=1.1847 ent_out=0.2656 rowmax_in=0.4758 rowmax_out=0.8689 discrete_mse=52.562504 best_discrete=25.607864 hash=False elapsed=57.8s
step   625/900 tau=0.0877 loss=0.280555 mse_soft=0.280124 ent_in=1.1759 ent_out=0.2599 rowmax_in=0.4818 rowmax_out=0.8729 discrete_mse=119.475571 best_discrete=25.607864 hash=False elapsed=60.3s
step   650/900 tau=0.0795 loss=0.283758 mse_soft=0.283334 ent_in=1.1598 ent_out=0.2521 rowmax_in=0.4871 rowmax_out=0.8791 discrete_mse=175.487228 best_discrete=25.607864 hash=False elapsed=62.9s
step   675/900 tau=0.0722 loss=0.278778 mse_soft=0.278359 ent_in=1.1474 ent_out=0.2474 rowmax_in=0.4908 rowmax_out=0.8816 discrete_mse=463.169800 best_discrete=25.607864 hash=False elapsed=65.3s
step   700/900 tau=0.0655 loss=0.281256 mse_soft=0.280848 ent_in=1.1264 ent_out=0.2352 rowmax_in=0.4992 rowmax_out=0.8843 discrete_mse=73.990761 best_discrete=25.607864 hash=False elapsed=67.7s
step   725/900 tau=0.0594 loss=0.285901 mse_soft=0.285494 ent_in=1.1203 ent_out=0.2352 rowmax_in=0.4970 rowmax_out=0.8912 discrete_mse=108.205200 best_discrete=25.607864 hash=False elapsed=70.1s
step   750/900 tau=0.0539 loss=0.328587 mse_soft=0.328197 ent_in=1.0832 ent_out=0.2175 rowmax_in=0.5188 rowmax_out=0.9024 discrete_mse=56.792423 best_discrete=25.607864 hash=False elapsed=72.4s
step   775/900 tau=0.0489 loss=0.366438 mse_soft=0.366115 ent_in=0.8627 ent_out=0.2135 rowmax_in=0.6070 rowmax_out=0.9052 discrete_mse=57.489666 best_discrete=25.607864 hash=False elapsed=75.0s
step   800/900 tau=0.0443 loss=0.319026 mse_soft=0.318721 ent_in=0.7861 ent_out=0.2316 rowmax_in=0.6413 rowmax_out=0.8743 discrete_mse=126.342323 best_discrete=25.607864 hash=False elapsed=77.3s
step   825/900 tau=0.0402 loss=0.298575 mse_soft=0.298265 ent_in=0.7952 ent_out=0.2375 rowmax_in=0.6037 rowmax_out=0.8633 discrete_mse=367.673950 best_discrete=25.607864 hash=False elapsed=79.7s
step   850/900 tau=0.0365 loss=0.336432 mse_soft=0.336158 ent_in=0.6731 ent_out=0.2381 rowmax_in=0.6531 rowmax_out=0.8637 discrete_mse=23.245144 best_discrete=23.245144 hash=False elapsed=82.0s
step   875/900 tau=0.0331 loss=0.411474 mse_soft=0.411237 ent_in=0.5713 ent_out=0.2206 rowmax_in=0.7314 rowmax_out=0.8753 discrete_mse=4.521798 best_discrete=4.521798 hash=False elapsed=84.1s
step   900/900 tau=0.0300 loss=0.387092 mse_soft=0.386911 ent_in=0.4118 ent_out=0.1907 rowmax_in=0.7806 rowmax_out=0.9110 discrete_mse=6.649667 best_discrete=4.521798 hash=False elapsed=86.3s

Final metrics:
  soft_mse_full=0.400424
  rowmax_in_mean=0.7768
  rowmax_out_mean=0.9040
  ent_in_mean=0.4105
  ent_out_mean=0.1997
  final_discrete_mse=12.621337
  hash_match=False
  best_discrete_mse_seen=4.521798
Saved results to overnight_b005_j1.json
