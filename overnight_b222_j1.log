Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.065353 mse_soft=1.063030 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=272.000610 best_discrete=272.000610 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.859975 mse_soft=0.857784 ent_in=3.6345 ent_out=3.6689 rowmax_in=0.0452 rowmax_out=0.0443 discrete_mse=1224.187988 best_discrete=272.000610 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.647257 mse_soft=0.645345 ent_in=3.1369 ent_out=3.2385 rowmax_in=0.0939 rowmax_out=0.0867 discrete_mse=14453.519531 best_discrete=272.000610 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.516179 mse_soft=0.514580 ent_in=2.6271 ent_out=2.7014 rowmax_in=0.2034 rowmax_out=0.1944 discrete_mse=1089.625244 best_discrete=272.000610 hash=False elapsed=7.4s
step   100/900 tau=0.6797 loss=0.412040 mse_soft=0.410877 ent_in=2.0390 ent_out=1.8385 rowmax_in=0.3396 rowmax_out=0.4318 discrete_mse=368.872986 best_discrete=272.000610 hash=False elapsed=9.7s
step   125/900 tau=0.6165 loss=0.353286 mse_soft=0.352443 ent_in=1.6689 ent_out=1.1392 rowmax_in=0.4338 rowmax_out=0.6438 discrete_mse=90.893150 best_discrete=90.893150 hash=False elapsed=12.1s
step   150/900 tau=0.5592 loss=0.322898 mse_soft=0.322212 ent_in=1.5098 ent_out=0.7769 rowmax_in=0.4562 rowmax_out=0.7312 discrete_mse=490.958282 best_discrete=90.893150 hash=False elapsed=14.4s
step   175/900 tau=0.5073 loss=0.305063 mse_soft=0.304482 ent_in=1.3890 ent_out=0.5476 rowmax_in=0.4712 rowmax_out=0.8119 discrete_mse=499.799774 best_discrete=90.893150 hash=False elapsed=16.6s
step   200/900 tau=0.4602 loss=0.295557 mse_soft=0.295034 ent_in=1.3357 ent_out=0.4071 rowmax_in=0.4782 rowmax_out=0.8619 discrete_mse=588.763977 best_discrete=90.893150 hash=False elapsed=18.8s
step   225/900 tau=0.4174 loss=0.287354 mse_soft=0.286868 ent_in=1.2953 ent_out=0.3257 rowmax_in=0.4819 rowmax_out=0.8841 discrete_mse=870.901367 best_discrete=90.893150 hash=False elapsed=21.2s
step   250/900 tau=0.3786 loss=0.287329 mse_soft=0.286864 ent_in=1.2638 ent_out=0.2872 rowmax_in=0.4845 rowmax_out=0.8950 discrete_mse=2238.520020 best_discrete=90.893150 hash=False elapsed=23.3s
step   275/900 tau=0.3434 loss=0.280481 mse_soft=0.280026 ent_in=1.2496 ent_out=0.2680 rowmax_in=0.4872 rowmax_out=0.8974 discrete_mse=1019.062378 best_discrete=90.893150 hash=False elapsed=25.7s
step   300/900 tau=0.3115 loss=0.283207 mse_soft=0.282760 ent_in=1.2409 ent_out=0.2477 rowmax_in=0.4892 rowmax_out=0.9042 discrete_mse=1029.303345 best_discrete=90.893150 hash=False elapsed=27.8s
step   325/900 tau=0.2826 loss=0.276335 mse_soft=0.275900 ent_in=1.2203 ent_out=0.2299 rowmax_in=0.4938 rowmax_out=0.9111 discrete_mse=839.356873 best_discrete=90.893150 hash=False elapsed=30.0s
step   350/900 tau=0.2563 loss=0.273015 mse_soft=0.272588 ent_in=1.2080 ent_out=0.2176 rowmax_in=0.4960 rowmax_out=0.9148 discrete_mse=1527.336792 best_discrete=90.893150 hash=False elapsed=32.2s
step   375/900 tau=0.2325 loss=0.275446 mse_soft=0.275023 ent_in=1.1973 ent_out=0.2129 rowmax_in=0.4970 rowmax_out=0.9153 discrete_mse=1136.412231 best_discrete=90.893150 hash=False elapsed=34.5s
step   400/900 tau=0.2109 loss=0.272946 mse_soft=0.272526 ent_in=1.1915 ent_out=0.2079 rowmax_in=0.4964 rowmax_out=0.9164 discrete_mse=780.129883 best_discrete=90.893150 hash=False elapsed=36.5s
step   425/900 tau=0.1913 loss=0.277062 mse_soft=0.276646 ent_in=1.1828 ent_out=0.2033 rowmax_in=0.4991 rowmax_out=0.9163 discrete_mse=780.129883 best_discrete=90.893150 hash=False elapsed=38.5s
step   450/900 tau=0.1735 loss=0.279447 mse_soft=0.279034 ent_in=1.1813 ent_out=0.1964 rowmax_in=0.4980 rowmax_out=0.9176 discrete_mse=123.817123 best_discrete=90.893150 hash=False elapsed=40.6s
step   475/900 tau=0.1574 loss=0.271137 mse_soft=0.270727 ent_in=1.1747 ent_out=0.1906 rowmax_in=0.5004 rowmax_out=0.9185 discrete_mse=123.817123 best_discrete=90.893150 hash=False elapsed=42.8s
step   500/900 tau=0.1428 loss=0.279529 mse_soft=0.279122 ent_in=1.1727 ent_out=0.1852 rowmax_in=0.4998 rowmax_out=0.9194 discrete_mse=581.470764 best_discrete=90.893150 hash=False elapsed=44.8s
step   525/900 tau=0.1295 loss=0.273713 mse_soft=0.273307 ent_in=1.1734 ent_out=0.1810 rowmax_in=0.4986 rowmax_out=0.9217 discrete_mse=581.470764 best_discrete=90.893150 hash=False elapsed=47.1s
step   550/900 tau=0.1175 loss=0.280169 mse_soft=0.279776 ent_in=1.1389 ent_out=0.1725 rowmax_in=0.5044 rowmax_out=0.9254 discrete_mse=381.166931 best_discrete=90.893150 hash=False elapsed=49.3s
step   575/900 tau=0.1066 loss=0.296310 mse_soft=0.295926 ent_in=1.1205 ent_out=0.1588 rowmax_in=0.5148 rowmax_out=0.9268 discrete_mse=307.886322 best_discrete=90.893150 hash=False elapsed=51.5s
step   600/900 tau=0.0967 loss=0.278166 mse_soft=0.277786 ent_in=1.1167 ent_out=0.1488 rowmax_in=0.5142 rowmax_out=0.9318 discrete_mse=1122.671997 best_discrete=90.893150 hash=False elapsed=53.8s
step   625/900 tau=0.0877 loss=0.278717 mse_soft=0.278340 ent_in=1.1145 ent_out=0.1435 rowmax_in=0.5175 rowmax_out=0.9331 discrete_mse=724.624573 best_discrete=90.893150 hash=False elapsed=55.8s
step   650/900 tau=0.0795 loss=0.274347 mse_soft=0.273975 ent_in=1.1034 ent_out=0.1384 rowmax_in=0.5211 rowmax_out=0.9339 discrete_mse=1122.671997 best_discrete=90.893150 hash=False elapsed=58.2s
step   675/900 tau=0.0722 loss=0.341709 mse_soft=0.341386 ent_in=0.9596 ent_out=0.1158 rowmax_in=0.5811 rowmax_out=0.9436 discrete_mse=81.633980 best_discrete=81.633980 hash=False elapsed=60.4s
step   700/900 tau=0.0655 loss=0.314092 mse_soft=0.313788 ent_in=0.9190 ent_out=0.0966 rowmax_in=0.5858 rowmax_out=0.9553 discrete_mse=67.635033 best_discrete=67.635033 hash=False elapsed=62.7s
step   725/900 tau=0.0594 loss=0.317316 mse_soft=0.317006 ent_in=0.9459 ent_out=0.0862 rowmax_in=0.5677 rowmax_out=0.9578 discrete_mse=41.141884 best_discrete=41.141884 hash=False elapsed=64.7s
step   750/900 tau=0.0539 loss=0.293759 mse_soft=0.293460 ent_in=0.9109 ent_out=0.0864 rowmax_in=0.5848 rowmax_out=0.9574 discrete_mse=37.001110 best_discrete=37.001110 hash=False elapsed=66.8s
step   775/900 tau=0.0489 loss=0.373565 mse_soft=0.373299 ent_in=0.8087 ent_out=0.0799 rowmax_in=0.6625 rowmax_out=0.9624 discrete_mse=65.659576 best_discrete=37.001110 hash=False elapsed=68.8s
step   800/900 tau=0.0443 loss=0.349541 mse_soft=0.349339 ent_in=0.6044 ent_out=0.0687 rowmax_in=0.7078 rowmax_out=0.9670 discrete_mse=158.205139 best_discrete=37.001110 hash=False elapsed=71.0s
step   825/900 tau=0.0402 loss=0.350522 mse_soft=0.350338 ent_in=0.5432 ent_out=0.0698 rowmax_in=0.7352 rowmax_out=0.9667 discrete_mse=235.762970 best_discrete=37.001110 hash=False elapsed=73.2s
step   850/900 tau=0.0365 loss=0.363581 mse_soft=0.363396 ent_in=0.5429 ent_out=0.0737 rowmax_in=0.7277 rowmax_out=0.9657 discrete_mse=248.520142 best_discrete=37.001110 hash=False elapsed=75.2s
step   875/900 tau=0.0331 loss=0.349156 mse_soft=0.348971 ent_in=0.5461 ent_out=0.0711 rowmax_in=0.7282 rowmax_out=0.9663 discrete_mse=248.520142 best_discrete=37.001110 hash=False elapsed=77.1s
step   900/900 tau=0.0300 loss=0.402462 mse_soft=0.402302 ent_in=0.4609 ent_out=0.0712 rowmax_in=0.7648 rowmax_out=0.9663 discrete_mse=138.927933 best_discrete=37.001110 hash=False elapsed=79.1s

Final metrics:
  soft_mse_full=0.420346
  rowmax_in_mean=0.7668
  rowmax_out_mean=0.9663
  ent_in_mean=0.4567
  ent_out_mean=0.0712
  final_discrete_mse=799.026917
  hash_match=False
  best_discrete_mse_seen=37.001110
Saved results to overnight_b222_j1.json
