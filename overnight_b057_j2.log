Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.068831 mse_soft=1.066509 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=34.880112 best_discrete=34.880112 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.863581 mse_soft=0.861391 ent_in=3.6333 ent_out=3.6655 rowmax_in=0.0452 rowmax_out=0.0443 discrete_mse=1174.203613 best_discrete=34.880112 hash=False elapsed=2.5s
step    50/900 tau=0.8229 loss=0.644668 mse_soft=0.642760 ent_in=3.1291 ent_out=3.2312 rowmax_in=0.0931 rowmax_out=0.0872 discrete_mse=1910.963013 best_discrete=34.880112 hash=False elapsed=4.4s
step    75/900 tau=0.7450 loss=0.500689 mse_soft=0.499107 ent_in=2.5970 ent_out=2.6756 rowmax_in=0.2153 rowmax_out=0.2062 discrete_mse=6124.180176 best_discrete=34.880112 hash=False elapsed=6.5s
step   100/900 tau=0.6745 loss=0.391776 mse_soft=0.390621 ent_in=1.9829 ent_out=1.8674 rowmax_in=0.3722 rowmax_out=0.4276 discrete_mse=2333.024658 best_discrete=34.880112 hash=False elapsed=8.5s
step   125/900 tau=0.6107 loss=0.339093 mse_soft=0.338220 ent_in=1.6555 ent_out=1.2536 rowmax_in=0.4233 rowmax_out=0.6006 discrete_mse=223.768692 best_discrete=34.880112 hash=False elapsed=10.6s
step   150/900 tau=0.5529 loss=0.315001 mse_soft=0.314319 ent_in=1.4576 ent_out=0.8144 rowmax_in=0.4452 rowmax_out=0.7278 discrete_mse=598.319702 best_discrete=34.880112 hash=False elapsed=12.6s
step   175/900 tau=0.5006 loss=0.299603 mse_soft=0.299045 ent_in=1.3218 ent_out=0.5402 rowmax_in=0.4705 rowmax_out=0.8047 discrete_mse=505.428528 best_discrete=34.880112 hash=False elapsed=14.7s
step   200/900 tau=0.4532 loss=0.292125 mse_soft=0.291622 ent_in=1.2614 ent_out=0.4144 rowmax_in=0.4751 rowmax_out=0.8500 discrete_mse=422.930389 best_discrete=34.880112 hash=False elapsed=16.9s
step   225/900 tau=0.4103 loss=0.288683 mse_soft=0.288201 ent_in=1.2301 ent_out=0.3772 rowmax_in=0.4807 rowmax_out=0.8609 discrete_mse=507.622284 best_discrete=34.880112 hash=False elapsed=19.3s
step   250/900 tau=0.3715 loss=0.285662 mse_soft=0.285190 ent_in=1.2122 ent_out=0.3618 rowmax_in=0.4829 rowmax_out=0.8595 discrete_mse=425.213776 best_discrete=34.880112 hash=False elapsed=21.4s
step   275/900 tau=0.3363 loss=0.283634 mse_soft=0.283172 ent_in=1.1995 ent_out=0.3380 rowmax_in=0.4863 rowmax_out=0.8630 discrete_mse=257.159851 best_discrete=34.880112 hash=False elapsed=23.6s
step   300/900 tau=0.3045 loss=0.280716 mse_soft=0.280270 ent_in=1.1701 ent_out=0.3173 rowmax_in=0.4904 rowmax_out=0.8623 discrete_mse=364.496399 best_discrete=34.880112 hash=False elapsed=25.9s
step   325/900 tau=0.2756 loss=0.279492 mse_soft=0.279049 ent_in=1.1666 ent_out=0.3087 rowmax_in=0.4888 rowmax_out=0.8621 discrete_mse=448.824677 best_discrete=34.880112 hash=False elapsed=28.0s
step   350/900 tau=0.2496 loss=0.277584 mse_soft=0.277146 ent_in=1.1613 ent_out=0.2979 rowmax_in=0.4898 rowmax_out=0.8626 discrete_mse=167.572250 best_discrete=34.880112 hash=False elapsed=30.2s
step   375/900 tau=0.2259 loss=0.277018 mse_soft=0.276584 ent_in=1.1543 ent_out=0.2923 rowmax_in=0.4915 rowmax_out=0.8647 discrete_mse=222.038895 best_discrete=34.880112 hash=False elapsed=32.7s
step   400/900 tau=0.2046 loss=0.277943 mse_soft=0.277509 ent_in=1.1570 ent_out=0.2890 rowmax_in=0.4887 rowmax_out=0.8656 discrete_mse=222.038895 best_discrete=34.880112 hash=False elapsed=35.1s
step   425/900 tau=0.1852 loss=0.276543 mse_soft=0.276109 ent_in=1.1576 ent_out=0.2893 rowmax_in=0.4891 rowmax_out=0.8673 discrete_mse=311.442535 best_discrete=34.880112 hash=False elapsed=37.5s
step   450/900 tau=0.1677 loss=0.277343 mse_soft=0.276909 ent_in=1.1576 ent_out=0.2891 rowmax_in=0.4902 rowmax_out=0.8665 discrete_mse=537.328308 best_discrete=34.880112 hash=False elapsed=39.9s
step   475/900 tau=0.1518 loss=0.278629 mse_soft=0.278196 ent_in=1.1581 ent_out=0.2872 rowmax_in=0.4896 rowmax_out=0.8666 discrete_mse=343.326996 best_discrete=34.880112 hash=False elapsed=42.1s
step   500/900 tau=0.1374 loss=0.276098 mse_soft=0.275667 ent_in=1.1570 ent_out=0.2786 rowmax_in=0.4905 rowmax_out=0.8698 discrete_mse=432.241486 best_discrete=34.880112 hash=False elapsed=44.3s
step   525/900 tau=0.1244 loss=0.280755 mse_soft=0.280327 ent_in=1.1511 ent_out=0.2743 rowmax_in=0.4911 rowmax_out=0.8695 discrete_mse=269.560638 best_discrete=34.880112 hash=False elapsed=46.5s
step   550/900 tau=0.1126 loss=0.277955 mse_soft=0.277529 ent_in=1.1511 ent_out=0.2702 rowmax_in=0.4910 rowmax_out=0.8712 discrete_mse=269.560638 best_discrete=34.880112 hash=False elapsed=48.9s
step   575/900 tau=0.1020 loss=0.281836 mse_soft=0.281412 ent_in=1.1478 ent_out=0.2653 rowmax_in=0.4894 rowmax_out=0.8738 discrete_mse=286.068695 best_discrete=34.880112 hash=False elapsed=51.3s
step   600/900 tau=0.0923 loss=0.297916 mse_soft=0.297490 ent_in=1.1479 ent_out=0.2716 rowmax_in=0.4860 rowmax_out=0.8674 discrete_mse=119.229424 best_discrete=34.880112 hash=False elapsed=53.6s
step   625/900 tau=0.0836 loss=0.281570 mse_soft=0.281152 ent_in=1.1330 ent_out=0.2610 rowmax_in=0.5006 rowmax_out=0.8702 discrete_mse=221.143921 best_discrete=34.880112 hash=False elapsed=56.0s
step   650/900 tau=0.0757 loss=0.281718 mse_soft=0.281296 ent_in=1.1373 ent_out=0.2706 rowmax_in=0.4931 rowmax_out=0.8703 discrete_mse=586.098816 best_discrete=34.880112 hash=False elapsed=58.3s
step   675/900 tau=0.0685 loss=0.288487 mse_soft=0.288079 ent_in=1.1070 ent_out=0.2532 rowmax_in=0.5087 rowmax_out=0.8786 discrete_mse=188.481155 best_discrete=34.880112 hash=False elapsed=60.5s
step   700/900 tau=0.0620 loss=0.290763 mse_soft=0.290358 ent_in=1.0971 ent_out=0.2542 rowmax_in=0.4938 rowmax_out=0.8787 discrete_mse=426.968903 best_discrete=34.880112 hash=False elapsed=62.7s
step   725/900 tau=0.0562 loss=0.293512 mse_soft=0.293111 ent_in=1.0885 ent_out=0.2464 rowmax_in=0.4994 rowmax_out=0.8768 discrete_mse=631.870117 best_discrete=34.880112 hash=False elapsed=65.0s
step   750/900 tau=0.0508 loss=0.310022 mse_soft=0.309637 ent_in=1.0411 ent_out=0.2434 rowmax_in=0.5163 rowmax_out=0.8705 discrete_mse=871.015991 best_discrete=34.880112 hash=False elapsed=67.1s
step   775/900 tau=0.0460 loss=0.413346 mse_soft=0.413123 ent_in=0.5628 ent_out=0.1812 rowmax_in=0.7489 rowmax_out=0.8996 discrete_mse=29.728065 best_discrete=29.728065 hash=False elapsed=69.1s
step   800/900 tau=0.0417 loss=0.397604 mse_soft=0.397403 ent_in=0.4959 ent_out=0.1723 rowmax_in=0.7567 rowmax_out=0.9056 discrete_mse=1.287816 best_discrete=1.287816 hash=False elapsed=71.2s
step   825/900 tau=0.0377 loss=0.380975 mse_soft=0.380770 ent_in=0.5203 ent_out=0.1612 rowmax_in=0.7315 rowmax_out=0.9123 discrete_mse=2.410679 best_discrete=1.287816 hash=False elapsed=73.2s
step   850/900 tau=0.0342 loss=0.376251 mse_soft=0.376051 ent_in=0.5102 ent_out=0.1557 rowmax_in=0.7396 rowmax_out=0.9144 discrete_mse=10.285816 best_discrete=1.287816 hash=False elapsed=75.3s
step   875/900 tau=0.0309 loss=0.375141 mse_soft=0.374944 ent_in=0.5087 ent_out=0.1475 rowmax_in=0.7386 rowmax_out=0.9193 discrete_mse=1.960331 best_discrete=1.287816 hash=False elapsed=77.4s
step   900/900 tau=0.0280 loss=0.440346 mse_soft=0.440206 ent_in=0.3437 ent_out=0.1230 rowmax_in=0.8081 rowmax_out=0.9227 discrete_mse=0.877454 best_discrete=0.877454 hash=False elapsed=79.4s

Final metrics:
  soft_mse_full=0.453101
  rowmax_in_mean=0.8125
  rowmax_out_mean=0.9260
  ent_in_mean=0.3391
  ent_out_mean=0.1164
  final_discrete_mse=60.988773
  hash_match=False
  best_discrete_mse_seen=0.877454
Saved results to overnight_b057_j2.json
