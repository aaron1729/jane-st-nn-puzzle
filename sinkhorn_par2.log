Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.02
step     1/700 tau=1.0000 loss=1.065807 mse_soft=1.063484 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=12.411489 best_discrete=12.411489 hash=False elapsed=0.5s
step    25/700 tau=0.8954 loss=0.937104 mse_soft=0.934852 ent_in=3.7443 ent_out=3.7648 rowmax_in=0.0374 rowmax_out=0.0361 discrete_mse=2881.484619 best_discrete=12.411489 hash=False elapsed=2.6s
step    50/700 tau=0.7980 loss=0.715789 mse_soft=0.713746 ent_in=3.3711 ent_out=3.4372 rowmax_in=0.0693 rowmax_out=0.0658 discrete_mse=8856.797852 best_discrete=12.411489 hash=False elapsed=4.8s
step    75/700 tau=0.7112 loss=0.595246 mse_soft=0.593432 ent_in=2.9647 ent_out=3.0838 rowmax_in=0.1281 rowmax_out=0.1146 discrete_mse=710.289612 best_discrete=12.411489 hash=False elapsed=7.0s
step   100/700 tau=0.6339 loss=0.479436 mse_soft=0.477961 ent_in=2.4406 ent_out=2.4783 rowmax_in=0.2430 rowmax_out=0.2516 discrete_mse=845.101807 best_discrete=12.411489 hash=False elapsed=9.2s
step   125/700 tau=0.5650 loss=0.382218 mse_soft=0.381160 ent_in=1.8398 ent_out=1.6870 rowmax_in=0.4016 rowmax_out=0.4722 discrete_mse=3195.913086 best_discrete=12.411489 hash=False elapsed=11.4s
step   150/700 tau=0.5035 loss=0.334930 mse_soft=0.334128 ent_in=1.5365 ent_out=1.1348 rowmax_in=0.4501 rowmax_out=0.6164 discrete_mse=575.628357 best_discrete=12.411489 hash=False elapsed=13.7s
step   175/700 tau=0.4488 loss=0.314753 mse_soft=0.314088 ent_in=1.4282 ent_out=0.7889 rowmax_in=0.4665 rowmax_out=0.7113 discrete_mse=895.283203 best_discrete=12.411489 hash=False elapsed=16.0s
step   200/700 tau=0.4000 loss=0.303287 mse_soft=0.302705 ent_in=1.3494 ent_out=0.5911 rowmax_in=0.4736 rowmax_out=0.7761 discrete_mse=1540.611816 best_discrete=12.411489 hash=False elapsed=18.5s
step   225/700 tau=0.3565 loss=0.296701 mse_soft=0.296162 ent_in=1.2863 ent_out=0.5106 rowmax_in=0.4809 rowmax_out=0.7931 discrete_mse=1958.164795 best_discrete=12.411489 hash=False elapsed=20.7s
step   250/700 tau=0.3177 loss=0.292821 mse_soft=0.292311 ent_in=1.2466 ent_out=0.4545 rowmax_in=0.4872 rowmax_out=0.8002 discrete_mse=1958.164795 best_discrete=12.411489 hash=False elapsed=22.9s
step   275/700 tau=0.2832 loss=0.291480 mse_soft=0.290986 ent_in=1.2231 ent_out=0.4245 rowmax_in=0.4893 rowmax_out=0.8105 discrete_mse=2277.031006 best_discrete=12.411489 hash=False elapsed=25.1s
step   300/700 tau=0.2524 loss=0.289386 mse_soft=0.288903 ent_in=1.2095 ent_out=0.3992 rowmax_in=0.4858 rowmax_out=0.8195 discrete_mse=2771.138428 best_discrete=12.411489 hash=False elapsed=27.3s
step   325/700 tau=0.2249 loss=0.287262 mse_soft=0.286793 ent_in=1.1891 ent_out=0.3751 rowmax_in=0.4867 rowmax_out=0.8244 discrete_mse=2259.589355 best_discrete=12.411489 hash=False elapsed=29.5s
step   350/700 tau=0.2005 loss=0.286203 mse_soft=0.285748 ent_in=1.1685 ent_out=0.3501 rowmax_in=0.4896 rowmax_out=0.8315 discrete_mse=3523.474365 best_discrete=12.411489 hash=False elapsed=31.7s
step   375/700 tau=0.1787 loss=0.285485 mse_soft=0.285038 ent_in=1.1521 ent_out=0.3372 rowmax_in=0.4903 rowmax_out=0.8331 discrete_mse=3523.474365 best_discrete=12.411489 hash=False elapsed=33.8s
step   400/700 tau=0.1592 loss=0.283571 mse_soft=0.283130 ent_in=1.1422 ent_out=0.3294 rowmax_in=0.4899 rowmax_out=0.8338 discrete_mse=3523.474365 best_discrete=12.411489 hash=False elapsed=36.0s
step   425/700 tau=0.1419 loss=0.283876 mse_soft=0.283440 ent_in=1.1308 ent_out=0.3227 rowmax_in=0.4922 rowmax_out=0.8354 discrete_mse=1695.977173 best_discrete=12.411489 hash=False elapsed=38.3s
step   450/700 tau=0.1265 loss=0.286234 mse_soft=0.285802 ent_in=1.1218 ent_out=0.3185 rowmax_in=0.4946 rowmax_out=0.8355 discrete_mse=1668.795410 best_discrete=12.411489 hash=False elapsed=40.7s
step   475/700 tau=0.1127 loss=0.290038 mse_soft=0.289608 ent_in=1.1183 ent_out=0.3149 rowmax_in=0.4944 rowmax_out=0.8359 discrete_mse=2189.963135 best_discrete=12.411489 hash=False elapsed=42.9s
step   500/700 tau=0.1005 loss=0.290710 mse_soft=0.290284 ent_in=1.1083 ent_out=0.3120 rowmax_in=0.4981 rowmax_out=0.8349 discrete_mse=1696.493408 best_discrete=12.411489 hash=False elapsed=45.4s
step   525/700 tau=0.0895 loss=0.299308 mse_soft=0.298890 ent_in=1.0870 ent_out=0.3093 rowmax_in=0.5035 rowmax_out=0.8342 discrete_mse=1075.539551 best_discrete=12.411489 hash=False elapsed=47.8s
step   550/700 tau=0.0798 loss=0.286948 mse_soft=0.286533 ent_in=1.0807 ent_out=0.3000 rowmax_in=0.5126 rowmax_out=0.8343 discrete_mse=838.607910 best_discrete=12.411489 hash=False elapsed=50.1s
step   575/700 tau=0.0711 loss=0.300309 mse_soft=0.299898 ent_in=1.0689 ent_out=0.2992 rowmax_in=0.5162 rowmax_out=0.8358 discrete_mse=1321.123901 best_discrete=12.411489 hash=False elapsed=52.5s
step   600/700 tau=0.0634 loss=0.290616 mse_soft=0.290210 ent_in=1.0536 ent_out=0.3004 rowmax_in=0.5274 rowmax_out=0.8365 discrete_mse=1180.233521 best_discrete=12.411489 hash=False elapsed=55.0s
step   625/700 tau=0.0565 loss=0.310987 mse_soft=0.310585 ent_in=1.0447 ent_out=0.2951 rowmax_in=0.5314 rowmax_out=0.8407 discrete_mse=1076.671753 best_discrete=12.411489 hash=False elapsed=57.4s
step   650/700 tau=0.0504 loss=0.309878 mse_soft=0.309476 ent_in=1.0444 ent_out=0.2958 rowmax_in=0.5264 rowmax_out=0.8435 discrete_mse=709.642090 best_discrete=12.411489 hash=False elapsed=60.0s
step   675/700 tau=0.0449 loss=0.357264 mse_soft=0.356940 ent_in=0.8611 ent_out=0.2186 rowmax_in=0.6065 rowmax_out=0.9024 discrete_mse=111.236122 best_discrete=12.411489 hash=False elapsed=62.6s
step   700/700 tau=0.0400 loss=0.384826 mse_soft=0.384545 ent_in=0.7891 ent_out=0.1497 rowmax_in=0.6273 rowmax_out=0.9362 discrete_mse=28.637293 best_discrete=12.411489 hash=False elapsed=65.2s

Final metrics:
  soft_mse_full=0.380441
  rowmax_in_mean=0.6172
  rowmax_out_mean=0.9389
  ent_in_mean=0.7948
  ent_out_mean=0.1438
  final_discrete_mse=174.140549
  hash_match=False
  best_discrete_mse_seen=12.411489
Saved results to sinkhorn_par2.json
