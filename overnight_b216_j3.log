Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.02
step     1/700 tau=1.0000 loss=1.065749 mse_soft=1.063426 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=23.867605 best_discrete=23.867605 hash=False elapsed=0.5s
step    25/700 tau=0.8866 loss=0.934779 mse_soft=0.932528 ent_in=3.7425 ent_out=3.7623 rowmax_in=0.0372 rowmax_out=0.0363 discrete_mse=847.039551 best_discrete=23.867605 hash=False elapsed=2.7s
step    50/700 tau=0.7821 loss=0.711374 mse_soft=0.709339 ent_in=3.3613 ent_out=3.4216 rowmax_in=0.0692 rowmax_out=0.0667 discrete_mse=15302.659180 best_discrete=23.867605 hash=False elapsed=5.3s
step    75/700 tau=0.6899 loss=0.590013 mse_soft=0.588212 ent_in=2.9494 ent_out=3.0555 rowmax_in=0.1278 rowmax_out=0.1218 discrete_mse=4344.799316 best_discrete=23.867605 hash=False elapsed=7.5s
step   100/700 tau=0.6086 loss=0.479874 mse_soft=0.478412 ent_in=2.4396 ent_out=2.4329 rowmax_in=0.2339 rowmax_out=0.2552 discrete_mse=2384.837646 best_discrete=23.867605 hash=False elapsed=9.7s
step   125/700 tau=0.5368 loss=0.389748 mse_soft=0.388661 ent_in=1.9386 ent_out=1.6860 rowmax_in=0.3603 rowmax_out=0.4642 discrete_mse=365.966980 best_discrete=23.867605 hash=False elapsed=12.1s
step   150/700 tau=0.4736 loss=0.337248 mse_soft=0.336438 ent_in=1.5994 ent_out=1.0999 rowmax_in=0.4487 rowmax_out=0.6223 discrete_mse=1675.336060 best_discrete=23.867605 hash=False elapsed=14.5s
step   175/700 tau=0.4177 loss=0.312428 mse_soft=0.311775 ent_in=1.4047 ent_out=0.7716 rowmax_in=0.4716 rowmax_out=0.7215 discrete_mse=1040.896118 best_discrete=23.867605 hash=False elapsed=16.6s
step   200/700 tau=0.3685 loss=0.297796 mse_soft=0.297227 ent_in=1.3176 ent_out=0.5807 rowmax_in=0.4705 rowmax_out=0.7907 discrete_mse=2217.065918 best_discrete=23.867605 hash=False elapsed=18.9s
step   225/700 tau=0.3251 loss=0.288779 mse_soft=0.288269 ent_in=1.2602 ent_out=0.4391 rowmax_in=0.4747 rowmax_out=0.8279 discrete_mse=726.070068 best_discrete=23.867605 hash=False elapsed=21.2s
step   250/700 tau=0.2868 loss=0.285217 mse_soft=0.284740 ent_in=1.2084 ent_out=0.3841 rowmax_in=0.4832 rowmax_out=0.8437 discrete_mse=738.204102 best_discrete=23.867605 hash=False elapsed=23.4s
step   275/700 tau=0.2530 loss=0.282525 mse_soft=0.282057 ent_in=1.1951 ent_out=0.3665 rowmax_in=0.4846 rowmax_out=0.8465 discrete_mse=738.204102 best_discrete=23.867605 hash=False elapsed=25.7s
step   300/700 tau=0.2231 loss=0.282310 mse_soft=0.281846 ent_in=1.1810 ent_out=0.3637 rowmax_in=0.4861 rowmax_out=0.8459 discrete_mse=823.105469 best_discrete=23.867605 hash=False elapsed=27.7s
step   325/700 tau=0.1968 loss=0.280844 mse_soft=0.280388 ent_in=1.1629 ent_out=0.3590 rowmax_in=0.4916 rowmax_out=0.8446 discrete_mse=1236.820923 best_discrete=23.867605 hash=False elapsed=30.0s
step   350/700 tau=0.1736 loss=0.281858 mse_soft=0.281407 ent_in=1.1488 ent_out=0.3545 rowmax_in=0.4969 rowmax_out=0.8449 discrete_mse=2379.301270 best_discrete=23.867605 hash=False elapsed=32.3s
step   375/700 tau=0.1532 loss=0.281750 mse_soft=0.281301 ent_in=1.1463 ent_out=0.3492 rowmax_in=0.4948 rowmax_out=0.8466 discrete_mse=2379.301270 best_discrete=23.867605 hash=False elapsed=34.4s
step   400/700 tau=0.1351 loss=0.281388 mse_soft=0.280944 ent_in=1.1394 ent_out=0.3416 rowmax_in=0.4985 rowmax_out=0.8472 discrete_mse=1468.380371 best_discrete=23.867605 hash=False elapsed=36.7s
step   425/700 tau=0.1192 loss=0.282523 mse_soft=0.282082 ent_in=1.1385 ent_out=0.3318 rowmax_in=0.4972 rowmax_out=0.8492 discrete_mse=1468.380371 best_discrete=23.867605 hash=False elapsed=39.3s
step   450/700 tau=0.1051 loss=0.280058 mse_soft=0.279620 ent_in=1.1374 ent_out=0.3246 rowmax_in=0.4982 rowmax_out=0.8506 discrete_mse=1468.380371 best_discrete=23.867605 hash=False elapsed=41.7s
step   475/700 tau=0.0928 loss=0.289223 mse_soft=0.288787 ent_in=1.1330 ent_out=0.3223 rowmax_in=0.5023 rowmax_out=0.8505 discrete_mse=1468.380371 best_discrete=23.867605 hash=False elapsed=44.2s
step   500/700 tau=0.0818 loss=0.281414 mse_soft=0.280977 ent_in=1.1392 ent_out=0.3167 rowmax_in=0.4984 rowmax_out=0.8525 discrete_mse=938.181152 best_discrete=23.867605 hash=False elapsed=46.7s
step   525/700 tau=0.0722 loss=0.285492 mse_soft=0.285057 ent_in=1.1320 ent_out=0.3184 rowmax_in=0.5042 rowmax_out=0.8514 discrete_mse=1293.390747 best_discrete=23.867605 hash=False elapsed=49.1s
step   550/700 tau=0.0637 loss=0.285300 mse_soft=0.284866 ent_in=1.1324 ent_out=0.3152 rowmax_in=0.4998 rowmax_out=0.8535 discrete_mse=992.852661 best_discrete=23.867605 hash=False elapsed=51.5s
step   575/700 tau=0.0562 loss=0.287456 mse_soft=0.287025 ent_in=1.1265 ent_out=0.3109 rowmax_in=0.4993 rowmax_out=0.8539 discrete_mse=1108.715820 best_discrete=23.867605 hash=False elapsed=53.9s
step   600/700 tau=0.0495 loss=0.296095 mse_soft=0.295710 ent_in=1.0149 ent_out=0.2669 rowmax_in=0.5550 rowmax_out=0.8732 discrete_mse=182.807297 best_discrete=23.867605 hash=False elapsed=56.2s
step   625/700 tau=0.0437 loss=0.300106 mse_soft=0.299715 ent_in=1.0184 ent_out=0.2841 rowmax_in=0.5439 rowmax_out=0.8648 discrete_mse=243.401474 best_discrete=23.867605 hash=False elapsed=58.5s
step   650/700 tau=0.0386 loss=0.291250 mse_soft=0.290863 ent_in=1.0170 ent_out=0.2743 rowmax_in=0.5478 rowmax_out=0.8691 discrete_mse=224.281250 best_discrete=23.867605 hash=False elapsed=60.7s
step   675/700 tau=0.0340 loss=0.311792 mse_soft=0.311402 ent_in=1.0189 ent_out=0.2781 rowmax_in=0.5486 rowmax_out=0.8667 discrete_mse=175.482300 best_discrete=23.867605 hash=False elapsed=63.1s
step   700/700 tau=0.0300 loss=0.337725 mse_soft=0.337409 ent_in=0.8085 ent_out=0.2440 rowmax_in=0.6346 rowmax_out=0.8829 discrete_mse=7.612203 best_discrete=7.612203 hash=False elapsed=65.3s

Final metrics:
  soft_mse_full=0.345533
  rowmax_in_mean=0.6319
  rowmax_out_mean=0.8841
  ent_in_mean=0.8080
  ent_out_mean=0.2405
  final_discrete_mse=10.684070
  hash_match=False
  best_discrete_mse_seen=7.612203
Saved results to overnight_b216_j3.json
