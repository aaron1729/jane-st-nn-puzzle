Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.045341 mse_soft=1.043019 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=101.447289 best_discrete=101.447289 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.844379 mse_soft=0.842189 ent_in=3.6351 ent_out=3.6663 rowmax_in=0.0452 rowmax_out=0.0447 discrete_mse=42.444538 best_discrete=42.444538 hash=False elapsed=3.0s
step    50/900 tau=0.8260 loss=0.634445 mse_soft=0.632535 ent_in=3.1431 ent_out=3.2235 rowmax_in=0.0920 rowmax_out=0.0885 discrete_mse=3345.629150 best_discrete=42.444538 hash=False elapsed=5.5s
step    75/900 tau=0.7493 loss=0.502915 mse_soft=0.501325 ent_in=2.6459 ent_out=2.6552 rowmax_in=0.1967 rowmax_out=0.2070 discrete_mse=1504.967773 best_discrete=42.444538 hash=False elapsed=7.8s
step   100/900 tau=0.6797 loss=0.400721 mse_soft=0.399545 ent_in=2.0545 ent_out=1.8672 rowmax_in=0.3228 rowmax_out=0.4013 discrete_mse=262.039825 best_discrete=42.444538 hash=False elapsed=10.2s
step   125/900 tau=0.6165 loss=0.341385 mse_soft=0.340500 ent_in=1.6635 ent_out=1.2855 rowmax_in=0.4205 rowmax_out=0.5591 discrete_mse=300.428192 best_discrete=42.444538 hash=False elapsed=12.5s
step   150/900 tau=0.5592 loss=0.311200 mse_soft=0.310503 ent_in=1.4462 ent_out=0.8762 rowmax_in=0.4707 rowmax_out=0.6969 discrete_mse=245.123169 best_discrete=42.444538 hash=False elapsed=14.9s
step   175/900 tau=0.5073 loss=0.293379 mse_soft=0.292786 ent_in=1.3439 ent_out=0.6325 rowmax_in=0.4832 rowmax_out=0.7760 discrete_mse=230.494202 best_discrete=42.444538 hash=False elapsed=17.4s
step   200/900 tau=0.4602 loss=0.285527 mse_soft=0.285002 ent_in=1.2899 ent_out=0.4580 rowmax_in=0.4906 rowmax_out=0.8382 discrete_mse=332.277679 best_discrete=42.444538 hash=False elapsed=19.7s
step   225/900 tau=0.4174 loss=0.279315 mse_soft=0.278825 ent_in=1.2523 ent_out=0.3804 rowmax_in=0.4959 rowmax_out=0.8590 discrete_mse=332.277679 best_discrete=42.444538 hash=False elapsed=22.1s
step   250/900 tau=0.3786 loss=0.278571 mse_soft=0.278096 ent_in=1.2312 ent_out=0.3503 rowmax_in=0.4988 rowmax_out=0.8650 discrete_mse=309.331848 best_discrete=42.444538 hash=False elapsed=24.6s
step   275/900 tau=0.3434 loss=0.275377 mse_soft=0.274913 ent_in=1.2203 ent_out=0.3288 rowmax_in=0.4999 rowmax_out=0.8709 discrete_mse=252.174042 best_discrete=42.444538 hash=False elapsed=27.0s
step   300/900 tau=0.3115 loss=0.273740 mse_soft=0.273283 ent_in=1.2147 ent_out=0.3103 rowmax_in=0.5001 rowmax_out=0.8764 discrete_mse=82.480324 best_discrete=42.444538 hash=False elapsed=29.5s
step   325/900 tau=0.2826 loss=0.274718 mse_soft=0.274265 ent_in=1.2154 ent_out=0.2940 rowmax_in=0.4980 rowmax_out=0.8811 discrete_mse=271.565430 best_discrete=42.444538 hash=False elapsed=32.0s
step   350/900 tau=0.2563 loss=0.274359 mse_soft=0.273911 ent_in=1.2131 ent_out=0.2796 rowmax_in=0.4966 rowmax_out=0.8846 discrete_mse=312.858337 best_discrete=42.444538 hash=False elapsed=34.4s
step   375/900 tau=0.2325 loss=0.275716 mse_soft=0.275274 ent_in=1.2027 ent_out=0.2685 rowmax_in=0.4968 rowmax_out=0.8885 discrete_mse=312.858337 best_discrete=42.444538 hash=False elapsed=36.8s
step   400/900 tau=0.2109 loss=0.270391 mse_soft=0.269955 ent_in=1.1949 ent_out=0.2599 rowmax_in=0.4960 rowmax_out=0.8918 discrete_mse=288.481445 best_discrete=42.444538 hash=False elapsed=39.3s
step   425/900 tau=0.1913 loss=0.272172 mse_soft=0.271740 ent_in=1.1881 ent_out=0.2536 rowmax_in=0.4969 rowmax_out=0.8936 discrete_mse=288.481445 best_discrete=42.444538 hash=False elapsed=41.9s
step   450/900 tau=0.1735 loss=0.277654 mse_soft=0.277227 ent_in=1.1803 ent_out=0.2412 rowmax_in=0.4997 rowmax_out=0.8999 discrete_mse=288.481445 best_discrete=42.444538 hash=False elapsed=44.6s
step   475/900 tau=0.1574 loss=0.270441 mse_soft=0.270020 ent_in=1.1774 ent_out=0.2250 rowmax_in=0.4986 rowmax_out=0.9051 discrete_mse=288.481445 best_discrete=42.444538 hash=False elapsed=46.9s
step   500/900 tau=0.1428 loss=0.283403 mse_soft=0.282982 ent_in=1.1847 ent_out=0.2196 rowmax_in=0.4928 rowmax_out=0.9051 discrete_mse=11.370052 best_discrete=11.370052 hash=False elapsed=49.2s
step   525/900 tau=0.1295 loss=0.279256 mse_soft=0.278839 ent_in=1.1749 ent_out=0.2151 rowmax_in=0.4968 rowmax_out=0.9052 discrete_mse=288.481445 best_discrete=11.370052 hash=False elapsed=51.6s
step   550/900 tau=0.1175 loss=0.271474 mse_soft=0.271061 ent_in=1.1691 ent_out=0.2085 rowmax_in=0.4992 rowmax_out=0.9068 discrete_mse=383.832947 best_discrete=11.370052 hash=False elapsed=54.1s
step   575/900 tau=0.1066 loss=0.285878 mse_soft=0.285471 ent_in=1.1550 ent_out=0.2019 rowmax_in=0.5084 rowmax_out=0.9081 discrete_mse=12.428300 best_discrete=11.370052 hash=False elapsed=56.3s
step   600/900 tau=0.0967 loss=0.272058 mse_soft=0.271652 ent_in=1.1492 ent_out=0.2022 rowmax_in=0.5075 rowmax_out=0.9056 discrete_mse=41.871975 best_discrete=11.370052 hash=False elapsed=58.7s
step   625/900 tau=0.0877 loss=0.295106 mse_soft=0.294725 ent_in=1.0794 ent_out=0.1898 rowmax_in=0.5268 rowmax_out=0.9150 discrete_mse=124.719200 best_discrete=11.370052 hash=False elapsed=61.2s
step   650/900 tau=0.0795 loss=0.279103 mse_soft=0.278731 ent_in=1.0578 ent_out=0.1836 rowmax_in=0.5336 rowmax_out=0.9137 discrete_mse=433.139740 best_discrete=11.370052 hash=False elapsed=63.4s
step   675/900 tau=0.0722 loss=0.285582 mse_soft=0.285216 ent_in=1.0431 ent_out=0.1766 rowmax_in=0.5362 rowmax_out=0.9183 discrete_mse=151.275940 best_discrete=11.370052 hash=False elapsed=65.7s
step   700/900 tau=0.0655 loss=0.291142 mse_soft=0.290784 ent_in=1.0106 ent_out=0.1818 rowmax_in=0.5481 rowmax_out=0.9152 discrete_mse=140.217514 best_discrete=11.370052 hash=False elapsed=68.1s
step   725/900 tau=0.0594 loss=0.381474 mse_soft=0.381241 ent_in=0.6452 ent_out=0.1299 rowmax_in=0.7126 rowmax_out=0.9409 discrete_mse=53.870472 best_discrete=11.370052 hash=False elapsed=70.6s
step   750/900 tau=0.0539 loss=0.444118 mse_soft=0.443943 ent_in=0.4424 ent_out=0.1395 rowmax_in=0.8065 rowmax_out=0.9338 discrete_mse=1.069069 best_discrete=1.069069 hash=False elapsed=72.8s
step   775/900 tau=0.0489 loss=0.386336 mse_soft=0.386167 ent_in=0.4254 ent_out=0.1390 rowmax_in=0.7884 rowmax_out=0.9326 discrete_mse=1.178587 best_discrete=1.069069 hash=False elapsed=75.0s
step   800/900 tau=0.0443 loss=0.376774 mse_soft=0.376611 ent_in=0.4133 ent_out=0.1296 rowmax_in=0.7920 rowmax_out=0.9363 discrete_mse=2.322133 best_discrete=1.069069 hash=False elapsed=77.4s
step   825/900 tau=0.0402 loss=0.377518 mse_soft=0.377354 ent_in=0.4155 ent_out=0.1297 rowmax_in=0.7873 rowmax_out=0.9364 discrete_mse=2.345302 best_discrete=1.069069 hash=False elapsed=79.9s
step   850/900 tau=0.0365 loss=0.371285 mse_soft=0.371123 ent_in=0.4104 ent_out=0.1315 rowmax_in=0.7934 rowmax_out=0.9343 discrete_mse=2.277507 best_discrete=1.069069 hash=False elapsed=82.2s
step   875/900 tau=0.0331 loss=0.377043 mse_soft=0.376877 ent_in=0.4177 ent_out=0.1333 rowmax_in=0.7936 rowmax_out=0.9277 discrete_mse=1.456568 best_discrete=1.069069 hash=False elapsed=84.6s
step   900/900 tau=0.0300 loss=0.366961 mse_soft=0.366800 ent_in=0.4063 ent_out=0.1298 rowmax_in=0.7955 rowmax_out=0.9283 discrete_mse=4.530298 best_discrete=1.069069 hash=False elapsed=86.9s

Final metrics:
  soft_mse_full=0.382011
  rowmax_in_mean=0.7959
  rowmax_out_mean=0.9279
  ent_in_mean=0.4054
  ent_out_mean=0.1292
  final_discrete_mse=2.277507
  hash_match=False
  best_discrete_mse_seen=1.069069
Saved results to overnight_b234_j1.json
