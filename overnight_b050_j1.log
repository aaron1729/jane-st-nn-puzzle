Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.047719 mse_soft=1.045396 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=50.290668 best_discrete=50.290668 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.846634 mse_soft=0.844444 ent_in=3.6349 ent_out=3.6652 rowmax_in=0.0459 rowmax_out=0.0447 discrete_mse=870.169800 best_discrete=50.290668 hash=False elapsed=2.5s
step    50/900 tau=0.8260 loss=0.636526 mse_soft=0.634619 ent_in=3.1388 ent_out=3.2184 rowmax_in=0.0921 rowmax_out=0.0900 discrete_mse=8955.293945 best_discrete=50.290668 hash=False elapsed=4.7s
step    75/900 tau=0.7493 loss=0.505282 mse_soft=0.503700 ent_in=2.6023 ent_out=2.6687 rowmax_in=0.1962 rowmax_out=0.1985 discrete_mse=3970.968750 best_discrete=50.290668 hash=False elapsed=6.9s
step   100/900 tau=0.6797 loss=0.409146 mse_soft=0.407983 ent_in=2.0021 ent_out=1.8756 rowmax_in=0.3346 rowmax_out=0.3926 discrete_mse=309.573364 best_discrete=50.290668 hash=False elapsed=9.0s
step   125/900 tau=0.6165 loss=0.342983 mse_soft=0.342172 ent_in=1.5673 ent_out=1.1342 rowmax_in=0.4372 rowmax_out=0.6123 discrete_mse=348.470734 best_discrete=50.290668 hash=False elapsed=11.1s
step   150/900 tau=0.5592 loss=0.313742 mse_soft=0.313134 ent_in=1.3376 ent_out=0.6874 rowmax_in=0.4895 rowmax_out=0.7805 discrete_mse=746.203369 best_discrete=50.290668 hash=False elapsed=13.2s
step   175/900 tau=0.5073 loss=0.302362 mse_soft=0.301833 ent_in=1.2647 ent_out=0.4979 rowmax_in=0.5057 rowmax_out=0.8279 discrete_mse=705.910889 best_discrete=50.290668 hash=False elapsed=15.2s
step   200/900 tau=0.4602 loss=0.294169 mse_soft=0.293672 ent_in=1.2188 ent_out=0.4364 rowmax_in=0.5063 rowmax_out=0.8273 discrete_mse=709.995605 best_discrete=50.290668 hash=False elapsed=17.3s
step   225/900 tau=0.4174 loss=0.290533 mse_soft=0.290060 ent_in=1.1789 ent_out=0.3961 rowmax_in=0.5065 rowmax_out=0.8305 discrete_mse=845.228455 best_discrete=50.290668 hash=False elapsed=19.4s
step   250/900 tau=0.3786 loss=0.286977 mse_soft=0.286517 ent_in=1.1543 ent_out=0.3774 rowmax_in=0.5084 rowmax_out=0.8340 discrete_mse=90.758972 best_discrete=50.290668 hash=False elapsed=21.5s
step   275/900 tau=0.3434 loss=0.283456 mse_soft=0.283012 ent_in=1.1247 ent_out=0.3563 rowmax_in=0.5139 rowmax_out=0.8356 discrete_mse=111.513023 best_discrete=50.290668 hash=False elapsed=23.7s
step   300/900 tau=0.3115 loss=0.282632 mse_soft=0.282197 ent_in=1.1051 ent_out=0.3439 rowmax_in=0.5169 rowmax_out=0.8411 discrete_mse=112.481636 best_discrete=50.290668 hash=False elapsed=25.8s
step   325/900 tau=0.2826 loss=0.280979 mse_soft=0.280551 ent_in=1.0946 ent_out=0.3336 rowmax_in=0.5181 rowmax_out=0.8410 discrete_mse=112.481636 best_discrete=50.290668 hash=False elapsed=27.8s
step   350/900 tau=0.2563 loss=0.282564 mse_soft=0.282141 ent_in=1.0868 ent_out=0.3259 rowmax_in=0.5190 rowmax_out=0.8410 discrete_mse=112.481636 best_discrete=50.290668 hash=False elapsed=29.7s
step   375/900 tau=0.2325 loss=0.280766 mse_soft=0.280345 ent_in=1.0828 ent_out=0.3213 rowmax_in=0.5175 rowmax_out=0.8429 discrete_mse=134.022964 best_discrete=50.290668 hash=False elapsed=31.8s
step   400/900 tau=0.2109 loss=0.280268 mse_soft=0.279848 ent_in=1.0801 ent_out=0.3192 rowmax_in=0.5171 rowmax_out=0.8440 discrete_mse=134.022964 best_discrete=50.290668 hash=False elapsed=34.2s
step   425/900 tau=0.1913 loss=0.282111 mse_soft=0.281691 ent_in=1.0809 ent_out=0.3202 rowmax_in=0.5172 rowmax_out=0.8437 discrete_mse=90.722946 best_discrete=50.290668 hash=False elapsed=36.5s
step   450/900 tau=0.1735 loss=0.281426 mse_soft=0.281008 ent_in=1.0782 ent_out=0.3175 rowmax_in=0.5198 rowmax_out=0.8451 discrete_mse=20.370798 best_discrete=20.370798 hash=False elapsed=38.6s
step   475/900 tau=0.1574 loss=0.285520 mse_soft=0.285101 ent_in=1.0819 ent_out=0.3139 rowmax_in=0.5169 rowmax_out=0.8486 discrete_mse=94.147743 best_discrete=20.370798 hash=False elapsed=40.7s
step   500/900 tau=0.1428 loss=0.280776 mse_soft=0.280359 ent_in=1.0785 ent_out=0.3138 rowmax_in=0.5173 rowmax_out=0.8462 discrete_mse=90.722946 best_discrete=20.370798 hash=False elapsed=42.8s
step   525/900 tau=0.1295 loss=0.282735 mse_soft=0.282318 ent_in=1.0754 ent_out=0.3134 rowmax_in=0.5181 rowmax_out=0.8436 discrete_mse=94.147743 best_discrete=20.370798 hash=False elapsed=45.0s
step   550/900 tau=0.1175 loss=0.284384 mse_soft=0.283969 ent_in=1.0752 ent_out=0.3083 rowmax_in=0.5169 rowmax_out=0.8508 discrete_mse=131.647705 best_discrete=20.370798 hash=False elapsed=47.2s
step   575/900 tau=0.1066 loss=0.291807 mse_soft=0.291393 ent_in=1.0761 ent_out=0.3047 rowmax_in=0.5168 rowmax_out=0.8474 discrete_mse=131.647705 best_discrete=20.370798 hash=False elapsed=49.3s
step   600/900 tau=0.0967 loss=0.291660 mse_soft=0.291249 ent_in=1.0696 ent_out=0.3008 rowmax_in=0.5227 rowmax_out=0.8514 discrete_mse=119.403244 best_discrete=20.370798 hash=False elapsed=51.5s
step   625/900 tau=0.0877 loss=0.314568 mse_soft=0.314175 ent_in=1.0286 ent_out=0.2811 rowmax_in=0.5381 rowmax_out=0.8733 discrete_mse=126.187050 best_discrete=20.370798 hash=False elapsed=53.7s
step   650/900 tau=0.0795 loss=0.319141 mse_soft=0.318774 ent_in=0.9430 ent_out=0.2806 rowmax_in=0.5675 rowmax_out=0.8642 discrete_mse=51.104538 best_discrete=20.370798 hash=False elapsed=55.8s
step   675/900 tau=0.0722 loss=0.287442 mse_soft=0.287071 ent_in=0.9675 ent_out=0.2718 rowmax_in=0.5595 rowmax_out=0.8640 discrete_mse=87.664246 best_discrete=20.370798 hash=False elapsed=57.9s
step   700/900 tau=0.0655 loss=0.287051 mse_soft=0.286683 ent_in=0.9723 ent_out=0.2564 rowmax_in=0.5517 rowmax_out=0.8704 discrete_mse=87.804970 best_discrete=20.370798 hash=False elapsed=60.1s
step   725/900 tau=0.0594 loss=0.286241 mse_soft=0.285879 ent_in=0.9625 ent_out=0.2447 rowmax_in=0.5527 rowmax_out=0.8761 discrete_mse=22.122347 best_discrete=20.370798 hash=False elapsed=62.3s
step   750/900 tau=0.0539 loss=0.305365 mse_soft=0.305016 ent_in=0.9282 ent_out=0.2342 rowmax_in=0.5714 rowmax_out=0.8806 discrete_mse=35.290092 best_discrete=20.370798 hash=False elapsed=64.6s
step   775/900 tau=0.0489 loss=0.300302 mse_soft=0.299968 ent_in=0.8924 ent_out=0.2229 rowmax_in=0.5850 rowmax_out=0.8975 discrete_mse=40.630352 best_discrete=20.370798 hash=False elapsed=66.7s
step   800/900 tau=0.0443 loss=0.621254 mse_soft=0.621122 ent_in=0.4098 ent_out=0.0285 rowmax_in=0.8140 rowmax_out=0.9933 discrete_mse=1.054559 best_discrete=1.054559 hash=False elapsed=68.8s
step   825/900 tau=0.0402 loss=0.525174 mse_soft=0.525066 ent_in=0.3349 ent_out=0.0238 rowmax_in=0.8513 rowmax_out=0.9941 discrete_mse=36.105373 best_discrete=1.054559 hash=False elapsed=71.0s
step   850/900 tau=0.0365 loss=0.468033 mse_soft=0.467917 ent_in=0.3565 ent_out=0.0327 rowmax_in=0.8080 rowmax_out=0.9902 discrete_mse=69.121803 best_discrete=1.054559 hash=False elapsed=73.0s
step   875/900 tau=0.0331 loss=0.459557 mse_soft=0.459436 ent_in=0.3703 ent_out=0.0345 rowmax_in=0.8024 rowmax_out=0.9892 discrete_mse=116.594788 best_discrete=1.054559 hash=False elapsed=75.3s
step   900/900 tau=0.0300 loss=0.502731 mse_soft=0.502619 ent_in=0.3466 ent_out=0.0250 rowmax_in=0.8180 rowmax_out=0.9937 discrete_mse=51.760361 best_discrete=1.054559 hash=False elapsed=77.4s

Final metrics:
  soft_mse_full=0.506025
  rowmax_in_mean=0.8158
  rowmax_out_mean=0.9937
  ent_in_mean=0.3480
  ent_out_mean=0.0250
  final_discrete_mse=51.760361
  hash_match=False
  best_discrete_mse_seen=1.054559
Saved results to overnight_b050_j1.json
