Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.015
step     1/700 tau=1.0000 loss=1.064252 mse_soft=1.063478 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=28.846655 best_discrete=28.846655 hash=False elapsed=0.5s
step    25/700 tau=0.8810 loss=0.972164 mse_soft=0.971404 ent_in=3.7929 ent_out=3.8055 rowmax_in=0.0332 rowmax_out=0.0323 discrete_mse=1294.886719 best_discrete=28.846655 hash=False elapsed=2.5s
step    50/700 tau=0.7721 loss=0.787532 mse_soft=0.786824 ent_in=3.5150 ent_out=3.5658 rowmax_in=0.0566 rowmax_out=0.0544 discrete_mse=4544.301270 best_discrete=28.846655 hash=False elapsed=4.7s
step    75/700 tau=0.6767 loss=0.641493 mse_soft=0.640858 ent_in=3.1241 ent_out=3.2263 rowmax_in=0.0978 rowmax_out=0.0929 discrete_mse=22612.685547 best_discrete=28.846655 hash=False elapsed=6.9s
step   100/700 tau=0.5931 loss=0.526056 mse_soft=0.525505 ent_in=2.6991 ent_out=2.8048 rowmax_in=0.1859 rowmax_out=0.1748 discrete_mse=3913.854736 best_discrete=28.846655 hash=False elapsed=9.2s
step   125/700 tau=0.5198 loss=0.433585 mse_soft=0.433151 ent_in=2.1567 ent_out=2.1825 rowmax_in=0.3076 rowmax_out=0.3087 discrete_mse=1856.134521 best_discrete=28.846655 hash=False elapsed=11.5s
step   150/700 tau=0.4555 loss=0.370532 mse_soft=0.370207 ent_in=1.7383 ent_out=1.5175 rowmax_in=0.3945 rowmax_out=0.5082 discrete_mse=467.549896 best_discrete=28.846655 hash=False elapsed=13.9s
step   175/700 tau=0.3992 loss=0.332317 mse_soft=0.332072 ent_in=1.4406 ent_out=1.0151 rowmax_in=0.4586 rowmax_out=0.6411 discrete_mse=301.576111 best_discrete=28.846655 hash=False elapsed=16.1s
step   200/700 tau=0.3499 loss=0.315150 mse_soft=0.314949 ent_in=1.2504 ent_out=0.7670 rowmax_in=0.5020 rowmax_out=0.6958 discrete_mse=292.011078 best_discrete=28.846655 hash=False elapsed=18.4s
step   225/700 tau=0.3066 loss=0.307392 mse_soft=0.307209 ent_in=1.1794 ent_out=0.6482 rowmax_in=0.5147 rowmax_out=0.7355 discrete_mse=496.601074 best_discrete=28.846655 hash=False elapsed=20.9s
step   250/700 tau=0.2687 loss=0.299312 mse_soft=0.299141 ent_in=1.1354 ent_out=0.5760 rowmax_in=0.5279 rowmax_out=0.7613 discrete_mse=521.493408 best_discrete=28.846655 hash=False elapsed=23.3s
step   275/700 tau=0.2355 loss=0.293504 mse_soft=0.293342 ent_in=1.1069 ent_out=0.5166 rowmax_in=0.5344 rowmax_out=0.7715 discrete_mse=791.031067 best_discrete=28.846655 hash=False elapsed=25.6s
step   300/700 tau=0.2064 loss=0.291435 mse_soft=0.291279 ent_in=1.0889 ent_out=0.4666 rowmax_in=0.5360 rowmax_out=0.7860 discrete_mse=491.341949 best_discrete=28.846655 hash=False elapsed=27.8s
step   325/700 tau=0.1809 loss=0.289102 mse_soft=0.288951 ent_in=1.0742 ent_out=0.4370 rowmax_in=0.5419 rowmax_out=0.7951 discrete_mse=1038.078979 best_discrete=28.846655 hash=False elapsed=30.3s
step   350/700 tau=0.1585 loss=0.288168 mse_soft=0.288020 ent_in=1.0614 ent_out=0.4184 rowmax_in=0.5471 rowmax_out=0.7981 discrete_mse=1179.741211 best_discrete=28.846655 hash=False elapsed=32.9s
step   375/700 tau=0.1389 loss=0.288549 mse_soft=0.288403 ent_in=1.0539 ent_out=0.4023 rowmax_in=0.5491 rowmax_out=0.8034 discrete_mse=965.398376 best_discrete=28.846655 hash=False elapsed=35.2s
step   400/700 tau=0.1218 loss=0.286409 mse_soft=0.286265 ent_in=1.0479 ent_out=0.3912 rowmax_in=0.5516 rowmax_out=0.8077 discrete_mse=188.306091 best_discrete=28.846655 hash=False elapsed=37.6s
step   425/700 tau=0.1067 loss=0.294643 mse_soft=0.294500 ent_in=1.0433 ent_out=0.3851 rowmax_in=0.5535 rowmax_out=0.8155 discrete_mse=188.306091 best_discrete=28.846655 hash=False elapsed=39.8s
step   450/700 tau=0.0935 loss=0.293561 mse_soft=0.293419 ent_in=1.0422 ent_out=0.3799 rowmax_in=0.5515 rowmax_out=0.8183 discrete_mse=188.306091 best_discrete=28.846655 hash=False elapsed=42.1s
step   475/700 tau=0.0820 loss=0.286996 mse_soft=0.286854 ent_in=1.0377 ent_out=0.3762 rowmax_in=0.5533 rowmax_out=0.8191 discrete_mse=239.020370 best_discrete=28.846655 hash=False elapsed=44.5s
step   500/700 tau=0.0718 loss=0.294790 mse_soft=0.294650 ent_in=1.0347 ent_out=0.3715 rowmax_in=0.5520 rowmax_out=0.8212 discrete_mse=245.809189 best_discrete=28.846655 hash=False elapsed=46.4s
step   525/700 tau=0.0630 loss=0.293780 mse_soft=0.293640 ent_in=1.0254 ent_out=0.3680 rowmax_in=0.5581 rowmax_out=0.8202 discrete_mse=239.020370 best_discrete=28.846655 hash=False elapsed=48.9s
step   550/700 tau=0.0552 loss=0.289917 mse_soft=0.289779 ent_in=1.0231 ent_out=0.3626 rowmax_in=0.5536 rowmax_out=0.8203 discrete_mse=221.237091 best_discrete=28.846655 hash=False elapsed=51.2s
step   575/700 tau=0.0484 loss=0.297223 mse_soft=0.297088 ent_in=0.9989 ent_out=0.3548 rowmax_in=0.5651 rowmax_out=0.8208 discrete_mse=190.210068 best_discrete=28.846655 hash=False elapsed=53.6s
step   600/700 tau=0.0424 loss=0.315458 mse_soft=0.315326 ent_in=0.9540 ent_out=0.3603 rowmax_in=0.5863 rowmax_out=0.8159 discrete_mse=141.692947 best_discrete=28.846655 hash=False elapsed=55.9s
step   625/700 tau=0.0371 loss=0.309916 mse_soft=0.309786 ent_in=0.9542 ent_out=0.3446 rowmax_in=0.5609 rowmax_out=0.8120 discrete_mse=133.524902 best_discrete=28.846655 hash=False elapsed=58.5s
step   650/700 tau=0.0325 loss=0.295529 mse_soft=0.295405 ent_in=0.9103 ent_out=0.3340 rowmax_in=0.5917 rowmax_out=0.8174 discrete_mse=129.019135 best_discrete=28.846655 hash=False elapsed=60.9s
step   675/700 tau=0.0285 loss=0.347527 mse_soft=0.347412 ent_in=0.8275 ent_out=0.3226 rowmax_in=0.6158 rowmax_out=0.8283 discrete_mse=393.688965 best_discrete=28.846655 hash=False elapsed=63.3s
step   700/700 tau=0.0250 loss=0.358806 mse_soft=0.358703 ent_in=0.7356 ent_out=0.2910 rowmax_in=0.6471 rowmax_out=0.8334 discrete_mse=278.383698 best_discrete=28.846655 hash=False elapsed=65.7s

Final metrics:
  soft_mse_full=0.323367
  rowmax_in_mean=0.6610
  rowmax_out_mean=0.8348
  ent_in_mean=0.7299
  ent_out_mean=0.2933
  final_discrete_mse=41.134968
  hash_match=False
  best_discrete_mse_seen=28.846655
Saved results to overnight_b003_j4.json
