Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.074577 mse_soft=1.072254 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=155.778091 best_discrete=155.778091 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.869835 mse_soft=0.867645 ent_in=3.6342 ent_out=3.6659 rowmax_in=0.0455 rowmax_out=0.0443 discrete_mse=9940.002930 best_discrete=155.778091 hash=False elapsed=2.7s
step    50/900 tau=0.8229 loss=0.651882 mse_soft=0.649976 ent_in=3.1361 ent_out=3.2180 rowmax_in=0.0940 rowmax_out=0.0878 discrete_mse=2391.612061 best_discrete=155.778091 hash=False elapsed=4.9s
step    75/900 tau=0.7450 loss=0.513240 mse_soft=0.511657 ent_in=2.6182 ent_out=2.6580 rowmax_in=0.2021 rowmax_out=0.2047 discrete_mse=1284.788208 best_discrete=155.778091 hash=False elapsed=6.9s
step   100/900 tau=0.6745 loss=0.408684 mse_soft=0.407510 ent_in=2.0591 ent_out=1.8565 rowmax_in=0.3314 rowmax_out=0.4102 discrete_mse=188.349640 best_discrete=155.778091 hash=False elapsed=9.3s
step   125/900 tau=0.6107 loss=0.344851 mse_soft=0.344010 ent_in=1.6798 ent_out=1.1219 rowmax_in=0.4093 rowmax_out=0.6310 discrete_mse=224.662796 best_discrete=155.778091 hash=False elapsed=11.5s
step   150/900 tau=0.5529 loss=0.312370 mse_soft=0.311720 ent_in=1.4390 ent_out=0.7300 rowmax_in=0.4674 rowmax_out=0.7570 discrete_mse=28.193556 best_discrete=28.193556 hash=False elapsed=13.9s
step   175/900 tau=0.5006 loss=0.295980 mse_soft=0.295450 ent_in=1.3100 ent_out=0.4553 rowmax_in=0.4896 rowmax_out=0.8489 discrete_mse=145.427231 best_discrete=28.193556 hash=False elapsed=16.2s
step   200/900 tau=0.4532 loss=0.285703 mse_soft=0.285229 ent_in=1.2318 ent_out=0.3490 rowmax_in=0.5042 rowmax_out=0.8733 discrete_mse=165.648315 best_discrete=28.193556 hash=False elapsed=18.6s
step   225/900 tau=0.4103 loss=0.280021 mse_soft=0.279569 ent_in=1.1911 ent_out=0.3139 rowmax_in=0.5107 rowmax_out=0.8753 discrete_mse=121.000626 best_discrete=28.193556 hash=False elapsed=20.8s
step   250/900 tau=0.3715 loss=0.275684 mse_soft=0.275245 ent_in=1.1688 ent_out=0.2932 rowmax_in=0.5151 rowmax_out=0.8779 discrete_mse=121.000626 best_discrete=28.193556 hash=False elapsed=23.0s
step   275/900 tau=0.3363 loss=0.271568 mse_soft=0.271139 ent_in=1.1496 ent_out=0.2819 rowmax_in=0.5196 rowmax_out=0.8789 discrete_mse=45.575851 best_discrete=28.193556 hash=False elapsed=25.1s
step   300/900 tau=0.3045 loss=0.273100 mse_soft=0.272678 ent_in=1.1373 ent_out=0.2685 rowmax_in=0.5209 rowmax_out=0.8819 discrete_mse=45.575851 best_discrete=28.193556 hash=False elapsed=27.4s
step   325/900 tau=0.2756 loss=0.269747 mse_soft=0.269329 ent_in=1.1311 ent_out=0.2621 rowmax_in=0.5208 rowmax_out=0.8818 discrete_mse=45.575851 best_discrete=28.193556 hash=False elapsed=29.8s
step   350/900 tau=0.2496 loss=0.269483 mse_soft=0.269068 ent_in=1.1268 ent_out=0.2579 rowmax_in=0.5199 rowmax_out=0.8840 discrete_mse=45.575851 best_discrete=28.193556 hash=False elapsed=32.2s
step   375/900 tau=0.2259 loss=0.271189 mse_soft=0.270774 ent_in=1.1272 ent_out=0.2576 rowmax_in=0.5203 rowmax_out=0.8843 discrete_mse=114.687271 best_discrete=28.193556 hash=False elapsed=34.5s
step   400/900 tau=0.2046 loss=0.271991 mse_soft=0.271575 ent_in=1.1273 ent_out=0.2588 rowmax_in=0.5204 rowmax_out=0.8831 discrete_mse=45.575851 best_discrete=28.193556 hash=False elapsed=36.6s
step   425/900 tau=0.1852 loss=0.270375 mse_soft=0.269959 ent_in=1.1271 ent_out=0.2599 rowmax_in=0.5214 rowmax_out=0.8825 discrete_mse=114.687271 best_discrete=28.193556 hash=False elapsed=39.0s
step   450/900 tau=0.1677 loss=0.272141 mse_soft=0.271724 ent_in=1.1298 ent_out=0.2576 rowmax_in=0.5188 rowmax_out=0.8851 discrete_mse=114.687271 best_discrete=28.193556 hash=False elapsed=41.3s
step   475/900 tau=0.1518 loss=0.269230 mse_soft=0.268812 ent_in=1.1309 ent_out=0.2618 rowmax_in=0.5163 rowmax_out=0.8840 discrete_mse=108.598572 best_discrete=28.193556 hash=False elapsed=43.6s
step   500/900 tau=0.1374 loss=0.271914 mse_soft=0.271497 ent_in=1.1317 ent_out=0.2596 rowmax_in=0.5138 rowmax_out=0.8867 discrete_mse=86.359886 best_discrete=28.193556 hash=False elapsed=46.0s
step   525/900 tau=0.1244 loss=0.272208 mse_soft=0.271792 ent_in=1.1298 ent_out=0.2587 rowmax_in=0.5148 rowmax_out=0.8878 discrete_mse=86.359886 best_discrete=28.193556 hash=False elapsed=48.3s
step   550/900 tau=0.1126 loss=0.275780 mse_soft=0.275367 ent_in=1.1219 ent_out=0.2526 rowmax_in=0.5155 rowmax_out=0.8921 discrete_mse=73.290428 best_discrete=28.193556 hash=False elapsed=50.6s
step   575/900 tau=0.1020 loss=0.282710 mse_soft=0.282308 ent_in=1.1132 ent_out=0.2260 rowmax_in=0.5193 rowmax_out=0.9069 discrete_mse=39.888916 best_discrete=28.193556 hash=False elapsed=52.9s
step   600/900 tau=0.0923 loss=0.284189 mse_soft=0.283784 ent_in=1.1202 ent_out=0.2285 rowmax_in=0.5135 rowmax_out=0.9023 discrete_mse=68.907425 best_discrete=28.193556 hash=False elapsed=55.2s
step   625/900 tau=0.0836 loss=0.311578 mse_soft=0.311202 ent_in=1.0398 ent_out=0.2162 rowmax_in=0.5503 rowmax_out=0.9038 discrete_mse=377.408020 best_discrete=28.193556 hash=False elapsed=57.5s
step   650/900 tau=0.0757 loss=0.276643 mse_soft=0.276270 ent_in=1.0309 ent_out=0.2123 rowmax_in=0.5375 rowmax_out=0.9075 discrete_mse=23.986423 best_discrete=23.986423 hash=False elapsed=59.9s
step   675/900 tau=0.0685 loss=0.419602 mse_soft=0.419262 ent_in=0.9575 ent_out=0.1781 rowmax_in=0.5695 rowmax_out=0.9208 discrete_mse=76.632500 best_discrete=23.986423 hash=False elapsed=62.4s
step   700/900 tau=0.0620 loss=0.362998 mse_soft=0.362731 ent_in=0.7326 ent_out=0.1574 rowmax_in=0.6666 rowmax_out=0.9295 discrete_mse=63.842499 best_discrete=23.986423 hash=False elapsed=64.8s
step   725/900 tau=0.0562 loss=0.343125 mse_soft=0.342872 ent_in=0.6739 ent_out=0.1687 rowmax_in=0.6873 rowmax_out=0.9247 discrete_mse=47.833225 best_discrete=23.986423 hash=False elapsed=67.0s
step   750/900 tau=0.0508 loss=0.381821 mse_soft=0.381642 ent_in=0.5359 ent_out=0.0605 rowmax_in=0.7328 rowmax_out=0.9825 discrete_mse=24.712915 best_discrete=23.986423 hash=False elapsed=69.5s
step   775/900 tau=0.0460 loss=0.366792 mse_soft=0.366615 ent_in=0.5427 ent_out=0.0469 rowmax_in=0.7245 rowmax_out=0.9873 discrete_mse=18.806936 best_discrete=18.806936 hash=False elapsed=71.9s
step   800/900 tau=0.0417 loss=0.364795 mse_soft=0.364614 ent_in=0.5457 ent_out=0.0588 rowmax_in=0.7213 rowmax_out=0.9803 discrete_mse=22.320347 best_discrete=18.806936 hash=False elapsed=74.3s
step   825/900 tau=0.0377 loss=0.364525 mse_soft=0.364343 ent_in=0.5369 ent_out=0.0706 rowmax_in=0.7329 rowmax_out=0.9712 discrete_mse=22.320347 best_discrete=18.806936 hash=False elapsed=76.6s
step   850/900 tau=0.0342 loss=0.438099 mse_soft=0.437973 ent_in=0.3660 ent_out=0.0553 rowmax_in=0.8185 rowmax_out=0.9824 discrete_mse=12.026716 best_discrete=12.026716 hash=False elapsed=78.9s
step   875/900 tau=0.0309 loss=0.407292 mse_soft=0.407169 ent_in=0.3563 ent_out=0.0553 rowmax_in=0.8202 rowmax_out=0.9828 discrete_mse=12.026716 best_discrete=12.026716 hash=False elapsed=81.3s
step   900/900 tau=0.0280 loss=0.396158 mse_soft=0.396024 ent_in=0.3589 ent_out=0.0886 rowmax_in=0.8195 rowmax_out=0.9619 discrete_mse=27.764730 best_discrete=12.026716 hash=False elapsed=83.6s

Final metrics:
  soft_mse_full=0.408653
  rowmax_in_mean=0.8206
  rowmax_out_mean=0.9581
  ent_in_mean=0.3569
  ent_out_mean=0.0905
  final_discrete_mse=25.342991
  hash_match=False
  best_discrete_mse_seen=12.026716
Saved results to overnight_b154_j2.json
