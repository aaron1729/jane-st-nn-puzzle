Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.048721 mse_soft=1.046399 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=83.766670 best_discrete=83.766670 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.855078 mse_soft=0.852888 ent_in=3.6325 ent_out=3.6674 rowmax_in=0.0449 rowmax_out=0.0442 discrete_mse=718.743652 best_discrete=83.766670 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.650260 mse_soft=0.648356 ent_in=3.1300 ent_out=3.2148 rowmax_in=0.0908 rowmax_out=0.0910 discrete_mse=5735.126953 best_discrete=83.766670 hash=False elapsed=5.2s
step    75/900 tau=0.7493 loss=0.511443 mse_soft=0.509875 ent_in=2.5885 ent_out=2.6383 rowmax_in=0.1980 rowmax_out=0.2053 discrete_mse=2950.334473 best_discrete=83.766670 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.405700 mse_soft=0.404549 ent_in=2.0174 ent_out=1.8181 rowmax_in=0.3345 rowmax_out=0.4284 discrete_mse=3216.313721 best_discrete=83.766670 hash=False elapsed=9.5s
step   125/900 tau=0.6165 loss=0.337973 mse_soft=0.337167 ent_in=1.6377 ent_out=1.0499 rowmax_in=0.4214 rowmax_out=0.6607 discrete_mse=814.560669 best_discrete=83.766670 hash=False elapsed=11.8s
step   150/900 tau=0.5592 loss=0.311867 mse_soft=0.311229 ent_in=1.4863 ent_out=0.6408 rowmax_in=0.4459 rowmax_out=0.8001 discrete_mse=144.742676 best_discrete=83.766670 hash=False elapsed=14.2s
step   175/900 tau=0.5073 loss=0.295585 mse_soft=0.295054 ent_in=1.3644 ent_out=0.4064 rowmax_in=0.4733 rowmax_out=0.8701 discrete_mse=149.808151 best_discrete=83.766670 hash=False elapsed=16.4s
step   200/900 tau=0.4602 loss=0.288228 mse_soft=0.287734 ent_in=1.3133 ent_out=0.3354 rowmax_in=0.4742 rowmax_out=0.8898 discrete_mse=55.540699 best_discrete=55.540699 hash=False elapsed=18.6s
step   225/900 tau=0.4174 loss=0.283509 mse_soft=0.283037 ent_in=1.2640 ent_out=0.3080 rowmax_in=0.4824 rowmax_out=0.8960 discrete_mse=926.250977 best_discrete=55.540699 hash=False elapsed=20.9s
step   250/900 tau=0.3786 loss=0.278603 mse_soft=0.278150 ent_in=1.2268 ent_out=0.2849 rowmax_in=0.4875 rowmax_out=0.9010 discrete_mse=1472.482788 best_discrete=55.540699 hash=False elapsed=22.9s
step   275/900 tau=0.3434 loss=0.274493 mse_soft=0.274055 ent_in=1.2082 ent_out=0.2536 rowmax_in=0.4868 rowmax_out=0.9098 discrete_mse=970.217590 best_discrete=55.540699 hash=False elapsed=25.0s
step   300/900 tau=0.3115 loss=0.271761 mse_soft=0.271333 ent_in=1.1964 ent_out=0.2292 rowmax_in=0.4880 rowmax_out=0.9155 discrete_mse=531.999390 best_discrete=55.540699 hash=False elapsed=27.3s
step   325/900 tau=0.2826 loss=0.270968 mse_soft=0.270546 ent_in=1.1857 ent_out=0.2200 rowmax_in=0.4872 rowmax_out=0.9164 discrete_mse=531.999390 best_discrete=55.540699 hash=False elapsed=29.5s
step   350/900 tau=0.2563 loss=0.270497 mse_soft=0.270079 ent_in=1.1808 ent_out=0.2147 rowmax_in=0.4880 rowmax_out=0.9169 discrete_mse=531.999390 best_discrete=55.540699 hash=False elapsed=31.9s
step   375/900 tau=0.2325 loss=0.269204 mse_soft=0.268788 ent_in=1.1739 ent_out=0.2122 rowmax_in=0.4891 rowmax_out=0.9163 discrete_mse=531.999390 best_discrete=55.540699 hash=False elapsed=34.0s
step   400/900 tau=0.2109 loss=0.271336 mse_soft=0.270925 ent_in=1.1672 ent_out=0.2031 rowmax_in=0.4903 rowmax_out=0.9183 discrete_mse=531.999390 best_discrete=55.540699 hash=False elapsed=36.1s
step   425/900 tau=0.1913 loss=0.269536 mse_soft=0.269128 ent_in=1.1654 ent_out=0.1959 rowmax_in=0.4902 rowmax_out=0.9199 discrete_mse=531.999390 best_discrete=55.540699 hash=False elapsed=38.2s
step   450/900 tau=0.1735 loss=0.271719 mse_soft=0.271312 ent_in=1.1633 ent_out=0.1923 rowmax_in=0.4894 rowmax_out=0.9209 discrete_mse=531.999390 best_discrete=55.540699 hash=False elapsed=40.5s
step   475/900 tau=0.1574 loss=0.273100 mse_soft=0.272695 ent_in=1.1597 ent_out=0.1892 rowmax_in=0.4934 rowmax_out=0.9223 discrete_mse=531.999390 best_discrete=55.540699 hash=False elapsed=42.9s
step   500/900 tau=0.1428 loss=0.275063 mse_soft=0.274659 ent_in=1.1594 ent_out=0.1893 rowmax_in=0.4922 rowmax_out=0.9216 discrete_mse=531.999390 best_discrete=55.540699 hash=False elapsed=45.3s
step   525/900 tau=0.1295 loss=0.274720 mse_soft=0.274318 ent_in=1.1506 ent_out=0.1899 rowmax_in=0.5000 rowmax_out=0.9199 discrete_mse=531.999390 best_discrete=55.540699 hash=False elapsed=47.5s
step   550/900 tau=0.1175 loss=0.277120 mse_soft=0.276720 ent_in=1.1505 ent_out=0.1855 rowmax_in=0.4911 rowmax_out=0.9220 discrete_mse=531.999390 best_discrete=55.540699 hash=False elapsed=49.6s
step   575/900 tau=0.1066 loss=0.270314 mse_soft=0.269921 ent_in=1.1314 ent_out=0.1796 rowmax_in=0.5012 rowmax_out=0.9238 discrete_mse=531.999390 best_discrete=55.540699 hash=False elapsed=51.7s
step   600/900 tau=0.0967 loss=0.272597 mse_soft=0.272206 ent_in=1.1298 ent_out=0.1765 rowmax_in=0.5004 rowmax_out=0.9249 discrete_mse=1234.775146 best_discrete=55.540699 hash=False elapsed=53.8s
step   625/900 tau=0.0877 loss=0.273233 mse_soft=0.272847 ent_in=1.1035 ent_out=0.1818 rowmax_in=0.5087 rowmax_out=0.9224 discrete_mse=624.194458 best_discrete=55.540699 hash=False elapsed=55.9s
step   650/900 tau=0.0795 loss=0.278248 mse_soft=0.277860 ent_in=1.1111 ent_out=0.1842 rowmax_in=0.5053 rowmax_out=0.9203 discrete_mse=267.355560 best_discrete=55.540699 hash=False elapsed=57.9s
step   675/900 tau=0.0722 loss=0.284092 mse_soft=0.283708 ent_in=1.1010 ent_out=0.1801 rowmax_in=0.5115 rowmax_out=0.9232 discrete_mse=255.448898 best_discrete=55.540699 hash=False elapsed=60.0s
step   700/900 tau=0.0655 loss=0.365844 mse_soft=0.365475 ent_in=1.0423 ent_out=0.1862 rowmax_in=0.5535 rowmax_out=0.9160 discrete_mse=148.512222 best_discrete=55.540699 hash=False elapsed=62.1s
step   725/900 tau=0.0594 loss=0.298607 mse_soft=0.298264 ent_in=0.9564 ent_out=0.1868 rowmax_in=0.5592 rowmax_out=0.9136 discrete_mse=106.403572 best_discrete=55.540699 hash=False elapsed=64.1s
step   750/900 tau=0.0539 loss=0.322161 mse_soft=0.321858 ent_in=0.8216 ent_out=0.1911 rowmax_in=0.6125 rowmax_out=0.9050 discrete_mse=73.635529 best_discrete=55.540699 hash=False elapsed=66.1s
step   775/900 tau=0.0489 loss=0.308014 mse_soft=0.307716 ent_in=0.8467 ent_out=0.1480 rowmax_in=0.5730 rowmax_out=0.9349 discrete_mse=1719.096313 best_discrete=55.540699 hash=False elapsed=68.1s
step   800/900 tau=0.0443 loss=0.408842 mse_soft=0.408615 ent_in=0.6172 ent_out=0.1418 rowmax_in=0.7199 rowmax_out=0.9350 discrete_mse=18.753462 best_discrete=18.753462 hash=False elapsed=70.1s
step   825/900 tau=0.0402 loss=0.383923 mse_soft=0.383746 ent_in=0.4799 ent_out=0.1105 rowmax_in=0.7707 rowmax_out=0.9389 discrete_mse=30.855612 best_discrete=18.753462 hash=False elapsed=72.1s
step   850/900 tau=0.0365 loss=0.366737 mse_soft=0.366558 ent_in=0.4861 ent_out=0.1113 rowmax_in=0.7607 rowmax_out=0.9358 discrete_mse=51.041355 best_discrete=18.753462 hash=False elapsed=74.1s
step   875/900 tau=0.0331 loss=0.371979 mse_soft=0.371798 ent_in=0.4933 ent_out=0.1115 rowmax_in=0.7592 rowmax_out=0.9365 discrete_mse=19.751930 best_discrete=18.753462 hash=False elapsed=76.2s
step   900/900 tau=0.0300 loss=0.362603 mse_soft=0.362419 ent_in=0.5004 ent_out=0.1119 rowmax_in=0.7561 rowmax_out=0.9357 discrete_mse=26.632006 best_discrete=18.753462 hash=False elapsed=78.2s

Final metrics:
  soft_mse_full=0.366470
  rowmax_in_mean=0.7596
  rowmax_out_mean=0.9366
  ent_in_mean=0.4950
  ent_out_mean=0.1116
  final_discrete_mse=29.025724
  hash_match=False
  best_discrete_mse_seen=18.753462
Saved results to overnight_b211_j1.json
