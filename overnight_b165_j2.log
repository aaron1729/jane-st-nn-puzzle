Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.052277 mse_soft=1.049954 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=98.004211 best_discrete=98.004211 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.851772 mse_soft=0.849582 ent_in=3.6335 ent_out=3.6658 rowmax_in=0.0458 rowmax_out=0.0447 discrete_mse=586.460205 best_discrete=98.004211 hash=False elapsed=2.9s
step    50/900 tau=0.8229 loss=0.640189 mse_soft=0.638281 ent_in=3.1339 ent_out=3.2256 rowmax_in=0.0949 rowmax_out=0.0892 discrete_mse=707.981567 best_discrete=98.004211 hash=False elapsed=5.2s
step    75/900 tau=0.7450 loss=0.496656 mse_soft=0.495079 ent_in=2.5903 ent_out=2.6647 rowmax_in=0.2156 rowmax_out=0.2011 discrete_mse=440.556091 best_discrete=98.004211 hash=False elapsed=7.7s
step   100/900 tau=0.6745 loss=0.406117 mse_soft=0.404951 ent_in=1.9874 ent_out=1.9004 rowmax_in=0.3539 rowmax_out=0.3840 discrete_mse=1296.823120 best_discrete=98.004211 hash=False elapsed=10.1s
step   125/900 tau=0.6107 loss=0.348415 mse_soft=0.347566 ent_in=1.5665 ent_out=1.2630 rowmax_in=0.4548 rowmax_out=0.5789 discrete_mse=4113.101074 best_discrete=98.004211 hash=False elapsed=12.4s
step   150/900 tau=0.5529 loss=0.314544 mse_soft=0.313887 ent_in=1.3458 ent_out=0.8427 rowmax_in=0.5130 rowmax_out=0.7028 discrete_mse=193.616165 best_discrete=98.004211 hash=False elapsed=14.8s
step   175/900 tau=0.5006 loss=0.300970 mse_soft=0.300392 ent_in=1.2472 ent_out=0.6776 rowmax_in=0.5365 rowmax_out=0.7217 discrete_mse=267.851562 best_discrete=98.004211 hash=False elapsed=17.0s
step   200/900 tau=0.4532 loss=0.293567 mse_soft=0.293027 ent_in=1.2007 ent_out=0.5986 rowmax_in=0.5381 rowmax_out=0.7371 discrete_mse=437.331085 best_discrete=98.004211 hash=False elapsed=19.2s
step   225/900 tau=0.4103 loss=0.286476 mse_soft=0.285976 ent_in=1.1540 ent_out=0.5136 rowmax_in=0.5463 rowmax_out=0.7694 discrete_mse=309.003845 best_discrete=98.004211 hash=False elapsed=21.5s
step   250/900 tau=0.3715 loss=0.282450 mse_soft=0.281971 ent_in=1.1347 ent_out=0.4628 rowmax_in=0.5427 rowmax_out=0.7837 discrete_mse=233.497101 best_discrete=98.004211 hash=False elapsed=23.8s
step   275/900 tau=0.3363 loss=0.280023 mse_soft=0.279556 ent_in=1.1276 ent_out=0.4270 rowmax_in=0.5394 rowmax_out=0.7921 discrete_mse=233.497101 best_discrete=98.004211 hash=False elapsed=25.9s
step   300/900 tau=0.3045 loss=0.276888 mse_soft=0.276429 ent_in=1.1165 ent_out=0.4139 rowmax_in=0.5381 rowmax_out=0.7926 discrete_mse=233.497101 best_discrete=98.004211 hash=False elapsed=28.1s
step   325/900 tau=0.2756 loss=0.274588 mse_soft=0.274132 ent_in=1.1027 ent_out=0.4168 rowmax_in=0.5382 rowmax_out=0.7849 discrete_mse=318.763184 best_discrete=98.004211 hash=False elapsed=30.3s
step   350/900 tau=0.2496 loss=0.272250 mse_soft=0.271803 ent_in=1.0811 ent_out=0.4104 rowmax_in=0.5442 rowmax_out=0.7907 discrete_mse=839.869751 best_discrete=98.004211 hash=False elapsed=32.5s
step   375/900 tau=0.2259 loss=0.272044 mse_soft=0.271599 ent_in=1.0789 ent_out=0.4044 rowmax_in=0.5427 rowmax_out=0.7957 discrete_mse=714.736267 best_discrete=98.004211 hash=False elapsed=34.8s
step   400/900 tau=0.2046 loss=0.273514 mse_soft=0.273078 ent_in=1.0581 ent_out=0.3949 rowmax_in=0.5489 rowmax_out=0.8011 discrete_mse=715.614075 best_discrete=98.004211 hash=False elapsed=37.3s
step   425/900 tau=0.1852 loss=0.269846 mse_soft=0.269415 ent_in=1.0501 ent_out=0.3883 rowmax_in=0.5494 rowmax_out=0.8054 discrete_mse=715.614075 best_discrete=98.004211 hash=False elapsed=39.5s
step   450/900 tau=0.1677 loss=0.272132 mse_soft=0.271703 ent_in=1.0461 ent_out=0.3826 rowmax_in=0.5480 rowmax_out=0.8091 discrete_mse=476.380676 best_discrete=98.004211 hash=False elapsed=42.0s
step   475/900 tau=0.1518 loss=0.274332 mse_soft=0.273909 ent_in=1.0331 ent_out=0.3782 rowmax_in=0.5514 rowmax_out=0.8109 discrete_mse=419.052917 best_discrete=98.004211 hash=False elapsed=44.3s
step   500/900 tau=0.1374 loss=0.277325 mse_soft=0.276904 ent_in=1.0328 ent_out=0.3731 rowmax_in=0.5484 rowmax_out=0.8145 discrete_mse=435.051239 best_discrete=98.004211 hash=False elapsed=46.7s
step   525/900 tau=0.1244 loss=0.274057 mse_soft=0.273641 ent_in=1.0201 ent_out=0.3676 rowmax_in=0.5518 rowmax_out=0.8168 discrete_mse=684.248535 best_discrete=98.004211 hash=False elapsed=48.9s
step   550/900 tau=0.1126 loss=0.280419 mse_soft=0.280008 ent_in=1.0115 ent_out=0.3582 rowmax_in=0.5514 rowmax_out=0.8204 discrete_mse=795.203247 best_discrete=98.004211 hash=False elapsed=51.4s
step   575/900 tau=0.1020 loss=0.275077 mse_soft=0.274668 ent_in=1.0137 ent_out=0.3490 rowmax_in=0.5472 rowmax_out=0.8214 discrete_mse=2675.919434 best_discrete=98.004211 hash=False elapsed=53.9s
step   600/900 tau=0.0923 loss=0.296045 mse_soft=0.295668 ent_in=0.9346 ent_out=0.3222 rowmax_in=0.5734 rowmax_out=0.8396 discrete_mse=452.883698 best_discrete=98.004211 hash=False elapsed=56.2s
step   625/900 tau=0.0836 loss=0.281993 mse_soft=0.281627 ent_in=0.8971 ent_out=0.3237 rowmax_in=0.5907 rowmax_out=0.8331 discrete_mse=910.329407 best_discrete=98.004211 hash=False elapsed=58.9s
step   650/900 tau=0.0757 loss=0.282561 mse_soft=0.282193 ent_in=0.9055 ent_out=0.3197 rowmax_in=0.5836 rowmax_out=0.8277 discrete_mse=998.639282 best_discrete=98.004211 hash=False elapsed=61.5s
step   675/900 tau=0.0685 loss=0.387944 mse_soft=0.387647 ent_in=0.7638 ent_out=0.2254 rowmax_in=0.6429 rowmax_out=0.8894 discrete_mse=190.469727 best_discrete=98.004211 hash=False elapsed=63.7s
step   700/900 tau=0.0620 loss=0.354879 mse_soft=0.354615 ent_in=0.6269 ent_out=0.2527 rowmax_in=0.6963 rowmax_out=0.8628 discrete_mse=149.723389 best_discrete=98.004211 hash=False elapsed=66.1s
step   725/900 tau=0.0562 loss=0.321811 mse_soft=0.321540 ent_in=0.6640 ent_out=0.2411 rowmax_in=0.6706 rowmax_out=0.8715 discrete_mse=361.618713 best_discrete=98.004211 hash=False elapsed=68.3s
step   750/900 tau=0.0508 loss=0.309964 mse_soft=0.309680 ent_in=0.6878 ent_out=0.2584 rowmax_in=0.6639 rowmax_out=0.8499 discrete_mse=196.465820 best_discrete=98.004211 hash=False elapsed=70.4s
step   775/900 tau=0.0460 loss=0.320681 mse_soft=0.320405 ent_in=0.6658 ent_out=0.2544 rowmax_in=0.6616 rowmax_out=0.8551 discrete_mse=164.067841 best_discrete=98.004211 hash=False elapsed=72.9s
step   800/900 tau=0.0417 loss=0.342528 mse_soft=0.342259 ent_in=0.6529 ent_out=0.2459 rowmax_in=0.6625 rowmax_out=0.8674 discrete_mse=343.839691 best_discrete=98.004211 hash=False elapsed=75.1s
step   825/900 tau=0.0377 loss=0.486674 mse_soft=0.486490 ent_in=0.4785 ent_out=0.1347 rowmax_in=0.7543 rowmax_out=0.9259 discrete_mse=32.238003 best_discrete=32.238003 hash=False elapsed=77.3s
step   850/900 tau=0.0342 loss=0.487088 mse_soft=0.486967 ent_in=0.2982 ent_out=0.1049 rowmax_in=0.8541 rowmax_out=0.9359 discrete_mse=12.032639 best_discrete=12.032639 hash=False elapsed=79.6s
step   875/900 tau=0.0309 loss=0.441160 mse_soft=0.441027 ent_in=0.3294 ent_out=0.1145 rowmax_in=0.8341 rowmax_out=0.9321 discrete_mse=24.541500 best_discrete=12.032639 hash=False elapsed=81.8s
step   900/900 tau=0.0280 loss=0.411249 mse_soft=0.411099 ent_in=0.3382 ent_out=0.1598 rowmax_in=0.8224 rowmax_out=0.9051 discrete_mse=16.708977 best_discrete=12.032639 hash=False elapsed=84.0s

Final metrics:
  soft_mse_full=0.417360
  rowmax_in_mean=0.8219
  rowmax_out_mean=0.9036
  ent_in_mean=0.3378
  ent_out_mean=0.1611
  final_discrete_mse=16.708977
  hash_match=False
  best_discrete_mse_seen=12.032639
Saved results to overnight_b165_j2.json
