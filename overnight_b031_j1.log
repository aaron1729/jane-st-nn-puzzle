Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.072445 mse_soft=1.070122 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=102.023659 best_discrete=102.023659 hash=False elapsed=0.6s
step    25/900 tau=0.9106 loss=0.872449 mse_soft=0.870259 ent_in=3.6344 ent_out=3.6668 rowmax_in=0.0448 rowmax_out=0.0450 discrete_mse=147.615997 best_discrete=102.023659 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.657996 mse_soft=0.656089 ent_in=3.1296 ent_out=3.2266 rowmax_in=0.0943 rowmax_out=0.0872 discrete_mse=9379.137695 best_discrete=102.023659 hash=False elapsed=4.7s
step    75/900 tau=0.7493 loss=0.509390 mse_soft=0.507810 ent_in=2.5953 ent_out=2.6741 rowmax_in=0.2032 rowmax_out=0.1986 discrete_mse=847.230591 best_discrete=102.023659 hash=False elapsed=6.9s
step   100/900 tau=0.6797 loss=0.397434 mse_soft=0.396282 ent_in=1.9818 ent_out=1.8592 rowmax_in=0.3431 rowmax_out=0.4167 discrete_mse=1230.689331 best_discrete=102.023659 hash=False elapsed=9.2s
step   125/900 tau=0.6165 loss=0.338793 mse_soft=0.337953 ent_in=1.6300 ent_out=1.1722 rowmax_in=0.4250 rowmax_out=0.6160 discrete_mse=2007.481201 best_discrete=102.023659 hash=False elapsed=11.2s
step   150/900 tau=0.5592 loss=0.313416 mse_soft=0.312725 ent_in=1.4307 ent_out=0.8714 rowmax_in=0.4663 rowmax_out=0.6877 discrete_mse=1280.354614 best_discrete=102.023659 hash=False elapsed=13.4s
step   175/900 tau=0.5073 loss=0.302996 mse_soft=0.302379 ent_in=1.3325 ent_out=0.7248 rowmax_in=0.4768 rowmax_out=0.7143 discrete_mse=1489.798706 best_discrete=102.023659 hash=False elapsed=15.4s
step   200/900 tau=0.4602 loss=0.296459 mse_soft=0.295884 ent_in=1.2739 ent_out=0.6399 rowmax_in=0.4845 rowmax_out=0.7284 discrete_mse=1165.705200 best_discrete=102.023659 hash=False elapsed=17.5s
step   225/900 tau=0.4174 loss=0.292402 mse_soft=0.291857 ent_in=1.2256 ent_out=0.5905 rowmax_in=0.4926 rowmax_out=0.7457 discrete_mse=951.403198 best_discrete=102.023659 hash=False elapsed=19.7s
step   250/900 tau=0.3786 loss=0.287753 mse_soft=0.287236 ent_in=1.1820 ent_out=0.5384 rowmax_in=0.5005 rowmax_out=0.7597 discrete_mse=692.737061 best_discrete=102.023659 hash=False elapsed=21.6s
step   275/900 tau=0.3434 loss=0.284231 mse_soft=0.283736 ent_in=1.1495 ent_out=0.5021 rowmax_in=0.5082 rowmax_out=0.7644 discrete_mse=632.987793 best_discrete=102.023659 hash=False elapsed=23.6s
step   300/900 tau=0.3115 loss=0.283315 mse_soft=0.282835 ent_in=1.1315 ent_out=0.4674 rowmax_in=0.5100 rowmax_out=0.7773 discrete_mse=632.987793 best_discrete=102.023659 hash=False elapsed=25.5s
step   325/900 tau=0.2826 loss=0.281880 mse_soft=0.281411 ent_in=1.1213 ent_out=0.4447 rowmax_in=0.5101 rowmax_out=0.7838 discrete_mse=1214.754028 best_discrete=102.023659 hash=False elapsed=27.4s
step   350/900 tau=0.2563 loss=0.282909 mse_soft=0.282444 ent_in=1.1225 ent_out=0.4268 rowmax_in=0.5077 rowmax_out=0.7882 discrete_mse=1414.891357 best_discrete=102.023659 hash=False elapsed=29.3s
step   375/900 tau=0.2325 loss=0.281958 mse_soft=0.281497 ent_in=1.1220 ent_out=0.4145 rowmax_in=0.5059 rowmax_out=0.7914 discrete_mse=1414.891357 best_discrete=102.023659 hash=False elapsed=31.2s
step   400/900 tau=0.2109 loss=0.278971 mse_soft=0.278514 ent_in=1.1178 ent_out=0.4040 rowmax_in=0.5083 rowmax_out=0.7962 discrete_mse=1414.891357 best_discrete=102.023659 hash=False elapsed=33.2s
step   425/900 tau=0.1913 loss=0.282408 mse_soft=0.281954 ent_in=1.1144 ent_out=0.3970 rowmax_in=0.5074 rowmax_out=0.8014 discrete_mse=1667.000122 best_discrete=102.023659 hash=False elapsed=35.2s
step   450/900 tau=0.1735 loss=0.277692 mse_soft=0.277242 ent_in=1.1085 ent_out=0.3911 rowmax_in=0.5096 rowmax_out=0.8045 discrete_mse=1414.891357 best_discrete=102.023659 hash=False elapsed=37.2s
step   475/900 tau=0.1574 loss=0.281440 mse_soft=0.280990 ent_in=1.1093 ent_out=0.3918 rowmax_in=0.5078 rowmax_out=0.8024 discrete_mse=978.818481 best_discrete=102.023659 hash=False elapsed=39.2s
step   500/900 tau=0.1428 loss=0.280851 mse_soft=0.280405 ent_in=1.0992 ent_out=0.3871 rowmax_in=0.5124 rowmax_out=0.8047 discrete_mse=1414.891357 best_discrete=102.023659 hash=False elapsed=41.1s
step   525/900 tau=0.1295 loss=0.281718 mse_soft=0.281275 ent_in=1.0925 ent_out=0.3842 rowmax_in=0.5185 rowmax_out=0.8067 discrete_mse=986.005676 best_discrete=102.023659 hash=False elapsed=43.2s
step   550/900 tau=0.1175 loss=0.295284 mse_soft=0.294844 ent_in=1.0823 ent_out=0.3834 rowmax_in=0.5163 rowmax_out=0.8065 discrete_mse=763.696289 best_discrete=102.023659 hash=False elapsed=45.4s
step   575/900 tau=0.1066 loss=0.281620 mse_soft=0.281176 ent_in=1.0894 ent_out=0.3888 rowmax_in=0.5117 rowmax_out=0.7993 discrete_mse=150.502472 best_discrete=102.023659 hash=False elapsed=47.7s
step   600/900 tau=0.0967 loss=0.287835 mse_soft=0.287397 ent_in=1.0765 ent_out=0.3840 rowmax_in=0.5204 rowmax_out=0.8035 discrete_mse=218.532944 best_discrete=102.023659 hash=False elapsed=49.9s
step   625/900 tau=0.0877 loss=0.306354 mse_soft=0.305946 ent_in=0.9891 ent_out=0.3711 rowmax_in=0.5480 rowmax_out=0.8101 discrete_mse=494.427429 best_discrete=102.023659 hash=False elapsed=51.9s
step   650/900 tau=0.0795 loss=0.290664 mse_soft=0.290263 ent_in=0.9679 ent_out=0.3669 rowmax_in=0.5620 rowmax_out=0.8148 discrete_mse=464.455688 best_discrete=102.023659 hash=False elapsed=54.1s
step   675/900 tau=0.0722 loss=0.290334 mse_soft=0.289937 ent_in=0.9526 ent_out=0.3730 rowmax_in=0.5629 rowmax_out=0.8147 discrete_mse=465.063477 best_discrete=102.023659 hash=False elapsed=56.2s
step   700/900 tau=0.0655 loss=0.295640 mse_soft=0.295251 ent_in=0.9266 ent_out=0.3680 rowmax_in=0.5799 rowmax_out=0.8217 discrete_mse=209.130524 best_discrete=102.023659 hash=False elapsed=58.3s
step   725/900 tau=0.0594 loss=0.311750 mse_soft=0.311364 ent_in=0.9187 ent_out=0.3653 rowmax_in=0.5805 rowmax_out=0.8208 discrete_mse=209.130524 best_discrete=102.023659 hash=False elapsed=60.5s
step   750/900 tau=0.0539 loss=0.380427 mse_soft=0.380166 ent_in=0.6012 ent_out=0.2714 rowmax_in=0.7336 rowmax_out=0.8699 discrete_mse=56.882961 best_discrete=56.882961 hash=False elapsed=62.5s
step   775/900 tau=0.0489 loss=0.466743 mse_soft=0.466518 ent_in=0.4864 ent_out=0.2629 rowmax_in=0.7653 rowmax_out=0.8666 discrete_mse=53.047131 best_discrete=53.047131 hash=False elapsed=64.6s
step   800/900 tau=0.0443 loss=0.373575 mse_soft=0.373372 ent_in=0.4334 ent_out=0.2443 rowmax_in=0.7777 rowmax_out=0.8641 discrete_mse=88.585075 best_discrete=53.047131 hash=False elapsed=66.7s
step   825/900 tau=0.0402 loss=0.384181 mse_soft=0.383974 ent_in=0.4432 ent_out=0.2471 rowmax_in=0.7644 rowmax_out=0.8647 discrete_mse=70.264481 best_discrete=53.047131 hash=False elapsed=69.1s
step   850/900 tau=0.0365 loss=0.535588 mse_soft=0.535437 ent_in=0.3537 ent_out=0.1508 rowmax_in=0.8321 rowmax_out=0.9048 discrete_mse=5.606717 best_discrete=5.606717 hash=False elapsed=71.2s
step   875/900 tau=0.0331 loss=0.426872 mse_soft=0.426709 ent_in=0.3811 ent_out=0.1647 rowmax_in=0.7920 rowmax_out=0.8937 discrete_mse=106.694069 best_discrete=5.606717 hash=False elapsed=73.4s
step   900/900 tau=0.0300 loss=0.405034 mse_soft=0.404875 ent_in=0.3670 ent_out=0.1648 rowmax_in=0.8097 rowmax_out=0.8941 discrete_mse=138.446396 best_discrete=5.606717 hash=False elapsed=75.3s

Final metrics:
  soft_mse_full=0.402053
  rowmax_in_mean=0.8112
  rowmax_out_mean=0.8949
  ent_in_mean=0.3660
  ent_out_mean=0.1643
  final_discrete_mse=138.446396
  hash_match=False
  best_discrete_mse_seen=5.606717
Saved results to overnight_b031_j1.json
