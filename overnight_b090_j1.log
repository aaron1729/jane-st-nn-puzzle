Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.094232 mse_soft=1.091910 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=485.681549 best_discrete=485.681549 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.885255 mse_soft=0.883065 ent_in=3.6320 ent_out=3.6658 rowmax_in=0.0450 rowmax_out=0.0443 discrete_mse=921.571167 best_discrete=485.681549 hash=False elapsed=2.9s
step    50/900 tau=0.8260 loss=0.671583 mse_soft=0.669672 ent_in=3.1416 ent_out=3.2274 rowmax_in=0.0896 rowmax_out=0.0860 discrete_mse=2535.575439 best_discrete=485.681549 hash=False elapsed=5.2s
step    75/900 tau=0.7493 loss=0.525626 mse_soft=0.524042 ent_in=2.6039 ent_out=2.6777 rowmax_in=0.2043 rowmax_out=0.1964 discrete_mse=845.281006 best_discrete=485.681549 hash=False elapsed=7.4s
step   100/900 tau=0.6797 loss=0.411364 mse_soft=0.410200 ent_in=2.0236 ent_out=1.8550 rowmax_in=0.3481 rowmax_out=0.4204 discrete_mse=1216.276978 best_discrete=485.681549 hash=False elapsed=9.4s
step   125/900 tau=0.6165 loss=0.338955 mse_soft=0.338126 ent_in=1.6115 ent_out=1.1516 rowmax_in=0.4430 rowmax_out=0.6177 discrete_mse=172.889572 best_discrete=172.889572 hash=False elapsed=11.5s
step   150/900 tau=0.5592 loss=0.308736 mse_soft=0.308077 ent_in=1.4227 ent_out=0.7753 rowmax_in=0.4689 rowmax_out=0.7396 discrete_mse=782.657654 best_discrete=172.889572 hash=False elapsed=13.5s
step   175/900 tau=0.5073 loss=0.297009 mse_soft=0.296435 ent_in=1.3215 ent_out=0.5918 rowmax_in=0.4831 rowmax_out=0.7889 discrete_mse=515.105103 best_discrete=172.889572 hash=False elapsed=15.6s
step   200/900 tau=0.4602 loss=0.289311 mse_soft=0.288788 ent_in=1.2609 ent_out=0.4803 rowmax_in=0.4902 rowmax_out=0.8229 discrete_mse=527.439026 best_discrete=172.889572 hash=False elapsed=17.7s
step   225/900 tau=0.4174 loss=0.285512 mse_soft=0.285022 ent_in=1.2215 ent_out=0.4105 rowmax_in=0.4924 rowmax_out=0.8442 discrete_mse=431.494598 best_discrete=172.889572 hash=False elapsed=20.0s
step   250/900 tau=0.3786 loss=0.282301 mse_soft=0.281831 ent_in=1.1956 ent_out=0.3718 rowmax_in=0.4970 rowmax_out=0.8524 discrete_mse=471.765045 best_discrete=172.889572 hash=False elapsed=22.2s
step   275/900 tau=0.3434 loss=0.280402 mse_soft=0.279946 ent_in=1.1805 ent_out=0.3412 rowmax_in=0.4967 rowmax_out=0.8584 discrete_mse=344.126129 best_discrete=172.889572 hash=False elapsed=24.5s
step   300/900 tau=0.3115 loss=0.279459 mse_soft=0.279012 ent_in=1.1665 ent_out=0.3228 rowmax_in=0.4974 rowmax_out=0.8624 discrete_mse=247.510590 best_discrete=172.889572 hash=False elapsed=26.6s
step   325/900 tau=0.2826 loss=0.279118 mse_soft=0.278676 ent_in=1.1604 ent_out=0.3155 rowmax_in=0.4981 rowmax_out=0.8639 discrete_mse=276.855499 best_discrete=172.889572 hash=False elapsed=28.9s
step   350/900 tau=0.2563 loss=0.277660 mse_soft=0.277220 ent_in=1.1506 ent_out=0.3162 rowmax_in=0.4995 rowmax_out=0.8612 discrete_mse=237.705017 best_discrete=172.889572 hash=False elapsed=31.3s
step   375/900 tau=0.2325 loss=0.278436 mse_soft=0.278000 ent_in=1.1413 ent_out=0.3103 rowmax_in=0.5022 rowmax_out=0.8628 discrete_mse=619.684204 best_discrete=172.889572 hash=False elapsed=33.6s
step   400/900 tau=0.2109 loss=0.278267 mse_soft=0.277837 ent_in=1.1292 ent_out=0.3062 rowmax_in=0.5048 rowmax_out=0.8637 discrete_mse=459.027100 best_discrete=172.889572 hash=False elapsed=35.7s
step   425/900 tau=0.1913 loss=0.278749 mse_soft=0.278325 ent_in=1.1176 ent_out=0.2970 rowmax_in=0.5082 rowmax_out=0.8680 discrete_mse=459.027100 best_discrete=172.889572 hash=False elapsed=38.0s
step   450/900 tau=0.1735 loss=0.278935 mse_soft=0.278512 ent_in=1.1145 ent_out=0.2961 rowmax_in=0.5076 rowmax_out=0.8665 discrete_mse=622.003784 best_discrete=172.889572 hash=False elapsed=40.4s
step   475/900 tau=0.1574 loss=0.274789 mse_soft=0.274369 ent_in=1.1097 ent_out=0.2919 rowmax_in=0.5100 rowmax_out=0.8656 discrete_mse=428.780701 best_discrete=172.889572 hash=False elapsed=42.9s
step   500/900 tau=0.1428 loss=0.277511 mse_soft=0.277092 ent_in=1.1048 ent_out=0.2926 rowmax_in=0.5103 rowmax_out=0.8636 discrete_mse=653.442688 best_discrete=172.889572 hash=False elapsed=45.0s
step   525/900 tau=0.1295 loss=0.276169 mse_soft=0.275751 ent_in=1.1011 ent_out=0.2915 rowmax_in=0.5125 rowmax_out=0.8620 discrete_mse=451.967499 best_discrete=172.889572 hash=False elapsed=47.1s
step   550/900 tau=0.1175 loss=0.282832 mse_soft=0.282414 ent_in=1.1015 ent_out=0.2890 rowmax_in=0.5117 rowmax_out=0.8635 discrete_mse=553.192261 best_discrete=172.889572 hash=False elapsed=49.5s
step   575/900 tau=0.1066 loss=0.283050 mse_soft=0.282633 ent_in=1.0995 ent_out=0.2911 rowmax_in=0.5126 rowmax_out=0.8594 discrete_mse=402.559601 best_discrete=172.889572 hash=False elapsed=51.9s
step   600/900 tau=0.0967 loss=0.277703 mse_soft=0.277288 ent_in=1.0968 ent_out=0.2860 rowmax_in=0.5113 rowmax_out=0.8641 discrete_mse=428.780701 best_discrete=172.889572 hash=False elapsed=54.3s
step   625/900 tau=0.0877 loss=0.303749 mse_soft=0.303336 ent_in=1.0948 ent_out=0.2814 rowmax_in=0.5115 rowmax_out=0.8682 discrete_mse=522.643372 best_discrete=172.889572 hash=False elapsed=56.7s
step   650/900 tau=0.0795 loss=0.309338 mse_soft=0.308929 ent_in=1.0837 ent_out=0.2784 rowmax_in=0.5210 rowmax_out=0.8678 discrete_mse=794.797180 best_discrete=172.889572 hash=False elapsed=59.1s
step   675/900 tau=0.0722 loss=0.314366 mse_soft=0.313956 ent_in=1.0908 ent_out=0.2753 rowmax_in=0.5100 rowmax_out=0.8632 discrete_mse=129.785019 best_discrete=129.785019 hash=False elapsed=61.5s
step   700/900 tau=0.0655 loss=0.357813 mse_soft=0.357445 ent_in=0.9738 ent_out=0.2533 rowmax_in=0.5763 rowmax_out=0.8611 discrete_mse=279.195526 best_discrete=129.785019 hash=False elapsed=63.8s
step   725/900 tau=0.0594 loss=0.338266 mse_soft=0.337959 ent_in=0.8207 ent_out=0.2046 rowmax_in=0.6152 rowmax_out=0.8868 discrete_mse=1.326775 best_discrete=1.326775 hash=False elapsed=66.2s
step   750/900 tau=0.0539 loss=0.325955 mse_soft=0.325665 ent_in=0.7661 ent_out=0.2022 rowmax_in=0.6263 rowmax_out=0.8879 discrete_mse=1.634712 best_discrete=1.326775 hash=False elapsed=68.4s
step   775/900 tau=0.0489 loss=0.354856 mse_soft=0.354586 ent_in=0.7233 ent_out=0.1785 rowmax_in=0.6452 rowmax_out=0.9035 discrete_mse=49.797134 best_discrete=1.326775 hash=False elapsed=70.5s
step   800/900 tau=0.0443 loss=0.463497 mse_soft=0.463329 ent_in=0.4158 ent_out=0.1441 rowmax_in=0.7868 rowmax_out=0.9217 discrete_mse=1.108317 best_discrete=1.108317 hash=False elapsed=72.5s
step   825/900 tau=0.0402 loss=0.417258 mse_soft=0.417099 ent_in=0.4045 ent_out=0.1249 rowmax_in=0.8093 rowmax_out=0.9297 discrete_mse=3.652837 best_discrete=1.108317 hash=False elapsed=74.5s
step   850/900 tau=0.0365 loss=0.404477 mse_soft=0.404311 ent_in=0.4264 ent_out=0.1267 rowmax_in=0.7922 rowmax_out=0.9288 discrete_mse=3.676422 best_discrete=1.108317 hash=False elapsed=76.5s
step   875/900 tau=0.0331 loss=0.398423 mse_soft=0.398250 ent_in=0.4351 ent_out=0.1403 rowmax_in=0.7828 rowmax_out=0.9225 discrete_mse=20.636976 best_discrete=1.108317 hash=False elapsed=78.5s
step   900/900 tau=0.0300 loss=0.403133 mse_soft=0.402970 ent_in=0.4346 ent_out=0.1091 rowmax_in=0.7785 rowmax_out=0.9373 discrete_mse=17.986216 best_discrete=1.108317 hash=False elapsed=80.5s

Final metrics:
  soft_mse_full=0.396053
  rowmax_in_mean=0.7756
  rowmax_out_mean=0.9373
  ent_in_mean=0.4351
  ent_out_mean=0.1092
  final_discrete_mse=20.636976
  hash_match=False
  best_discrete_mse_seen=1.108317
Saved results to overnight_b090_j1.json
