Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.068573 mse_soft=1.066251 ent_in=3.8712 ent_out=3.8711 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=263.887512 best_discrete=263.887512 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.863248 mse_soft=0.861057 ent_in=3.6347 ent_out=3.6677 rowmax_in=0.0453 rowmax_out=0.0436 discrete_mse=4165.183105 best_discrete=263.887512 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.640740 mse_soft=0.638836 ent_in=3.1330 ent_out=3.2138 rowmax_in=0.0948 rowmax_out=0.0891 discrete_mse=141.395844 best_discrete=141.395844 hash=False elapsed=5.3s
step    75/900 tau=0.7450 loss=0.505494 mse_soft=0.503908 ent_in=2.6130 ent_out=2.6752 rowmax_in=0.2030 rowmax_out=0.1919 discrete_mse=1521.191528 best_discrete=141.395844 hash=False elapsed=7.4s
step   100/900 tau=0.6745 loss=0.391146 mse_soft=0.389985 ent_in=1.9760 ent_out=1.8948 rowmax_in=0.3650 rowmax_out=0.4093 discrete_mse=6517.434082 best_discrete=141.395844 hash=False elapsed=9.7s
step   125/900 tau=0.6107 loss=0.321367 mse_soft=0.320565 ent_in=1.5321 ent_out=1.1422 rowmax_in=0.4680 rowmax_out=0.6526 discrete_mse=1160.863525 best_discrete=141.395844 hash=False elapsed=12.0s
step   150/900 tau=0.5529 loss=0.294343 mse_soft=0.293722 ent_in=1.3744 ent_out=0.6964 rowmax_in=0.4900 rowmax_out=0.7911 discrete_mse=533.926758 best_discrete=141.395844 hash=False elapsed=14.2s
step   175/900 tau=0.5006 loss=0.279767 mse_soft=0.279221 ent_in=1.2945 ent_out=0.5264 rowmax_in=0.4984 rowmax_out=0.8231 discrete_mse=386.521576 best_discrete=141.395844 hash=False elapsed=16.3s
step   200/900 tau=0.4532 loss=0.273211 mse_soft=0.272722 ent_in=1.2141 ent_out=0.4148 rowmax_in=0.5112 rowmax_out=0.8457 discrete_mse=90.421806 best_discrete=90.421806 hash=False elapsed=18.7s
step   225/900 tau=0.4103 loss=0.266807 mse_soft=0.266344 ent_in=1.1785 ent_out=0.3635 rowmax_in=0.5159 rowmax_out=0.8558 discrete_mse=35.948193 best_discrete=35.948193 hash=False elapsed=20.7s
step   250/900 tau=0.3715 loss=0.264215 mse_soft=0.263767 ent_in=1.1479 ent_out=0.3443 rowmax_in=0.5223 rowmax_out=0.8568 discrete_mse=35.948193 best_discrete=35.948193 hash=False elapsed=22.8s
step   275/900 tau=0.3363 loss=0.261477 mse_soft=0.261034 ent_in=1.1361 ent_out=0.3397 rowmax_in=0.5243 rowmax_out=0.8562 discrete_mse=35.948193 best_discrete=35.948193 hash=False elapsed=25.2s
step   300/900 tau=0.3045 loss=0.261495 mse_soft=0.261058 ent_in=1.1251 ent_out=0.3304 rowmax_in=0.5251 rowmax_out=0.8578 discrete_mse=160.662857 best_discrete=35.948193 hash=False elapsed=27.4s
step   325/900 tau=0.2756 loss=0.260275 mse_soft=0.259844 ent_in=1.1133 ent_out=0.3253 rowmax_in=0.5267 rowmax_out=0.8597 discrete_mse=167.501205 best_discrete=35.948193 hash=False elapsed=29.6s
step   350/900 tau=0.2496 loss=0.257665 mse_soft=0.257238 ent_in=1.1032 ent_out=0.3216 rowmax_in=0.5258 rowmax_out=0.8586 discrete_mse=164.327560 best_discrete=35.948193 hash=False elapsed=31.9s
step   375/900 tau=0.2259 loss=0.257068 mse_soft=0.256643 ent_in=1.0953 ent_out=0.3207 rowmax_in=0.5256 rowmax_out=0.8594 discrete_mse=167.501205 best_discrete=35.948193 hash=False elapsed=34.2s
step   400/900 tau=0.2046 loss=0.259728 mse_soft=0.259306 ent_in=1.0894 ent_out=0.3184 rowmax_in=0.5281 rowmax_out=0.8599 discrete_mse=167.501205 best_discrete=35.948193 hash=False elapsed=36.5s
step   425/900 tau=0.1852 loss=0.262695 mse_soft=0.262274 ent_in=1.0844 ent_out=0.3188 rowmax_in=0.5289 rowmax_out=0.8583 discrete_mse=164.327560 best_discrete=35.948193 hash=False elapsed=38.9s
step   450/900 tau=0.1677 loss=0.259440 mse_soft=0.259021 ent_in=1.0798 ent_out=0.3196 rowmax_in=0.5318 rowmax_out=0.8580 discrete_mse=164.327560 best_discrete=35.948193 hash=False elapsed=41.3s
step   475/900 tau=0.1518 loss=0.265290 mse_soft=0.264872 ent_in=1.0792 ent_out=0.3133 rowmax_in=0.5277 rowmax_out=0.8624 discrete_mse=164.327560 best_discrete=35.948193 hash=False elapsed=43.7s
step   500/900 tau=0.1374 loss=0.268548 mse_soft=0.268133 ent_in=1.0771 ent_out=0.3090 rowmax_in=0.5258 rowmax_out=0.8621 discrete_mse=170.006577 best_discrete=35.948193 hash=False elapsed=45.9s
step   525/900 tau=0.1244 loss=0.263392 mse_soft=0.262980 ent_in=1.0673 ent_out=0.3070 rowmax_in=0.5290 rowmax_out=0.8614 discrete_mse=164.327560 best_discrete=35.948193 hash=False elapsed=48.0s
step   550/900 tau=0.1126 loss=0.263436 mse_soft=0.263026 ent_in=1.0573 ent_out=0.3116 rowmax_in=0.5298 rowmax_out=0.8565 discrete_mse=164.327560 best_discrete=35.948193 hash=False elapsed=50.2s
step   575/900 tau=0.1020 loss=0.271954 mse_soft=0.271547 ent_in=1.0583 ent_out=0.2991 rowmax_in=0.5271 rowmax_out=0.8629 discrete_mse=164.327560 best_discrete=35.948193 hash=False elapsed=52.4s
step   600/900 tau=0.0923 loss=0.265288 mse_soft=0.264889 ent_in=1.0319 ent_out=0.2996 rowmax_in=0.5328 rowmax_out=0.8568 discrete_mse=61.487362 best_discrete=35.948193 hash=False elapsed=54.6s
step   625/900 tau=0.0836 loss=0.265642 mse_soft=0.265248 ent_in=1.0195 ent_out=0.2942 rowmax_in=0.5324 rowmax_out=0.8569 discrete_mse=192.604889 best_discrete=35.948193 hash=False elapsed=56.8s
step   650/900 tau=0.0757 loss=0.259560 mse_soft=0.259164 ent_in=1.0243 ent_out=0.2930 rowmax_in=0.5333 rowmax_out=0.8601 discrete_mse=102.493576 best_discrete=35.948193 hash=False elapsed=59.0s
step   675/900 tau=0.0685 loss=0.301431 mse_soft=0.301126 ent_in=0.7938 ent_out=0.2200 rowmax_in=0.6307 rowmax_out=0.9018 discrete_mse=80.495522 best_discrete=35.948193 hash=False elapsed=61.3s
step   700/900 tau=0.0620 loss=0.279724 mse_soft=0.279420 ent_in=0.7682 ent_out=0.2447 rowmax_in=0.6332 rowmax_out=0.8843 discrete_mse=96.004944 best_discrete=35.948193 hash=False elapsed=63.6s
step   725/900 tau=0.0562 loss=0.285612 mse_soft=0.285314 ent_in=0.7765 ent_out=0.2192 rowmax_in=0.6343 rowmax_out=0.8974 discrete_mse=96.004944 best_discrete=35.948193 hash=False elapsed=65.9s
step   750/900 tau=0.0508 loss=0.416839 mse_soft=0.416555 ent_in=0.7249 ent_out=0.2218 rowmax_in=0.6753 rowmax_out=0.8958 discrete_mse=173.191971 best_discrete=35.948193 hash=False elapsed=68.1s
step   775/900 tau=0.0460 loss=0.326931 mse_soft=0.326685 ent_in=0.6589 ent_out=0.1626 rowmax_in=0.6579 rowmax_out=0.9286 discrete_mse=70.632301 best_discrete=35.948193 hash=False elapsed=70.5s
step   800/900 tau=0.0417 loss=0.307175 mse_soft=0.306928 ent_in=0.6614 ent_out=0.1618 rowmax_in=0.6571 rowmax_out=0.9326 discrete_mse=70.718132 best_discrete=35.948193 hash=False elapsed=73.0s
step   825/900 tau=0.0377 loss=0.561453 mse_soft=0.561322 ent_in=0.3488 ent_out=0.0886 rowmax_in=0.8474 rowmax_out=0.9582 discrete_mse=22.836292 best_discrete=22.836292 hash=False elapsed=75.2s
step   850/900 tau=0.0342 loss=0.494907 mse_soft=0.494795 ent_in=0.3031 ent_out=0.0715 rowmax_in=0.8475 rowmax_out=0.9607 discrete_mse=55.909500 best_discrete=22.836292 hash=False elapsed=77.3s
step   875/900 tau=0.0309 loss=0.550089 mse_soft=0.549982 ent_in=0.3016 ent_out=0.0565 rowmax_in=0.8517 rowmax_out=0.9674 discrete_mse=27.987230 best_discrete=22.836292 hash=False elapsed=79.4s
step   900/900 tau=0.0280 loss=0.520279 mse_soft=0.520177 ent_in=0.2611 ent_out=0.0786 rowmax_in=0.8636 rowmax_out=0.9541 discrete_mse=9.886330 best_discrete=9.886330 hash=False elapsed=81.6s

Final metrics:
  soft_mse_full=0.522790
  rowmax_in_mean=0.8611
  rowmax_out_mean=0.9541
  ent_in_mean=0.2624
  ent_out_mean=0.0785
  final_discrete_mse=9.886330
  hash_match=False
  best_discrete_mse_seen=9.886330
Saved results to overnight_b227_j2.json
