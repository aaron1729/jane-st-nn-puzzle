Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.084732 mse_soft=1.082409 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=85.386780 best_discrete=85.386780 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.874575 mse_soft=0.872385 ent_in=3.6330 ent_out=3.6672 rowmax_in=0.0454 rowmax_out=0.0439 discrete_mse=1704.068359 best_discrete=85.386780 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.656850 mse_soft=0.654940 ent_in=3.1378 ent_out=3.2287 rowmax_in=0.0927 rowmax_out=0.0868 discrete_mse=605.818909 best_discrete=85.386780 hash=False elapsed=5.3s
step    75/900 tau=0.7450 loss=0.516637 mse_soft=0.515050 ent_in=2.6203 ent_out=2.6692 rowmax_in=0.2038 rowmax_out=0.2070 discrete_mse=690.845032 best_discrete=85.386780 hash=False elapsed=7.7s
step   100/900 tau=0.6745 loss=0.409652 mse_soft=0.408505 ent_in=1.9934 ent_out=1.8308 rowmax_in=0.3548 rowmax_out=0.4204 discrete_mse=1867.161133 best_discrete=85.386780 hash=False elapsed=10.3s
step   125/900 tau=0.6107 loss=0.360912 mse_soft=0.360047 ent_in=1.6374 ent_out=1.2481 rowmax_in=0.4228 rowmax_out=0.5837 discrete_mse=343.236267 best_discrete=85.386780 hash=False elapsed=12.8s
step   150/900 tau=0.5529 loss=0.333597 mse_soft=0.332889 ent_in=1.4543 ent_out=0.9063 rowmax_in=0.4589 rowmax_out=0.6759 discrete_mse=371.547180 best_discrete=85.386780 hash=False elapsed=15.3s
step   175/900 tau=0.5006 loss=0.316171 mse_soft=0.315571 ent_in=1.3423 ent_out=0.6548 rowmax_in=0.4768 rowmax_out=0.7545 discrete_mse=782.725159 best_discrete=85.386780 hash=False elapsed=17.7s
step   200/900 tau=0.4532 loss=0.304833 mse_soft=0.304295 ent_in=1.2449 ent_out=0.5461 rowmax_in=0.4984 rowmax_out=0.7879 discrete_mse=143.141052 best_discrete=85.386780 hash=False elapsed=20.3s
step   225/900 tau=0.4103 loss=0.298918 mse_soft=0.298408 ent_in=1.2048 ent_out=0.4938 rowmax_in=0.5062 rowmax_out=0.8084 discrete_mse=222.498749 best_discrete=85.386780 hash=False elapsed=22.8s
step   250/900 tau=0.3715 loss=0.291373 mse_soft=0.290884 ent_in=1.1905 ent_out=0.4395 rowmax_in=0.5086 rowmax_out=0.8256 discrete_mse=72.458496 best_discrete=72.458496 hash=False elapsed=25.2s
step   275/900 tau=0.3363 loss=0.289073 mse_soft=0.288604 ent_in=1.1670 ent_out=0.3955 rowmax_in=0.5117 rowmax_out=0.8369 discrete_mse=71.410011 best_discrete=71.410011 hash=False elapsed=27.7s
step   300/900 tau=0.3045 loss=0.286689 mse_soft=0.286230 ent_in=1.1598 ent_out=0.3701 rowmax_in=0.5114 rowmax_out=0.8434 discrete_mse=111.529457 best_discrete=71.410011 hash=False elapsed=30.1s
step   325/900 tau=0.2756 loss=0.285588 mse_soft=0.285138 ent_in=1.1519 ent_out=0.3499 rowmax_in=0.5096 rowmax_out=0.8511 discrete_mse=111.529457 best_discrete=71.410011 hash=False elapsed=32.6s
step   350/900 tau=0.2496 loss=0.285276 mse_soft=0.284830 ent_in=1.1429 ent_out=0.3433 rowmax_in=0.5105 rowmax_out=0.8550 discrete_mse=110.811996 best_discrete=71.410011 hash=False elapsed=34.8s
step   375/900 tau=0.2259 loss=0.287396 mse_soft=0.286949 ent_in=1.1386 ent_out=0.3508 rowmax_in=0.5089 rowmax_out=0.8499 discrete_mse=110.811996 best_discrete=71.410011 hash=False elapsed=36.9s
step   400/900 tau=0.2046 loss=0.284757 mse_soft=0.284313 ent_in=1.1289 ent_out=0.3487 rowmax_in=0.5130 rowmax_out=0.8529 discrete_mse=65.306740 best_discrete=65.306740 hash=False elapsed=39.2s
step   425/900 tau=0.1852 loss=0.281873 mse_soft=0.281433 ent_in=1.1260 ent_out=0.3388 rowmax_in=0.5111 rowmax_out=0.8551 discrete_mse=48.846355 best_discrete=48.846355 hash=False elapsed=41.5s
step   450/900 tau=0.1677 loss=0.287343 mse_soft=0.286907 ent_in=1.1228 ent_out=0.3311 rowmax_in=0.5087 rowmax_out=0.8568 discrete_mse=72.806549 best_discrete=48.846355 hash=False elapsed=44.0s
step   475/900 tau=0.1518 loss=0.286601 mse_soft=0.286170 ent_in=1.1123 ent_out=0.3250 rowmax_in=0.5130 rowmax_out=0.8590 discrete_mse=82.442322 best_discrete=48.846355 hash=False elapsed=46.2s
step   500/900 tau=0.1374 loss=0.281418 mse_soft=0.280990 ent_in=1.1069 ent_out=0.3182 rowmax_in=0.5103 rowmax_out=0.8609 discrete_mse=82.442322 best_discrete=48.846355 hash=False elapsed=48.6s
step   525/900 tau=0.1244 loss=0.326578 mse_soft=0.326155 ent_in=1.0973 ent_out=0.3120 rowmax_in=0.5141 rowmax_out=0.8605 discrete_mse=102.059494 best_discrete=48.846355 hash=False elapsed=51.2s
step   550/900 tau=0.1126 loss=0.297026 mse_soft=0.296620 ent_in=1.0453 ent_out=0.3072 rowmax_in=0.5334 rowmax_out=0.8525 discrete_mse=495.539001 best_discrete=48.846355 hash=False elapsed=53.6s
step   575/900 tau=0.1020 loss=0.283927 mse_soft=0.283526 ent_in=1.0346 ent_out=0.3010 rowmax_in=0.5316 rowmax_out=0.8563 discrete_mse=527.325378 best_discrete=48.846355 hash=False elapsed=56.1s
step   600/900 tau=0.0923 loss=0.286242 mse_soft=0.285845 ent_in=1.0279 ent_out=0.2946 rowmax_in=0.5352 rowmax_out=0.8612 discrete_mse=238.906296 best_discrete=48.846355 hash=False elapsed=58.5s
step   625/900 tau=0.0836 loss=0.289513 mse_soft=0.289120 ent_in=1.0159 ent_out=0.2945 rowmax_in=0.5347 rowmax_out=0.8658 discrete_mse=277.105743 best_discrete=48.846355 hash=False elapsed=61.0s
step   650/900 tau=0.0757 loss=0.326579 mse_soft=0.326195 ent_in=0.9906 ent_out=0.2899 rowmax_in=0.5542 rowmax_out=0.8686 discrete_mse=65.547562 best_discrete=48.846355 hash=False elapsed=63.6s
step   675/900 tau=0.0685 loss=0.314547 mse_soft=0.314189 ent_in=0.9296 ent_out=0.2623 rowmax_in=0.5688 rowmax_out=0.8715 discrete_mse=166.405106 best_discrete=48.846355 hash=False elapsed=66.0s
step   700/900 tau=0.0620 loss=0.315794 mse_soft=0.315447 ent_in=0.8926 ent_out=0.2650 rowmax_in=0.5854 rowmax_out=0.8774 discrete_mse=33.077000 best_discrete=33.077000 hash=False elapsed=68.5s
step   725/900 tau=0.0562 loss=0.419155 mse_soft=0.418872 ent_in=0.7029 ent_out=0.2401 rowmax_in=0.6748 rowmax_out=0.8837 discrete_mse=55.631317 best_discrete=33.077000 hash=False elapsed=70.9s
step   750/900 tau=0.0508 loss=0.471214 mse_soft=0.471005 ent_in=0.4536 ent_out=0.2409 rowmax_in=0.8002 rowmax_out=0.8726 discrete_mse=31.981478 best_discrete=31.981478 hash=False elapsed=73.3s
step   775/900 tau=0.0460 loss=0.399879 mse_soft=0.399704 ent_in=0.3555 ent_out=0.2265 rowmax_in=0.8372 rowmax_out=0.8836 discrete_mse=40.958450 best_discrete=31.981478 hash=False elapsed=75.5s
step   800/900 tau=0.0417 loss=0.390397 mse_soft=0.390226 ent_in=0.3422 ent_out=0.2257 rowmax_in=0.8422 rowmax_out=0.8854 discrete_mse=72.713516 best_discrete=31.981478 hash=False elapsed=77.9s
step   825/900 tau=0.0377 loss=0.392489 mse_soft=0.392311 ent_in=0.3626 ent_out=0.2291 rowmax_in=0.8339 rowmax_out=0.8844 discrete_mse=57.222992 best_discrete=31.981478 hash=False elapsed=80.3s
step   850/900 tau=0.0342 loss=0.382711 mse_soft=0.382524 ent_in=0.3898 ent_out=0.2349 rowmax_in=0.8138 rowmax_out=0.8803 discrete_mse=72.713516 best_discrete=31.981478 hash=False elapsed=82.8s
step   875/900 tau=0.0309 loss=0.403783 mse_soft=0.403605 ent_in=0.3634 ent_out=0.2312 rowmax_in=0.8304 rowmax_out=0.8820 discrete_mse=78.746063 best_discrete=31.981478 hash=False elapsed=85.0s
step   900/900 tau=0.0280 loss=0.380428 mse_soft=0.380245 ent_in=0.3771 ent_out=0.2312 rowmax_in=0.8202 rowmax_out=0.8829 discrete_mse=124.465149 best_discrete=31.981478 hash=False elapsed=87.5s

Final metrics:
  soft_mse_full=0.381912
  rowmax_in_mean=0.8164
  rowmax_out_mean=0.8832
  ent_in_mean=0.3810
  ent_out_mean=0.2305
  final_discrete_mse=57.222992
  hash_match=False
  best_discrete_mse_seen=31.981478
Saved results to overnight_b139_j2.json
