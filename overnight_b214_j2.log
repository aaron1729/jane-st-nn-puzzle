Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.061172 mse_soft=1.058849 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=10.774059 best_discrete=10.774059 hash=False elapsed=0.6s
step    25/900 tau=0.9090 loss=0.856525 mse_soft=0.854335 ent_in=3.6323 ent_out=3.6678 rowmax_in=0.0462 rowmax_out=0.0438 discrete_mse=908.521484 best_discrete=10.774059 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.647067 mse_soft=0.645158 ent_in=3.1350 ent_out=3.2259 rowmax_in=0.0936 rowmax_out=0.0882 discrete_mse=724.853821 best_discrete=10.774059 hash=False elapsed=5.2s
step    75/900 tau=0.7450 loss=0.510743 mse_soft=0.509146 ent_in=2.6280 ent_out=2.6929 rowmax_in=0.1972 rowmax_out=0.1930 discrete_mse=1676.751587 best_discrete=10.774059 hash=False elapsed=7.9s
step   100/900 tau=0.6745 loss=0.404706 mse_soft=0.403533 ent_in=2.0184 ent_out=1.8925 rowmax_in=0.3366 rowmax_out=0.4065 discrete_mse=276.853851 best_discrete=10.774059 hash=False elapsed=10.6s
step   125/900 tau=0.6107 loss=0.343006 mse_soft=0.342143 ent_in=1.6940 ent_out=1.1826 rowmax_in=0.4032 rowmax_out=0.6156 discrete_mse=2210.804443 best_discrete=10.774059 hash=False elapsed=13.1s
step   150/900 tau=0.5529 loss=0.317291 mse_soft=0.316592 ent_in=1.5359 ent_out=0.7967 rowmax_in=0.4190 rowmax_out=0.6999 discrete_mse=1700.301392 best_discrete=10.774059 hash=False elapsed=15.8s
step   175/900 tau=0.5006 loss=0.305731 mse_soft=0.305102 ent_in=1.4578 ent_out=0.6397 rowmax_in=0.4342 rowmax_out=0.7466 discrete_mse=359.979309 best_discrete=10.774059 hash=False elapsed=18.4s
step   200/900 tau=0.4532 loss=0.295409 mse_soft=0.294824 ent_in=1.4116 ent_out=0.5391 rowmax_in=0.4400 rowmax_out=0.7868 discrete_mse=456.326385 best_discrete=10.774059 hash=False elapsed=20.9s
step   225/900 tau=0.4103 loss=0.286235 mse_soft=0.285696 ent_in=1.3575 ent_out=0.4410 rowmax_in=0.4461 rowmax_out=0.8182 discrete_mse=2280.823486 best_discrete=10.774059 hash=False elapsed=23.5s
step   250/900 tau=0.3715 loss=0.283246 mse_soft=0.282730 ent_in=1.3214 ent_out=0.4005 rowmax_in=0.4551 rowmax_out=0.8281 discrete_mse=2306.945312 best_discrete=10.774059 hash=False elapsed=25.9s
step   275/900 tau=0.3363 loss=0.281824 mse_soft=0.281321 ent_in=1.2945 ent_out=0.3836 rowmax_in=0.4632 rowmax_out=0.8329 discrete_mse=4133.903809 best_discrete=10.774059 hash=False elapsed=28.4s
step   300/900 tau=0.3045 loss=0.278610 mse_soft=0.278117 ent_in=1.2749 ent_out=0.3664 rowmax_in=0.4677 rowmax_out=0.8395 discrete_mse=4133.903809 best_discrete=10.774059 hash=False elapsed=31.2s
step   325/900 tau=0.2756 loss=0.278850 mse_soft=0.278365 ent_in=1.2702 ent_out=0.3471 rowmax_in=0.4656 rowmax_out=0.8457 discrete_mse=3738.583984 best_discrete=10.774059 hash=False elapsed=33.7s
step   350/900 tau=0.2496 loss=0.276873 mse_soft=0.276392 ent_in=1.2621 ent_out=0.3399 rowmax_in=0.4640 rowmax_out=0.8426 discrete_mse=3738.583984 best_discrete=10.774059 hash=False elapsed=36.2s
step   375/900 tau=0.2259 loss=0.274924 mse_soft=0.274448 ent_in=1.2556 ent_out=0.3310 rowmax_in=0.4669 rowmax_out=0.8445 discrete_mse=2740.900635 best_discrete=10.774059 hash=False elapsed=38.4s
step   400/900 tau=0.2046 loss=0.277401 mse_soft=0.276929 ent_in=1.2457 ent_out=0.3299 rowmax_in=0.4689 rowmax_out=0.8452 discrete_mse=2740.900635 best_discrete=10.774059 hash=False elapsed=40.9s
step   425/900 tau=0.1852 loss=0.276075 mse_soft=0.275604 ent_in=1.2408 ent_out=0.3277 rowmax_in=0.4682 rowmax_out=0.8474 discrete_mse=2740.900635 best_discrete=10.774059 hash=False elapsed=43.2s
step   450/900 tau=0.1677 loss=0.277043 mse_soft=0.276572 ent_in=1.2418 ent_out=0.3267 rowmax_in=0.4674 rowmax_out=0.8458 discrete_mse=2807.417236 best_discrete=10.774059 hash=False elapsed=45.6s
step   475/900 tau=0.1518 loss=0.280828 mse_soft=0.280359 ent_in=1.2363 ent_out=0.3250 rowmax_in=0.4686 rowmax_out=0.8465 discrete_mse=2740.900635 best_discrete=10.774059 hash=False elapsed=48.1s
step   500/900 tau=0.1374 loss=0.281164 mse_soft=0.280697 ent_in=1.2320 ent_out=0.3252 rowmax_in=0.4698 rowmax_out=0.8448 discrete_mse=2085.121094 best_discrete=10.774059 hash=False elapsed=50.6s
step   525/900 tau=0.1244 loss=0.277880 mse_soft=0.277412 ent_in=1.2326 ent_out=0.3258 rowmax_in=0.4690 rowmax_out=0.8434 discrete_mse=3165.275879 best_discrete=10.774059 hash=False elapsed=53.2s
step   550/900 tau=0.1126 loss=0.278326 mse_soft=0.277859 ent_in=1.2311 ent_out=0.3280 rowmax_in=0.4694 rowmax_out=0.8421 discrete_mse=2380.451660 best_discrete=10.774059 hash=False elapsed=55.8s
step   575/900 tau=0.1020 loss=0.288713 mse_soft=0.288248 ent_in=1.2243 ent_out=0.3259 rowmax_in=0.4705 rowmax_out=0.8438 discrete_mse=6220.994141 best_discrete=10.774059 hash=False elapsed=58.2s
step   600/900 tau=0.0923 loss=0.287674 mse_soft=0.287209 ent_in=1.2295 ent_out=0.3231 rowmax_in=0.4684 rowmax_out=0.8447 discrete_mse=8007.006836 best_discrete=10.774059 hash=False elapsed=60.6s
step   625/900 tau=0.0836 loss=0.482543 mse_soft=0.482087 ent_in=1.1960 ent_out=0.3228 rowmax_in=0.4911 rowmax_out=0.8439 discrete_mse=569.041687 best_discrete=10.774059 hash=False elapsed=62.8s
step   650/900 tau=0.0757 loss=0.443433 mse_soft=0.443085 ent_in=0.9459 ent_out=0.2138 rowmax_in=0.5682 rowmax_out=0.8963 discrete_mse=306.205353 best_discrete=10.774059 hash=False elapsed=65.2s
step   675/900 tau=0.0685 loss=0.309059 mse_soft=0.308729 ent_in=0.8775 ent_out=0.2213 rowmax_in=0.5760 rowmax_out=0.9005 discrete_mse=710.302795 best_discrete=10.774059 hash=False elapsed=67.5s
step   700/900 tau=0.0620 loss=0.299148 mse_soft=0.298820 ent_in=0.8718 ent_out=0.2191 rowmax_in=0.5857 rowmax_out=0.9064 discrete_mse=1108.179321 best_discrete=10.774059 hash=False elapsed=70.1s
step   725/900 tau=0.0562 loss=0.419385 mse_soft=0.419155 ent_in=0.5822 ent_out=0.1861 rowmax_in=0.7321 rowmax_out=0.9178 discrete_mse=7.654014 best_discrete=7.654014 hash=False elapsed=72.6s
step   750/900 tau=0.0508 loss=0.381267 mse_soft=0.381063 ent_in=0.5036 ent_out=0.1776 rowmax_in=0.7471 rowmax_out=0.9212 discrete_mse=9.114180 best_discrete=7.654014 hash=False elapsed=75.0s
step   775/900 tau=0.0460 loss=0.364063 mse_soft=0.363860 ent_in=0.4910 ent_out=0.1847 rowmax_in=0.7412 rowmax_out=0.9117 discrete_mse=33.648964 best_discrete=7.654014 hash=False elapsed=77.5s
step   800/900 tau=0.0417 loss=0.359207 mse_soft=0.359001 ent_in=0.4865 ent_out=0.1978 rowmax_in=0.7484 rowmax_out=0.8960 discrete_mse=1.782021 best_discrete=1.782021 hash=False elapsed=80.0s
step   825/900 tau=0.0377 loss=0.384902 mse_soft=0.384701 ent_in=0.4883 ent_out=0.1831 rowmax_in=0.7482 rowmax_out=0.9102 discrete_mse=5.356881 best_discrete=1.782021 hash=False elapsed=82.6s
step   850/900 tau=0.0342 loss=0.432508 mse_soft=0.432342 ent_in=0.3903 ent_out=0.1623 rowmax_in=0.7961 rowmax_out=0.9218 discrete_mse=6.829887 best_discrete=1.782021 hash=False elapsed=85.1s
step   875/900 tau=0.0309 loss=0.405434 mse_soft=0.405282 ent_in=0.3510 ent_out=0.1563 rowmax_in=0.8147 rowmax_out=0.9307 discrete_mse=1.045324 best_discrete=1.045324 hash=False elapsed=87.5s
step   900/900 tau=0.0280 loss=0.390720 mse_soft=0.390564 ent_in=0.3730 ent_out=0.1440 rowmax_in=0.7937 rowmax_out=0.9308 discrete_mse=1.045324 best_discrete=1.045324 hash=False elapsed=90.1s

Final metrics:
  soft_mse_full=0.402185
  rowmax_in_mean=0.7927
  rowmax_out_mean=0.9288
  ent_in_mean=0.3733
  ent_out_mean=0.1465
  final_discrete_mse=1.045324
  hash_match=False
  best_discrete_mse_seen=1.045324
Saved results to overnight_b214_j2.json
