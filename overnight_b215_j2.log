Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.086570 mse_soft=1.084247 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=37.776718 best_discrete=37.776718 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.884240 mse_soft=0.882050 ent_in=3.6334 ent_out=3.6685 rowmax_in=0.0459 rowmax_out=0.0433 discrete_mse=6042.174316 best_discrete=37.776718 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.671054 mse_soft=0.669149 ent_in=3.1251 ent_out=3.2262 rowmax_in=0.0950 rowmax_out=0.0883 discrete_mse=1698.682617 best_discrete=37.776718 hash=False elapsed=5.2s
step    75/900 tau=0.7450 loss=0.530356 mse_soft=0.528771 ent_in=2.5924 ent_out=2.6908 rowmax_in=0.2019 rowmax_out=0.1917 discrete_mse=26.022131 best_discrete=26.022131 hash=False elapsed=7.7s
step   100/900 tau=0.6745 loss=0.417498 mse_soft=0.416322 ent_in=2.0570 ent_out=1.8641 rowmax_in=0.3362 rowmax_out=0.4135 discrete_mse=929.122375 best_discrete=26.022131 hash=False elapsed=10.1s
step   125/900 tau=0.6107 loss=0.344206 mse_soft=0.343386 ent_in=1.6212 ent_out=1.1128 rowmax_in=0.4412 rowmax_out=0.6545 discrete_mse=653.339111 best_discrete=26.022131 hash=False elapsed=12.3s
step   150/900 tau=0.5529 loss=0.315757 mse_soft=0.315078 ent_in=1.4447 ent_out=0.8176 rowmax_in=0.4617 rowmax_out=0.7174 discrete_mse=1370.844604 best_discrete=26.022131 hash=False elapsed=14.4s
step   175/900 tau=0.5006 loss=0.302772 mse_soft=0.302170 ent_in=1.3477 ent_out=0.6576 rowmax_in=0.4778 rowmax_out=0.7548 discrete_mse=939.397705 best_discrete=26.022131 hash=False elapsed=16.5s
step   200/900 tau=0.4532 loss=0.293469 mse_soft=0.292902 ent_in=1.3161 ent_out=0.5727 rowmax_in=0.4783 rowmax_out=0.7783 discrete_mse=1725.968994 best_discrete=26.022131 hash=False elapsed=18.8s
step   225/900 tau=0.4103 loss=0.287451 mse_soft=0.286917 ent_in=1.2669 ent_out=0.5159 rowmax_in=0.4840 rowmax_out=0.7942 discrete_mse=1650.292725 best_discrete=26.022131 hash=False elapsed=21.1s
step   250/900 tau=0.3715 loss=0.283036 mse_soft=0.282527 ent_in=1.2373 ent_out=0.4589 rowmax_in=0.4898 rowmax_out=0.8124 discrete_mse=1426.540161 best_discrete=26.022131 hash=False elapsed=23.3s
step   275/900 tau=0.3363 loss=0.279702 mse_soft=0.279215 ent_in=1.2128 ent_out=0.4117 rowmax_in=0.4942 rowmax_out=0.8282 discrete_mse=1426.540161 best_discrete=26.022131 hash=False elapsed=25.5s
step   300/900 tau=0.3045 loss=0.277806 mse_soft=0.277332 ent_in=1.1958 ent_out=0.3836 rowmax_in=0.4960 rowmax_out=0.8355 discrete_mse=4397.245605 best_discrete=26.022131 hash=False elapsed=27.8s
step   325/900 tau=0.2756 loss=0.276618 mse_soft=0.276154 ent_in=1.1846 ent_out=0.3628 rowmax_in=0.4962 rowmax_out=0.8406 discrete_mse=2807.293457 best_discrete=26.022131 hash=False elapsed=30.1s
step   350/900 tau=0.2496 loss=0.278415 mse_soft=0.277958 ent_in=1.1776 ent_out=0.3463 rowmax_in=0.4945 rowmax_out=0.8449 discrete_mse=2385.075439 best_discrete=26.022131 hash=False elapsed=32.3s
step   375/900 tau=0.2259 loss=0.275696 mse_soft=0.275245 ent_in=1.1723 ent_out=0.3315 rowmax_in=0.4970 rowmax_out=0.8499 discrete_mse=2385.075439 best_discrete=26.022131 hash=False elapsed=34.7s
step   400/900 tau=0.2046 loss=0.277693 mse_soft=0.277246 ent_in=1.1693 ent_out=0.3198 rowmax_in=0.4967 rowmax_out=0.8544 discrete_mse=2385.075439 best_discrete=26.022131 hash=False elapsed=37.1s
step   425/900 tau=0.1852 loss=0.278023 mse_soft=0.277579 ent_in=1.1673 ent_out=0.3129 rowmax_in=0.4961 rowmax_out=0.8555 discrete_mse=781.919373 best_discrete=26.022131 hash=False elapsed=39.3s
step   450/900 tau=0.1677 loss=0.276207 mse_soft=0.275768 ent_in=1.1567 ent_out=0.3069 rowmax_in=0.5008 rowmax_out=0.8574 discrete_mse=749.018860 best_discrete=26.022131 hash=False elapsed=41.5s
step   475/900 tau=0.1518 loss=0.274914 mse_soft=0.274478 ent_in=1.1516 ent_out=0.3025 rowmax_in=0.5004 rowmax_out=0.8581 discrete_mse=781.919373 best_discrete=26.022131 hash=False elapsed=43.7s
step   500/900 tau=0.1374 loss=0.274986 mse_soft=0.274554 ent_in=1.1415 ent_out=0.2989 rowmax_in=0.5023 rowmax_out=0.8596 discrete_mse=951.589355 best_discrete=26.022131 hash=False elapsed=46.0s
step   525/900 tau=0.1244 loss=0.274817 mse_soft=0.274388 ent_in=1.1324 ent_out=0.2959 rowmax_in=0.5053 rowmax_out=0.8604 discrete_mse=1173.960205 best_discrete=26.022131 hash=False elapsed=48.0s
step   550/900 tau=0.1126 loss=0.286638 mse_soft=0.286212 ent_in=1.1288 ent_out=0.2888 rowmax_in=0.5047 rowmax_out=0.8640 discrete_mse=950.577393 best_discrete=26.022131 hash=False elapsed=50.1s
step   575/900 tau=0.1020 loss=0.279087 mse_soft=0.278666 ent_in=1.1152 ent_out=0.2872 rowmax_in=0.5120 rowmax_out=0.8641 discrete_mse=3121.593018 best_discrete=26.022131 hash=False elapsed=52.3s
step   600/900 tau=0.0923 loss=0.277562 mse_soft=0.277145 ent_in=1.1073 ent_out=0.2814 rowmax_in=0.5125 rowmax_out=0.8685 discrete_mse=1778.693726 best_discrete=26.022131 hash=False elapsed=54.5s
step   625/900 tau=0.0836 loss=0.286176 mse_soft=0.285767 ent_in=1.0842 ent_out=0.2792 rowmax_in=0.5210 rowmax_out=0.8720 discrete_mse=1347.728638 best_discrete=26.022131 hash=False elapsed=56.7s
step   650/900 tau=0.0757 loss=0.283729 mse_soft=0.283329 ent_in=1.0640 ent_out=0.2692 rowmax_in=0.5230 rowmax_out=0.8784 discrete_mse=1051.910034 best_discrete=26.022131 hash=False elapsed=58.9s
step   675/900 tau=0.0685 loss=0.336654 mse_soft=0.336258 ent_in=1.0590 ent_out=0.2629 rowmax_in=0.5177 rowmax_out=0.8803 discrete_mse=534.780823 best_discrete=26.022131 hash=False elapsed=60.9s
step   700/900 tau=0.0620 loss=0.312801 mse_soft=0.312445 ent_in=0.9661 ent_out=0.2206 rowmax_in=0.5380 rowmax_out=0.8923 discrete_mse=494.202179 best_discrete=26.022131 hash=False elapsed=63.1s
step   725/900 tau=0.0562 loss=0.304477 mse_soft=0.304147 ent_in=0.8799 ent_out=0.2205 rowmax_in=0.5964 rowmax_out=0.8892 discrete_mse=353.404938 best_discrete=26.022131 hash=False elapsed=65.3s
step   750/900 tau=0.0508 loss=0.291921 mse_soft=0.291593 ent_in=0.8886 ent_out=0.2070 rowmax_in=0.5618 rowmax_out=0.8972 discrete_mse=367.932190 best_discrete=26.022131 hash=False elapsed=67.4s
step   775/900 tau=0.0460 loss=0.328181 mse_soft=0.327857 ent_in=0.8832 ent_out=0.1953 rowmax_in=0.5656 rowmax_out=0.9094 discrete_mse=80.033035 best_discrete=26.022131 hash=False elapsed=69.7s
step   800/900 tau=0.0417 loss=0.305127 mse_soft=0.304828 ent_in=0.8233 ent_out=0.1702 rowmax_in=0.5813 rowmax_out=0.9083 discrete_mse=32.691757 best_discrete=26.022131 hash=False elapsed=71.8s
step   825/900 tau=0.0377 loss=0.516788 mse_soft=0.516559 ent_in=0.6164 ent_out=0.1479 rowmax_in=0.6977 rowmax_out=0.9302 discrete_mse=3.910680 best_discrete=3.910680 hash=False elapsed=74.0s
step   850/900 tau=0.0342 loss=0.496390 mse_soft=0.496283 ent_in=0.2441 ent_out=0.1107 rowmax_in=0.8727 rowmax_out=0.9386 discrete_mse=114.337349 best_discrete=3.910680 hash=False elapsed=76.2s
step   875/900 tau=0.0309 loss=0.465536 mse_soft=0.465427 ent_in=0.2350 ent_out=0.1281 rowmax_in=0.8722 rowmax_out=0.9209 discrete_mse=84.308449 best_discrete=3.910680 hash=False elapsed=78.2s
step   900/900 tau=0.0280 loss=0.462250 mse_soft=0.462142 ent_in=0.2317 ent_out=0.1276 rowmax_in=0.8715 rowmax_out=0.9222 discrete_mse=42.564041 best_discrete=3.910680 hash=False elapsed=80.5s

Final metrics:
  soft_mse_full=0.451118
  rowmax_in_mean=0.8711
  rowmax_out_mean=0.9223
  ent_in_mean=0.2319
  ent_out_mean=0.1276
  final_discrete_mse=42.564041
  hash_match=False
  best_discrete_mse_seen=3.910680
Saved results to overnight_b215_j2.json
