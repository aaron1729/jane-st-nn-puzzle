Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.075067 mse_soft=1.072744 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=60.450947 best_discrete=60.450947 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.872424 mse_soft=0.870233 ent_in=3.6359 ent_out=3.6679 rowmax_in=0.0455 rowmax_out=0.0441 discrete_mse=1917.847900 best_discrete=60.450947 hash=False elapsed=2.7s
step    50/900 tau=0.8229 loss=0.659274 mse_soft=0.657362 ent_in=3.1395 ent_out=3.2371 rowmax_in=0.0942 rowmax_out=0.0892 discrete_mse=1549.668823 best_discrete=60.450947 hash=False elapsed=5.0s
step    75/900 tau=0.7450 loss=0.516657 mse_soft=0.515069 ent_in=2.6056 ent_out=2.6876 rowmax_in=0.2060 rowmax_out=0.1945 discrete_mse=8669.063477 best_discrete=60.450947 hash=False elapsed=7.3s
step   100/900 tau=0.6745 loss=0.407772 mse_soft=0.406589 ent_in=2.0176 ent_out=1.9275 rowmax_in=0.3356 rowmax_out=0.3772 discrete_mse=1323.043701 best_discrete=60.450947 hash=False elapsed=9.7s
step   125/900 tau=0.6107 loss=0.347292 mse_soft=0.346423 ent_in=1.6488 ent_out=1.2476 rowmax_in=0.4244 rowmax_out=0.5967 discrete_mse=436.104126 best_discrete=60.450947 hash=False elapsed=11.8s
step   150/900 tau=0.5529 loss=0.320285 mse_soft=0.319595 ent_in=1.4719 ent_out=0.8276 rowmax_in=0.4557 rowmax_out=0.7203 discrete_mse=893.437988 best_discrete=60.450947 hash=False elapsed=14.1s
step   175/900 tau=0.5006 loss=0.307398 mse_soft=0.306803 ent_in=1.3796 ent_out=0.6053 rowmax_in=0.4692 rowmax_out=0.7948 discrete_mse=1567.004517 best_discrete=60.450947 hash=False elapsed=16.3s
step   200/900 tau=0.4532 loss=0.298077 mse_soft=0.297532 ent_in=1.3132 ent_out=0.5030 rowmax_in=0.4788 rowmax_out=0.8186 discrete_mse=1232.341919 best_discrete=60.450947 hash=False elapsed=18.5s
step   225/900 tau=0.4103 loss=0.292514 mse_soft=0.291999 ent_in=1.2768 ent_out=0.4413 rowmax_in=0.4827 rowmax_out=0.8336 discrete_mse=1597.242798 best_discrete=60.450947 hash=False elapsed=20.6s
step   250/900 tau=0.3715 loss=0.288542 mse_soft=0.288050 ent_in=1.2511 ent_out=0.3907 rowmax_in=0.4854 rowmax_out=0.8464 discrete_mse=1056.771606 best_discrete=60.450947 hash=False elapsed=22.8s
step   275/900 tau=0.3363 loss=0.286572 mse_soft=0.286093 ent_in=1.2296 ent_out=0.3669 rowmax_in=0.4906 rowmax_out=0.8545 discrete_mse=867.126770 best_discrete=60.450947 hash=False elapsed=25.0s
step   300/900 tau=0.3045 loss=0.285084 mse_soft=0.284612 ent_in=1.2135 ent_out=0.3595 rowmax_in=0.4930 rowmax_out=0.8582 discrete_mse=867.126770 best_discrete=60.450947 hash=False elapsed=27.2s
step   325/900 tau=0.2756 loss=0.288087 mse_soft=0.287620 ent_in=1.2027 ent_out=0.3537 rowmax_in=0.4939 rowmax_out=0.8598 discrete_mse=867.126770 best_discrete=60.450947 hash=False elapsed=29.4s
step   350/900 tau=0.2496 loss=0.282655 mse_soft=0.282194 ent_in=1.1917 ent_out=0.3445 rowmax_in=0.4959 rowmax_out=0.8606 discrete_mse=603.144775 best_discrete=60.450947 hash=False elapsed=31.8s
step   375/900 tau=0.2259 loss=0.282277 mse_soft=0.281822 ent_in=1.1863 ent_out=0.3330 rowmax_in=0.4941 rowmax_out=0.8615 discrete_mse=603.144775 best_discrete=60.450947 hash=False elapsed=34.0s
step   400/900 tau=0.2046 loss=0.280499 mse_soft=0.280046 ent_in=1.1839 ent_out=0.3258 rowmax_in=0.4926 rowmax_out=0.8602 discrete_mse=1797.977295 best_discrete=60.450947 hash=False elapsed=36.2s
step   425/900 tau=0.1852 loss=0.282176 mse_soft=0.281726 ent_in=1.1811 ent_out=0.3185 rowmax_in=0.4955 rowmax_out=0.8598 discrete_mse=2736.201660 best_discrete=60.450947 hash=False elapsed=38.1s
step   450/900 tau=0.1677 loss=0.289153 mse_soft=0.288704 ent_in=1.1814 ent_out=0.3149 rowmax_in=0.4923 rowmax_out=0.8583 discrete_mse=1923.686401 best_discrete=60.450947 hash=False elapsed=40.1s
step   475/900 tau=0.1518 loss=0.289248 mse_soft=0.288804 ent_in=1.1742 ent_out=0.3067 rowmax_in=0.4972 rowmax_out=0.8637 discrete_mse=926.164001 best_discrete=60.450947 hash=False elapsed=42.0s
step   500/900 tau=0.1374 loss=0.286324 mse_soft=0.285882 ent_in=1.1702 ent_out=0.3016 rowmax_in=0.4976 rowmax_out=0.8619 discrete_mse=1923.686401 best_discrete=60.450947 hash=False elapsed=44.3s
step   525/900 tau=0.1244 loss=0.282165 mse_soft=0.281727 ent_in=1.1637 ent_out=0.2945 rowmax_in=0.5010 rowmax_out=0.8649 discrete_mse=3947.699951 best_discrete=60.450947 hash=False elapsed=46.4s
step   550/900 tau=0.1126 loss=0.284620 mse_soft=0.284185 ent_in=1.1585 ent_out=0.2921 rowmax_in=0.4997 rowmax_out=0.8631 discrete_mse=3203.312012 best_discrete=60.450947 hash=False elapsed=48.4s
step   575/900 tau=0.1020 loss=0.290756 mse_soft=0.290326 ent_in=1.1546 ent_out=0.2806 rowmax_in=0.5005 rowmax_out=0.8676 discrete_mse=6311.555176 best_discrete=60.450947 hash=False elapsed=50.3s
step   600/900 tau=0.0923 loss=0.279550 mse_soft=0.279127 ent_in=1.1421 ent_out=0.2687 rowmax_in=0.5016 rowmax_out=0.8708 discrete_mse=987.320679 best_discrete=60.450947 hash=False elapsed=52.5s
step   625/900 tau=0.0836 loss=0.286535 mse_soft=0.286121 ent_in=1.1269 ent_out=0.2531 rowmax_in=0.5058 rowmax_out=0.8764 discrete_mse=1876.827515 best_discrete=60.450947 hash=False elapsed=54.6s
step   650/900 tau=0.0757 loss=0.295675 mse_soft=0.295265 ent_in=1.1184 ent_out=0.2493 rowmax_in=0.5001 rowmax_out=0.8761 discrete_mse=1780.525146 best_discrete=60.450947 hash=False elapsed=56.7s
step   675/900 tau=0.0685 loss=0.326030 mse_soft=0.325663 ent_in=1.0046 ent_out=0.2201 rowmax_in=0.5434 rowmax_out=0.8965 discrete_mse=410.157532 best_discrete=60.450947 hash=False elapsed=58.7s
step   700/900 tau=0.0620 loss=0.311800 mse_soft=0.311443 ent_in=0.9878 ent_out=0.2048 rowmax_in=0.5447 rowmax_out=0.8975 discrete_mse=111.784012 best_discrete=60.450947 hash=False elapsed=60.7s
step   725/900 tau=0.0562 loss=0.294239 mse_soft=0.293883 ent_in=0.9701 ent_out=0.2153 rowmax_in=0.5484 rowmax_out=0.8954 discrete_mse=107.078926 best_discrete=60.450947 hash=False elapsed=62.8s
step   750/900 tau=0.0508 loss=0.399714 mse_soft=0.399469 ent_in=0.6628 ent_out=0.1534 rowmax_in=0.7100 rowmax_out=0.9359 discrete_mse=60.947380 best_discrete=60.450947 hash=False elapsed=65.0s
step   775/900 tau=0.0460 loss=0.358607 mse_soft=0.358378 ent_in=0.5979 ent_out=0.1661 rowmax_in=0.7018 rowmax_out=0.9118 discrete_mse=84.880051 best_discrete=60.450947 hash=False elapsed=67.1s
step   800/900 tau=0.0417 loss=0.346772 mse_soft=0.346540 ent_in=0.5988 ent_out=0.1736 rowmax_in=0.6948 rowmax_out=0.9030 discrete_mse=31.210062 best_discrete=31.210062 hash=False elapsed=69.1s
step   825/900 tau=0.0377 loss=0.379238 mse_soft=0.379032 ent_in=0.5241 ent_out=0.1603 rowmax_in=0.7351 rowmax_out=0.9108 discrete_mse=26.714516 best_discrete=26.714516 hash=False elapsed=71.1s
step   850/900 tau=0.0342 loss=0.362360 mse_soft=0.362156 ent_in=0.5253 ent_out=0.1545 rowmax_in=0.7340 rowmax_out=0.9156 discrete_mse=44.039021 best_discrete=26.714516 hash=False elapsed=73.2s
step   875/900 tau=0.0309 loss=0.371192 mse_soft=0.370984 ent_in=0.5454 ent_out=0.1483 rowmax_in=0.7262 rowmax_out=0.9242 discrete_mse=50.953606 best_discrete=26.714516 hash=False elapsed=75.2s
step   900/900 tau=0.0280 loss=0.404366 mse_soft=0.404211 ent_in=0.3901 ent_out=0.1270 rowmax_in=0.7993 rowmax_out=0.9311 discrete_mse=17.602678 best_discrete=17.602678 hash=False elapsed=77.2s

Final metrics:
  soft_mse_full=0.406303
  rowmax_in_mean=0.7981
  rowmax_out_mean=0.9311
  ent_in_mean=0.3885
  ent_out_mean=0.1268
  final_discrete_mse=43.593658
  hash_match=False
  best_discrete_mse_seen=17.602678
Saved results to overnight_b201_j2.json
