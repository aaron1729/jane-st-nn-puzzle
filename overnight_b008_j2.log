Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.043371 mse_soft=1.041048 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=33.118729 best_discrete=33.118729 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.843527 mse_soft=0.841338 ent_in=3.6295 ent_out=3.6660 rowmax_in=0.0444 rowmax_out=0.0446 discrete_mse=2146.971924 best_discrete=33.118729 hash=False elapsed=2.8s
step    50/900 tau=0.8229 loss=0.640783 mse_soft=0.638871 ent_in=3.1398 ent_out=3.2327 rowmax_in=0.0908 rowmax_out=0.0883 discrete_mse=3727.473877 best_discrete=33.118729 hash=False elapsed=5.3s
step    75/900 tau=0.7450 loss=0.506954 mse_soft=0.505358 ent_in=2.6297 ent_out=2.6909 rowmax_in=0.1963 rowmax_out=0.1953 discrete_mse=623.276367 best_discrete=33.118729 hash=False elapsed=7.6s
step   100/900 tau=0.6745 loss=0.404641 mse_soft=0.403453 ent_in=2.0625 ent_out=1.8968 rowmax_in=0.3206 rowmax_out=0.3877 discrete_mse=33.721729 best_discrete=33.118729 hash=False elapsed=9.9s
step   125/900 tau=0.6107 loss=0.343916 mse_soft=0.343050 ent_in=1.5839 ent_out=1.3010 rowmax_in=0.4443 rowmax_out=0.5571 discrete_mse=1222.472290 best_discrete=33.118729 hash=False elapsed=12.1s
step   150/900 tau=0.5529 loss=0.316409 mse_soft=0.315708 ent_in=1.3989 ent_out=0.9390 rowmax_in=0.4907 rowmax_out=0.6823 discrete_mse=1744.872314 best_discrete=33.118729 hash=False elapsed=14.5s
step   175/900 tau=0.5006 loss=0.300274 mse_soft=0.299659 ent_in=1.2713 ent_out=0.7792 rowmax_in=0.5019 rowmax_out=0.7164 discrete_mse=1127.281128 best_discrete=33.118729 hash=False elapsed=16.9s
step   200/900 tau=0.4532 loss=0.290034 mse_soft=0.289484 ent_in=1.1890 ent_out=0.6449 rowmax_in=0.5166 rowmax_out=0.7415 discrete_mse=694.581360 best_discrete=33.118729 hash=False elapsed=19.4s
step   225/900 tau=0.4103 loss=0.284253 mse_soft=0.283743 ent_in=1.1493 ent_out=0.5516 rowmax_in=0.5213 rowmax_out=0.7725 discrete_mse=818.948364 best_discrete=33.118729 hash=False elapsed=21.8s
step   250/900 tau=0.3715 loss=0.281556 mse_soft=0.281071 ent_in=1.1162 ent_out=0.5011 rowmax_in=0.5249 rowmax_out=0.7823 discrete_mse=354.750763 best_discrete=33.118729 hash=False elapsed=23.8s
step   275/900 tau=0.3363 loss=0.277486 mse_soft=0.277018 ent_in=1.0875 ent_out=0.4726 rowmax_in=0.5309 rowmax_out=0.7861 discrete_mse=258.030487 best_discrete=33.118729 hash=False elapsed=26.0s
step   300/900 tau=0.3045 loss=0.276776 mse_soft=0.276321 ent_in=1.0687 ent_out=0.4495 rowmax_in=0.5342 rowmax_out=0.7923 discrete_mse=354.750763 best_discrete=33.118729 hash=False elapsed=28.2s
step   325/900 tau=0.2756 loss=0.275747 mse_soft=0.275296 ent_in=1.0651 ent_out=0.4374 rowmax_in=0.5347 rowmax_out=0.7948 discrete_mse=371.875427 best_discrete=33.118729 hash=False elapsed=30.4s
step   350/900 tau=0.2496 loss=0.273991 mse_soft=0.273544 ent_in=1.0660 ent_out=0.4240 rowmax_in=0.5355 rowmax_out=0.7984 discrete_mse=371.875427 best_discrete=33.118729 hash=False elapsed=32.7s
step   375/900 tau=0.2259 loss=0.273388 mse_soft=0.272946 ent_in=1.0613 ent_out=0.4134 rowmax_in=0.5342 rowmax_out=0.8017 discrete_mse=880.879700 best_discrete=33.118729 hash=False elapsed=35.1s
step   400/900 tau=0.2046 loss=0.276047 mse_soft=0.275608 ent_in=1.0599 ent_out=0.4037 rowmax_in=0.5325 rowmax_out=0.8046 discrete_mse=455.430695 best_discrete=33.118729 hash=False elapsed=37.4s
step   425/900 tau=0.1852 loss=0.272849 mse_soft=0.272411 ent_in=1.0601 ent_out=0.4004 rowmax_in=0.5336 rowmax_out=0.8059 discrete_mse=274.134979 best_discrete=33.118729 hash=False elapsed=39.7s
step   450/900 tau=0.1677 loss=0.276088 mse_soft=0.275651 ent_in=1.0587 ent_out=0.3989 rowmax_in=0.5351 rowmax_out=0.8056 discrete_mse=418.358154 best_discrete=33.118729 hash=False elapsed=42.0s
step   475/900 tau=0.1518 loss=0.274397 mse_soft=0.273962 ent_in=1.0581 ent_out=0.3935 rowmax_in=0.5346 rowmax_out=0.8074 discrete_mse=472.813293 best_discrete=33.118729 hash=False elapsed=44.3s
step   500/900 tau=0.1374 loss=0.272344 mse_soft=0.271911 ent_in=1.0539 ent_out=0.3902 rowmax_in=0.5354 rowmax_out=0.8098 discrete_mse=472.813293 best_discrete=33.118729 hash=False elapsed=46.5s
step   525/900 tau=0.1244 loss=0.276052 mse_soft=0.275622 ent_in=1.0474 ent_out=0.3887 rowmax_in=0.5384 rowmax_out=0.8116 discrete_mse=472.813293 best_discrete=33.118729 hash=False elapsed=48.8s
step   550/900 tau=0.1126 loss=0.276256 mse_soft=0.275828 ent_in=1.0430 ent_out=0.3830 rowmax_in=0.5387 rowmax_out=0.8130 discrete_mse=472.813293 best_discrete=33.118729 hash=False elapsed=51.0s
step   575/900 tau=0.1020 loss=0.276906 mse_soft=0.276479 ent_in=1.0384 ent_out=0.3843 rowmax_in=0.5410 rowmax_out=0.8140 discrete_mse=472.813293 best_discrete=33.118729 hash=False elapsed=53.3s
step   600/900 tau=0.0923 loss=0.278149 mse_soft=0.277725 ent_in=1.0313 ent_out=0.3813 rowmax_in=0.5412 rowmax_out=0.8128 discrete_mse=313.453552 best_discrete=33.118729 hash=False elapsed=55.4s
step   625/900 tau=0.0836 loss=0.274041 mse_soft=0.273623 ent_in=1.0130 ent_out=0.3802 rowmax_in=0.5505 rowmax_out=0.8137 discrete_mse=472.813293 best_discrete=33.118729 hash=False elapsed=57.8s
step   650/900 tau=0.0757 loss=0.282677 mse_soft=0.282275 ent_in=0.9689 ent_out=0.3713 rowmax_in=0.5642 rowmax_out=0.8253 discrete_mse=84.143784 best_discrete=33.118729 hash=False elapsed=60.1s
step   675/900 tau=0.0685 loss=0.283762 mse_soft=0.283368 ent_in=0.9592 ent_out=0.3521 rowmax_in=0.5731 rowmax_out=0.8318 discrete_mse=90.849586 best_discrete=33.118729 hash=False elapsed=62.4s
step   700/900 tau=0.0620 loss=0.281743 mse_soft=0.281352 ent_in=0.9658 ent_out=0.3379 rowmax_in=0.5674 rowmax_out=0.8347 discrete_mse=195.590164 best_discrete=33.118729 hash=False elapsed=64.6s
step   725/900 tau=0.0562 loss=0.286012 mse_soft=0.285639 ent_in=0.9120 ent_out=0.3318 rowmax_in=0.5938 rowmax_out=0.8429 discrete_mse=215.241440 best_discrete=33.118729 hash=False elapsed=66.8s
step   750/900 tau=0.0508 loss=0.310943 mse_soft=0.310616 ent_in=0.7882 ent_out=0.2997 rowmax_in=0.6475 rowmax_out=0.8673 discrete_mse=78.908577 best_discrete=33.118729 hash=False elapsed=69.0s
step   775/900 tau=0.0460 loss=0.286747 mse_soft=0.286420 ent_in=0.7932 ent_out=0.2955 rowmax_in=0.6312 rowmax_out=0.8580 discrete_mse=18.203381 best_discrete=18.203381 hash=False elapsed=71.4s
step   800/900 tau=0.0417 loss=0.331688 mse_soft=0.331432 ent_in=0.6169 ent_out=0.2342 rowmax_in=0.6899 rowmax_out=0.8941 discrete_mse=5.961885 best_discrete=5.961885 hash=False elapsed=73.6s
step   825/900 tau=0.0377 loss=0.311349 mse_soft=0.311073 ent_in=0.6493 ent_out=0.2690 rowmax_in=0.6696 rowmax_out=0.8733 discrete_mse=44.707226 best_discrete=5.961885 hash=False elapsed=75.7s
step   850/900 tau=0.0342 loss=0.443561 mse_soft=0.443344 ent_in=0.5288 ent_out=0.1936 rowmax_in=0.7287 rowmax_out=0.9129 discrete_mse=7.061592 best_discrete=5.961885 hash=False elapsed=77.8s
step   875/900 tau=0.0309 loss=0.423548 mse_soft=0.423387 ent_in=0.3647 ent_out=0.1744 rowmax_in=0.7849 rowmax_out=0.9116 discrete_mse=1.675626 best_discrete=1.675626 hash=False elapsed=80.1s
step   900/900 tau=0.0280 loss=0.413229 mse_soft=0.413070 ent_in=0.3614 ent_out=0.1684 rowmax_in=0.8089 rowmax_out=0.9155 discrete_mse=10.575537 best_discrete=1.675626 hash=False elapsed=82.4s

Final metrics:
  soft_mse_full=0.421503
  rowmax_in_mean=0.8061
  rowmax_out_mean=0.9171
  ent_in_mean=0.3661
  ent_out_mean=0.1652
  final_discrete_mse=51.516663
  hash_match=False
  best_discrete_mse_seen=1.675626
Saved results to overnight_b008_j2.json
