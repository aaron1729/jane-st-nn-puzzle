Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.059663 mse_soft=1.057340 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=29.478037 best_discrete=29.478037 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.860150 mse_soft=0.857959 ent_in=3.6347 ent_out=3.6674 rowmax_in=0.0469 rowmax_out=0.0438 discrete_mse=2608.720947 best_discrete=29.478037 hash=False elapsed=2.7s
step    50/900 tau=0.8260 loss=0.648906 mse_soft=0.647002 ent_in=3.1238 ent_out=3.2246 rowmax_in=0.0964 rowmax_out=0.0869 discrete_mse=5914.090820 best_discrete=29.478037 hash=False elapsed=5.0s
step    75/900 tau=0.7493 loss=0.510650 mse_soft=0.509069 ent_in=2.5897 ent_out=2.6802 rowmax_in=0.1979 rowmax_out=0.1907 discrete_mse=4642.531738 best_discrete=29.478037 hash=False elapsed=7.3s
step   100/900 tau=0.6797 loss=0.397161 mse_soft=0.396021 ent_in=1.9850 ent_out=1.8175 rowmax_in=0.3438 rowmax_out=0.4319 discrete_mse=31.590174 best_discrete=29.478037 hash=False elapsed=9.8s
step   125/900 tau=0.6165 loss=0.336097 mse_soft=0.335272 ent_in=1.6164 ent_out=1.1350 rowmax_in=0.4158 rowmax_out=0.6277 discrete_mse=1115.858643 best_discrete=29.478037 hash=False elapsed=12.2s
step   150/900 tau=0.5592 loss=0.305908 mse_soft=0.305248 ent_in=1.4124 ent_out=0.7876 rowmax_in=0.4554 rowmax_out=0.7120 discrete_mse=728.490906 best_discrete=29.478037 hash=False elapsed=14.5s
step   175/900 tau=0.5073 loss=0.293113 mse_soft=0.292543 ent_in=1.2977 ent_out=0.6041 rowmax_in=0.4830 rowmax_out=0.7611 discrete_mse=2.033958 best_discrete=2.033958 hash=False elapsed=16.8s
step   200/900 tau=0.4602 loss=0.286987 mse_soft=0.286457 ent_in=1.2409 ent_out=0.5265 rowmax_in=0.4925 rowmax_out=0.7810 discrete_mse=1.630364 best_discrete=1.630364 hash=False elapsed=19.2s
step   225/900 tau=0.4174 loss=0.283703 mse_soft=0.283203 ent_in=1.1993 ent_out=0.4656 rowmax_in=0.4953 rowmax_out=0.8041 discrete_mse=739.205383 best_discrete=1.630364 hash=False elapsed=21.7s
step   250/900 tau=0.3786 loss=0.278813 mse_soft=0.278333 ent_in=1.1746 ent_out=0.4259 rowmax_in=0.5032 rowmax_out=0.8210 discrete_mse=712.292358 best_discrete=1.630364 hash=False elapsed=24.2s
step   275/900 tau=0.3434 loss=0.275161 mse_soft=0.274696 ent_in=1.1526 ent_out=0.3982 rowmax_in=0.5102 rowmax_out=0.8338 discrete_mse=758.256958 best_discrete=1.630364 hash=False elapsed=26.5s
step   300/900 tau=0.3115 loss=0.274111 mse_soft=0.273654 ent_in=1.1456 ent_out=0.3767 rowmax_in=0.5098 rowmax_out=0.8419 discrete_mse=707.583801 best_discrete=1.630364 hash=False elapsed=29.0s
step   325/900 tau=0.2826 loss=0.273006 mse_soft=0.272556 ent_in=1.1403 ent_out=0.3592 rowmax_in=0.5092 rowmax_out=0.8488 discrete_mse=758.256958 best_discrete=1.630364 hash=False elapsed=31.2s
step   350/900 tau=0.2563 loss=0.270418 mse_soft=0.269975 ent_in=1.1355 ent_out=0.3405 rowmax_in=0.5099 rowmax_out=0.8558 discrete_mse=87.937813 best_discrete=1.630364 hash=False elapsed=33.5s
step   375/900 tau=0.2325 loss=0.273545 mse_soft=0.273109 ent_in=1.1277 ent_out=0.3250 rowmax_in=0.5128 rowmax_out=0.8598 discrete_mse=75.549324 best_discrete=1.630364 hash=False elapsed=35.8s
step   400/900 tau=0.2109 loss=0.269181 mse_soft=0.268753 ent_in=1.1184 ent_out=0.3095 rowmax_in=0.5154 rowmax_out=0.8637 discrete_mse=65.729248 best_discrete=1.630364 hash=False elapsed=38.2s
step   425/900 tau=0.1913 loss=0.270916 mse_soft=0.270492 ent_in=1.1133 ent_out=0.2992 rowmax_in=0.5165 rowmax_out=0.8657 discrete_mse=65.729248 best_discrete=1.630364 hash=False elapsed=40.6s
step   450/900 tau=0.1735 loss=0.270108 mse_soft=0.269687 ent_in=1.1099 ent_out=0.2910 rowmax_in=0.5186 rowmax_out=0.8682 discrete_mse=65.729248 best_discrete=1.630364 hash=False elapsed=42.9s
step   475/900 tau=0.1574 loss=0.273932 mse_soft=0.273515 ent_in=1.1059 ent_out=0.2831 rowmax_in=0.5186 rowmax_out=0.8714 discrete_mse=68.702133 best_discrete=1.630364 hash=False elapsed=45.3s
step   500/900 tau=0.1428 loss=0.270205 mse_soft=0.269790 ent_in=1.1038 ent_out=0.2797 rowmax_in=0.5183 rowmax_out=0.8731 discrete_mse=275.789886 best_discrete=1.630364 hash=False elapsed=47.7s
step   525/900 tau=0.1295 loss=0.278927 mse_soft=0.278513 ent_in=1.1008 ent_out=0.2766 rowmax_in=0.5205 rowmax_out=0.8740 discrete_mse=93.438896 best_discrete=1.630364 hash=False elapsed=49.9s
step   550/900 tau=0.1175 loss=0.281460 mse_soft=0.281050 ent_in=1.0942 ent_out=0.2705 rowmax_in=0.5241 rowmax_out=0.8771 discrete_mse=379.679901 best_discrete=1.630364 hash=False elapsed=52.2s
step   575/900 tau=0.1066 loss=0.339309 mse_soft=0.338925 ent_in=1.0209 ent_out=0.2602 rowmax_in=0.5714 rowmax_out=0.8808 discrete_mse=66.825211 best_discrete=1.630364 hash=False elapsed=54.5s
step   600/900 tau=0.0967 loss=0.301185 mse_soft=0.300851 ent_in=0.8899 ent_out=0.2239 rowmax_in=0.6065 rowmax_out=0.8959 discrete_mse=151.594116 best_discrete=1.630364 hash=False elapsed=56.8s
step   625/900 tau=0.0877 loss=0.287621 mse_soft=0.287286 ent_in=0.8965 ent_out=0.2211 rowmax_in=0.6011 rowmax_out=0.9005 discrete_mse=151.594116 best_discrete=1.630364 hash=False elapsed=59.1s
step   650/900 tau=0.0795 loss=0.283416 mse_soft=0.283086 ent_in=0.8935 ent_out=0.2080 rowmax_in=0.5978 rowmax_out=0.9049 discrete_mse=130.141998 best_discrete=1.630364 hash=False elapsed=61.4s
step   675/900 tau=0.0722 loss=0.288183 mse_soft=0.287856 ent_in=0.8762 ent_out=0.2133 rowmax_in=0.6034 rowmax_out=0.9037 discrete_mse=151.594116 best_discrete=1.630364 hash=False elapsed=63.7s
step   700/900 tau=0.0655 loss=0.283171 mse_soft=0.282841 ent_in=0.8840 ent_out=0.2159 rowmax_in=0.5975 rowmax_out=0.9024 discrete_mse=151.594116 best_discrete=1.630364 hash=False elapsed=66.0s
step   725/900 tau=0.0594 loss=0.417672 mse_soft=0.417395 ent_in=0.7087 ent_out=0.2150 rowmax_in=0.6702 rowmax_out=0.8964 discrete_mse=179.116714 best_discrete=1.630364 hash=False elapsed=68.3s
step   750/900 tau=0.0539 loss=0.369927 mse_soft=0.369686 ent_in=0.5987 ent_out=0.2048 rowmax_in=0.7138 rowmax_out=0.9018 discrete_mse=30.691338 best_discrete=1.630364 hash=False elapsed=70.5s
step   775/900 tau=0.0489 loss=0.322763 mse_soft=0.322505 ent_in=0.6428 ent_out=0.2176 rowmax_in=0.6768 rowmax_out=0.8916 discrete_mse=46.281960 best_discrete=1.630364 hash=False elapsed=72.8s
step   800/900 tau=0.0443 loss=0.309751 mse_soft=0.309494 ent_in=0.6410 ent_out=0.2176 rowmax_in=0.6794 rowmax_out=0.8929 discrete_mse=129.535843 best_discrete=1.630364 hash=False elapsed=75.1s
step   825/900 tau=0.0402 loss=0.430449 mse_soft=0.430284 ent_in=0.3930 ent_out=0.1577 rowmax_in=0.8136 rowmax_out=0.9220 discrete_mse=74.664360 best_discrete=1.630364 hash=False elapsed=77.5s
step   850/900 tau=0.0365 loss=0.429197 mse_soft=0.429051 ent_in=0.3600 ent_out=0.1275 rowmax_in=0.8153 rowmax_out=0.9340 discrete_mse=47.997936 best_discrete=1.630364 hash=False elapsed=79.9s
step   875/900 tau=0.0331 loss=0.408081 mse_soft=0.407927 ent_in=0.3853 ent_out=0.1288 rowmax_in=0.7992 rowmax_out=0.9326 discrete_mse=90.035164 best_discrete=1.630364 hash=False elapsed=82.2s
step   900/900 tau=0.0300 loss=0.404226 mse_soft=0.404070 ent_in=0.3911 ent_out=0.1298 rowmax_in=0.7946 rowmax_out=0.9316 discrete_mse=44.740501 best_discrete=1.630364 hash=False elapsed=84.4s

Final metrics:
  soft_mse_full=0.422204
  rowmax_in_mean=0.7952
  rowmax_out_mean=0.9315
  ent_in_mean=0.3908
  ent_out_mean=0.1299
  final_discrete_mse=44.740501
  hash_match=False
  best_discrete_mse_seen=1.630364
Saved results to overnight_b163_j1.json
