Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.074995 mse_soft=1.072672 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=101.076401 best_discrete=101.076401 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.867403 mse_soft=0.865213 ent_in=3.6335 ent_out=3.6670 rowmax_in=0.0459 rowmax_out=0.0447 discrete_mse=3436.306396 best_discrete=101.076401 hash=False elapsed=2.4s
step    50/900 tau=0.8229 loss=0.643403 mse_soft=0.641502 ent_in=3.1271 ent_out=3.2102 rowmax_in=0.0944 rowmax_out=0.0932 discrete_mse=4472.174316 best_discrete=101.076401 hash=False elapsed=4.4s
step    75/900 tau=0.7450 loss=0.503418 mse_soft=0.501838 ent_in=2.5926 ent_out=2.6724 rowmax_in=0.2039 rowmax_out=0.1945 discrete_mse=1599.047119 best_discrete=101.076401 hash=False elapsed=6.4s
step   100/900 tau=0.6745 loss=0.396395 mse_soft=0.395234 ent_in=1.9959 ent_out=1.8762 rowmax_in=0.3412 rowmax_out=0.3884 discrete_mse=3958.370361 best_discrete=101.076401 hash=False elapsed=8.4s
step   125/900 tau=0.6107 loss=0.339437 mse_soft=0.338559 ent_in=1.6491 ent_out=1.2775 rowmax_in=0.4179 rowmax_out=0.5738 discrete_mse=76.375763 best_discrete=76.375763 hash=False elapsed=10.3s
step   150/900 tau=0.5529 loss=0.304054 mse_soft=0.303389 ent_in=1.4006 ent_out=0.8172 rowmax_in=0.4719 rowmax_out=0.7122 discrete_mse=110.565163 best_discrete=76.375763 hash=False elapsed=12.2s
step   175/900 tau=0.5006 loss=0.287351 mse_soft=0.286771 ent_in=1.2901 ent_out=0.6435 rowmax_in=0.4940 rowmax_out=0.7615 discrete_mse=228.404541 best_discrete=76.375763 hash=False elapsed=14.2s
step   200/900 tau=0.4532 loss=0.278523 mse_soft=0.278007 ent_in=1.2188 ent_out=0.5028 rowmax_in=0.5025 rowmax_out=0.8203 discrete_mse=181.608948 best_discrete=76.375763 hash=False elapsed=16.1s
step   225/900 tau=0.4103 loss=0.274741 mse_soft=0.274252 ent_in=1.1990 ent_out=0.4314 rowmax_in=0.4995 rowmax_out=0.8362 discrete_mse=476.523926 best_discrete=76.375763 hash=False elapsed=18.0s
step   250/900 tau=0.3715 loss=0.270974 mse_soft=0.270503 ent_in=1.1841 ent_out=0.3857 rowmax_in=0.4980 rowmax_out=0.8477 discrete_mse=615.388123 best_discrete=76.375763 hash=False elapsed=20.0s
step   275/900 tau=0.3363 loss=0.267243 mse_soft=0.266788 ent_in=1.1648 ent_out=0.3493 rowmax_in=0.4924 rowmax_out=0.8580 discrete_mse=283.131012 best_discrete=76.375763 hash=False elapsed=21.9s
step   300/900 tau=0.3045 loss=0.266657 mse_soft=0.266210 ent_in=1.1593 ent_out=0.3304 rowmax_in=0.4899 rowmax_out=0.8626 discrete_mse=287.789642 best_discrete=76.375763 hash=False elapsed=24.1s
step   325/900 tau=0.2756 loss=0.263424 mse_soft=0.262985 ent_in=1.1517 ent_out=0.3122 rowmax_in=0.4986 rowmax_out=0.8675 discrete_mse=392.676086 best_discrete=76.375763 hash=False elapsed=26.2s
step   350/900 tau=0.2496 loss=0.264377 mse_soft=0.263950 ent_in=1.1289 ent_out=0.2942 rowmax_in=0.5055 rowmax_out=0.8725 discrete_mse=444.958801 best_discrete=76.375763 hash=False elapsed=28.4s
step   375/900 tau=0.2259 loss=0.261823 mse_soft=0.261401 ent_in=1.1215 ent_out=0.2863 rowmax_in=0.5065 rowmax_out=0.8744 discrete_mse=444.958801 best_discrete=76.375763 hash=False elapsed=30.5s
step   400/900 tau=0.2046 loss=0.260408 mse_soft=0.259990 ent_in=1.1142 ent_out=0.2804 rowmax_in=0.5064 rowmax_out=0.8759 discrete_mse=165.108749 best_discrete=76.375763 hash=False elapsed=32.8s
step   425/900 tau=0.1852 loss=0.264150 mse_soft=0.263735 ent_in=1.1053 ent_out=0.2781 rowmax_in=0.5085 rowmax_out=0.8761 discrete_mse=165.108749 best_discrete=76.375763 hash=False elapsed=35.1s
step   450/900 tau=0.1677 loss=0.260717 mse_soft=0.260304 ent_in=1.1021 ent_out=0.2765 rowmax_in=0.5076 rowmax_out=0.8772 discrete_mse=185.608353 best_discrete=76.375763 hash=False elapsed=37.3s
step   475/900 tau=0.1518 loss=0.260358 mse_soft=0.259947 ent_in=1.0943 ent_out=0.2750 rowmax_in=0.5105 rowmax_out=0.8787 discrete_mse=331.409851 best_discrete=76.375763 hash=False elapsed=39.5s
step   500/900 tau=0.1374 loss=0.264422 mse_soft=0.264013 ent_in=1.0898 ent_out=0.2734 rowmax_in=0.5100 rowmax_out=0.8785 discrete_mse=176.748550 best_discrete=76.375763 hash=False elapsed=41.6s
step   525/900 tau=0.1244 loss=0.261421 mse_soft=0.261016 ent_in=1.0822 ent_out=0.2684 rowmax_in=0.5083 rowmax_out=0.8776 discrete_mse=414.583405 best_discrete=76.375763 hash=False elapsed=43.8s
step   550/900 tau=0.1126 loss=0.268213 mse_soft=0.267811 ent_in=1.0754 ent_out=0.2643 rowmax_in=0.5090 rowmax_out=0.8769 discrete_mse=111.478073 best_discrete=76.375763 hash=False elapsed=46.0s
step   575/900 tau=0.1020 loss=0.272217 mse_soft=0.271818 ent_in=1.0693 ent_out=0.2611 rowmax_in=0.5106 rowmax_out=0.8778 discrete_mse=145.568710 best_discrete=76.375763 hash=False elapsed=48.0s
step   600/900 tau=0.0923 loss=0.261478 mse_soft=0.261079 ent_in=1.0673 ent_out=0.2618 rowmax_in=0.5095 rowmax_out=0.8769 discrete_mse=111.478073 best_discrete=76.375763 hash=False elapsed=50.1s
step   625/900 tau=0.0836 loss=0.274192 mse_soft=0.273826 ent_in=0.9788 ent_out=0.2421 rowmax_in=0.5431 rowmax_out=0.8862 discrete_mse=150.930359 best_discrete=76.375763 hash=False elapsed=52.2s
step   650/900 tau=0.0757 loss=0.277142 mse_soft=0.276775 ent_in=0.9761 ent_out=0.2462 rowmax_in=0.5386 rowmax_out=0.8751 discrete_mse=65.348526 best_discrete=65.348526 hash=False elapsed=54.2s
step   675/900 tau=0.0685 loss=0.278791 mse_soft=0.278424 ent_in=0.9743 ent_out=0.2462 rowmax_in=0.5438 rowmax_out=0.8776 discrete_mse=31.391474 best_discrete=31.391474 hash=False elapsed=56.2s
step   700/900 tau=0.0620 loss=0.281801 mse_soft=0.281451 ent_in=0.9204 ent_out=0.2434 rowmax_in=0.5689 rowmax_out=0.8845 discrete_mse=132.974777 best_discrete=31.391474 hash=False elapsed=58.2s
step   725/900 tau=0.0562 loss=0.299402 mse_soft=0.299102 ent_in=0.8091 ent_out=0.1898 rowmax_in=0.6058 rowmax_out=0.9092 discrete_mse=24.062050 best_discrete=24.062050 hash=False elapsed=60.2s
step   750/900 tau=0.0508 loss=0.290168 mse_soft=0.289869 ent_in=0.7998 ent_out=0.1968 rowmax_in=0.6001 rowmax_out=0.9026 discrete_mse=44.186329 best_discrete=24.062050 hash=False elapsed=62.3s
step   775/900 tau=0.0460 loss=0.296572 mse_soft=0.296284 ent_in=0.7701 ent_out=0.1904 rowmax_in=0.6244 rowmax_out=0.9035 discrete_mse=157.168030 best_discrete=24.062050 hash=False elapsed=64.4s
step   800/900 tau=0.0417 loss=0.297956 mse_soft=0.297669 ent_in=0.7560 ent_out=0.1987 rowmax_in=0.6188 rowmax_out=0.9028 discrete_mse=78.994164 best_discrete=24.062050 hash=False elapsed=66.6s
step   825/900 tau=0.0377 loss=0.299860 mse_soft=0.299572 ent_in=0.7478 ent_out=0.2103 rowmax_in=0.6217 rowmax_out=0.9001 discrete_mse=68.069572 best_discrete=24.062050 hash=False elapsed=68.6s
step   850/900 tau=0.0342 loss=0.526671 mse_soft=0.526554 ent_in=0.2792 ent_out=0.1118 rowmax_in=0.8746 rowmax_out=0.9485 discrete_mse=8.429583 best_discrete=8.429583 hash=False elapsed=70.6s
step   875/900 tau=0.0309 loss=0.431822 mse_soft=0.431700 ent_in=0.3105 ent_out=0.0969 rowmax_in=0.8278 rowmax_out=0.9541 discrete_mse=5.143698 best_discrete=5.143698 hash=False elapsed=72.7s
step   900/900 tau=0.0280 loss=0.412732 mse_soft=0.412604 ent_in=0.3299 ent_out=0.0960 rowmax_in=0.8109 rowmax_out=0.9552 discrete_mse=9.075910 best_discrete=5.143698 hash=False elapsed=74.7s

Final metrics:
  soft_mse_full=0.422490
  rowmax_in_mean=0.8129
  rowmax_out_mean=0.9553
  ent_in_mean=0.3303
  ent_out_mean=0.0957
  final_discrete_mse=41.495041
  hash_match=False
  best_discrete_mse_seen=5.143698
Saved results to overnight_b142_j2.json
