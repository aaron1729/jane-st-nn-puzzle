Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.069028 mse_soft=1.066705 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=0.891176 best_discrete=0.891176 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.866464 mse_soft=0.864274 ent_in=3.6330 ent_out=3.6660 rowmax_in=0.0458 rowmax_out=0.0447 discrete_mse=15329.791992 best_discrete=0.891176 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.651534 mse_soft=0.649632 ent_in=3.1263 ent_out=3.2153 rowmax_in=0.0937 rowmax_out=0.0872 discrete_mse=3550.429932 best_discrete=0.891176 hash=False elapsed=4.8s
step    75/900 tau=0.7450 loss=0.514576 mse_soft=0.513006 ent_in=2.5811 ent_out=2.6529 rowmax_in=0.2007 rowmax_out=0.2011 discrete_mse=4754.368164 best_discrete=0.891176 hash=False elapsed=7.3s
step   100/900 tau=0.6745 loss=0.409349 mse_soft=0.408213 ent_in=1.9636 ent_out=1.8252 rowmax_in=0.3718 rowmax_out=0.4119 discrete_mse=3226.214355 best_discrete=0.891176 hash=False elapsed=9.4s
step   125/900 tau=0.6107 loss=0.341649 mse_soft=0.340818 ent_in=1.5647 ent_out=1.2039 rowmax_in=0.4752 rowmax_out=0.5882 discrete_mse=983.268005 best_discrete=0.891176 hash=False elapsed=11.7s
step   150/900 tau=0.5529 loss=0.313104 mse_soft=0.312412 ent_in=1.3990 ent_out=0.9080 rowmax_in=0.5182 rowmax_out=0.6785 discrete_mse=966.048157 best_discrete=0.891176 hash=False elapsed=14.0s
step   175/900 tau=0.5006 loss=0.296572 mse_soft=0.295947 ent_in=1.3282 ent_out=0.7543 rowmax_in=0.5222 rowmax_out=0.7224 discrete_mse=567.041138 best_discrete=0.891176 hash=False elapsed=16.2s
step   200/900 tau=0.4532 loss=0.288619 mse_soft=0.288045 ent_in=1.2624 ent_out=0.6538 rowmax_in=0.5327 rowmax_out=0.7511 discrete_mse=567.041138 best_discrete=0.891176 hash=False elapsed=18.4s
step   225/900 tau=0.4103 loss=0.284388 mse_soft=0.283847 ent_in=1.2198 ent_out=0.5861 rowmax_in=0.5373 rowmax_out=0.7683 discrete_mse=906.227051 best_discrete=0.891176 hash=False elapsed=20.7s
step   250/900 tau=0.3715 loss=0.281922 mse_soft=0.281401 ent_in=1.1940 ent_out=0.5430 rowmax_in=0.5370 rowmax_out=0.7769 discrete_mse=1485.940796 best_discrete=0.891176 hash=False elapsed=22.9s
step   275/900 tau=0.3363 loss=0.280245 mse_soft=0.279740 ent_in=1.1735 ent_out=0.5095 rowmax_in=0.5389 rowmax_out=0.7860 discrete_mse=1485.940796 best_discrete=0.891176 hash=False elapsed=25.1s
step   300/900 tau=0.3045 loss=0.279316 mse_soft=0.278826 ent_in=1.1537 ent_out=0.4809 rowmax_in=0.5395 rowmax_out=0.7927 discrete_mse=1323.976929 best_discrete=0.891176 hash=False elapsed=27.3s
step   325/900 tau=0.2756 loss=0.279052 mse_soft=0.278575 ent_in=1.1361 ent_out=0.4538 rowmax_in=0.5408 rowmax_out=0.7982 discrete_mse=1764.137207 best_discrete=0.891176 hash=False elapsed=29.8s
step   350/900 tau=0.2496 loss=0.280092 mse_soft=0.279623 ent_in=1.1210 ent_out=0.4432 rowmax_in=0.5444 rowmax_out=0.7998 discrete_mse=1764.137207 best_discrete=0.891176 hash=False elapsed=32.5s
step   375/900 tau=0.2259 loss=0.277476 mse_soft=0.277012 ent_in=1.1120 ent_out=0.4341 rowmax_in=0.5450 rowmax_out=0.8022 discrete_mse=1764.137207 best_discrete=0.891176 hash=False elapsed=35.0s
step   400/900 tau=0.2046 loss=0.275780 mse_soft=0.275322 ent_in=1.1019 ent_out=0.4259 rowmax_in=0.5457 rowmax_out=0.8038 discrete_mse=1764.137207 best_discrete=0.891176 hash=False elapsed=37.4s
step   425/900 tau=0.1852 loss=0.281231 mse_soft=0.280778 ent_in=1.0887 ent_out=0.4203 rowmax_in=0.5498 rowmax_out=0.8045 discrete_mse=1541.422607 best_discrete=0.891176 hash=False elapsed=39.8s
step   450/900 tau=0.1677 loss=0.279450 mse_soft=0.278999 ent_in=1.0835 ent_out=0.4205 rowmax_in=0.5495 rowmax_out=0.8009 discrete_mse=1541.422607 best_discrete=0.891176 hash=False elapsed=42.0s
step   475/900 tau=0.1518 loss=0.283333 mse_soft=0.282886 ent_in=1.0735 ent_out=0.4178 rowmax_in=0.5533 rowmax_out=0.8006 discrete_mse=1541.422607 best_discrete=0.891176 hash=False elapsed=44.4s
step   500/900 tau=0.1374 loss=0.284486 mse_soft=0.284042 ent_in=1.0667 ent_out=0.4150 rowmax_in=0.5533 rowmax_out=0.7989 discrete_mse=1541.422607 best_discrete=0.891176 hash=False elapsed=46.8s
step   525/900 tau=0.1244 loss=0.281902 mse_soft=0.281462 ent_in=1.0577 ent_out=0.4115 rowmax_in=0.5540 rowmax_out=0.7997 discrete_mse=335.300629 best_discrete=0.891176 hash=False elapsed=49.0s
step   550/900 tau=0.1126 loss=0.288907 mse_soft=0.288470 ent_in=1.0478 ent_out=0.4082 rowmax_in=0.5565 rowmax_out=0.8002 discrete_mse=680.606995 best_discrete=0.891176 hash=False elapsed=51.4s
step   575/900 tau=0.1020 loss=0.282717 mse_soft=0.282283 ent_in=1.0417 ent_out=0.4046 rowmax_in=0.5544 rowmax_out=0.8019 discrete_mse=626.760864 best_discrete=0.891176 hash=False elapsed=53.7s
step   600/900 tau=0.0923 loss=0.284754 mse_soft=0.284326 ent_in=1.0242 ent_out=0.4006 rowmax_in=0.5565 rowmax_out=0.7996 discrete_mse=1541.422607 best_discrete=0.891176 hash=False elapsed=56.0s
step   625/900 tau=0.0836 loss=0.284052 mse_soft=0.283628 ent_in=1.0098 ent_out=0.4041 rowmax_in=0.5600 rowmax_out=0.7922 discrete_mse=185.331650 best_discrete=0.891176 hash=False elapsed=58.2s
step   650/900 tau=0.0757 loss=0.284413 mse_soft=0.283994 ent_in=1.0043 ent_out=0.3917 rowmax_in=0.5580 rowmax_out=0.8023 discrete_mse=1093.063965 best_discrete=0.891176 hash=False elapsed=60.2s
step   675/900 tau=0.0685 loss=0.345514 mse_soft=0.345131 ent_in=0.9034 ent_out=0.3731 rowmax_in=0.5985 rowmax_out=0.8003 discrete_mse=318.876190 best_discrete=0.891176 hash=False elapsed=62.3s
step   700/900 tau=0.0620 loss=0.305373 mse_soft=0.305018 ent_in=0.8132 ent_out=0.3675 rowmax_in=0.6325 rowmax_out=0.7913 discrete_mse=396.024536 best_discrete=0.891176 hash=False elapsed=64.5s
step   725/900 tau=0.0562 loss=0.293632 mse_soft=0.293279 ent_in=0.8068 ent_out=0.3696 rowmax_in=0.6330 rowmax_out=0.7913 discrete_mse=1037.317627 best_discrete=0.891176 hash=False elapsed=66.8s
step   750/900 tau=0.0508 loss=0.300344 mse_soft=0.299997 ent_in=0.7871 ent_out=0.3689 rowmax_in=0.6400 rowmax_out=0.7903 discrete_mse=813.838806 best_discrete=0.891176 hash=False elapsed=69.0s
step   775/900 tau=0.0460 loss=0.388497 mse_soft=0.388209 ent_in=0.6345 ent_out=0.3263 rowmax_in=0.6926 rowmax_out=0.8223 discrete_mse=280.664551 best_discrete=0.891176 hash=False elapsed=71.3s
step   800/900 tau=0.0417 loss=0.413928 mse_soft=0.413680 ent_in=0.5076 ent_out=0.3197 rowmax_in=0.7518 rowmax_out=0.8198 discrete_mse=401.985931 best_discrete=0.891176 hash=False elapsed=73.7s
step   825/900 tau=0.0377 loss=0.343539 mse_soft=0.343291 ent_in=0.5040 ent_out=0.3236 rowmax_in=0.7252 rowmax_out=0.8180 discrete_mse=555.609375 best_discrete=0.891176 hash=False elapsed=76.2s
step   850/900 tau=0.0342 loss=0.326535 mse_soft=0.326280 ent_in=0.5189 ent_out=0.3322 rowmax_in=0.7371 rowmax_out=0.8071 discrete_mse=731.163391 best_discrete=0.891176 hash=False elapsed=78.8s
step   875/900 tau=0.0309 loss=0.343731 mse_soft=0.343481 ent_in=0.5127 ent_out=0.3215 rowmax_in=0.7221 rowmax_out=0.8137 discrete_mse=114.719734 best_discrete=0.891176 hash=False elapsed=81.0s
step   900/900 tau=0.0280 loss=0.333990 mse_soft=0.333749 ent_in=0.4752 ent_out=0.3294 rowmax_in=0.7464 rowmax_out=0.8095 discrete_mse=1265.734131 best_discrete=0.891176 hash=False elapsed=83.0s

Final metrics:
  soft_mse_full=0.336430
  rowmax_in_mean=0.7457
  rowmax_out_mean=0.8075
  ent_in_mean=0.4765
  ent_out_mean=0.3310
  final_discrete_mse=812.973633
  hash_match=False
  best_discrete_mse_seen=0.891176
Saved results to overnight_b104_j2.json
