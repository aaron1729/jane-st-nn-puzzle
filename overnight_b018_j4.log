Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.015
step     1/700 tau=1.0000 loss=1.064177 mse_soft=1.063403 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=389.310181 best_discrete=389.310181 hash=False elapsed=0.5s
step    25/700 tau=0.8810 loss=0.971808 mse_soft=0.971049 ent_in=3.7928 ent_out=3.8055 rowmax_in=0.0331 rowmax_out=0.0324 discrete_mse=767.441467 best_discrete=389.310181 hash=False elapsed=2.7s
step    50/700 tau=0.7721 loss=0.785292 mse_soft=0.784584 ent_in=3.5139 ent_out=3.5649 rowmax_in=0.0561 rowmax_out=0.0542 discrete_mse=10562.874023 best_discrete=389.310181 hash=False elapsed=4.9s
step    75/700 tau=0.6767 loss=0.643083 mse_soft=0.642446 ent_in=3.1360 ent_out=3.2346 rowmax_in=0.0967 rowmax_out=0.0894 discrete_mse=5386.721680 best_discrete=389.310181 hash=False elapsed=7.3s
step   100/700 tau=0.5931 loss=0.530442 mse_soft=0.529889 ent_in=2.7139 ent_out=2.8176 rowmax_in=0.1843 rowmax_out=0.1710 discrete_mse=4118.612793 best_discrete=389.310181 hash=False elapsed=9.4s
step   125/700 tau=0.5198 loss=0.439933 mse_soft=0.439496 ent_in=2.1972 ent_out=2.1729 rowmax_in=0.2929 rowmax_out=0.3148 discrete_mse=1469.950806 best_discrete=389.310181 hash=False elapsed=11.5s
step   150/700 tau=0.4555 loss=0.361081 mse_soft=0.360759 ent_in=1.7081 ent_out=1.5187 rowmax_in=0.4238 rowmax_out=0.5021 discrete_mse=4.427900 best_discrete=4.427900 hash=False elapsed=13.7s
step   175/700 tau=0.3992 loss=0.324785 mse_soft=0.324537 ent_in=1.4153 ent_out=1.0661 rowmax_in=0.4872 rowmax_out=0.6298 discrete_mse=223.260498 best_discrete=4.427900 hash=False elapsed=16.1s
step   200/700 tau=0.3499 loss=0.310285 mse_soft=0.310073 ent_in=1.2654 ent_out=0.8575 rowmax_in=0.5141 rowmax_out=0.6764 discrete_mse=227.256348 best_discrete=4.427900 hash=False elapsed=18.2s
step   225/700 tau=0.3066 loss=0.302420 mse_soft=0.302230 ent_in=1.1777 ent_out=0.7174 rowmax_in=0.5248 rowmax_out=0.7150 discrete_mse=351.425598 best_discrete=4.427900 hash=False elapsed=20.3s
step   250/700 tau=0.2687 loss=0.296686 mse_soft=0.296511 ent_in=1.1232 ent_out=0.6270 rowmax_in=0.5328 rowmax_out=0.7307 discrete_mse=351.425598 best_discrete=4.427900 hash=False elapsed=22.6s
step   275/700 tau=0.2355 loss=0.294256 mse_soft=0.294087 ent_in=1.0987 ent_out=0.5905 rowmax_in=0.5330 rowmax_out=0.7374 discrete_mse=1085.964722 best_discrete=4.427900 hash=False elapsed=24.9s
step   300/700 tau=0.2064 loss=0.293378 mse_soft=0.293214 ent_in=1.0766 ent_out=0.5598 rowmax_in=0.5346 rowmax_out=0.7461 discrete_mse=1064.656616 best_discrete=4.427900 hash=False elapsed=26.9s
step   325/700 tau=0.1809 loss=0.290889 mse_soft=0.290729 ent_in=1.0629 ent_out=0.5399 rowmax_in=0.5356 rowmax_out=0.7490 discrete_mse=2045.462402 best_discrete=4.427900 hash=False elapsed=28.9s
step   350/700 tau=0.1585 loss=0.289989 mse_soft=0.289831 ent_in=1.0555 ent_out=0.5267 rowmax_in=0.5357 rowmax_out=0.7516 discrete_mse=2045.462402 best_discrete=4.427900 hash=False elapsed=31.0s
step   375/700 tau=0.1389 loss=0.288293 mse_soft=0.288136 ent_in=1.0488 ent_out=0.5160 rowmax_in=0.5365 rowmax_out=0.7549 discrete_mse=1271.609985 best_discrete=4.427900 hash=False elapsed=33.0s
step   400/700 tau=0.1218 loss=0.289807 mse_soft=0.289652 ent_in=1.0450 ent_out=0.5093 rowmax_in=0.5379 rowmax_out=0.7576 discrete_mse=856.484375 best_discrete=4.427900 hash=False elapsed=35.1s
step   425/700 tau=0.1067 loss=0.293327 mse_soft=0.293173 ent_in=1.0442 ent_out=0.5052 rowmax_in=0.5384 rowmax_out=0.7562 discrete_mse=1644.515503 best_discrete=4.427900 hash=False elapsed=37.2s
step   450/700 tau=0.0935 loss=0.298094 mse_soft=0.297941 ent_in=1.0380 ent_out=0.4943 rowmax_in=0.5380 rowmax_out=0.7576 discrete_mse=1706.630737 best_discrete=4.427900 hash=False elapsed=39.2s
step   475/700 tau=0.0820 loss=0.297054 mse_soft=0.296902 ent_in=1.0335 ent_out=0.4912 rowmax_in=0.5408 rowmax_out=0.7605 discrete_mse=1622.178101 best_discrete=4.427900 hash=False elapsed=41.4s
step   500/700 tau=0.0718 loss=0.291392 mse_soft=0.291240 ent_in=1.0251 ent_out=0.4908 rowmax_in=0.5399 rowmax_out=0.7578 discrete_mse=1468.293579 best_discrete=4.427900 hash=False elapsed=43.4s
step   525/700 tau=0.0630 loss=0.297397 mse_soft=0.297246 ent_in=1.0226 ent_out=0.4864 rowmax_in=0.5388 rowmax_out=0.7637 discrete_mse=1468.293579 best_discrete=4.427900 hash=False elapsed=45.4s
step   550/700 tau=0.0552 loss=0.289782 mse_soft=0.289632 ent_in=1.0211 ent_out=0.4752 rowmax_in=0.5366 rowmax_out=0.7711 discrete_mse=1468.293579 best_discrete=4.427900 hash=False elapsed=47.4s
step   575/700 tau=0.0484 loss=0.369950 mse_soft=0.369813 ent_in=0.9345 ent_out=0.4366 rowmax_in=0.5795 rowmax_out=0.7864 discrete_mse=89.134651 best_discrete=4.427900 hash=False elapsed=49.6s
step   600/700 tau=0.0424 loss=0.320621 mse_soft=0.320493 ent_in=0.8317 ent_out=0.4465 rowmax_in=0.6110 rowmax_out=0.7626 discrete_mse=118.984497 best_discrete=4.427900 hash=False elapsed=51.6s
step   625/700 tau=0.0371 loss=0.306142 mse_soft=0.306014 ent_in=0.8267 ent_out=0.4459 rowmax_in=0.6076 rowmax_out=0.7742 discrete_mse=38.602531 best_discrete=4.427900 hash=False elapsed=53.6s
step   650/700 tau=0.0325 loss=0.305466 mse_soft=0.305338 ent_in=0.8229 ent_out=0.4512 rowmax_in=0.6074 rowmax_out=0.7656 discrete_mse=38.602531 best_discrete=4.427900 hash=False elapsed=55.7s
step   675/700 tau=0.0285 loss=0.307519 mse_soft=0.307393 ent_in=0.8249 ent_out=0.4363 rowmax_in=0.6056 rowmax_out=0.7732 discrete_mse=38.602531 best_discrete=4.427900 hash=False elapsed=58.0s
step   700/700 tau=0.0250 loss=0.391432 mse_soft=0.391337 ent_in=0.5943 ent_out=0.3605 rowmax_in=0.7231 rowmax_out=0.8261 discrete_mse=14.259270 best_discrete=4.427900 hash=False elapsed=60.2s

Final metrics:
  soft_mse_full=0.393315
  rowmax_in_mean=0.7285
  rowmax_out_mean=0.8286
  ent_in_mean=0.5886
  ent_out_mean=0.3591
  final_discrete_mse=2.451528
  hash_match=False
  best_discrete_mse_seen=4.427900
Saved results to overnight_b018_j4.json
