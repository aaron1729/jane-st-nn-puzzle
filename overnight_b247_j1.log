Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.094502 mse_soft=1.092179 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=53.316425 best_discrete=53.316425 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.881537 mse_soft=0.879346 ent_in=3.6356 ent_out=3.6683 rowmax_in=0.0456 rowmax_out=0.0444 discrete_mse=3294.551514 best_discrete=53.316425 hash=False elapsed=2.6s
step    50/900 tau=0.8260 loss=0.660028 mse_soft=0.658113 ent_in=3.1385 ent_out=3.2420 rowmax_in=0.0966 rowmax_out=0.0854 discrete_mse=732.209900 best_discrete=53.316425 hash=False elapsed=4.9s
step    75/900 tau=0.7493 loss=0.526564 mse_soft=0.524948 ent_in=2.6426 ent_out=2.7442 rowmax_in=0.1977 rowmax_out=0.1789 discrete_mse=913.885986 best_discrete=53.316425 hash=False elapsed=7.1s
step   100/900 tau=0.6797 loss=0.424962 mse_soft=0.423734 ent_in=2.0926 ent_out=1.9997 rowmax_in=0.3307 rowmax_out=0.3531 discrete_mse=453.282684 best_discrete=53.316425 hash=False elapsed=9.2s
step   125/900 tau=0.6165 loss=0.358725 mse_soft=0.357836 ent_in=1.7153 ent_out=1.2480 rowmax_in=0.4049 rowmax_out=0.5851 discrete_mse=182.902374 best_discrete=53.316425 hash=False elapsed=11.6s
step   150/900 tau=0.5592 loss=0.324899 mse_soft=0.324228 ent_in=1.4773 ent_out=0.7594 rowmax_in=0.4579 rowmax_out=0.7456 discrete_mse=854.358582 best_discrete=53.316425 hash=False elapsed=13.9s
step   175/900 tau=0.5073 loss=0.311824 mse_soft=0.311256 ent_in=1.3456 ent_out=0.5467 rowmax_in=0.4833 rowmax_out=0.8064 discrete_mse=780.842712 best_discrete=53.316425 hash=False elapsed=16.2s
step   200/900 tau=0.4602 loss=0.304173 mse_soft=0.303666 ent_in=1.2694 ent_out=0.4216 rowmax_in=0.4956 rowmax_out=0.8444 discrete_mse=510.466034 best_discrete=53.316425 hash=False elapsed=18.6s
step   225/900 tau=0.4174 loss=0.298723 mse_soft=0.298247 ent_in=1.2246 ent_out=0.3618 rowmax_in=0.5045 rowmax_out=0.8619 discrete_mse=677.458008 best_discrete=53.316425 hash=False elapsed=21.2s
step   250/900 tau=0.3786 loss=0.294667 mse_soft=0.294209 ent_in=1.2075 ent_out=0.3188 rowmax_in=0.5061 rowmax_out=0.8793 discrete_mse=677.458008 best_discrete=53.316425 hash=False elapsed=23.5s
step   275/900 tau=0.3434 loss=0.291850 mse_soft=0.291406 ent_in=1.1918 ent_out=0.2869 rowmax_in=0.5075 rowmax_out=0.8929 discrete_mse=315.639526 best_discrete=53.316425 hash=False elapsed=25.8s
step   300/900 tau=0.3115 loss=0.290742 mse_soft=0.290305 ent_in=1.1846 ent_out=0.2719 rowmax_in=0.5085 rowmax_out=0.8964 discrete_mse=471.863953 best_discrete=53.316425 hash=False elapsed=28.4s
step   325/900 tau=0.2826 loss=0.288016 mse_soft=0.287586 ent_in=1.1749 ent_out=0.2595 rowmax_in=0.5063 rowmax_out=0.8984 discrete_mse=225.405075 best_discrete=53.316425 hash=False elapsed=30.7s
step   350/900 tau=0.2563 loss=0.288562 mse_soft=0.288138 ent_in=1.1580 ent_out=0.2576 rowmax_in=0.5082 rowmax_out=0.8936 discrete_mse=144.392990 best_discrete=53.316425 hash=False elapsed=33.2s
step   375/900 tau=0.2325 loss=0.288447 mse_soft=0.288027 ent_in=1.1467 ent_out=0.2545 rowmax_in=0.5093 rowmax_out=0.8920 discrete_mse=144.392990 best_discrete=53.316425 hash=False elapsed=35.6s
step   400/900 tau=0.2109 loss=0.286925 mse_soft=0.286506 ent_in=1.1372 ent_out=0.2604 rowmax_in=0.5121 rowmax_out=0.8897 discrete_mse=233.447601 best_discrete=53.316425 hash=False elapsed=38.0s
step   425/900 tau=0.1913 loss=0.288963 mse_soft=0.288546 ent_in=1.1294 ent_out=0.2602 rowmax_in=0.5125 rowmax_out=0.8877 discrete_mse=233.447601 best_discrete=53.316425 hash=False elapsed=40.5s
step   450/900 tau=0.1735 loss=0.288077 mse_soft=0.287662 ent_in=1.1211 ent_out=0.2618 rowmax_in=0.5161 rowmax_out=0.8880 discrete_mse=288.291260 best_discrete=53.316425 hash=False elapsed=42.7s
step   475/900 tau=0.1574 loss=0.286976 mse_soft=0.286563 ent_in=1.1161 ent_out=0.2618 rowmax_in=0.5170 rowmax_out=0.8881 discrete_mse=155.362152 best_discrete=53.316425 hash=False elapsed=44.9s
step   500/900 tau=0.1428 loss=0.283296 mse_soft=0.282885 ent_in=1.1102 ent_out=0.2604 rowmax_in=0.5168 rowmax_out=0.8898 discrete_mse=288.291260 best_discrete=53.316425 hash=False elapsed=47.3s
step   525/900 tau=0.1295 loss=0.306895 mse_soft=0.306491 ent_in=1.0879 ent_out=0.2581 rowmax_in=0.5251 rowmax_out=0.8897 discrete_mse=1498.342529 best_discrete=53.316425 hash=False elapsed=49.9s
step   550/900 tau=0.1175 loss=0.295835 mse_soft=0.295437 ent_in=1.0828 ent_out=0.2443 rowmax_in=0.5226 rowmax_out=0.8967 discrete_mse=289.913818 best_discrete=53.316425 hash=False elapsed=52.5s
step   575/900 tau=0.1066 loss=0.293719 mse_soft=0.293326 ent_in=1.0763 ent_out=0.2332 rowmax_in=0.5208 rowmax_out=0.9012 discrete_mse=289.913818 best_discrete=53.316425 hash=False elapsed=55.1s
step   600/900 tau=0.0967 loss=0.288173 mse_soft=0.287783 ent_in=1.0761 ent_out=0.2244 rowmax_in=0.5131 rowmax_out=0.9072 discrete_mse=452.823151 best_discrete=53.316425 hash=False elapsed=57.4s
step   625/900 tau=0.0877 loss=0.308420 mse_soft=0.308038 ent_in=1.0579 ent_out=0.2149 rowmax_in=0.5262 rowmax_out=0.9099 discrete_mse=138.428299 best_discrete=53.316425 hash=False elapsed=59.6s
step   650/900 tau=0.0795 loss=0.328467 mse_soft=0.328099 ent_in=1.0310 ent_out=0.1971 rowmax_in=0.5359 rowmax_out=0.9161 discrete_mse=138.199600 best_discrete=53.316425 hash=False elapsed=62.1s
step   675/900 tau=0.0722 loss=0.311058 mse_soft=0.310726 ent_in=0.9030 ent_out=0.2061 rowmax_in=0.5884 rowmax_out=0.8924 discrete_mse=54.092323 best_discrete=53.316425 hash=False elapsed=64.4s
step   700/900 tau=0.0655 loss=0.328745 mse_soft=0.328404 ent_in=0.9272 ent_out=0.2111 rowmax_in=0.5585 rowmax_out=0.8992 discrete_mse=191.876556 best_discrete=53.316425 hash=False elapsed=66.7s
step   725/900 tau=0.0594 loss=0.309903 mse_soft=0.309562 ent_in=0.9103 ent_out=0.2272 rowmax_in=0.5692 rowmax_out=0.8908 discrete_mse=47.524960 best_discrete=47.524960 hash=False elapsed=69.1s
step   750/900 tau=0.0539 loss=0.354869 mse_soft=0.354546 ent_in=0.8767 ent_out=0.1996 rowmax_in=0.5747 rowmax_out=0.9115 discrete_mse=155.916901 best_discrete=47.524960 hash=False elapsed=71.7s
step   775/900 tau=0.0489 loss=0.374964 mse_soft=0.374671 ent_in=0.7799 ent_out=0.1975 rowmax_in=0.6209 rowmax_out=0.9039 discrete_mse=44.709949 best_discrete=44.709949 hash=False elapsed=73.9s
step   800/900 tau=0.0443 loss=0.510060 mse_soft=0.509901 ent_in=0.4285 ent_out=0.1002 rowmax_in=0.8162 rowmax_out=0.9418 discrete_mse=21.358854 best_discrete=21.358854 hash=False elapsed=76.5s
step   825/900 tau=0.0402 loss=0.430830 mse_soft=0.430656 ent_in=0.4819 ent_out=0.0969 rowmax_in=0.7438 rowmax_out=0.9428 discrete_mse=30.567131 best_discrete=21.358854 hash=False elapsed=78.9s
step   850/900 tau=0.0365 loss=0.408328 mse_soft=0.408160 ent_in=0.4656 ent_out=0.0973 rowmax_in=0.7593 rowmax_out=0.9459 discrete_mse=33.173901 best_discrete=21.358854 hash=False elapsed=81.1s
step   875/900 tau=0.0331 loss=0.510019 mse_soft=0.509904 ent_in=0.3242 ent_out=0.0591 rowmax_in=0.8384 rowmax_out=0.9709 discrete_mse=51.289894 best_discrete=21.358854 hash=False elapsed=83.5s
step   900/900 tau=0.0300 loss=0.442797 mse_soft=0.442658 ent_in=0.3789 ent_out=0.0839 rowmax_in=0.7953 rowmax_out=0.9499 discrete_mse=55.362949 best_discrete=21.358854 hash=False elapsed=85.7s

Final metrics:
  soft_mse_full=0.439205
  rowmax_in_mean=0.7909
  rowmax_out_mean=0.9477
  ent_in_mean=0.3822
  ent_out_mean=0.0861
  final_discrete_mse=52.859398
  hash_match=False
  best_discrete_mse_seen=21.358854
Saved results to overnight_b247_j1.json
