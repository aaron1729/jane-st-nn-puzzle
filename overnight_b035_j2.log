Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.065809 mse_soft=1.063486 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=24.558796 best_discrete=24.558796 hash=False elapsed=0.5s
step    25/900 tau=0.9090 loss=0.864580 mse_soft=0.862391 ent_in=3.6317 ent_out=3.6664 rowmax_in=0.0458 rowmax_out=0.0443 discrete_mse=132.914307 best_discrete=24.558796 hash=False elapsed=2.6s
step    50/900 tau=0.8229 loss=0.651292 mse_soft=0.649388 ent_in=3.1284 ent_out=3.2184 rowmax_in=0.0939 rowmax_out=0.0909 discrete_mse=4401.262207 best_discrete=24.558796 hash=False elapsed=4.7s
step    75/900 tau=0.7450 loss=0.508641 mse_soft=0.507073 ent_in=2.5940 ent_out=2.6316 rowmax_in=0.2057 rowmax_out=0.2070 discrete_mse=5.099902 best_discrete=5.099902 hash=False elapsed=7.0s
step   100/900 tau=0.6745 loss=0.400697 mse_soft=0.399543 ent_in=1.9998 ent_out=1.8461 rowmax_in=0.3484 rowmax_out=0.4199 discrete_mse=1772.473755 best_discrete=5.099902 hash=False elapsed=9.4s
step   125/900 tau=0.6107 loss=0.350227 mse_soft=0.349338 ent_in=1.7195 ent_out=1.2436 rowmax_in=0.3961 rowmax_out=0.5844 discrete_mse=700.633606 best_discrete=5.099902 hash=False elapsed=11.3s
step   150/900 tau=0.5529 loss=0.325083 mse_soft=0.324344 ent_in=1.5429 ent_out=0.9198 rowmax_in=0.4315 rowmax_out=0.6623 discrete_mse=142.548035 best_discrete=5.099902 hash=False elapsed=13.3s
step   175/900 tau=0.5006 loss=0.307495 mse_soft=0.306874 ent_in=1.3766 ent_out=0.6965 rowmax_in=0.4784 rowmax_out=0.7292 discrete_mse=636.648010 best_discrete=5.099902 hash=False elapsed=15.4s
step   200/900 tau=0.4532 loss=0.296903 mse_soft=0.296353 ent_in=1.2975 ent_out=0.5377 rowmax_in=0.5005 rowmax_out=0.7865 discrete_mse=185.228851 best_discrete=5.099902 hash=False elapsed=17.6s
step   225/900 tau=0.4103 loss=0.291278 mse_soft=0.290763 ent_in=1.2482 ent_out=0.4689 rowmax_in=0.5079 rowmax_out=0.7976 discrete_mse=157.557816 best_discrete=5.099902 hash=False elapsed=19.8s
step   250/900 tau=0.3715 loss=0.287495 mse_soft=0.286997 ent_in=1.2297 ent_out=0.4300 rowmax_in=0.5081 rowmax_out=0.8080 discrete_mse=160.687622 best_discrete=5.099902 hash=False elapsed=21.9s
step   275/900 tau=0.3363 loss=0.286352 mse_soft=0.285866 ent_in=1.2098 ent_out=0.4106 rowmax_in=0.5089 rowmax_out=0.8159 discrete_mse=157.557816 best_discrete=5.099902 hash=False elapsed=23.8s
step   300/900 tau=0.3045 loss=0.284064 mse_soft=0.283586 ent_in=1.1950 ent_out=0.4005 rowmax_in=0.5094 rowmax_out=0.8192 discrete_mse=54.633862 best_discrete=5.099902 hash=False elapsed=26.0s
step   325/900 tau=0.2756 loss=0.284593 mse_soft=0.284118 ent_in=1.1922 ent_out=0.3917 rowmax_in=0.5052 rowmax_out=0.8206 discrete_mse=61.331036 best_discrete=5.099902 hash=False elapsed=28.2s
step   350/900 tau=0.2496 loss=0.281380 mse_soft=0.280910 ent_in=1.1907 ent_out=0.3767 rowmax_in=0.5032 rowmax_out=0.8240 discrete_mse=1.799626 best_discrete=1.799626 hash=False elapsed=30.2s
step   375/900 tau=0.2259 loss=0.280063 mse_soft=0.279597 ent_in=1.1828 ent_out=0.3681 rowmax_in=0.5024 rowmax_out=0.8271 discrete_mse=1.799626 best_discrete=1.799626 hash=False elapsed=32.2s
step   400/900 tau=0.2046 loss=0.280105 mse_soft=0.279643 ent_in=1.1766 ent_out=0.3626 rowmax_in=0.5029 rowmax_out=0.8299 discrete_mse=33.954254 best_discrete=1.799626 hash=False elapsed=34.3s
step   425/900 tau=0.1852 loss=0.287436 mse_soft=0.286976 ent_in=1.1687 ent_out=0.3632 rowmax_in=0.5042 rowmax_out=0.8265 discrete_mse=1.799626 best_discrete=1.799626 hash=False elapsed=36.3s
step   450/900 tau=0.1677 loss=0.284036 mse_soft=0.283582 ent_in=1.1657 ent_out=0.3460 rowmax_in=0.5026 rowmax_out=0.8336 discrete_mse=2.797954 best_discrete=1.799626 hash=False elapsed=38.6s
step   475/900 tau=0.1518 loss=0.281214 mse_soft=0.280760 ent_in=1.1641 ent_out=0.3495 rowmax_in=0.5015 rowmax_out=0.8304 discrete_mse=13.303875 best_discrete=1.799626 hash=False elapsed=40.8s
step   500/900 tau=0.1374 loss=0.283130 mse_soft=0.282677 ent_in=1.1628 ent_out=0.3466 rowmax_in=0.5031 rowmax_out=0.8327 discrete_mse=2.797954 best_discrete=1.799626 hash=False elapsed=42.9s
step   525/900 tau=0.1244 loss=0.292941 mse_soft=0.292488 ent_in=1.1609 ent_out=0.3491 rowmax_in=0.5035 rowmax_out=0.8298 discrete_mse=30.117947 best_discrete=1.799626 hash=False elapsed=44.9s
step   550/900 tau=0.1126 loss=0.286426 mse_soft=0.285972 ent_in=1.1596 ent_out=0.3556 rowmax_in=0.5033 rowmax_out=0.8255 discrete_mse=4.507854 best_discrete=1.799626 hash=False elapsed=47.1s
step   575/900 tau=0.1020 loss=0.295420 mse_soft=0.294968 ent_in=1.1620 ent_out=0.3464 rowmax_in=0.4997 rowmax_out=0.8348 discrete_mse=30.117947 best_discrete=1.799626 hash=False elapsed=49.5s
step   600/900 tau=0.0923 loss=0.284690 mse_soft=0.284242 ent_in=1.1483 ent_out=0.3447 rowmax_in=0.5059 rowmax_out=0.8327 discrete_mse=30.162468 best_discrete=1.799626 hash=False elapsed=51.8s
step   625/900 tau=0.0836 loss=0.292285 mse_soft=0.291851 ent_in=1.1057 ent_out=0.3409 rowmax_in=0.5083 rowmax_out=0.8224 discrete_mse=103.434059 best_discrete=1.799626 hash=False elapsed=53.8s
step   650/900 tau=0.0757 loss=0.293565 mse_soft=0.293138 ent_in=1.0999 ent_out=0.3248 rowmax_in=0.5228 rowmax_out=0.8323 discrete_mse=22.579023 best_discrete=1.799626 hash=False elapsed=56.0s
step   675/900 tau=0.0685 loss=0.315917 mse_soft=0.315546 ent_in=0.9463 ent_out=0.2889 rowmax_in=0.5892 rowmax_out=0.8556 discrete_mse=43.605999 best_discrete=1.799626 hash=False elapsed=58.3s
step   700/900 tau=0.0620 loss=0.316880 mse_soft=0.316510 ent_in=0.9460 ent_out=0.2858 rowmax_in=0.5787 rowmax_out=0.8543 discrete_mse=35.524830 best_discrete=1.799626 hash=False elapsed=60.3s
step   725/900 tau=0.0562 loss=0.328788 mse_soft=0.328443 ent_in=0.8754 ent_out=0.2733 rowmax_in=0.6191 rowmax_out=0.8633 discrete_mse=18.882812 best_discrete=1.799626 hash=False elapsed=62.5s
step   750/900 tau=0.0508 loss=0.312393 mse_soft=0.312060 ent_in=0.8430 ent_out=0.2683 rowmax_in=0.6195 rowmax_out=0.8585 discrete_mse=38.032181 best_discrete=1.799626 hash=False elapsed=64.5s
step   775/900 tau=0.0460 loss=0.309528 mse_soft=0.309199 ent_in=0.8320 ent_out=0.2641 rowmax_in=0.6280 rowmax_out=0.8599 discrete_mse=45.131725 best_discrete=1.799626 hash=False elapsed=66.6s
step   800/900 tau=0.0417 loss=0.445562 mse_soft=0.445353 ent_in=0.4899 ent_out=0.2056 rowmax_in=0.7622 rowmax_out=0.8983 discrete_mse=136.183426 best_discrete=1.799626 hash=False elapsed=68.7s
step   825/900 tau=0.0377 loss=0.397241 mse_soft=0.397058 ent_in=0.4278 ent_out=0.1830 rowmax_in=0.7914 rowmax_out=0.9017 discrete_mse=33.336029 best_discrete=1.799626 hash=False elapsed=70.8s
step   850/900 tau=0.0342 loss=0.381335 mse_soft=0.381163 ent_in=0.4154 ent_out=0.1595 rowmax_in=0.7852 rowmax_out=0.9128 discrete_mse=85.427200 best_discrete=1.799626 hash=False elapsed=72.9s
step   875/900 tau=0.0309 loss=0.371970 mse_soft=0.371791 ent_in=0.4330 ent_out=0.1634 rowmax_in=0.7753 rowmax_out=0.9118 discrete_mse=52.449612 best_discrete=1.799626 hash=False elapsed=74.9s
step   900/900 tau=0.0280 loss=0.368618 mse_soft=0.368451 ent_in=0.4071 ent_out=0.1495 rowmax_in=0.7887 rowmax_out=0.9181 discrete_mse=65.596863 best_discrete=1.799626 hash=False elapsed=76.9s

Final metrics:
  soft_mse_full=0.378115
  rowmax_in_mean=0.7904
  rowmax_out_mean=0.9188
  ent_in_mean=0.4080
  ent_out_mean=0.1477
  final_discrete_mse=26.379210
  hash_match=False
  best_discrete_mse_seen=1.799626
Saved results to overnight_b035_j2.json
