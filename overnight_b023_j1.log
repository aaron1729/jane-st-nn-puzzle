Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.072070 mse_soft=1.069748 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=45.711636 best_discrete=45.711636 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.870265 mse_soft=0.868075 ent_in=3.6312 ent_out=3.6686 rowmax_in=0.0471 rowmax_out=0.0438 discrete_mse=1071.481689 best_discrete=45.711636 hash=False elapsed=2.4s
step    50/900 tau=0.8260 loss=0.663638 mse_soft=0.661726 ent_in=3.1378 ent_out=3.2347 rowmax_in=0.0904 rowmax_out=0.0850 discrete_mse=5064.065918 best_discrete=45.711636 hash=False elapsed=4.4s
step    75/900 tau=0.7493 loss=0.532226 mse_soft=0.530617 ent_in=2.6387 ent_out=2.7278 rowmax_in=0.2028 rowmax_out=0.1937 discrete_mse=966.627747 best_discrete=45.711636 hash=False elapsed=6.4s
step   100/900 tau=0.6797 loss=0.412417 mse_soft=0.411242 ent_in=1.9906 ent_out=1.9280 rowmax_in=0.3593 rowmax_out=0.3961 discrete_mse=882.787781 best_discrete=45.711636 hash=False elapsed=8.4s
step   125/900 tau=0.6165 loss=0.342444 mse_soft=0.341605 ent_in=1.5421 ent_out=1.2568 rowmax_in=0.4789 rowmax_out=0.5989 discrete_mse=383.593292 best_discrete=45.711636 hash=False elapsed=10.3s
step   150/900 tau=0.5592 loss=0.310654 mse_soft=0.310006 ent_in=1.3465 ent_out=0.8124 rowmax_in=0.5092 rowmax_out=0.7200 discrete_mse=667.056091 best_discrete=45.711636 hash=False elapsed=12.3s
step   175/900 tau=0.5073 loss=0.293060 mse_soft=0.292500 ent_in=1.2574 ent_out=0.6101 rowmax_in=0.5178 rowmax_out=0.7749 discrete_mse=181.522949 best_discrete=45.711636 hash=False elapsed=14.4s
step   200/900 tau=0.4602 loss=0.280726 mse_soft=0.280214 ent_in=1.2292 ent_out=0.4774 rowmax_in=0.5112 rowmax_out=0.8252 discrete_mse=98.158958 best_discrete=45.711636 hash=False elapsed=16.4s
step   225/900 tau=0.4174 loss=0.273419 mse_soft=0.272934 ent_in=1.2008 ent_out=0.4137 rowmax_in=0.5129 rowmax_out=0.8494 discrete_mse=149.771896 best_discrete=45.711636 hash=False elapsed=18.4s
step   250/900 tau=0.3786 loss=0.269676 mse_soft=0.269208 ent_in=1.1748 ent_out=0.3875 rowmax_in=0.5186 rowmax_out=0.8531 discrete_mse=149.771896 best_discrete=45.711636 hash=False elapsed=20.4s
step   275/900 tau=0.3434 loss=0.266891 mse_soft=0.266434 ent_in=1.1604 ent_out=0.3641 rowmax_in=0.5199 rowmax_out=0.8548 discrete_mse=344.966980 best_discrete=45.711636 hash=False elapsed=22.5s
step   300/900 tau=0.3115 loss=0.265317 mse_soft=0.264866 ent_in=1.1552 ent_out=0.3480 rowmax_in=0.5199 rowmax_out=0.8574 discrete_mse=344.966980 best_discrete=45.711636 hash=False elapsed=24.5s
step   325/900 tau=0.2826 loss=0.263305 mse_soft=0.262861 ent_in=1.1514 ent_out=0.3307 rowmax_in=0.5198 rowmax_out=0.8634 discrete_mse=344.966980 best_discrete=45.711636 hash=False elapsed=26.6s
step   350/900 tau=0.2563 loss=0.263257 mse_soft=0.262818 ent_in=1.1434 ent_out=0.3216 rowmax_in=0.5211 rowmax_out=0.8650 discrete_mse=473.677094 best_discrete=45.711636 hash=False elapsed=28.6s
step   375/900 tau=0.2325 loss=0.263133 mse_soft=0.262701 ent_in=1.1308 ent_out=0.3103 rowmax_in=0.5225 rowmax_out=0.8692 discrete_mse=473.677094 best_discrete=45.711636 hash=False elapsed=30.6s
step   400/900 tau=0.2109 loss=0.263338 mse_soft=0.262908 ent_in=1.1291 ent_out=0.3038 rowmax_in=0.5222 rowmax_out=0.8706 discrete_mse=473.677094 best_discrete=45.711636 hash=False elapsed=32.8s
step   425/900 tau=0.1913 loss=0.263908 mse_soft=0.263481 ent_in=1.1272 ent_out=0.2955 rowmax_in=0.5216 rowmax_out=0.8735 discrete_mse=238.693649 best_discrete=45.711636 hash=False elapsed=34.9s
step   450/900 tau=0.1735 loss=0.267530 mse_soft=0.267105 ent_in=1.1264 ent_out=0.2890 rowmax_in=0.5200 rowmax_out=0.8776 discrete_mse=238.693649 best_discrete=45.711636 hash=False elapsed=36.9s
step   475/900 tau=0.1574 loss=0.261142 mse_soft=0.260720 ent_in=1.1210 ent_out=0.2857 rowmax_in=0.5231 rowmax_out=0.8778 discrete_mse=238.693649 best_discrete=45.711636 hash=False elapsed=39.1s
step   500/900 tau=0.1428 loss=0.269522 mse_soft=0.269102 ent_in=1.1212 ent_out=0.2784 rowmax_in=0.5180 rowmax_out=0.8813 discrete_mse=238.693649 best_discrete=45.711636 hash=False elapsed=41.2s
step   525/900 tau=0.1295 loss=0.264768 mse_soft=0.264348 ent_in=1.1205 ent_out=0.2775 rowmax_in=0.5175 rowmax_out=0.8764 discrete_mse=274.277802 best_discrete=45.711636 hash=False elapsed=43.2s
step   550/900 tau=0.1175 loss=0.265552 mse_soft=0.265134 ent_in=1.1162 ent_out=0.2756 rowmax_in=0.5215 rowmax_out=0.8795 discrete_mse=210.194641 best_discrete=45.711636 hash=False elapsed=45.3s
step   575/900 tau=0.1066 loss=0.307508 mse_soft=0.307098 ent_in=1.0985 ent_out=0.2673 rowmax_in=0.5263 rowmax_out=0.8743 discrete_mse=232.823624 best_discrete=45.711636 hash=False elapsed=47.5s
step   600/900 tau=0.0967 loss=0.267286 mse_soft=0.266895 ent_in=1.0435 ent_out=0.2581 rowmax_in=0.5446 rowmax_out=0.8804 discrete_mse=546.263428 best_discrete=45.711636 hash=False elapsed=49.8s
step   625/900 tau=0.0877 loss=0.267167 mse_soft=0.266779 ent_in=1.0389 ent_out=0.2544 rowmax_in=0.5447 rowmax_out=0.8796 discrete_mse=726.119690 best_discrete=45.711636 hash=False elapsed=52.1s
step   650/900 tau=0.0795 loss=0.266623 mse_soft=0.266238 ent_in=1.0300 ent_out=0.2528 rowmax_in=0.5441 rowmax_out=0.8809 discrete_mse=726.119690 best_discrete=45.711636 hash=False elapsed=54.6s
step   675/900 tau=0.0722 loss=0.285208 mse_soft=0.284827 ent_in=1.0154 ent_out=0.2544 rowmax_in=0.5535 rowmax_out=0.8781 discrete_mse=426.591003 best_discrete=45.711636 hash=False elapsed=57.0s
step   700/900 tau=0.0655 loss=0.278625 mse_soft=0.278257 ent_in=0.9851 ent_out=0.2440 rowmax_in=0.5551 rowmax_out=0.8821 discrete_mse=426.591003 best_discrete=45.711636 hash=False elapsed=59.2s
step   725/900 tau=0.0594 loss=0.322238 mse_soft=0.321901 ent_in=0.8888 ent_out=0.2343 rowmax_in=0.5850 rowmax_out=0.8826 discrete_mse=29.703274 best_discrete=29.703274 hash=False elapsed=61.4s
step   750/900 tau=0.0539 loss=0.299080 mse_soft=0.298768 ent_in=0.8074 ent_out=0.2327 rowmax_in=0.6182 rowmax_out=0.8836 discrete_mse=9.591490 best_discrete=9.591490 hash=False elapsed=63.6s
step   775/900 tau=0.0489 loss=0.295381 mse_soft=0.295069 ent_in=0.8151 ent_out=0.2256 rowmax_in=0.6134 rowmax_out=0.8900 discrete_mse=188.245560 best_discrete=9.591490 hash=False elapsed=65.7s
step   800/900 tau=0.0443 loss=0.379845 mse_soft=0.379537 ent_in=0.8108 ent_out=0.2149 rowmax_in=0.6151 rowmax_out=0.8960 discrete_mse=204.592926 best_discrete=9.591490 hash=False elapsed=68.2s
step   825/900 tau=0.0402 loss=0.448150 mse_soft=0.447982 ent_in=0.4385 ent_out=0.1212 rowmax_in=0.7869 rowmax_out=0.9302 discrete_mse=164.589218 best_discrete=9.591490 hash=False elapsed=70.3s
step   850/900 tau=0.0365 loss=0.421083 mse_soft=0.420935 ent_in=0.3722 ent_out=0.1218 rowmax_in=0.8264 rowmax_out=0.9297 discrete_mse=219.420914 best_discrete=9.591490 hash=False elapsed=72.5s
step   875/900 tau=0.0331 loss=0.408880 mse_soft=0.408719 ent_in=0.4104 ent_out=0.1253 rowmax_in=0.7968 rowmax_out=0.9296 discrete_mse=259.573364 best_discrete=9.591490 hash=False elapsed=74.6s
step   900/900 tau=0.0300 loss=0.449054 mse_soft=0.448921 ent_in=0.3239 ent_out=0.1203 rowmax_in=0.8359 rowmax_out=0.9297 discrete_mse=169.745255 best_discrete=9.591490 hash=False elapsed=76.6s

Final metrics:
  soft_mse_full=0.438789
  rowmax_in_mean=0.8330
  rowmax_out_mean=0.9296
  ent_in_mean=0.3326
  ent_out_mean=0.1202
  final_discrete_mse=209.765244
  hash_match=False
  best_discrete_mse_seen=9.591490
Saved results to overnight_b023_j1.json
