Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.015
step     1/700 tau=1.0000 loss=1.064141 mse_soft=1.063367 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=36.672672 best_discrete=36.672672 hash=False elapsed=0.5s
step    25/700 tau=0.8810 loss=0.971826 mse_soft=0.971066 ent_in=3.7935 ent_out=3.8053 rowmax_in=0.0328 rowmax_out=0.0323 discrete_mse=2323.231934 best_discrete=36.672672 hash=False elapsed=2.6s
step    50/700 tau=0.7721 loss=0.786443 mse_soft=0.785735 ent_in=3.5183 ent_out=3.5659 rowmax_in=0.0555 rowmax_out=0.0543 discrete_mse=9103.835938 best_discrete=36.672672 hash=False elapsed=4.9s
step    75/700 tau=0.6767 loss=0.643705 mse_soft=0.643068 ent_in=3.1405 ent_out=3.2307 rowmax_in=0.0927 rowmax_out=0.0905 discrete_mse=3538.264648 best_discrete=36.672672 hash=False elapsed=7.0s
step   100/700 tau=0.5931 loss=0.534249 mse_soft=0.533694 ent_in=2.7267 ent_out=2.8192 rowmax_in=0.1795 rowmax_out=0.1678 discrete_mse=4500.866699 best_discrete=36.672672 hash=False elapsed=9.2s
step   125/700 tau=0.5198 loss=0.436695 mse_soft=0.436261 ent_in=2.1947 ent_out=2.1506 rowmax_in=0.3070 rowmax_out=0.3358 discrete_mse=2068.932861 best_discrete=36.672672 hash=False elapsed=11.4s
step   150/700 tau=0.4555 loss=0.368840 mse_soft=0.368508 ent_in=1.7635 ent_out=1.5517 rowmax_in=0.4081 rowmax_out=0.4977 discrete_mse=1068.161743 best_discrete=36.672672 hash=False elapsed=13.6s
step   175/700 tau=0.3992 loss=0.330197 mse_soft=0.329939 ent_in=1.4625 ent_out=1.1121 rowmax_in=0.4693 rowmax_out=0.6087 discrete_mse=418.524841 best_discrete=36.672672 hash=False elapsed=15.6s
step   200/700 tau=0.3499 loss=0.315656 mse_soft=0.315435 ent_in=1.3226 ent_out=0.8868 rowmax_in=0.4943 rowmax_out=0.6685 discrete_mse=4041.869385 best_discrete=36.672672 hash=False elapsed=17.7s
step   225/700 tau=0.3066 loss=0.307046 mse_soft=0.306846 ent_in=1.2559 ent_out=0.7425 rowmax_in=0.5011 rowmax_out=0.6968 discrete_mse=1492.724609 best_discrete=36.672672 hash=False elapsed=20.0s
step   250/700 tau=0.2687 loss=0.300447 mse_soft=0.300262 ent_in=1.2180 ent_out=0.6299 rowmax_in=0.5097 rowmax_out=0.7249 discrete_mse=2634.694092 best_discrete=36.672672 hash=False elapsed=22.1s
step   275/700 tau=0.2355 loss=0.297819 mse_soft=0.297644 ent_in=1.1885 ent_out=0.5651 rowmax_in=0.5160 rowmax_out=0.7355 discrete_mse=397.932129 best_discrete=36.672672 hash=False elapsed=24.3s
step   300/700 tau=0.2064 loss=0.295058 mse_soft=0.294889 ent_in=1.1598 ent_out=0.5346 rowmax_in=0.5239 rowmax_out=0.7440 discrete_mse=259.861206 best_discrete=36.672672 hash=False elapsed=26.8s
step   325/700 tau=0.1809 loss=0.293087 mse_soft=0.292921 ent_in=1.1349 ent_out=0.5229 rowmax_in=0.5297 rowmax_out=0.7507 discrete_mse=295.906433 best_discrete=36.672672 hash=False elapsed=28.9s
step   350/700 tau=0.1585 loss=0.295078 mse_soft=0.294915 ent_in=1.1278 ent_out=0.4994 rowmax_in=0.5306 rowmax_out=0.7590 discrete_mse=797.957764 best_discrete=36.672672 hash=False elapsed=31.1s
step   375/700 tau=0.1389 loss=0.290940 mse_soft=0.290779 ent_in=1.1238 ent_out=0.4853 rowmax_in=0.5306 rowmax_out=0.7640 discrete_mse=608.438965 best_discrete=36.672672 hash=False elapsed=33.4s
step   400/700 tau=0.1218 loss=0.291691 mse_soft=0.291533 ent_in=1.1206 ent_out=0.4635 rowmax_in=0.5314 rowmax_out=0.7696 discrete_mse=266.315521 best_discrete=36.672672 hash=False elapsed=35.6s
step   425/700 tau=0.1067 loss=0.294102 mse_soft=0.293946 ent_in=1.1139 ent_out=0.4451 rowmax_in=0.5327 rowmax_out=0.7733 discrete_mse=800.110779 best_discrete=36.672672 hash=False elapsed=37.8s
step   450/700 tau=0.0935 loss=0.293433 mse_soft=0.293278 ent_in=1.1109 ent_out=0.4407 rowmax_in=0.5337 rowmax_out=0.7737 discrete_mse=800.110779 best_discrete=36.672672 hash=False elapsed=39.9s
step   475/700 tau=0.0820 loss=0.293486 mse_soft=0.293332 ent_in=1.1098 ent_out=0.4352 rowmax_in=0.5314 rowmax_out=0.7756 discrete_mse=800.110779 best_discrete=36.672672 hash=False elapsed=42.2s
step   500/700 tau=0.0718 loss=0.289828 mse_soft=0.289674 ent_in=1.1096 ent_out=0.4282 rowmax_in=0.5284 rowmax_out=0.7772 discrete_mse=599.135803 best_discrete=36.672672 hash=False elapsed=44.3s
step   525/700 tau=0.0630 loss=0.297972 mse_soft=0.297820 ent_in=1.1061 ent_out=0.4198 rowmax_in=0.5289 rowmax_out=0.7817 discrete_mse=599.135803 best_discrete=36.672672 hash=False elapsed=46.6s
step   550/700 tau=0.0552 loss=0.301758 mse_soft=0.301605 ent_in=1.1048 ent_out=0.4178 rowmax_in=0.5269 rowmax_out=0.7825 discrete_mse=862.604980 best_discrete=36.672672 hash=False elapsed=49.0s
step   575/700 tau=0.0484 loss=0.321970 mse_soft=0.321821 ent_in=1.0755 ent_out=0.4106 rowmax_in=0.5346 rowmax_out=0.7865 discrete_mse=1105.126343 best_discrete=36.672672 hash=False elapsed=51.3s
step   600/700 tau=0.0424 loss=0.298836 mse_soft=0.298694 ent_in=1.0287 ent_out=0.3896 rowmax_in=0.5530 rowmax_out=0.7929 discrete_mse=253.450439 best_discrete=36.672672 hash=False elapsed=53.6s
step   625/700 tau=0.0371 loss=0.338800 mse_soft=0.338671 ent_in=0.9073 ent_out=0.3838 rowmax_in=0.5942 rowmax_out=0.7966 discrete_mse=127.108307 best_discrete=36.672672 hash=False elapsed=56.0s
step   650/700 tau=0.0325 loss=0.323418 mse_soft=0.323299 ent_in=0.8084 ent_out=0.3816 rowmax_in=0.6182 rowmax_out=0.8013 discrete_mse=121.913612 best_discrete=36.672672 hash=False elapsed=58.3s
step   675/700 tau=0.0285 loss=0.331172 mse_soft=0.331055 ent_in=0.7816 ent_out=0.3810 rowmax_in=0.6268 rowmax_out=0.7987 discrete_mse=9.702080 best_discrete=9.702080 hash=False elapsed=60.7s
step   700/700 tau=0.0250 loss=0.383090 mse_soft=0.382985 ent_in=0.7057 ent_out=0.3417 rowmax_in=0.6668 rowmax_out=0.8210 discrete_mse=70.383583 best_discrete=9.702080 hash=False elapsed=63.2s

Final metrics:
  soft_mse_full=0.420149
  rowmax_in_mean=0.6609
  rowmax_out_mean=0.8169
  ent_in_mean=0.7057
  ent_out_mean=0.3434
  final_discrete_mse=88.475876
  hash_match=False
  best_discrete_mse_seen=9.702080
Saved results to overnight_b077_j4.json
