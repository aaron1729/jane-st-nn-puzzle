Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.062282 mse_soft=1.059959 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=33.213371 best_discrete=33.213371 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.856461 mse_soft=0.854271 ent_in=3.6334 ent_out=3.6683 rowmax_in=0.0462 rowmax_out=0.0441 discrete_mse=155.239639 best_discrete=33.213371 hash=False elapsed=2.9s
step    50/900 tau=0.8260 loss=0.645776 mse_soft=0.643864 ent_in=3.1389 ent_out=3.2351 rowmax_in=0.0927 rowmax_out=0.0869 discrete_mse=4810.445312 best_discrete=33.213371 hash=False elapsed=5.1s
step    75/900 tau=0.7493 loss=0.516595 mse_soft=0.514997 ent_in=2.6123 ent_out=2.7145 rowmax_in=0.2091 rowmax_out=0.1932 discrete_mse=977.836304 best_discrete=33.213371 hash=False elapsed=7.2s
step   100/900 tau=0.6797 loss=0.407215 mse_soft=0.406049 ent_in=1.9891 ent_out=1.8984 rowmax_in=0.3479 rowmax_out=0.3818 discrete_mse=253.959671 best_discrete=33.213371 hash=False elapsed=9.4s
step   125/900 tau=0.6165 loss=0.351367 mse_soft=0.350491 ent_in=1.6568 ent_out=1.2645 rowmax_in=0.4092 rowmax_out=0.5753 discrete_mse=1263.358765 best_discrete=33.213371 hash=False elapsed=11.6s
step   150/900 tau=0.5592 loss=0.327195 mse_soft=0.326465 ent_in=1.5066 ent_out=0.9260 rowmax_in=0.4339 rowmax_out=0.6844 discrete_mse=880.202576 best_discrete=33.213371 hash=False elapsed=13.9s
step   175/900 tau=0.5073 loss=0.311329 mse_soft=0.310670 ent_in=1.4367 ent_out=0.7581 rowmax_in=0.4410 rowmax_out=0.7151 discrete_mse=1981.995728 best_discrete=33.213371 hash=False elapsed=16.2s
step   200/900 tau=0.4602 loss=0.303361 mse_soft=0.302750 ent_in=1.3698 ent_out=0.6671 rowmax_in=0.4557 rowmax_out=0.7343 discrete_mse=1821.156372 best_discrete=33.213371 hash=False elapsed=18.6s
step   225/900 tau=0.4174 loss=0.297772 mse_soft=0.297198 ent_in=1.3301 ent_out=0.5834 rowmax_in=0.4595 rowmax_out=0.7655 discrete_mse=411.430603 best_discrete=33.213371 hash=False elapsed=20.9s
step   250/900 tau=0.3786 loss=0.293551 mse_soft=0.293003 ent_in=1.2993 ent_out=0.5264 rowmax_in=0.4659 rowmax_out=0.7822 discrete_mse=1130.016724 best_discrete=33.213371 hash=False elapsed=23.1s
step   275/900 tau=0.3434 loss=0.293467 mse_soft=0.292938 ent_in=1.2765 ent_out=0.4864 rowmax_in=0.4701 rowmax_out=0.7955 discrete_mse=2098.030762 best_discrete=33.213371 hash=False elapsed=25.4s
step   300/900 tau=0.3115 loss=0.290217 mse_soft=0.289701 ent_in=1.2586 ent_out=0.4601 rowmax_in=0.4733 rowmax_out=0.8026 discrete_mse=1130.016724 best_discrete=33.213371 hash=False elapsed=27.5s
step   325/900 tau=0.2826 loss=0.287175 mse_soft=0.286671 ent_in=1.2365 ent_out=0.4432 rowmax_in=0.4769 rowmax_out=0.8102 discrete_mse=1633.720703 best_discrete=33.213371 hash=False elapsed=30.1s
step   350/900 tau=0.2563 loss=0.288102 mse_soft=0.287606 ent_in=1.2222 ent_out=0.4313 rowmax_in=0.4796 rowmax_out=0.8120 discrete_mse=1633.720703 best_discrete=33.213371 hash=False elapsed=32.3s
step   375/900 tau=0.2325 loss=0.287967 mse_soft=0.287479 ent_in=1.2063 ent_out=0.4196 rowmax_in=0.4845 rowmax_out=0.8180 discrete_mse=3821.389404 best_discrete=33.213371 hash=False elapsed=34.6s
step   400/900 tau=0.2109 loss=0.287023 mse_soft=0.286542 ent_in=1.1954 ent_out=0.4085 rowmax_in=0.4857 rowmax_out=0.8246 discrete_mse=5139.417480 best_discrete=33.213371 hash=False elapsed=37.0s
step   425/900 tau=0.1913 loss=0.285792 mse_soft=0.285316 ent_in=1.1866 ent_out=0.3982 rowmax_in=0.4882 rowmax_out=0.8293 discrete_mse=5359.954102 best_discrete=33.213371 hash=False elapsed=39.1s
step   450/900 tau=0.1735 loss=0.289416 mse_soft=0.288945 ent_in=1.1807 ent_out=0.3871 rowmax_in=0.4890 rowmax_out=0.8328 discrete_mse=5359.954102 best_discrete=33.213371 hash=False elapsed=41.2s
step   475/900 tau=0.1574 loss=0.302298 mse_soft=0.301834 ent_in=1.1724 ent_out=0.3737 rowmax_in=0.4906 rowmax_out=0.8381 discrete_mse=5359.954102 best_discrete=33.213371 hash=False elapsed=43.3s
step   500/900 tau=0.1428 loss=0.284910 mse_soft=0.284449 ent_in=1.1631 ent_out=0.3740 rowmax_in=0.4945 rowmax_out=0.8338 discrete_mse=3369.018311 best_discrete=33.213371 hash=False elapsed=45.4s
step   525/900 tau=0.1295 loss=0.297843 mse_soft=0.297390 ent_in=1.1511 ent_out=0.3585 rowmax_in=0.5012 rowmax_out=0.8397 discrete_mse=1484.308716 best_discrete=33.213371 hash=False elapsed=47.5s
step   550/900 tau=0.1175 loss=0.289643 mse_soft=0.289191 ent_in=1.1439 ent_out=0.3638 rowmax_in=0.4967 rowmax_out=0.8305 discrete_mse=1699.906738 best_discrete=33.213371 hash=False elapsed=49.8s
step   575/900 tau=0.1066 loss=0.285127 mse_soft=0.284676 ent_in=1.1481 ent_out=0.3575 rowmax_in=0.4917 rowmax_out=0.8343 discrete_mse=1680.587769 best_discrete=33.213371 hash=False elapsed=52.1s
step   600/900 tau=0.0967 loss=0.285075 mse_soft=0.284627 ent_in=1.1349 ent_out=0.3569 rowmax_in=0.4947 rowmax_out=0.8342 discrete_mse=553.047302 best_discrete=33.213371 hash=False elapsed=54.5s
step   625/900 tau=0.0877 loss=0.290527 mse_soft=0.290090 ent_in=1.1028 ent_out=0.3526 rowmax_in=0.5113 rowmax_out=0.8331 discrete_mse=817.004456 best_discrete=33.213371 hash=False elapsed=56.8s
step   650/900 tau=0.0795 loss=0.329765 mse_soft=0.329385 ent_in=0.9625 ent_out=0.3046 rowmax_in=0.5557 rowmax_out=0.8464 discrete_mse=247.179871 best_discrete=33.213371 hash=False elapsed=59.1s
step   675/900 tau=0.0722 loss=0.298678 mse_soft=0.298291 ent_in=0.9837 ent_out=0.3059 rowmax_in=0.5362 rowmax_out=0.8509 discrete_mse=1414.306885 best_discrete=33.213371 hash=False elapsed=61.5s
step   700/900 tau=0.0655 loss=0.302171 mse_soft=0.301783 ent_in=0.9898 ent_out=0.3025 rowmax_in=0.5266 rowmax_out=0.8522 discrete_mse=1263.239136 best_discrete=33.213371 hash=False elapsed=63.8s
step   725/900 tau=0.0594 loss=0.363781 mse_soft=0.363414 ent_in=0.9294 ent_out=0.2949 rowmax_in=0.5761 rowmax_out=0.8468 discrete_mse=7.599175 best_discrete=7.599175 hash=False elapsed=65.9s
step   750/900 tau=0.0539 loss=0.412147 mse_soft=0.411921 ent_in=0.5635 ent_out=0.1888 rowmax_in=0.7366 rowmax_out=0.9033 discrete_mse=182.077042 best_discrete=7.599175 hash=False elapsed=68.0s
step   775/900 tau=0.0489 loss=0.364993 mse_soft=0.364770 ent_in=0.5682 ent_out=0.1777 rowmax_in=0.7232 rowmax_out=0.9077 discrete_mse=81.178299 best_discrete=7.599175 hash=False elapsed=70.3s
step   800/900 tau=0.0443 loss=0.360275 mse_soft=0.360049 ent_in=0.5732 ent_out=0.1832 rowmax_in=0.7174 rowmax_out=0.9067 discrete_mse=181.644028 best_discrete=7.599175 hash=False elapsed=72.4s
step   825/900 tau=0.0402 loss=0.360285 mse_soft=0.360050 ent_in=0.5811 ent_out=0.2036 rowmax_in=0.7256 rowmax_out=0.8939 discrete_mse=63.039562 best_discrete=7.599175 hash=False elapsed=74.4s
step   850/900 tau=0.0365 loss=0.467529 mse_soft=0.467309 ent_in=0.5397 ent_out=0.1912 rowmax_in=0.7377 rowmax_out=0.9015 discrete_mse=33.454659 best_discrete=7.599175 hash=False elapsed=76.7s
step   875/900 tau=0.0331 loss=0.445049 mse_soft=0.444897 ent_in=0.3352 ent_out=0.1714 rowmax_in=0.8246 rowmax_out=0.9093 discrete_mse=45.535728 best_discrete=7.599175 hash=False elapsed=78.9s
step   900/900 tau=0.0300 loss=0.434085 mse_soft=0.433941 ent_in=0.3091 ent_out=0.1716 rowmax_in=0.8412 rowmax_out=0.9098 discrete_mse=27.141893 best_discrete=7.599175 hash=False elapsed=81.1s

Final metrics:
  soft_mse_full=0.430723
  rowmax_in_mean=0.8402
  rowmax_out_mean=0.9093
  ent_in_mean=0.3096
  ent_out_mean=0.1724
  final_discrete_mse=27.141893
  hash_match=False
  best_discrete_mse_seen=7.599175
Saved results to overnight_b173_j1.json
