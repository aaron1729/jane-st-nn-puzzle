Using device: cuda
Train rows: 10000 / Full rows: 10000, steps=700, lr=0.02
step     1/700 tau=1.0000 loss=1.065745 mse_soft=1.063422 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=16.336746 best_discrete=16.336746 hash=False elapsed=0.5s
step    25/700 tau=0.8866 loss=0.934896 mse_soft=0.932645 ent_in=3.7418 ent_out=3.7624 rowmax_in=0.0373 rowmax_out=0.0363 discrete_mse=2077.942627 best_discrete=16.336746 hash=False elapsed=2.7s
step    50/700 tau=0.7821 loss=0.711272 mse_soft=0.709238 ent_in=3.3583 ent_out=3.4231 rowmax_in=0.0689 rowmax_out=0.0673 discrete_mse=1864.805298 best_discrete=16.336746 hash=False elapsed=5.2s
step    75/700 tau=0.6899 loss=0.588960 mse_soft=0.587164 ent_in=2.9381 ent_out=3.0494 rowmax_in=0.1318 rowmax_out=0.1218 discrete_mse=1955.850342 best_discrete=16.336746 hash=False elapsed=7.6s
step   100/700 tau=0.6086 loss=0.472114 mse_soft=0.470671 ent_in=2.4070 ent_out=2.4041 rowmax_in=0.2482 rowmax_out=0.2612 discrete_mse=182.097839 best_discrete=16.336746 hash=False elapsed=10.0s
step   125/700 tau=0.5368 loss=0.380881 mse_soft=0.379842 ent_in=1.8092 ent_out=1.6523 rowmax_in=0.4002 rowmax_out=0.4837 discrete_mse=604.651367 best_discrete=16.336746 hash=False elapsed=12.1s
step   150/700 tau=0.4736 loss=0.331079 mse_soft=0.330315 ent_in=1.4537 ent_out=1.0927 rowmax_in=0.4715 rowmax_out=0.6328 discrete_mse=37.146923 best_discrete=16.336746 hash=False elapsed=14.5s
step   175/700 tau=0.4177 loss=0.306144 mse_soft=0.305545 ent_in=1.2578 ent_out=0.7403 rowmax_in=0.5081 rowmax_out=0.7157 discrete_mse=312.198120 best_discrete=16.336746 hash=False elapsed=17.1s
step   200/700 tau=0.3685 loss=0.296632 mse_soft=0.296102 ent_in=1.1775 ent_out=0.5912 rowmax_in=0.5207 rowmax_out=0.7522 discrete_mse=88.546471 best_discrete=16.336746 hash=False elapsed=19.4s
step   225/700 tau=0.3251 loss=0.290755 mse_soft=0.290266 ent_in=1.1239 ent_out=0.5085 rowmax_in=0.5375 rowmax_out=0.7793 discrete_mse=46.837791 best_discrete=16.336746 hash=False elapsed=21.7s
step   250/700 tau=0.2868 loss=0.286935 mse_soft=0.286471 ent_in=1.0828 ent_out=0.4643 rowmax_in=0.5476 rowmax_out=0.7962 discrete_mse=32.642109 best_discrete=16.336746 hash=False elapsed=24.1s
step   275/700 tau=0.2530 loss=0.284715 mse_soft=0.284267 ent_in=1.0592 ent_out=0.4327 rowmax_in=0.5480 rowmax_out=0.8089 discrete_mse=140.798645 best_discrete=16.336746 hash=False elapsed=26.6s
step   300/700 tau=0.2231 loss=0.283972 mse_soft=0.283540 ent_in=1.0401 ent_out=0.3993 rowmax_in=0.5487 rowmax_out=0.8180 discrete_mse=140.798645 best_discrete=16.336746 hash=False elapsed=29.1s
step   325/700 tau=0.1968 loss=0.283812 mse_soft=0.283388 ent_in=1.0312 ent_out=0.3811 rowmax_in=0.5495 rowmax_out=0.8250 discrete_mse=128.760376 best_discrete=16.336746 hash=False elapsed=31.4s
step   350/700 tau=0.1736 loss=0.284138 mse_soft=0.283717 ent_in=1.0256 ent_out=0.3778 rowmax_in=0.5486 rowmax_out=0.8260 discrete_mse=128.760376 best_discrete=16.336746 hash=False elapsed=33.7s
step   375/700 tau=0.1532 loss=0.283427 mse_soft=0.283009 ent_in=1.0212 ent_out=0.3741 rowmax_in=0.5495 rowmax_out=0.8266 discrete_mse=128.760376 best_discrete=16.336746 hash=False elapsed=36.0s
step   400/700 tau=0.1351 loss=0.283130 mse_soft=0.282713 ent_in=1.0195 ent_out=0.3714 rowmax_in=0.5499 rowmax_out=0.8290 discrete_mse=128.760376 best_discrete=16.336746 hash=False elapsed=38.4s
step   425/700 tau=0.1192 loss=0.287359 mse_soft=0.286943 ent_in=1.0176 ent_out=0.3684 rowmax_in=0.5508 rowmax_out=0.8298 discrete_mse=140.798645 best_discrete=16.336746 hash=False elapsed=40.9s
step   450/700 tau=0.1051 loss=0.283090 mse_soft=0.282675 ent_in=1.0154 ent_out=0.3685 rowmax_in=0.5505 rowmax_out=0.8287 discrete_mse=140.798645 best_discrete=16.336746 hash=False elapsed=43.3s
step   475/700 tau=0.0928 loss=0.289882 mse_soft=0.289465 ent_in=1.0093 ent_out=0.3827 rowmax_in=0.5501 rowmax_out=0.8156 discrete_mse=99.256866 best_discrete=16.336746 hash=False elapsed=45.8s
step   500/700 tau=0.0818 loss=0.282842 mse_soft=0.282428 ent_in=1.0025 ent_out=0.3786 rowmax_in=0.5541 rowmax_out=0.8150 discrete_mse=180.198914 best_discrete=16.336746 hash=False elapsed=48.4s
step   525/700 tau=0.0722 loss=0.292483 mse_soft=0.292074 ent_in=0.9916 ent_out=0.3701 rowmax_in=0.5586 rowmax_out=0.8180 discrete_mse=82.656326 best_discrete=16.336746 hash=False elapsed=50.8s
step   550/700 tau=0.0637 loss=0.289058 mse_soft=0.288651 ent_in=0.9879 ent_out=0.3673 rowmax_in=0.5584 rowmax_out=0.8133 discrete_mse=191.022354 best_discrete=16.336746 hash=False elapsed=53.1s
step   575/700 tau=0.0562 loss=0.289678 mse_soft=0.289278 ent_in=0.9788 ent_out=0.3539 rowmax_in=0.5635 rowmax_out=0.8191 discrete_mse=79.809677 best_discrete=16.336746 hash=False elapsed=55.7s
step   600/700 tau=0.0495 loss=0.292829 mse_soft=0.292445 ent_in=0.9456 ent_out=0.3341 rowmax_in=0.5606 rowmax_out=0.8320 discrete_mse=29.368086 best_discrete=16.336746 hash=False elapsed=58.0s
step   625/700 tau=0.0437 loss=0.300442 mse_soft=0.300072 ent_in=0.9166 ent_out=0.3163 rowmax_in=0.5813 rowmax_out=0.8373 discrete_mse=35.816292 best_discrete=16.336746 hash=False elapsed=60.5s
step   650/700 tau=0.0386 loss=0.292492 mse_soft=0.292133 ent_in=0.8928 ent_out=0.3049 rowmax_in=0.5856 rowmax_out=0.8446 discrete_mse=93.516556 best_discrete=16.336746 hash=False elapsed=63.1s
step   675/700 tau=0.0340 loss=0.432646 mse_soft=0.432399 ent_in=0.5924 ent_out=0.2325 rowmax_in=0.7067 rowmax_out=0.8889 discrete_mse=78.851204 best_discrete=16.336746 hash=False elapsed=65.5s
step   700/700 tau=0.0300 loss=0.357243 mse_soft=0.357006 ent_in=0.5264 ent_out=0.2636 rowmax_in=0.7250 rowmax_out=0.8606 discrete_mse=16.393099 best_discrete=16.336746 hash=False elapsed=67.9s

Final metrics:
  soft_mse_full=0.356901
  rowmax_in_mean=0.7275
  rowmax_out_mean=0.8619
  ent_in_mean=0.5266
  ent_out_mean=0.2634
  final_discrete_mse=16.393099
  hash_match=False
  best_discrete_mse_seen=16.336746
Saved results to overnight_b235_j3.json
