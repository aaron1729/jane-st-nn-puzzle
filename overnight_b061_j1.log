Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.080274 mse_soft=1.077951 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=41.326283 best_discrete=41.326283 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.874069 mse_soft=0.871879 ent_in=3.6310 ent_out=3.6672 rowmax_in=0.0457 rowmax_out=0.0439 discrete_mse=1452.539307 best_discrete=41.326283 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.647722 mse_soft=0.645824 ent_in=3.1164 ent_out=3.2091 rowmax_in=0.0919 rowmax_out=0.0894 discrete_mse=10527.134766 best_discrete=41.326283 hash=False elapsed=5.2s
step    75/900 tau=0.7493 loss=0.512679 mse_soft=0.511099 ent_in=2.5957 ent_out=2.6710 rowmax_in=0.2057 rowmax_out=0.1972 discrete_mse=5491.271973 best_discrete=41.326283 hash=False elapsed=7.5s
step   100/900 tau=0.6797 loss=0.410902 mse_soft=0.409717 ent_in=2.0437 ent_out=1.9068 rowmax_in=0.3372 rowmax_out=0.3966 discrete_mse=7600.054199 best_discrete=41.326283 hash=False elapsed=10.1s
step   125/900 tau=0.6165 loss=0.347515 mse_soft=0.346651 ent_in=1.7026 ent_out=1.1775 rowmax_in=0.4072 rowmax_out=0.6185 discrete_mse=55.298328 best_discrete=41.326283 hash=False elapsed=12.6s
step   150/900 tau=0.5592 loss=0.313510 mse_soft=0.312829 ent_in=1.4672 ent_out=0.8017 rowmax_in=0.4524 rowmax_out=0.7174 discrete_mse=134.026352 best_discrete=41.326283 hash=False elapsed=14.9s
step   175/900 tau=0.5073 loss=0.297417 mse_soft=0.296845 ent_in=1.3107 ent_out=0.5938 rowmax_in=0.4888 rowmax_out=0.7700 discrete_mse=744.579590 best_discrete=41.326283 hash=False elapsed=17.3s
step   200/900 tau=0.4602 loss=0.289683 mse_soft=0.289163 ent_in=1.2328 ent_out=0.4991 rowmax_in=0.5019 rowmax_out=0.7924 discrete_mse=217.121201 best_discrete=41.326283 hash=False elapsed=19.8s
step   225/900 tau=0.4174 loss=0.284153 mse_soft=0.283668 ent_in=1.1759 ent_out=0.4418 rowmax_in=0.5130 rowmax_out=0.8092 discrete_mse=151.571396 best_discrete=41.326283 hash=False elapsed=22.2s
step   250/900 tau=0.3786 loss=0.280143 mse_soft=0.279680 ent_in=1.1427 ent_out=0.4023 rowmax_in=0.5185 rowmax_out=0.8225 discrete_mse=102.550323 best_discrete=41.326283 hash=False elapsed=24.5s
step   275/900 tau=0.3434 loss=0.277869 mse_soft=0.277419 ent_in=1.1195 ent_out=0.3799 rowmax_in=0.5267 rowmax_out=0.8301 discrete_mse=285.947906 best_discrete=41.326283 hash=False elapsed=27.1s
step   300/900 tau=0.3115 loss=0.276275 mse_soft=0.275834 ent_in=1.1032 ent_out=0.3673 rowmax_in=0.5269 rowmax_out=0.8315 discrete_mse=184.761368 best_discrete=41.326283 hash=False elapsed=29.6s
step   325/900 tau=0.2826 loss=0.274298 mse_soft=0.273863 ent_in=1.0901 ent_out=0.3612 rowmax_in=0.5290 rowmax_out=0.8344 discrete_mse=252.061264 best_discrete=41.326283 hash=False elapsed=32.0s
step   350/900 tau=0.2563 loss=0.274253 mse_soft=0.273821 ent_in=1.0821 ent_out=0.3596 rowmax_in=0.5286 rowmax_out=0.8351 discrete_mse=252.061264 best_discrete=41.326283 hash=False elapsed=34.3s
step   375/900 tau=0.2325 loss=0.274590 mse_soft=0.274160 ent_in=1.0776 ent_out=0.3556 rowmax_in=0.5283 rowmax_out=0.8369 discrete_mse=376.896393 best_discrete=41.326283 hash=False elapsed=36.5s
step   400/900 tau=0.2109 loss=0.275675 mse_soft=0.275246 ent_in=1.0747 ent_out=0.3552 rowmax_in=0.5273 rowmax_out=0.8354 discrete_mse=287.317688 best_discrete=41.326283 hash=False elapsed=38.9s
step   425/900 tau=0.1913 loss=0.272913 mse_soft=0.272485 ent_in=1.0730 ent_out=0.3533 rowmax_in=0.5277 rowmax_out=0.8368 discrete_mse=287.317688 best_discrete=41.326283 hash=False elapsed=41.1s
step   450/900 tau=0.1735 loss=0.273186 mse_soft=0.272758 ent_in=1.0735 ent_out=0.3518 rowmax_in=0.5265 rowmax_out=0.8378 discrete_mse=287.317688 best_discrete=41.326283 hash=False elapsed=43.2s
step   475/900 tau=0.1574 loss=0.274505 mse_soft=0.274076 ent_in=1.0742 ent_out=0.3531 rowmax_in=0.5257 rowmax_out=0.8357 discrete_mse=399.595825 best_discrete=41.326283 hash=False elapsed=45.5s
step   500/900 tau=0.1428 loss=0.277867 mse_soft=0.277439 ent_in=1.0732 ent_out=0.3531 rowmax_in=0.5271 rowmax_out=0.8367 discrete_mse=287.317688 best_discrete=41.326283 hash=False elapsed=47.6s
step   525/900 tau=0.1295 loss=0.274510 mse_soft=0.274080 ent_in=1.0757 ent_out=0.3572 rowmax_in=0.5241 rowmax_out=0.8330 discrete_mse=287.317688 best_discrete=41.326283 hash=False elapsed=49.9s
step   550/900 tau=0.1175 loss=0.284793 mse_soft=0.284365 ent_in=1.0724 ent_out=0.3537 rowmax_in=0.5215 rowmax_out=0.8282 discrete_mse=525.040222 best_discrete=41.326283 hash=False elapsed=52.2s
step   575/900 tau=0.1066 loss=0.277399 mse_soft=0.276977 ent_in=1.0662 ent_out=0.3404 rowmax_in=0.5217 rowmax_out=0.8323 discrete_mse=233.500641 best_discrete=41.326283 hash=False elapsed=54.5s
step   600/900 tau=0.0967 loss=0.280747 mse_soft=0.280327 ent_in=1.0603 ent_out=0.3379 rowmax_in=0.5230 rowmax_out=0.8351 discrete_mse=529.326111 best_discrete=41.326283 hash=False elapsed=56.7s
step   625/900 tau=0.0877 loss=0.282354 mse_soft=0.281940 ent_in=1.0412 ent_out=0.3384 rowmax_in=0.5312 rowmax_out=0.8280 discrete_mse=463.304901 best_discrete=41.326283 hash=False elapsed=58.9s
step   650/900 tau=0.0795 loss=0.329924 mse_soft=0.329538 ent_in=0.9816 ent_out=0.3062 rowmax_in=0.5612 rowmax_out=0.8691 discrete_mse=92.081474 best_discrete=41.326283 hash=False elapsed=61.2s
step   675/900 tau=0.0722 loss=0.385549 mse_soft=0.385264 ent_in=0.7249 ent_out=0.2219 rowmax_in=0.6654 rowmax_out=0.8916 discrete_mse=115.713493 best_discrete=41.326283 hash=False elapsed=63.7s
step   700/900 tau=0.0655 loss=0.336645 mse_soft=0.336360 ent_in=0.7254 ent_out=0.2229 rowmax_in=0.6489 rowmax_out=0.8953 discrete_mse=79.362755 best_discrete=41.326283 hash=False elapsed=65.9s
step   725/900 tau=0.0594 loss=0.328549 mse_soft=0.328260 ent_in=0.7358 ent_out=0.2289 rowmax_in=0.6350 rowmax_out=0.8895 discrete_mse=60.029156 best_discrete=41.326283 hash=False elapsed=68.2s
step   750/900 tau=0.0539 loss=0.325375 mse_soft=0.325084 ent_in=0.7491 ent_out=0.2242 rowmax_in=0.6230 rowmax_out=0.8911 discrete_mse=40.094662 best_discrete=40.094662 hash=False elapsed=70.5s
step   775/900 tau=0.0489 loss=0.332896 mse_soft=0.332604 ent_in=0.7511 ent_out=0.2203 rowmax_in=0.6198 rowmax_out=0.8938 discrete_mse=50.385326 best_discrete=40.094662 hash=False elapsed=72.8s
step   800/900 tau=0.0443 loss=0.351712 mse_soft=0.351424 ent_in=0.7390 ent_out=0.2227 rowmax_in=0.6232 rowmax_out=0.8905 discrete_mse=30.292461 best_discrete=30.292461 hash=False elapsed=75.1s
step   825/900 tau=0.0402 loss=0.462509 mse_soft=0.462341 ent_in=0.3862 ent_out=0.1728 rowmax_in=0.8088 rowmax_out=0.9104 discrete_mse=26.907236 best_discrete=26.907236 hash=False elapsed=77.4s
step   850/900 tau=0.0365 loss=0.407796 mse_soft=0.407640 ent_in=0.3866 ent_out=0.1323 rowmax_in=0.8050 rowmax_out=0.9317 discrete_mse=16.658161 best_discrete=16.658161 hash=False elapsed=79.6s
step   875/900 tau=0.0331 loss=0.400701 mse_soft=0.400546 ent_in=0.3941 ent_out=0.1237 rowmax_in=0.8029 rowmax_out=0.9380 discrete_mse=20.699728 best_discrete=16.658161 hash=False elapsed=82.1s
step   900/900 tau=0.0300 loss=0.399835 mse_soft=0.399683 ent_in=0.3811 ent_out=0.1238 rowmax_in=0.8104 rowmax_out=0.9383 discrete_mse=24.464334 best_discrete=16.658161 hash=False elapsed=84.5s

Final metrics:
  soft_mse_full=0.405250
  rowmax_in_mean=0.8059
  rowmax_out_mean=0.9374
  ent_in_mean=0.3836
  ent_out_mean=0.1256
  final_discrete_mse=24.464334
  hash_match=False
  best_discrete_mse_seen=16.658161
Saved results to overnight_b061_j1.json
