Using device: cuda
Train rows: 4096 / Full rows: 10000, steps=900, lr=0.03
step     1/900 tau=1.0000 loss=1.071466 mse_soft=1.069144 ent_in=3.8712 ent_out=3.8712 rowmax_in=0.0213 rowmax_out=0.0213 discrete_mse=51.129425 best_discrete=51.129425 hash=False elapsed=0.5s
step    25/900 tau=0.9106 loss=0.867824 mse_soft=0.865634 ent_in=3.6332 ent_out=3.6662 rowmax_in=0.0455 rowmax_out=0.0450 discrete_mse=3509.713867 best_discrete=51.129425 hash=False elapsed=2.8s
step    50/900 tau=0.8260 loss=0.652780 mse_soft=0.650871 ent_in=3.1385 ent_out=3.2265 rowmax_in=0.0895 rowmax_out=0.0869 discrete_mse=859.645508 best_discrete=51.129425 hash=False elapsed=5.3s
step    75/900 tau=0.7493 loss=0.506021 mse_soft=0.504436 ent_in=2.5988 ent_out=2.6830 rowmax_in=0.2031 rowmax_out=0.1978 discrete_mse=590.456360 best_discrete=51.129425 hash=False elapsed=7.7s
step   100/900 tau=0.6797 loss=0.402814 mse_soft=0.401651 ent_in=1.9729 ent_out=1.9038 rowmax_in=0.3707 rowmax_out=0.3984 discrete_mse=2085.055176 best_discrete=51.129425 hash=False elapsed=10.1s
step   125/900 tau=0.6165 loss=0.347348 mse_soft=0.346485 ent_in=1.5725 ent_out=1.3063 rowmax_in=0.4728 rowmax_out=0.5424 discrete_mse=1847.651123 best_discrete=51.129425 hash=False elapsed=12.3s
step   150/900 tau=0.5592 loss=0.322909 mse_soft=0.322201 ent_in=1.3943 ent_out=0.9676 rowmax_in=0.5098 rowmax_out=0.6279 discrete_mse=642.667175 best_discrete=51.129425 hash=False elapsed=14.6s
step   175/900 tau=0.5073 loss=0.307655 mse_soft=0.307027 ent_in=1.3021 ent_out=0.7905 rowmax_in=0.5163 rowmax_out=0.6762 discrete_mse=698.844482 best_discrete=51.129425 hash=False elapsed=16.7s
step   200/900 tau=0.4602 loss=0.299545 mse_soft=0.298959 ent_in=1.2537 ent_out=0.7001 rowmax_in=0.5212 rowmax_out=0.6914 discrete_mse=916.781799 best_discrete=51.129425 hash=False elapsed=18.9s
step   225/900 tau=0.4174 loss=0.293071 mse_soft=0.292514 ent_in=1.2096 ent_out=0.6461 rowmax_in=0.5262 rowmax_out=0.7136 discrete_mse=1090.841309 best_discrete=51.129425 hash=False elapsed=21.2s
step   250/900 tau=0.3786 loss=0.290944 mse_soft=0.290413 ent_in=1.1871 ent_out=0.5822 rowmax_in=0.5252 rowmax_out=0.7404 discrete_mse=520.887390 best_discrete=51.129425 hash=False elapsed=23.7s
step   275/900 tau=0.3434 loss=0.285779 mse_soft=0.285268 ent_in=1.1663 ent_out=0.5368 rowmax_in=0.5284 rowmax_out=0.7597 discrete_mse=520.887390 best_discrete=51.129425 hash=False elapsed=26.0s
step   300/900 tau=0.3115 loss=0.283839 mse_soft=0.283342 ent_in=1.1461 ent_out=0.5106 rowmax_in=0.5309 rowmax_out=0.7686 discrete_mse=520.887390 best_discrete=51.129425 hash=False elapsed=28.3s
step   325/900 tau=0.2826 loss=0.283916 mse_soft=0.283429 ent_in=1.1294 ent_out=0.4935 rowmax_in=0.5340 rowmax_out=0.7745 discrete_mse=520.887390 best_discrete=51.129425 hash=False elapsed=30.4s
step   350/900 tau=0.2563 loss=0.282057 mse_soft=0.281582 ent_in=1.1109 ent_out=0.4734 rowmax_in=0.5388 rowmax_out=0.7829 discrete_mse=325.080841 best_discrete=51.129425 hash=False elapsed=32.5s
step   375/900 tau=0.2325 loss=0.279418 mse_soft=0.278954 ent_in=1.0871 ent_out=0.4565 rowmax_in=0.5445 rowmax_out=0.7892 discrete_mse=543.975891 best_discrete=51.129425 hash=False elapsed=34.9s
step   400/900 tau=0.2109 loss=0.279378 mse_soft=0.278923 ent_in=1.0752 ent_out=0.4416 rowmax_in=0.5462 rowmax_out=0.7952 discrete_mse=389.869751 best_discrete=51.129425 hash=False elapsed=37.1s
step   425/900 tau=0.1913 loss=0.282001 mse_soft=0.281554 ent_in=1.0624 ent_out=0.4298 rowmax_in=0.5481 rowmax_out=0.8018 discrete_mse=389.869751 best_discrete=51.129425 hash=False elapsed=39.4s
step   450/900 tau=0.1735 loss=0.281051 mse_soft=0.280608 ent_in=1.0569 ent_out=0.4198 rowmax_in=0.5468 rowmax_out=0.8061 discrete_mse=389.869751 best_discrete=51.129425 hash=False elapsed=41.8s
step   475/900 tau=0.1574 loss=0.279745 mse_soft=0.279306 ent_in=1.0541 ent_out=0.4102 rowmax_in=0.5458 rowmax_out=0.8143 discrete_mse=1251.820801 best_discrete=51.129425 hash=False elapsed=43.9s
step   500/900 tau=0.1428 loss=0.280969 mse_soft=0.280532 ent_in=1.0523 ent_out=0.4017 rowmax_in=0.5449 rowmax_out=0.8180 discrete_mse=1243.797241 best_discrete=51.129425 hash=False elapsed=46.0s
step   525/900 tau=0.1295 loss=0.284028 mse_soft=0.283596 ent_in=1.0464 ent_out=0.3929 rowmax_in=0.5466 rowmax_out=0.8220 discrete_mse=677.478760 best_discrete=51.129425 hash=False elapsed=48.3s
step   550/900 tau=0.1175 loss=0.298164 mse_soft=0.297734 ent_in=1.0480 ent_out=0.3851 rowmax_in=0.5454 rowmax_out=0.8242 discrete_mse=291.081970 best_discrete=51.129425 hash=False elapsed=50.3s
step   575/900 tau=0.1066 loss=0.282633 mse_soft=0.282209 ent_in=1.0271 ent_out=0.3863 rowmax_in=0.5542 rowmax_out=0.8179 discrete_mse=765.142273 best_discrete=51.129425 hash=False elapsed=52.3s
step   600/900 tau=0.0967 loss=0.286958 mse_soft=0.286547 ent_in=1.0072 ent_out=0.3622 rowmax_in=0.5593 rowmax_out=0.8275 discrete_mse=640.418579 best_discrete=51.129425 hash=False elapsed=54.6s
step   625/900 tau=0.0877 loss=0.393847 mse_soft=0.393494 ent_in=0.9079 ent_out=0.2677 rowmax_in=0.5977 rowmax_out=0.8829 discrete_mse=21.098494 best_discrete=21.098494 hash=False elapsed=56.9s
step   650/900 tau=0.0795 loss=0.383729 mse_soft=0.383435 ent_in=0.6942 ent_out=0.2864 rowmax_in=0.6909 rowmax_out=0.8558 discrete_mse=68.991310 best_discrete=21.098494 hash=False elapsed=59.2s
step   675/900 tau=0.0722 loss=0.351243 mse_soft=0.350964 ent_in=0.6509 ent_out=0.2770 rowmax_in=0.6978 rowmax_out=0.8565 discrete_mse=36.464211 best_discrete=21.098494 hash=False elapsed=61.6s
step   700/900 tau=0.0655 loss=0.365116 mse_soft=0.364840 ent_in=0.6621 ent_out=0.2602 rowmax_in=0.6907 rowmax_out=0.8686 discrete_mse=41.470787 best_discrete=21.098494 hash=False elapsed=63.9s
step   725/900 tau=0.0594 loss=0.341757 mse_soft=0.341495 ent_in=0.6296 ent_out=0.2419 rowmax_in=0.6904 rowmax_out=0.8736 discrete_mse=60.649006 best_discrete=21.098494 hash=False elapsed=66.1s
step   750/900 tau=0.0539 loss=0.373371 mse_soft=0.373108 ent_in=0.6417 ent_out=0.2358 rowmax_in=0.6966 rowmax_out=0.8716 discrete_mse=43.388985 best_discrete=21.098494 hash=False elapsed=68.3s
step   775/900 tau=0.0489 loss=0.343544 mse_soft=0.343286 ent_in=0.6355 ent_out=0.2249 rowmax_in=0.6879 rowmax_out=0.8858 discrete_mse=60.649006 best_discrete=21.098494 hash=False elapsed=70.5s
step   800/900 tau=0.0443 loss=0.351479 mse_soft=0.351216 ent_in=0.6462 ent_out=0.2294 rowmax_in=0.6805 rowmax_out=0.8778 discrete_mse=43.388985 best_discrete=21.098494 hash=False elapsed=72.9s
step   825/900 tau=0.0402 loss=0.467089 mse_soft=0.466906 ent_in=0.4579 ent_out=0.1513 rowmax_in=0.7577 rowmax_out=0.9288 discrete_mse=112.979332 best_discrete=21.098494 hash=False elapsed=75.0s
step   850/900 tau=0.0365 loss=0.412940 mse_soft=0.412771 ent_in=0.4152 ent_out=0.1484 rowmax_in=0.7818 rowmax_out=0.9304 discrete_mse=87.921997 best_discrete=21.098494 hash=False elapsed=77.1s
step   875/900 tau=0.0331 loss=0.407410 mse_soft=0.407242 ent_in=0.4129 ent_out=0.1473 rowmax_in=0.7837 rowmax_out=0.9321 discrete_mse=85.834816 best_discrete=21.098494 hash=False elapsed=79.3s
step   900/900 tau=0.0300 loss=0.387883 mse_soft=0.387702 ent_in=0.4378 ent_out=0.1653 rowmax_in=0.7756 rowmax_out=0.9030 discrete_mse=76.095558 best_discrete=21.098494 hash=False elapsed=81.4s

Final metrics:
  soft_mse_full=0.397736
  rowmax_in_mean=0.7704
  rowmax_out_mean=0.9011
  ent_in_mean=0.4430
  ent_out_mean=0.1666
  final_discrete_mse=82.215485
  hash_match=False
  best_discrete_mse_seen=21.098494
Saved results to overnight_b227_j1.json
